/*! WooCommerce Free Gift Coupons 3.4.2 2023-01-12 17:30 */
let WC_Free_Gift_Coupons={};!function(i){i.Product=Backbone.Model.extend({defaults:{quantity:1,title:"",product_id:"",variation_id:"",gift_id:""},initialize:function(){this.get("gift_id").length||this.set("gift_id",0<this.get("variation_id")?this.get("variation_id"):this.get("product_id"))}}),i.ProductsCollection=Backbone.Collection.extend({model:i.Product,el:"#wc-free-gift-container"}),i.productView=Backbone.View.extend({model:i.Product,tagName:"tr",events:{"click .delete-product":"removeProduct","change .product-quantity :input":"setQuantity"},template:wp.template("wc-free-gift-product"),render:function(){return this.$el.html(this.template(this.model.toJSON())),this},reorder:function(e,t){this.$el.trigger("update-sort",[this.model,t])},removeProduct:function(e){e.preventDefault(),this.model.destroy(),i.productList.render()},setQuantity:function(){var e=this.$el.find(".product-quantity :input").val();this.model.set("quantity",e)}}),i.productListTable=Backbone.View.extend({el:"#wc-free-gift-table",template:wp.template("wc-free-gift-products-table-header"),addSingle:function(e){e=new i.productView({model:e});this.$el.find("tbody").prepend(e.render().el)},addProduct:function(e,t){t=new i.Product(t);this.collection.add(t,{at:0}),this.render()},events:{"click .delete-product":"removeProduct",addFreeGiftProduct:"addProduct"},render:function(){return this.$el.children().remove(),this.collection.length&&(this.$el.html(this.template()),this.collection.each(function(e){this.$el.find("tbody").append(new i.productView({model:e}).render().el)},this)),this}}),i.initApplication=function(){i.productCollection=new i.ProductsCollection(woocommerce_free_gift_coupon_meta_i18n.free_gifts),i.productList=new i.productListTable({collection:i.productCollection}),i.productList.render()},jQuery(function(o){i.initApplication(),o("#wc-free-gift-table").sortable({items:"tbody > tr",handle:".product-title",axis:"y",opacity:.5,grid:[20,10],tolerance:"pointer"}),o(document.body).trigger("wc-enhanced-select-init"),o("#free_gift_ids").hasClass("select2-hidden-accessible")&&o("#free_gift_ids").on("select2:select",function(e){var e=e.params.data;e.id.length&&(e={gift_id:e.id,title:e.text},o("#wc-free-gift-table").trigger("addFreeGiftProduct",e),o(this).val([]).trigger("change"),o("#wc-free-gift-table").sortable("refresh"))}),o("select#discount_type").change(function(){var e=o(this).val(),t=o(".coupon_amount_field"),i=jQuery.parseJSON(woocommerce_free_gift_coupon_meta_i18n.coupon_types);-1!==o.inArray(e,i)?(o(".show_if_free_gift").show(),"free_gift"===e?t.hide():t.show()):(o(".show_if_free_gift").hide(),t.show())}).trigger("change")})}((jQuery,WC_Free_Gift_Coupons));