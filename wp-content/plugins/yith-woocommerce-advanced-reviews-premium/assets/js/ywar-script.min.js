jQuery(function(n){n("body").off("click","#respond #submit");var o='<div id="modal_reviews" class="pp_pic_holder"><a class="pp_close" href="#"></a><div class="pp_content_container"><div class="pp_left"><div class="pp_right"><div class="pp_content"><div class="pp_loaderIcon"></div><div class="pp_fade"><a href="#" class="pp_expand" title="Expand the image">Expand</a><div id="pp_full_res"></div><div class="pp_details"><div class="pp_nav"><a href="#" class="pp_arrow_previous">Previous</a><p class="currentTextHolder">0/0</p><a href="#" class="pp_arrow_next">Next</a></div><p class="pp_description"></p></div></div></div></div></div></div></div><div class="pp_overlay"></div>';function a(){n("#unvalidated_rating").prop("name","rating"),n("#unvalidated_rating").prop("id","rating"),n("#title").val(""),n("textarea#comment").val(""),n("form#commentform").removeClass("edit-review"),n("form#commentform input#review_id").remove(),n("p.comment-form-rating").show(),n("p.upload_section").show(),n(".review_label").text(ywar.add_review_title)}function r(e){n(e).block({message:null,overlayCSS:{background:"#fff url("+ywar.loader+") no-repeat center",opacity:.6}})}function i(e){var t=n(e).attr("data-id_product"),o=n(e).attr("data-order"),a=n(e).attr("data-stars"),r=n(e).attr("data-page"),e=n(e).attr("data-dialog"),i=window.location.href.split("?")[0];return{action:"get_ajax_comments",product_id:t,stars:a,order:o,data_page:r,is_modal:e,_wpnonce:ywar.nonce_value,return_path:i}}n(document).on("click touchstart","#cancel-comment-reply-link",function(e){a()}),n(document).on("click","a.ywar_votereview",function(e){var t,o,a,r,i;e.preventDefault(),n(this).hasClass("ywar_votereview_selected")||(e=n(this).attr("data-id_review"),t=n(this).attr("data-vote_review"),o=window.location.href.split("?")[0],o={action:"vote_review",id_review:e,review_value:t,_wpnonce:ywar.nonce_value,return_path:o},a="#vote_yes_"+e,r="#vote_no_"+e,(i=n(this).parent()).block({message:null,overlayCSS:{background:"#fff url("+ywar.loader+") no-repeat center",opacity:.6}}),n.post(woocommerce_params.ajax_url,o,function(e){-1==e.code?top.location.replace(e.value):1==e.code&&((1==t?(n(a).addClass("vote_selected"),n(r)):(n(r).addClass("vote_selected"),n(a))).removeClass("vote_selected"),i.children(".ywar_review_helpful").empty().append(e.value)),i.unblock()}))}),n(document).on("click","a.review-inappropriate",function(e){e.preventDefault();var e=n(this).attr("data-id_review"),t=window.location.href.split("?")[0],e={action:"report_inappropriate_review",id_review:e,_wpnonce:ywar.nonce_value,return_path:t},o=n(this).parent();o.block({message:null,overlayCSS:{background:"#fff url("+ywar.loader+") no-repeat center",opacity:.6}}),n.post(woocommerce_params.ajax_url,e,function(e){o.empty().append('<span class="inappropriate-content reported">'+e.value+"</span"),o.unblock()})}),n("#reviews #comments>h2").remove(),ywar.review_section_anchor&&n('a[href="#reviews"]').attr("href","#reviews_summary"),n(document).on("click","a.ywar_filter_reviews",function(e){e.preventDefault(),a();var t=n(this).attr("data-dialog");1!=t&&r("#reviews_summary"),n.post(woocommerce_params.ajax_url,i(n(this)),function(e){1!=t?(n("#reviews_header").empty().append(e.review_title),n("#comments ol.commentlist").empty().append(e.comment_list),n("div.ywar_show_more").empty().append(e.load_more),n("#reviews_summary").unblock()):(n("#reviews_dialog").empty().append('<ol class="commentlist">'+e.comment_list+"</ol>"),n("#reviews_dialog").append('<div class="ywar_show_more">'+e.load_more+"</div>"),"function"==typeof n.fn.prettyPhoto&&(n().prettyPhoto({markup:o,default_width:"70%",default_height:"200px",social_tools:!1,theme:"pp_woocommerce",modal:!0,callback:function(){n("#reviews_dialog").empty()}}),n.prettyPhoto.open("#reviews_dialog","","")),n("div.pp_pic_holder.pp_woocommerce").appendTo("#comments"))},"json")}),n(document).on("click","a.ywar_show_more, button.ywar_show_more_container",function(e){e.preventDefault(),a();var t=n(this),o=(t=t.is("button")?t.children("a.ywar_show_more"):t).attr("data-dialog");1!=o&&r(t),n.post(woocommerce_params.ajax_url,i(t),function(e){1!=o?(n("#reviews_header").empty().append(e.review_title),n("#reviews ol.commentlist").append(e.comment_list),n(t).unblock(),"function"==typeof n.fn.prettyPhoto&&n("a[data-rel^='prettyPhoto']").prettyPhoto({hook:"data-rel",social_tools:!1,theme:"pp_woocommerce",horizontal_padding:20,opacity:.8,deeplinking:!1})):n("#modal_reviews ol.commentlist").append(e.comment_list),n("body div.ywar_show_more").empty().append(e.load_more)},"json")});var s=!1;if(n("body").on("click",".ywar-review-thumbnails a",function(e){e.preventDefault(),s||("function"==typeof n.fn.prettyPhoto&&n("a[data-rel^='prettyPhoto']").prettyPhoto({hook:"data-rel",social_tools:!1,theme:"pp_woocommerce",horizontal_padding:20,opacity:.8,deeplinking:!1}),s=!0,n(this).trigger("click"))}),n(document).on("click","a.ywar_filter_order",function(e){e.preventDefault(),a(),s=!1,r("#reviews_order");var t=n(this);n.post(woocommerce_params.ajax_url,i(n(this)),function(e){n("#reviews_header").empty().append(e.review_title),n("ol.commentlist").empty().append(e.comment_list),n("div.ywar_show_more").empty().append(e.load_more),"most_recent_reviews"==t.attr("id")?(n("#most_recent_reviews").addClass("active"),n("#most_helpful_reviews").removeClass("active")):"most_helpful_reviews"==t.attr("id")&&(n("#most_helpful_reviews").addClass("active"),n("#most_recent_reviews").removeClass("active")),n("#reviews_order").unblock()},"json")}),n("a.ywar_filter_order.active").trigger("click"),n(document).on("click","a.edit-my-reviews",function(e){e.preventDefault();e={action:"get_customer_reviews",product_id:n(this).data("product-id")};n("#ywar_reviews").block({message:null,overlayCSS:{background:"#fff url("+ywar.loader+") no-repeat center",opacity:.6}}),n(this);n.post(woocommerce_params.ajax_url,e,function(e){n("#reviews_header").empty().append(e.review_title),n("ol.commentlist").empty().append(e.comment_list),n("#ywar_reviews").unblock()},"json"),a()}),n(document).on("click","a.comment-reply-link",function(e){e.preventDefault(),e.stopImmediatePropagation(),n('select#rating option[value="5"]').prop("selected",!0),n("#title").val(""),n("textarea#comment").val(""),n("p.comment-form-rating").hide(),n("p.upload_section").hide(),n(".review_label").text(ywar.reply_to_review_title)}),n(document).on("click","a.comment-edit-link",function(e){e.preventDefault(),e.stopImmediatePropagation();var e=n(this).data("review-id"),e=(n("form#commentform").addClass("edit-review"),n("form#commentform").append('<input type="hidden" id="review-id" name="review-id" value="'+e+'" />'),n("p.upload_section").remove(),0!=n(this).data("parent")&&n("p.comment-form-rating").hide(),n(this).closest("div#comment-"+e)),t=e.find("span.review_title").text(),t=(n("form#commentform #title").val(t),e.find("span.review_content").text()),e=(n("form#commentform #comment").val(t),n(this).data("rating"));n('select#rating option[value="'+e+'"]').prop("selected",!0),n('.comment-form-rating a[class^="star-"]').removeClass("active"),n(".comment-form-rating a.star-"+e).addClass("active"),n(".review_label").text(ywar.edit_review_title)}),n(document).on("submit","form.edit-review",function(e){e.preventDefault();var t=n(this).parent(),o=(t.block({message:null,overlayCSS:{background:"#fff url("+ywar.loader+") no-repeat center",opacity:.6}}),n(this).find("#review-id").val()),e={action:"edit_review",review_id:o,review_title:n(this).find("#title").val(),review_content:n(this).find("textarea#comment").val(),review_rating:n(this).find("select#rating").val()};n.post(woocommerce_params.ajax_url,e,function(e){1==e.code&&n("#li-comment-"+o).replaceWith(e.content),t.unblock()}),a()}),n(document).on("click","a.goto-reviews",function(e){e.preventDefault(),a(),n.post(woocommerce_params.ajax_url,i(n(this)),function(e){1!=open_in_dialog?(n("#reviews_header").empty().append(e.review_title),n("#comments ol.commentlist").empty().append(e.comment_list),n("div.ywar_show_more").empty().append(e.load_more),n("#reviews_summary").unblock()):(n("#reviews_dialog").empty().append('<ol class="commentlist">'+e.comment_list+"</ol>"),n("#reviews_dialog").append('<div class="ywar_show_more">'+e.load_more+"</div>"),"function"==typeof n.fn.prettyPhoto&&(n().prettyPhoto({markup:o,default_width:"70%",default_height:"200px",social_tools:!1,theme:"pp_woocommerce",modal:!0,callback:function(){n("#reviews_dialog").empty()}}),n.prettyPhoto.open("#reviews_dialog","","")),n("div.pp_pic_holder.pp_woocommerce").appendTo("#comments"))},"json")}),n(document).on("click","#respond form#commentform #submit",function(e){n("span.empty-review").remove();var t=ywar.is_rating_required&&!n(this).closest("form").find("select#rating").val(),o=!n(this).closest("form").find("textarea#comment").val(),a=ywar.is_user_data_required&&0<n(this).closest("form").find(".comment-form-author #author").length&&!n(this).closest("form").find(".comment-form-author #author").val(),r=ywar.is_user_data_required&&0<n(this).closest("form").find(".comment-form-email #email").length&&!n(this).closest("form").find(".comment-form-email #email").val();t&&n(this).before('<span class="error empty-review">'+ywar.missing_rating_review+"</span>"),o&&n(this).before('<span class="error empty-review">'+ywar.empty_review_content+"</span>"),a&&n(this).before('<span class="error empty-review">'+ywar.empty_user_name+"</span>"),r&&n(this).before('<span class="error empty-review">'+ywar.empty_user_email+"</span>"),(t||o||a||r)&&e.preventDefault()}),1<jQuery(".ywar-review-content").length)for(let e=1;e<jQuery(".ywar-review-content").length;e++)jQuery(jQuery(jQuery(".ywar-review-content")[0]).find("p.comment-form-rating p.stars")[e-1]).appendTo(jQuery(".ywar-review-content p.comment-form-rating")[e])});