/*! For license information please see admin.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[328],{49868:function(){jQuery.AsyncQueue=function(){var e,t,a,s,n=this,o=[],r=!1;return s=function(){var e=o.shift();e?(e.apply(n,[n]),!1===r&&s()):t&&t.apply(n)},this.onFailure=function(t){e=t},this.onComplete=function(e){t=e},this.add=function(e){return o.push(e),this},this.storeData=function(e){return a=e,this},this.lastCallbackData=function(){return a},this.run=function(){r=!1,s()},this.pause=function(){return r=!0,this},this.failure=function(){if(r=!0,e){var t=[n];for(i=0;i<arguments.length;i++)t.push(arguments[i]);e.apply(n,t)}},this}},83653:function(e,t,i){e.exports={Experiment:i(54160).Z,Variant:i(95776).Z,emitter:i(91414).default,useExperiment:i(81116).default,experimentDebugger:i(11446),mixpanelHelper:i(80773).Z,segmentHelper:i(43013).Z}},82335:function(e,t,i){"use strict";function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var i=d(t);if(i&&i.has(e))return i.get(e);var s={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var r=n?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(s,o,r):s[o]=e[o]}return s.default=e,i&&i.set(e,s),s}(i(70079)),n=l(i(39519)),o=l(i(81116)),r=l(i(91414));function l(e){return e&&e.__esModule?e:{default:e}}function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(d=function(e){return e?i:t})(e)}var c=function(e){var t=(0,s.useMemo)((function(){return function(e,t){var i={};return s.default.Children.forEach(t,(function(t){if(!s.default.isValidElement(t)||"Pushtell.Variant"!==t.type.displayName){var a=new Error("Pushtell Experiment children must be Pushtell Variant components.");throw a.type="PUSHTELL_INVALID_CHILD",a}i[t.props.name]=t,r.default.addExperimentVariant(e,t.props.name)})),r.default.emit("variants-loaded",e),i}(e.name,e.children)}),[e.name,e.children]);return(0,(0,o.default)(e.name,e.userIdentifier,e.defaultVariantName).selectVariant)(t,[])};c.propTypes={name:n.default.string.isRequired,userIdentifier:n.default.string,defaultVariantName:n.default.string,children:n.default.node};var m=c;t.default=m},54160:function(e,t,i){"use strict";function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}t.Z=void 0;var s=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var i=c(t);if(i&&i.has(e))return i.get(e);var s={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var r=n?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(s,o,r):s[o]=e[o]}return s.default=e,i&&i.set(e,s),s}(i(70079)),n=d(i(39519)),o=d(i(82335)),r=d(i(91414)),l=d(i(70935));function d(e){return e&&e.__esModule?e:{default:e}}function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(c=function(e){return e?i:t})(e)}function m(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function g(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}r.default.addActiveVariantListener((function(e,t,i){i||l.default.setItem("PUSHTELL-"+e,t)}));var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,e);var t,i,n,l,d=(n=c,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(n);if(l){var i=h(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?p(e):t}(this,e)});function c(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return g(p(e=d.call.apply(d,[this].concat(i))),"win",(function(){r.default.emitWin(e.props.name)})),e}return t=c,(i=[{key:"render",value:function(){return s.default.createElement(o.default,this.props,this.props.children)}}])&&m(t.prototype,i),c}(s.Component);t.Z=f,g(f,"propTypes",{name:n.default.string.isRequired,defaultVariantName:n.default.string,userIdentifier:n.default.string,children:n.default.node}),g(f,"displayName","Pushtell.Experiment")},95776:function(e,t,i){"use strict";function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}t.Z=void 0;var s,n=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var i=r(t);if(i&&i.has(e))return i.get(e);var s={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var l=n?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(s,o,l):s[o]=e[o]}return s.default=e,i&&i.set(e,s),s}(i(70079)),o=(s=i(39519))&&s.__esModule?s:{default:s};function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(r=function(e){return e?i:t})(e)}function l(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function m(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(m,e);var t,i,s,o,r=(s=m,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=c(s);if(o){var i=c(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function m(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),r.apply(this,arguments)}return t=m,(i=[{key:"render",value:function(){return n.default.isValidElement(this.props.children)?this.props.children:n.default.createElement("span",null,this.props.children)}}])&&l(t.prototype,i),m}(n.Component);t.Z=u,m(u,"propTypes",{name:o.default.string.isRequired}),m(u,"displayName","Pushtell.Variant")},49382:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(i(13003)),s=o(i(91414)),n=o(i(70935));function o(e){return e&&e.__esModule?e:{default:e}}var r=function(e,t){for(var i=s.default.getSortedVariants(e),n=s.default.getSortedVariantWeights(e),o=n.reduce((function(e,t){return e+t}),0),r="string"==typeof t?Math.abs((0,a.default)(t)%o):Math.floor(Math.random()*o),l=i[i.length-1],d=0;d<n.length;d++)if((r-=n[d])<0){l=i[d];break}return s.default.setActiveVariant(e,l),l};t.default=function(e,t,i){if("string"==typeof t)return r(e,t);var a=s.default.getActiveVariant(e);if("string"==typeof a)return a;var o=n.default.getItem("PUSHTELL-"+e);return"string"==typeof o?(s.default.setActiveVariant(e,o,!0),o):"string"==typeof i?(s.default.setActiveVariant(e,i),i):r(e)}},11446:function(e,t,i){"use strict";function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}var s=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var i=d(t);if(i&&i.has(e))return i.get(e);var s={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var r=n?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(s,o,r):s[o]=e[o]}return s.default=e,i&&i.set(e,s),s}(i(70079)),n=l(i(99581)),o=l(i(91414)),r=i(35245);function l(e){return e&&e.__esModule?e:{default:e}}function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(d=function(e){return e?i:t})(e)}function c(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var g=!1,f=null,_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(d,e);var t,i,n,r,l=(n=d,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(n);if(r){var i=p(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?u(e):t}(this,e)});function d(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d);for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return h(u(e=l.call.apply(l,[this].concat(i))),"state",{experiments:o.default.getActiveExperiments(),visible:!1}),h(u(e),"toggleVisibility",(function(){e.setState({visible:!e.state.visible})})),h(u(e),"updateExperiments",(function(){e.setState({experiments:o.default.getActiveExperiments()})})),e}return t=d,(i=[{key:"setActiveVariant",value:function(e,t){o.default.setActiveVariant(e,t)}},{key:"componentDidMount",value:function(){this.activeSubscription=o.default.addListener("active",this.updateExperiments),this.inactiveSubscription=o.default.addListener("inactive",this.updateExperiments)}},{key:"componentWillUnmount",value:function(){this.activeSubscription.remove(),this.inactiveSubscription.remove()}},{key:"render",value:function(){var e=this,t=Object.keys(this.state.experiments);return this.state.visible?s.default.createElement("div",{className:"pushtell-container pushtell-panel"},s.default.createElement("div",{className:"pushtell-close",onClick:this.toggleVisibility},"×"),t.map((function(t){var i=Object.keys(e.state.experiments[t]);if(0!==i.length)return s.default.createElement("div",{className:"pushtell-experiment",key:t},s.default.createElement("div",{className:"pushtell-experiment-name"},t),s.default.createElement("ul",null,i.map((function(i){return s.default.createElement("li",{key:i},s.default.createElement("label",{className:e.state.experiments[t][i]?"active":null,onClick:e.setActiveVariant.bind(e,t,i)},s.default.createElement("input",{type:"radio",name:t,value:i,defaultChecked:e.state.experiments[t][i]}),i))}))))})),s.default.createElement("div",{className:"pushtell-production-build-note"},"This panel is hidden on production builds.")):t.length>0?s.default.createElement("div",{className:"pushtell-container pushtell-handle",onClick:this.toggleVisibility},t.length," Active Experiment",t.length>1?"s":""):null}}])&&c(t.prototype,i),d}(s.Component);e.exports={setDebuggerAvailable:function(e){g=e},enable:function(){if(g&&r.canUseDOM){!function(){function e(e,t){"insertRule"in f.sheet?f.sheet.insertRule(e+"{"+t+"}",0):"addRule"in f.sheet&&f.sheet.addRule(e,t,0)}(f=document.createElement("style")).appendChild(document.createTextNode("")),document.head.appendChild(f),e("#pushtell-debugger","z-index: 25000"),e("#pushtell-debugger","position: fixed"),e("#pushtell-debugger","transform: translateX(-50%)"),e("#pushtell-debugger","bottom: 0"),e("#pushtell-debugger","left: 50%"),e("#pushtell-debugger ul","margin: 0"),e("#pushtell-debugger ul","padding: 0 0 0 20px"),e("#pushtell-debugger li","margin: 0"),e("#pushtell-debugger li","padding: 0"),e("#pushtell-debugger li","font-size: 14px"),e("#pushtell-debugger li","line-height: 14px"),e("#pushtell-debugger input","float: left"),e("#pushtell-debugger input","margin: 0 10px 0 0"),e("#pushtell-debugger input","padding: 0"),e("#pushtell-debugger input","cursor: pointer"),e("#pushtell-debugger label","color: #999999"),e("#pushtell-debugger label","margin: 0 0 10px 0"),e("#pushtell-debugger label","cursor: pointer"),e("#pushtell-debugger label","font-weight: normal"),e("#pushtell-debugger label.active","color: #000000"),e("#pushtell-debugger .pushtell-experiment-name","font-size: 16px"),e("#pushtell-debugger .pushtell-experiment-name","color: #000000"),e("#pushtell-debugger .pushtell-experiment-name","margin: 0 0 10px 0"),e("#pushtell-debugger .pushtell-production-build-note","font-size: 10px"),e("#pushtell-debugger .pushtell-production-build-note","color: #999999"),e("#pushtell-debugger .pushtell-production-build-note","text-align: center"),e("#pushtell-debugger .pushtell-production-build-note","margin: 10px -40px 0 -10px"),e("#pushtell-debugger .pushtell-production-build-note","border-top: 1px solid #b3b3b3"),e("#pushtell-debugger .pushtell-production-build-note","padding: 10px 10px 5px 10px"),e("#pushtell-debugger .pushtell-handle","cursor: pointer"),e("#pushtell-debugger .pushtell-handle","padding: 5px 10px 5px 10px"),e("#pushtell-debugger .pushtell-panel","padding: 15px 40px 5px 10px"),e("#pushtell-debugger .pushtell-container","font-size: 11px"),e("#pushtell-debugger .pushtell-container","background-color: #ebebeb"),e("#pushtell-debugger .pushtell-container","color: #000000"),e("#pushtell-debugger .pushtell-container","box-shadow: 0px 0 5px rgba(0, 0, 0, 0.1)"),e("#pushtell-debugger .pushtell-container","border-top: 1px solid #b3b3b3"),e("#pushtell-debugger .pushtell-container","border-left: 1px solid #b3b3b3"),e("#pushtell-debugger .pushtell-container","border-right: 1px solid #b3b3b3"),e("#pushtell-debugger .pushtell-container","border-top-left-radius: 2px"),e("#pushtell-debugger .pushtell-container","border-top-right-radius: 2px"),e("#pushtell-debugger .pushtell-close","cursor: pointer"),e("#pushtell-debugger .pushtell-close","font-size: 16px"),e("#pushtell-debugger .pushtell-close","font-weight: bold"),e("#pushtell-debugger .pushtell-close","color: #CC0000"),e("#pushtell-debugger .pushtell-close","position: absolute"),e("#pushtell-debugger .pushtell-close","top: 0px"),e("#pushtell-debugger .pushtell-close","right: 7px"),e("#pushtell-debugger .pushtell-close:hover","color: #FF0000"),e("#pushtell-debugger .pushtell-close, #pushtell-debugger label","transition: all .25s")}();var e=document.getElementsByTagName("body")[0],t=document.createElement("div");t.id="pushtell-debugger",e.appendChild(t),n.default.render(s.default.createElement(_,null),t)}},disable:function(){if(g&&r.canUseDOM){null!==f&&(document.head.removeChild(f),f=null);var e=document.getElementsByTagName("body")[0],t=document.getElementById("pushtell-debugger");t&&(n.default.unmountComponentAtNode(t),e.removeChild(t))}}}},91414:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=i(71248),n=(a=i(49382))&&a.__esModule?a:{default:a},o={},r={},l={},d={},c={},m={},u=void 0,p=new s.EventEmitter,h=function(){};h.prototype.emitWin=function(e){if("string"!=typeof e)throw new Error("Required argument 'experimentName' should have type 'string'");p.emit("win",e,o[e])},h.prototype._emitPlay=function(e,t){if("string"!=typeof e)throw new Error("Required argument 'experimentName' should have type 'string'");if("string"!=typeof t)throw new Error("Required argument 'variantName' should have type 'string'");m[e]||(p.emit("play",e,t),m[e]=!0)},h.prototype._resetPlayedExperiments=function(){o={},m={}},h.prototype._reset=function(){o={},r={},l={},d={},c={},m={},u=void 0},h.prototype.rewind=function(){this._reset(),p.removeAllListeners()},h.prototype._incrementActiveExperiments=function(e){d[e]=d[e]||0,d[e]+=1,p.emit("active",e)},h.prototype._decrementActiveExperiments=function(e){d[e]-=1,p.emit("inactive",e)},h.prototype.addActiveVariantListener=function(e,t){return"function"==typeof e?(t=e,p.addListener("active-variant",(function(e,i,a){t(e,i,a)}))):p.addListener("active-variant",(function(i,a,s){i===e&&t(i,a,s)}))},h.prototype.emit=function(){return p.emit.apply(p,arguments)},h.prototype.addListener=function(e,t){return p.addListener(e,t)},h.prototype.once=function(e,t){return p.once(e,t)},h.prototype.addPlayListener=function(e,t){return"function"==typeof e?(t=e,p.addListener("play",(function(e,i){t(e,i)}))):p.addListener("play",(function(i,a){i===e&&t(i,a)}))},h.prototype.addWinListener=function(e,t){return"function"==typeof e?(t=e,p.addListener("win",(function(e,i){t(e,i)}))):p.addListener("win",(function(i,a){i===e&&t(i,a)}))},h.prototype.setCustomDistributionAlgorithm=function(e){u=e},h.prototype.defineVariants=function(e,t,i){var a={},s={};if(t.forEach((function(e){a[e]=!0})),Array.isArray(i)){if(t.length!==i.length)throw new Error("Required argument 'variantNames' should have the same number of elements as optional argument 'variantWeights'");t.forEach((function(e,t){if("number"!=typeof i[t])throw new Error("Optional argument 'variantWeights' should be an array of numbers.");s[e]=i[t]}))}else t.forEach((function(e,t){s[e]=1}));l[e]=s,r[e]=a,c[e]=!0},h.prototype.getSortedVariants=function(e){var t=Object.keys(r[e]);return t.sort(),t},h.prototype.getSortedVariantWeights=function(e){return this.getSortedVariants(e).map((function(t){return l[e][t]}))},h.prototype.getActiveExperiments=function(){var e={};return Object.keys(d).forEach((function(t){0!==d[t]&&(e[t]={},Object.keys(r[t]).forEach((function(i){e[t][i]=o[t]===i})))})),e},h.prototype.calculateActiveVariant=function(e,t,i){return void 0!==u?u(e,t,i):(0,n.default)(e,t,i)},h.prototype.getActiveVariant=function(e){return o[e]},h.prototype.setActiveVariant=function(e,t,i){o[e]=t,p.emit("active-variant",e,t,i)},h.prototype.addExperimentVariant=function(e,t){if(r[e]=r[e]||{},l[e]=l[e]||{},!0!==r[e][t]){if(c[e]){var i=new Error("Experiment “"+e+"” added new variants after variants were defined.");throw i.type="PUSHTELL_INVALID_VARIANT",i}if(o[e]){var a=new Error("Experiment “"+e+"” added new variants after a variant was selected. Declare the variant names using emitter.defineVariants(experimentName, variantNames).");throw a.type="PUSHTELL_INVALID_VARIANT",a}l[e][t]=1}r[e][t]=!0};var g=new h;t.default=g},80773:function(e,t,i){"use strict";t.Z=void 0;var a,s,n,o=(a=i(91414))&&a.__esModule?a:{default:a},r=i(35245),l={enable:function(){if(r.canUseDOM){if("undefined"==typeof mixpanel){var e=new Error("React A/B Test Mixpanel Helper: 'mixpanel' global is not defined.");throw e.type="PUSHTELL_HELPER_MISSING_GLOBAL",e}s=o.default.addPlayListener((function(e,t){mixpanel.track("Experiment Play",{Experiment:e,Variant:t},(function(){o.default.emit("mixpanel-play",e,t)}))})),n=o.default.addWinListener((function(e,t){mixpanel.track("Experiment Win",{Experiment:e,Variant:t},(function(){o.default.emit("mixpanel-win",e,t)}))}))}},disable:function(){if(r.canUseDOM){if(!s||!n){var e=new Error("React A/B Test Mixpanel Helper: Helper was not enabled.");throw e.type="PUSHTELL_HELPER_INVALID_DISABLE",e}s.remove(),n.remove()}}};t.Z=l},43013:function(e,t,i){"use strict";t.Z=void 0;var a,s,n,o=(a=i(91414))&&a.__esModule?a:{default:a},r=i(35245),l={enable:function(){if(r.canUseDOM){if("undefined"==typeof analytics){var e=new Error("React A/B Test Segment Helper: 'analytics' global is not defined.");throw e.type="PUSHTELL_HELPER_MISSING_GLOBAL",e}s=o.default.addPlayListener((function(e,t){analytics.track("Experiment Viewed",{experimentName:e,variationName:t},(function(){o.default.emit("segment-play",e,t)}))})),n=o.default.addWinListener((function(e,t){analytics.track("Experiment Won",{experimentName:e,variationName:t},(function(){o.default.emit("segment-win",e,t)}))}))}},disable:function(){if(r.canUseDOM){if(!s||!n){var e=new Error("React A/B Test Segment Helper: Helper was not enabled.");throw e.type="PUSHTELL_HELPER_INVALID_DISABLE",e}s.remove(),n.remove()}}};t.Z=l},81116:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s=i(70079),n=(a=i(91414))&&a.__esModule?a:{default:a};function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}t.default=function(e,t,i){var a,r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=i){var a,s,n=[],o=!0,r=!1;try{for(i=i.call(e);!(o=(a=i.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,s=e}finally{try{o||null==i.return||i.return()}finally{if(r)throw s}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,s.useState)(n.default.calculateActiveVariant(e,t,i)),2),l=r[0],d=r[1];return(0,s.useEffect)((function(){n.default._incrementActiveExperiments(e),n.default.setActiveVariant(e,l),n.default._emitPlay(e,l);var t=n.default.addActiveVariantListener(e,(function(t,i){t===e&&i!==l&&d(i)}));return function(){t.remove(),n.default._decrementActiveExperiments(e)}}),[e,l]),{experimentName:e,activeVariant:l,emitWin:function(){return n.default.emitWin(e)},selectVariant:(a=l,function(e,t){return a in e?e[a]:t})}}},70935:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a={getItem:function(){},setItem:function(){}};if("undefined"!=typeof window&&"localStorage"in window)try{var s="__pushtell_react__";window.localStorage.setItem(s,s),window.localStorage.getItem(s)!==s?i=a:(window.localStorage.removeItem(s),i=window.localStorage)}catch(e){i=a}else i=a;var n=i;t.default=n},81950:function(e,t,i){"use strict";var a={};i.r(a),i.d(a,{hideProductDiscovery:function(){return E},hideTaskList:function(){return T},hideUpsell:function(){return A}});var s={};i.r(s),i.d(s,{getCanDisplayUpsell:function(){return Z},getCanImportWooCommerceSubscribers:function(){return F},getCurrentTask:function(){return H},getGlobalSubscriberStatsChange:function(){return B},getHasForms:function(){return q},getHasImportedSubscribers:function(){return D},getIsProductDiscoveryDone:function(){return V},getIsProductDiscoveryHidden:function(){return $},getIsTaskListHidden:function(){return R},getIsUpsellHidden:function(){return z},getIsWooCommerceActive:function(){return U},getListsSubscriberStatsChange:function(){return W},getProductDiscoveryTasksStatus:function(){return L},getTasksStatus:function(){return O}});var n=i(99581),o=i(70079),r=i(97856),l=i(14526),d=i(44259),c=i(67308),m=i(92883),u=i(82299),p=i(35250);function h(e){let{mailpoetInstalledDaysAgo:t,sendTransactionalEmails:i,mtaMethod:a,noticeDismissed:s,apiVersion:n}=e;const[r,l]=(0,o.useState)(!1),d=()=>{c.MailPoet.Ajax.post({api_version:n,endpoint:"UserFlags",action:"set",data:{transactional_emails_opt_in_notice_dismissed:"1"}})};return t<30||i||"PHPMail"===a||s||r?null:(0,p.jsxs)(u.q,{type:"success",timeout:!1,onClose:d,children:[(0,p.jsx)("h3",{children:c.MailPoet.I18n.t("transactionalEmailNoticeTitle")}),(0,p.jsxs)("p",{children:[c.MailPoet.I18n.t("transactionalEmailNoticeBody")," ",(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/292-choose-how-to-send-your-wordpress-websites-emails",target:"_blank",rel:"noopener noreferrer",children:c.MailPoet.I18n.t("transactionalEmailNoticeBodyReadMore")})]}),(0,p.jsx)("p",{children:(0,p.jsx)("button",{type:"button",className:"button",onClick:()=>{l(!0),c.MailPoet.Ajax.post({api_version:n,endpoint:"settings",action:"set",data:{send_transactional_emails:"1"}}),d()},children:c.MailPoet.I18n.t("transactionalEmailNoticeCTA")})})]})}h.displayName="TransactionalEmailsProposeOptInNotice";var g=i(87658),f=i(34352),_=i.n(f);function b(){if(!c.MailPoet.subscribersLimitReached)return null;const e=c.MailPoet.hasValidApiKey,t=c.MailPoet.subscribersLimit.toLocaleString();let i=c.MailPoet.I18n.t("subscribersLimitNoticeTitleUnknownLimit"),a=c.MailPoet.I18n.t("subscribersLimitReachedUnknownLimit"),s="";c.MailPoet.subscribersLimit&&(i=c.MailPoet.I18n.t("subscribersLimitNoticeTitle").replace("[subscribersLimit]",t),s=c.MailPoet.I18n.t(e?"yourPlanLimit":"freeVersionLimit").replace("[subscribersLimit]",t),a=c.MailPoet.I18n.t("subscribersLimitReached").replace("[subscribersLimit]",t));const n=e?c.MailPoet.MailPoetComUrlFactory.getUpgradeUrl(c.MailPoet.pluginPartialKey):c.MailPoet.MailPoetComUrlFactory.getPurchasePlanUrl(c.MailPoet.subscribersCount+1),o=_()(c.MailPoet.I18n.t("checkHowToManageSubscribers"),/\[link](.*?)\[\/link]/g,(e=>(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/348-subscribers-limit-for-sending-plans",children:e},"checkManageSubscribers")));return(0,p.jsxs)(u.q,{type:"error",timeout:!1,closable:!1,renderInPlace:!0,children:[(0,p.jsx)("h3",{children:i}),(0,p.jsxs)("p",{children:[a," ",s," ",c.MailPoet.I18n.t("youNeedToUpgrade"),(0,p.jsx)("br",{}),"active"===c.MailPoet.wpSegmentState?o:null," ",c.MailPoet.I18n.t("actToSeamlessService")]}),(0,p.jsxs)("p",{children:[(0,p.jsx)("a",{target:"_blank",rel:"noopener noreferrer",className:"button button-primary",href:n,children:c.MailPoet.I18n.t("upgradeNow")}),e&&(0,p.jsxs)(p.Fragment,{children:[" ",(0,p.jsx)("button",{type:"button",className:"button",onClick:async()=>{await c.MailPoet.Ajax.post({api_version:c.MailPoet.apiVersion,endpoint:"services",action:"recheckKeys"}),window.location.reload()},children:c.MailPoet.I18n.t("refreshMySubscribers")})]})]})]})}b.displayName="SubscribersLimitNotice";var x=i(26973);function v(){if(!c.MailPoet.emailVolumeLimitReached)return null;let e=c.MailPoet.I18n.t("emailVolumeLimitNoticeTitleUnknownLimit"),t=c.MailPoet.I18n.t("youReachedEmailVolumeLimitUnknownLimit");c.MailPoet.emailVolumeLimit&&(e=c.MailPoet.I18n.t("emailVolumeLimitNoticeTitle").replace("[emailVolumeLimit]",c.MailPoet.emailVolumeLimit.toLocaleString()),t=c.MailPoet.I18n.t("youReachedEmailVolumeLimit").replace("[emailVolumeLimit]",c.MailPoet.emailVolumeLimit.toLocaleString()));const i=c.MailPoet.MailPoetComUrlFactory.getUpgradeUrl(c.MailPoet.pluginPartialKey),a=new Date,s=new Date(a.getFullYear(),a.getMonth()+1,1);let n=_()(c.MailPoet.I18n.t("toContinueUpgradeYourPlanOrWaitUntil"),/\[link](.*?)\[\/link]/g,(e=>(0,p.jsx)("a",{target:"_blank",rel:"noreferrer",href:i,children:e},e)));return n=_()(n,/<b>\[date]<\/b>\./g,(()=>(0,x.ZP)(`<b>${c.MailPoet.Date.short(s)}</b>.`))),(0,p.jsxs)(u.q,{type:"error",timeout:!1,closable:!1,renderInPlace:!0,children:[(0,p.jsx)("h3",{children:e}),(0,p.jsxs)("p",{children:[t,(0,p.jsx)("br",{}),n]}),(0,p.jsxs)("p",{children:[(0,p.jsx)("a",{target:"_blank",rel:"noopener noreferrer",className:"button button-primary",href:i,children:c.MailPoet.I18n.t("upgradeNow")})," ",(0,p.jsx)("button",{type:"button",className:"button",onClick:async()=>{await c.MailPoet.Ajax.post({api_version:c.MailPoet.apiVersion,endpoint:"services",action:"recheckKeys"}),window.location.reload()},children:c.MailPoet.I18n.t("refreshMyEmailVolumeLimit")})]})]})}v.displayName="EmailVolumeLimitNotice";const y=(0,r.withBoundary)(v);function j(e){let{mssKeyInvalid:t,subscribersCount:i}=e;return t?(0,p.jsxs)(u.q,{type:"error",timeout:!1,closable:!1,renderInPlace:!0,children:[(0,p.jsx)("h3",{children:c.MailPoet.I18n.t("allSendingPausedHeader")}),(0,p.jsx)("p",{children:_()(c.MailPoet.I18n.t("allSendingPausedBody"),/\[link\](.*?)\[\/link\]/g,(e=>(0,p.jsx)("a",{href:"?page=mailpoet-settings#premium",children:e},"check-sending")))}),(0,p.jsx)("p",{children:(0,p.jsx)("a",{href:`https://account.mailpoet.com?s=${i}`,className:"button button-primary",target:"_blank",rel:"noopener noreferrer",children:c.MailPoet.I18n.t("allSendingPausedLink")})})]}):null}function w(){return(0,p.jsxs)(r.ErrorBoundary,{children:[c.MailPoet.subscribersLimitReached&&(0,p.jsx)(b,{}),c.MailPoet.emailVolumeLimitReached&&(0,p.jsx)(y,{}),!c.MailPoet.subscribersLimitReached&&!c.MailPoet.emailVolumeLimitReached&&(0,p.jsx)(j,{mssKeyInvalid:c.MailPoet.hasInvalidMssApiKey,subscribersCount:c.MailPoet.subscribersCount})]})}function S(){return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(m.w,{}),(0,p.jsx)(w,{}),(0,p.jsx)(h,{mailpoetInstalledDaysAgo:c.MailPoet.installedDaysAgo,sendTransactionalEmails:c.MailPoet.transactionalEmailsEnabled,mtaMethod:c.MailPoet.mtaMethod,apiVersion:c.MailPoet.apiVersion,noticeDismissed:c.MailPoet.transactionalEmailsOptInNoticeDismissed}),(0,p.jsx)(g._,{mtaLog:c.MailPoet.mtaLog,mtaMethod:c.MailPoet.mtaMethod,isInline:!0})]})}j.displayName="InvalidMssKeyNotice";var P=i(10159),M=i(52542),N=i(74457),I=i(64826),k=i(81433),C=i(76944);function*T(){return yield(0,C.t)({endpoint:"settings",action:"set",method:"POST",data:{"homepage.task_list_dismissed":!0}}),{type:"SET_TASK_LIST_HIDDEN"}}function*E(){return yield(0,C.t)({endpoint:"settings",action:"set",method:"POST",data:{"homepage.product_discovery_dismissed":!0}}),{type:"SET_PRODUCT_DISCOVERY_HIDDEN"}}function*A(){return yield(0,C.t)({endpoint:"settings",action:"set",method:"POST",data:{"homepage.upsell_dismissed":!0}}),{type:"SET_UPSELL_HIDDEN"}}function R(e){return e.taskList.isTaskListHidden}function O(e){return e.taskList.tasksStatus}function L(e){return e.productDiscovery.tasksStatus}function F(e){return e.taskList.canImportWooCommerceSubscribers}function D(e){return e.taskList.hasImportedSubscribers}function q(e){return e.formsCount>0}function $(e){return e.productDiscovery.isHidden}function B(e){return e.subscribersStats.global}function W(e){return e.subscribersStats.lists}function V(e){const t=e.productDiscovery.tasksStatus;return e.isWooCommerceActive?t.addSubscriptionForm&&t.setUpWelcomeCampaign&&t.setUpAbandonedCartEmail&&t.brandWooEmails:t.setUpWelcomeCampaign&&t.addSubscriptionForm&&t.sendFirstNewsletter}function U(e){return e.isWooCommerceActive}function H(e){return e.taskList.tasksStatus.senderSet?e.taskList.tasksStatus.mssConnected?!e.taskList.tasksStatus.wooSubscribersImported&&e.taskList.canImportWooCommerceSubscribers?"wooSubscribersImported":e.taskList.tasksStatus.subscribersAdded?null:"subscribersAdded":"mssConnected":"senderSet"}function z(e){return e.upsell.isHidden}function Z(e){return e.upsell.upsellStatus?.canDisplay}function Y(e,t){switch(t.type){case"SET_TASK_LIST_HIDDEN":return{...e,taskList:{...e.taskList,isTaskListHidden:!0}};case"SET_PRODUCT_DISCOVERY_HIDDEN":return{...e,productDiscovery:{...e.productDiscovery,isHidden:!0}};case"SET_UPSELL_HIDDEN":return{...e,upsell:{...e.upsell,isHidden:!0}};default:return e}}const G="mailpoet/homepage",K={};var Q=i(57995),X=i(71458),J=i(26372),ee=i.n(J);function te(e,t,i){c.MailPoet.trackEvent(e,{ctaLabel:t},{send_immediately:!0},(()=>{window.location.href=i}))}function ie(e){let{title:t,titleCompleted:i="",slug:a,link:s,order:n,isCompleted:o,isActive:r,children:l=null}=e;const d=ee()("mailpoet-task-list__task",{"mailpoet-task-list__task--completed":o,"mailpoet-task-list__task--active":r}),c=()=>{te("Home Page Task",a,s)};return(0,p.jsxs)("li",{className:d,role:"row",onClick:o?void 0:c,tabIndex:o?void 0:0,onKeyDown:o?void 0:e=>"Enter"===e.key&&c(),children:[(0,p.jsx)("div",{className:"mailpoet-task-list__task-before",children:(0,p.jsx)("div",{className:"mailpoet-task-list__task-icon",children:o?(0,p.jsx)(Q.Z,{icon:X.Z}):n})}),(0,p.jsxs)("div",{className:"mailpoet-task-list__task-content",children:[(0,p.jsx)("div",{className:"mailpoet-task-list__task-title",children:o&&i?i:t}),l]})]})}function ae(e){let{onHide:t}=e;const{tasksStatus:i,currentTask:a,hasImportedSubscribers:s,canImportWooCommerceSubscribers:n}=(0,P.Z)((e=>({tasksStatus:e(G).getTasksStatus(),currentTask:e(G).getCurrentTask(),hasImportedSubscribers:e(G).getHasImportedSubscribers(),canImportWooCommerceSubscribers:e(G).getCanImportWooCommerceSubscribers()})),[]),o=[];return o.push((0,p.jsx)(ie,{slug:"set sender",title:c.MailPoet.I18n.t("senderSetTask"),titleCompleted:c.MailPoet.I18n.t("senderSetTaskDone"),link:"admin.php?page=mailpoet-settings#/basics",order:1,isCompleted:i.senderSet,isActive:"senderSet"===a},"senderSet")),o.push((0,p.jsx)(ie,{slug:"connect mss",title:c.MailPoet.I18n.t("mssConnectedTask"),titleCompleted:c.MailPoet.I18n.t("mssConnectedTaskDone"),link:"admin.php?page=mailpoet-settings#/premium",order:2,isCompleted:i.mssConnected,isActive:"mssConnected"===a},"mssConnected")),n&&o.push((0,p.jsx)(ie,{slug:"import woocommerce subscribers",title:c.MailPoet.I18n.t("wooSubscribersImportedTask"),titleCompleted:c.MailPoet.I18n.t("wooSubscribersImportedTaskDone"),link:"admin.php?page=mailpoet-woocommerce-setup",order:3,isCompleted:i.wooSubscribersImported,isActive:"wooSubscribersImported"===a},"wooSubscribersImported")),o.push((0,p.jsxs)(ie,{slug:"add subscribers",title:c.MailPoet.I18n.t("subscribersAddedTask"),titleCompleted:s?c.MailPoet.I18n.t("subscribersAddedTaskDoneByImport"):c.MailPoet.I18n.t("subscribersAddedTaskDoneByForm"),link:"admin.php?page=mailpoet-import",order:n?4:3,isCompleted:i.subscribersAdded,isActive:"subscribersAdded"===a,children:[!i.subscribersAdded&&(0,p.jsxs)("p",{children:[c.MailPoet.I18n.t("noSubscribersQuestion")," ",(0,p.jsx)("a",{href:"admin.php?page=mailpoet-form-editor-template-selection",onClick:r.stopLinkPropagation,children:c.MailPoet.I18n.t("setUpForm")})]}),i.subscribersAdded&&!s&&(0,p.jsxs)("p",{children:[c.MailPoet.I18n.t("haveSubscribersQuestion")," ",(0,p.jsx)("a",{href:"admin.php?page=mailpoet-import",children:c.MailPoet.I18n.t("import")})]})]},"subscribersAdded")),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"mailpoet-task-list__heading",children:[(0,p.jsx)("h1",{children:c.MailPoet.I18n.t("welcomeToMailPoet")}),(0,p.jsx)("p",{children:c.MailPoet.I18n.t("beginByCompletingSetup")}),(0,p.jsx)(M.Z,{label:c.MailPoet.I18n.t("hideList"),icon:N.Z,controls:[{title:c.MailPoet.I18n.t("hideList"),onClick:t,icon:null}]})]}),(0,p.jsx)("ul",{children:o.map((e=>e))}),!a&&(0,p.jsxs)("p",{className:"mailpoet-task-list__all-set",children:[c.MailPoet.I18n.t("youAreSet")," ",(0,p.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),t()},children:c.MailPoet.I18n.t("dismissList")})]})]})}function se(e){let{title:t,slug:i,link:a,description:s,doneMessage:n,imgSrc:o,isDone:r}=e;const l=()=>{te("Home Page Task",i,a)};return(0,p.jsxs)("li",{className:ee()("mailpoet-product-discovery__task",{"mailpoet-product-discovery__task--completed":r}),role:"row",onClick:r?void 0:l,tabIndex:r?void 0:0,onKeyDown:r?void 0:e=>"Enter"===e.key&&l(),children:[(0,p.jsx)("img",{src:o,alt:t,width:124,height:72}),(0,p.jsx)("div",{className:"mailpoet-product-discovery__task-content",children:r?(0,p.jsx)("h3",{children:n}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("h3",{children:`${t} →`}),s&&(0,p.jsx)("p",{children:s})]})}),(0,p.jsx)("div",{className:"mailpoet-product-discovery__task-after",children:r&&(0,p.jsx)("div",{className:"mailpoet-task-list__task-icon",children:(0,p.jsx)(Q.Z,{icon:X.Z})})})]})}function ne(e){let{heading:t,description:i,children:a,headingAfter:s,className:n=""}=e;return(0,p.jsxs)("section",{className:ee()("mailpoet-homepage-section__container",n),children:[(0,p.jsxs)("header",{className:"mailpoet-homepage-section__heading",children:[(0,p.jsxs)("h2",{children:[t,i&&(0,p.jsx)("span",{children:i})]}),(0,p.jsx)("div",{className:"mailpoet-homepage-section__heading-after",children:s})]}),a]})}function oe(e){let{onHide:t}=e;const{tasksStatus:i,isWooCommerceActive:a,isDiscoveryDone:s}=(0,P.Z)((e=>({tasksStatus:e(G).getProductDiscoveryTasksStatus(),isWooCommerceActive:e(G).getIsWooCommerceActive(),isDiscoveryDone:e(G).getIsProductDiscoveryDone()})),[]),n=[];return n.push((0,p.jsx)(se,{slug:"set up welcome campaign",title:c.MailPoet.I18n.t("setUpWelcomeCampaign"),description:c.MailPoet.I18n.t("setUpWelcomeCampaignDesc"),link:"admin.php?page=mailpoet-automation-templates",imgSrc:`${c.MailPoet.cdnUrl}homepage/welcome-email-illustration.png`,isDone:i.setUpWelcomeCampaign,doneMessage:c.MailPoet.I18n.t("setUpWelcomeCampaignDone")},"setUpWelcomeCampaign"),(0,p.jsx)(se,{slug:"add subscription form",title:c.MailPoet.I18n.t("addSubscriptionForm"),description:c.MailPoet.I18n.t("addSubscriptionFormDesc"),link:"admin.php?page=mailpoet-form-editor-template-selection",imgSrc:`${c.MailPoet.cdnUrl}homepage/subscription-form-illustration.png`,isDone:i.addSubscriptionForm,doneMessage:c.MailPoet.I18n.t("addSubscriptionFormDone")},"addSubscriptionForm")),a?n.push((0,p.jsx)(se,{slug:"set up abandoned cart email",title:c.MailPoet.I18n.t("setUpAbandonedCartEmail"),description:c.MailPoet.I18n.t("setUpAbandonedCartEmailDesc"),link:"admin.php?page=mailpoet-newsletters#/new/woocommerce/woocommerce_abandoned_shopping_cart/conditions",imgSrc:`${c.MailPoet.cdnUrl}homepage/woo-cart-email-illustration.png`,isDone:i.setUpAbandonedCartEmail,doneMessage:c.MailPoet.I18n.t("setUpAbandonedCartEmailDone")},"setUpAbandonedCartEmail"),(0,p.jsx)(se,{slug:"brand woocommerce emails",title:c.MailPoet.I18n.t("brandWooEmails"),description:c.MailPoet.I18n.t("brandWooEmailsDesc"),link:"admin.php?page=mailpoet-settings#/woocommerce",imgSrc:`${c.MailPoet.cdnUrl}homepage/woo-transactional-email-illustration.png`,isDone:i.brandWooEmails,doneMessage:c.MailPoet.I18n.t("brandWooEmailsDone")},"brandWooEmails")):n.push((0,p.jsx)(se,{slug:"send first newsletter",title:c.MailPoet.I18n.t("sendFirstNewsletter"),description:c.MailPoet.I18n.t("sendFirstNewsletterDesc"),link:"admin.php?page=mailpoet-newsletters#/new",imgSrc:`${c.MailPoet.cdnUrl}homepage/newsletter-illustration.png`,isDone:i.sendFirstNewsletter,doneMessage:c.MailPoet.I18n.t("sendFirstNewsletterDone")},"sendFirstNewsletter")),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ne,{className:"mailpoet-homepage-product-discovery",heading:c.MailPoet.I18n.t("startEngagingWithYourCustomers"),headingAfter:(0,p.jsx)(M.Z,{label:c.MailPoet.I18n.t("hideList"),icon:N.Z,controls:[{title:c.MailPoet.I18n.t("hideList"),onClick:t,icon:null}]}),children:(0,p.jsx)("ul",{children:n.map((e=>e))})}),s&&(0,p.jsxs)("p",{className:"mailpoet-task-list__all-set",children:[c.MailPoet.I18n.t("allDone")," ",(0,p.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),t()},children:c.MailPoet.I18n.t("dismissTasks")})]})]})}var re=i(15128),le=i(18822),de=i(43981),ce=i(31347),me=i(42238),ue=i(19382);function pe(e){let{closable:t,onHide:i}=e;return(0,p.jsx)(ne,{className:"mailpoet-homepage-upsell",heading:c.MailPoet.I18n.t("accelerateYourGrowth"),headingAfter:t&&i?(0,p.jsx)(ue.ZP,{icon:re.Z,onClick:i,label:c.MailPoet.I18n.t("close")}):null,children:(0,p.jsxs)("div",{className:"mailpoet-homepage-upsell__content",children:[(0,p.jsxs)("ul",{children:[(0,p.jsxs)("li",{children:[(0,p.jsx)(Q.Z,{icon:le.Z}),(0,p.jsx)("span",{children:c.MailPoet.I18n.t("detailedAnalytics")})]}),(0,p.jsxs)("li",{children:[(0,p.jsx)(Q.Z,{icon:de.Z}),(0,p.jsx)("span",{children:c.MailPoet.I18n.t("advancedSubscriberSegmentation")})]}),(0,p.jsxs)("li",{children:[(0,p.jsx)(Q.Z,{icon:ce.Z}),(0,p.jsx)("span",{children:c.MailPoet.I18n.t("emailMarketingAutomations")})]}),(0,p.jsxs)("li",{children:[(0,p.jsx)(Q.Z,{icon:me.Z}),(0,p.jsx)("span",{children:c.MailPoet.I18n.t("prioritySupport")})]})]}),(0,p.jsx)(ue.ZP,{variant:"primary",href:c.MailPoet.MailPoetComUrlFactory.getPurchasePlanUrl(c.MailPoet.subscribersCount,c.MailPoet.currentWpUserEmail,"business",{utm_source:"plugin",utm_medium:"homepage",utm_campaign:"upsell"}),children:c.MailPoet.I18n.t("upgradePlan")})]})})}var he=i(48405),ge=i(47384);function fe(e){let{id:t,engagementScore:i}=e;const a={unknown:{name:c.MailPoet.I18n.t("unknownBadgeName"),type:"unknown",tooltipTitle:c.MailPoet.I18n.t("unknownBadgeTooltip"),tooltipText:c.MailPoet.I18n.t("tooltipUnknown")},excellent:{name:c.MailPoet.I18n.t("excellentBadgeName"),type:"excellent",tooltipTitle:c.MailPoet.I18n.t("excellentBadgeTooltip"),tooltipText:c.MailPoet.I18n.t("tooltipExcellent")},good:{name:c.MailPoet.I18n.t("goodBadgeName"),type:"good",tooltipTitle:c.MailPoet.I18n.t("goodBadgeTooltip"),tooltipText:c.MailPoet.I18n.t("tooltipGood")},average:{name:c.MailPoet.I18n.t("averageBadgeName"),type:"average",tooltipTitle:c.MailPoet.I18n.t("averageBadgeTooltip"),tooltipText:c.MailPoet.I18n.t("tooltipAverage")}},s=`badge-${t}`;let n;n=null==i?a.unknown:i<20?a.average:i<50?a.good:a.excellent;const o=(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{className:"mailpoet-listing-stats-tooltip-title",children:n.tooltipTitle.toUpperCase()}),(0,p.jsx)("div",{className:"mailpoet-listing-stats-tooltip-description",children:c.MailPoet.I18n.t("engagementScoreDescription")}),(0,p.jsxs)("div",{className:"mailpoet-listing-stats-tooltip-content",children:[(0,p.jsx)(ge.C,{type:"unknown",name:c.MailPoet.I18n.t("unknownBadgeName")})," : ",a.unknown.tooltipText,(0,p.jsx)("br",{}),(0,p.jsx)(ge.C,{type:"excellent",name:c.MailPoet.I18n.t("excellentBadgeName")})," : ",a.excellent.tooltipText,(0,p.jsx)("br",{}),(0,p.jsx)(ge.C,{type:"good",name:c.MailPoet.I18n.t("goodBadgeName")})," : ",a.good.tooltipText,(0,p.jsx)("br",{}),(0,p.jsx)(ge.C,{type:"average",name:c.MailPoet.I18n.t("averageBadgeName")})," : ",a.average.tooltipText]})]},`tooltip-${s}`);return(0,p.jsxs)("div",{className:"mailpoet-listing-stats-opened-clicked",children:[null!=i&&(0,p.jsxs)("div",{className:"mailpoet-listing-stats-percentages",children:[i.toLocaleString(void 0,{minimumFractionDigits:1,maximumFractionDigits:1}),"%"]}),(0,p.jsx)("div",{children:(0,p.jsx)(ge.C,{isInverted:!0,type:n.type,name:n.name,tooltip:o,tooltipId:s,tooltipPlace:"top"})})]})}const _e=(e,t,i)=>{e.preventDefault(),te("Home Page Statistics Click",t,i)};function be(){const{globalChange:e,listsChange:t,hasForms:i}=(0,P.Z)((e=>({globalChange:e(G).getGlobalSubscriberStatsChange(),listsChange:e(G).getListsSubscriberStatsChange(),hasForms:e(G).getHasForms()})),[]),a=0===t.length&&0===e.subscribed&&0===e.unsubscribed;return(0,p.jsx)(ne,{className:"mailpoet-subscribers-stats",heading:c.MailPoet.I18n.t("subscribersHeading"),description:c.MailPoet.I18n.t("subscribersSectionDescription"),headingAfter:!a&&(0,p.jsxs)("span",{className:ee()({"mailpoet-decrease":e.changePercent<0}),children:[(0,p.jsx)(Q.Z,{icon:le.Z}),e.changePercent<0&&"-",Math.abs(e.changePercent)>1e3?"∞%":`${Math.abs(e.changePercent)}%`]}),children:a?(0,p.jsxs)("div",{className:"mailpoet-subscribers-stats-empty",children:[(0,p.jsx)(Q.Z,{icon:le.Z,viewBox:"-4 -4 32 32"}),i?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("p",{children:c.MailPoet.I18n.t("subscriberCountHasNotChangeLongTime")}),(0,p.jsx)("a",{href:"admin.php?page=mailpoet-newsletters#/new",onClick:e=>_e(e,"campaigns","admin.php?page=mailpoet-newsletters#/new"),children:c.MailPoet.I18n.t("exploreCampaigns")})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("p",{children:[c.MailPoet.I18n.t("changesWillAppear"),(0,p.jsx)("br",{}),c.MailPoet.I18n.t("starBySettingUpForm")]}),(0,p.jsx)("a",{href:"admin.php?page=mailpoet-form-editor-template-selection",onClick:e=>_e(e,"new form","admin.php?page=mailpoet-form-editor-template-selection"),children:c.MailPoet.I18n.t("createForm")})]})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"mailpoet-subscribers-stats-global-change",children:[(0,p.jsxs)("div",{children:[c.MailPoet.I18n.t("newSubscribers"),(0,p.jsx)("br",{}),(0,p.jsx)("span",{children:e.subscribed})]}),(0,p.jsxs)("div",{children:[c.MailPoet.I18n.t("unsubscribedSubscribers"),(0,p.jsx)("br",{}),(0,p.jsx)("span",{children:e.unsubscribed})]})]}),!!t.length&&(0,p.jsxs)("table",{className:"mailpoet-subscribers-stats-list-change-table",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:c.MailPoet.I18n.t("listName")}),(0,p.jsx)("th",{children:c.MailPoet.I18n.t("listScore")}),(0,p.jsx)("th",{children:c.MailPoet.I18n.t("subscribedSubscribers")}),(0,p.jsx)("th",{children:c.MailPoet.I18n.t("unsubscribedSubscribers")})]})}),(0,p.jsx)("tbody",{children:t.map((e=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(0,p.jsx)("a",{href:`admin.php?page=mailpoet-subscribers#/page[1]/sort_by[created_at]/sort_order[desc]/group[all]/filter[segment=${e.id}]`,children:e.name})}),(0,p.jsx)("td",{children:(0,p.jsx)("div",{className:"mailpoet-listing-stats",children:(0,p.jsx)(fe,{id:e.id,engagementScore:e.averageEngagementScore})})}),(0,p.jsx)("td",{children:e.subscribed}),(0,p.jsx)("td",{children:e.unsubscribed})]},e.id)))})]})]})})}var xe=i(74193),ve=i(83158);function ye(e){let{link:t,abstract:i,title:a,imgSrc:s}=e;return(0,p.jsxs)("a",{className:"mailpoet-resource-post",href:t,target:"_blank",rel:"noreferrer",children:[(0,p.jsx)("img",{src:s,alt:a,width:"292",height:"166"}),(0,p.jsx)("h3",{children:a}),(0,p.jsx)("p",{children:i})]})}function je(){const[e,t]=(0,o.useState)(1),i=[(0,p.jsx)(ye,{link:"https://kb.mailpoet.com/article/141-create-an-email-types-of-campaigns?utm_source=plugin&utm_medium=homepage&utm_campaign=resources",abstract:c.MailPoet.I18n.t("createAnEmailAbstract"),title:c.MailPoet.I18n.t("createAnEmailTitle"),imgSrc:`${c.MailPoet.cdnUrl}homepage/resources/add_email.png`},"createAnEmail"),(0,p.jsx)(ye,{link:"https://kb.mailpoet.com/article/297-create-a-form-with-our-new-editor?utm_source=plugin&utm_medium=homepage&utm_campaign=resources",abstract:c.MailPoet.I18n.t("createAFormAbstract"),title:c.MailPoet.I18n.t("createAFormTitle"),imgSrc:`${c.MailPoet.cdnUrl}homepage/resources/add_form.png`},"createAForm"),(0,p.jsx)(ye,{link:"https://www.mailpoet.com/blog/email-segmentation/?utm_source=plugin&utm_medium=homepage&utm_campaign=resources",abstract:c.MailPoet.I18n.t("segmentationGuideAbstract"),title:c.MailPoet.I18n.t("segmentationGuideTitle"),imgSrc:`${c.MailPoet.cdnUrl}homepage/resources/segmentation.png`},"segmentationGuide"),(0,p.jsx)(ye,{link:"https://www.mailpoet.com/blog/re-engagement-emails/?utm_source=plugin&utm_medium=homepage&utm_campaign=resources",abstract:c.MailPoet.I18n.t("reEngagementAbstract"),title:c.MailPoet.I18n.t("reEngagementTitle"),imgSrc:`${c.MailPoet.cdnUrl}homepage/resources/reengagement.png`},"reEngagement"),(0,p.jsx)(ye,{link:"https://www.mailpoet.com/blog/newsletter-marketing-strategy/?utm_source=plugin&utm_medium=homepage&utm_campaign=resources",abstract:c.MailPoet.I18n.t("marketingStrategyAbstract"),title:c.MailPoet.I18n.t("marketingStrategyTitle"),imgSrc:`${c.MailPoet.cdnUrl}homepage/resources/marketing.png`},"marketingStrategy"),(0,p.jsx)(ye,{link:"https://www.mailpoet.com/blog/how-to-promote-your-sales-with-email-marketing-mailpoet-woocommerce-segmentation/?utm_source=plugin&utm_medium=homepage&utm_campaign=resources",abstract:c.MailPoet.I18n.t("promotingSalesAbstract"),title:c.MailPoet.I18n.t("promotingSalesTitle"),imgSrc:`${c.MailPoet.cdnUrl}homepage/resources/sales.png`},"promotingSales")],a=(0,o.useCallback)((i=>{i.preventDefault(),t(e+1)}),[e]),s=(0,o.useCallback)((i=>{i.preventDefault(),t(e-1)}),[e]);return(0,p.jsxs)(ne,{className:"mailpoet-homepage-resources",heading:c.MailPoet.I18n.t("learnMoreAboutEmailMarketing"),children:[(0,p.jsx)("div",{className:"mailpoet-homepage-resources__posts",children:i.filter(((t,i)=>i+1===2*e||i+1===2*e-1)).map((e=>e))}),(0,p.jsxs)("div",{className:"mailpoet-homepage-resources__pagination",children:[c.MailPoet.I18n.t("pageOf").replace("%1$d",e.toString()).replace("%2$d",Math.ceil(i.length/2).toString()),e>1?(0,p.jsx)("a",{href:"#",onClick:s,title:c.MailPoet.I18n.t("previousPostsPage"),children:(0,p.jsx)(Q.Z,{icon:xe.Z})}):(0,p.jsx)(Q.Z,{icon:xe.Z}),e<Math.ceil(i.length/2)?(0,p.jsx)("a",{href:"#",onClick:a,title:c.MailPoet.I18n.t("nextPostsPage"),children:(0,p.jsx)(Q.Z,{icon:ve.Z})}):(0,p.jsx)(Q.Z,{icon:ve.Z})]})]})}function we(){const{isTaskListHidden:e,isProductDiscoveryHidden:t,isUpsellHidden:i,canDisplayUpsell:a}=(0,P.Z)((e=>({isTaskListHidden:e(G).getIsTaskListHidden(),isProductDiscoveryHidden:e(G).getIsProductDiscoveryHidden(),isUpsellHidden:e(G).getIsUpsellHidden(),canDisplayUpsell:e(G).getCanDisplayUpsell()})),[]),{hideTaskList:s}=(0,he.Z)(G),{hideProductDiscovery:n}=(0,he.Z)(G),{hideUpsell:o}=(0,he.Z)(G);return(0,p.jsxs)("div",{className:"mailpoet-homepage__container",children:[!e&&(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(ae,{onHide:s})}),!t&&(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(oe,{onHide:n})}),e&&t&&a&&!i&&(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(pe,{closable:!0,onHide:o})}),(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(be,{})}),(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(je,{})})]})}function Se(){const[e,t]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{(()=>{const e=(0,I.Z)(G,{actions:a,controls:K,selectors:s,reducer:Y,initialState:{taskList:{isTaskListHidden:window.mailpoet_homepage_data.taskListDismissed,tasksStatus:window.mailpoet_homepage_data.taskListStatus,canImportWooCommerceSubscribers:window.mailpoet_homepage_data.wooCustomersCount>0,hasImportedSubscribers:window.mailpoet_homepage_data.subscribersCount>10},productDiscovery:{isHidden:window.mailpoet_homepage_data.productDiscoveryDismissed,tasksStatus:window.mailpoet_homepage_data.productDiscoveryStatus},upsell:{isHidden:window.mailpoet_homepage_data.upsellDismissed,upsellStatus:window.mailpoet_homepage_data.upsellStatus},isWooCommerceActive:c.MailPoet.isWoocommerceActive,subscribersStats:window.mailpoet_homepage_data.subscribersStats,formsCount:window.mailpoet_homepage_data.formsCount}});(0,k.register)(e)})(),t(!0)}),[]),(0,p.jsxs)(l.k.Provider,{value:(0,l.S)(window),children:[(0,p.jsx)(d.Q,{}),(0,p.jsx)(S,{}),e?(0,p.jsx)(we,{}):null]})}const Pe=document.getElementById("mailpoet_homepage_container");Pe&&((0,r.registerTranslations)(),n.render((0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(Se,{})}),Pe));var Me=i(26952),Ne=i(16374),Ie=i(65311),ke=i.n(Ie),Ce=i(39519),Te=i.n(Ce),Ee=i(26694),Ae=i(38611),Re=i(79830),Oe=i(7936),Le=i(49773);function Fe(e){let{cacheCalculation:t}=e;const[i,a]=(0,o.useState)(!1),[s,n]=(0,o.useState)([]),r=(new Date).getTime()-new Date(t).getTime(),l=Math.floor(r/1e3/60);return(0,p.jsxs)("div",{className:"mailpoet-subscribers-cache-notice",children:[_()((0,Oe.__)("Lists and Segments subscribers counts were calculated <abbr>{$mins} minutes ago</abbr>","mailpoet"),/<abbr>(.*?)<\/abbr>/,((e,i)=>(0,p.jsx)("abbr",{title:t,children:e.replace(/(\{\$mins\}|\$mins)/i,String(l))},i))),(0,p.jsx)(Le.z,{className:"mailpoet-subscribers-cache-notice-button",type:"button",variant:"secondary",dimension:"small",onClick:()=>{a(!0),c.MailPoet.Ajax.post({api_version:c.MailPoet.apiVersion,endpoint:"settings",action:"recalculateSubscribersCountsCache"}).done((()=>{window.location.reload()})).fail((e=>{n(e.errors.map((e=>e.message))),a(!1)}))},withSpinner:i,children:(0,Oe.__)("Recalculate now","mailpoet")}),(0,p.jsx)("div",{className:"mailpoet-gap"}),s.length>0&&(0,p.jsx)(u.q,{type:"error",children:s.map((e=>(0,p.jsx)("p",{children:e},e)))})]})}var De=i(37248);function qe(e){let{subscribersInPlan:t,subscribersInPlanLimit:i}=e;if(!1===t)return null;const a=i?(0,p.jsx)("b",{children:(0,Oe._x)("%1$d / %2$d","count / total subscribers","mailpoet").replace("%1$d",t.toLocaleString()).replace("%2$d",i.toLocaleString())},"subscribers_count"):(0,p.jsx)("b",{children:t},"subscribers_count");return(0,p.jsxs)("div",{className:"mailpoet-subscribers-in-plan",children:[_()((0,Oe._x)("%s subscribers in your plan","number of subscribers in a sending plan","mailpoet"),"%s",(()=>a))," ",(0,p.jsx)(De.Tooltip,{tooltip:(0,Oe.__)("This is the total of subscribed, unconfirmed and inactive subscribers we count when you are sending with MailPoet Sending Service. The count excludes unsubscribed and bounced (invalid) email addresses.","mailpoet"),place:"right"}),(0,p.jsx)("span",{className:"mailpoet-subscribers-in-plan-spacer",children:" "})]})}var $e=i(33493);function Be(e){let{location:t}=e;return(0,p.jsxs)(d.Q,{children:[(0,p.jsxs)(Me.Link,{className:"mailpoet-button button-secondary",to:{pathname:"/new",state:{backUrl:t?.pathname}},children:[$e.R,(0,p.jsx)("span",{"data-automation-id":"add-new-subscribers-button",children:c.MailPoet.I18n.t("new")})]}),(0,p.jsx)("a",{className:"mailpoet-button not-small-screen button-secondary",href:"?page=mailpoet-import","data-automation-id":"import-subscribers-button",children:c.MailPoet.I18n.t("import")}),(0,p.jsx)("a",{id:"mailpoet_export_button",className:"mailpoet-button not-small-screen button-secondary",href:"?page=mailpoet-export",children:c.MailPoet.I18n.t("export")})]})}Be.propTypes={location:Te().object.isRequired};const We=(0,Ne.EN)(Be),Ve=c.MailPoet.trackingConfig.emailTrackingEnabled,Ue=[{name:"email",label:c.MailPoet.I18n.t("subscriber"),sortable:!0},{name:"status",label:c.MailPoet.I18n.t("status"),sortable:!0},{name:"segments",label:c.MailPoet.I18n.t("lists")},{name:"tags",label:c.MailPoet.I18n.t("tags")},{name:"statistics",label:c.MailPoet.I18n.t("statisticsColumn"),display:Ve},{name:"created_at",label:c.MailPoet.I18n.t("subscribedOn"),sortable:!0}],He={onTrash:e=>{const t=Number(e.meta.count);let i=null;i=1===t?c.MailPoet.I18n.t("oneSubscriberTrashed"):c.MailPoet.I18n.t("multipleSubscribersTrashed").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onDelete:e=>{const t=Number(e.meta.count);let i=null;i=1===t?c.MailPoet.I18n.t("oneSubscriberDeleted"):c.MailPoet.I18n.t("multipleSubscribersDeleted").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onRestore:e=>{const t=Number(e.meta.count);let i=null;i=1===t?c.MailPoet.I18n.t("oneSubscriberRestored"):c.MailPoet.I18n.t("multipleSubscribersRestored").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onNoItemsFound:e=>"bounced"===e&&!window.mailpoet_premium_active&&!window.mailpoet_mss_active&&(0,p.jsxs)("div",{children:[(0,p.jsx)("p",{children:c.MailPoet.I18n.t("bouncedSubscribersHelp")}),(0,p.jsx)("p",{children:(0,p.jsx)("a",{href:"admin.php?page=mailpoet-upgrade",className:"button-primary",children:c.MailPoet.I18n.t("bouncedSubscribersPremiumButtonText")})})]})},ze=(e,t,i,a)=>(0,p.jsxs)(Ae.u,{title:a,onRequestClose:t,isDismissible:!0,children:[(0,p.jsx)(Re.Y,{field:i}),(0,p.jsx)("span",{className:"mailpoet-gap-half"}),(0,p.jsx)(r.Button,{onClick:e,dimension:"small",variant:"secondary",children:c.MailPoet.I18n.t("apply")})]}),Ze=[{name:"moveToList",label:c.MailPoet.I18n.t("moveToList"),onSelect:function(e,t){return ze(e,t,{id:"move_to_segment",name:"move_to_segment",endpoint:"segments",filter:function(e){return!(e.deleted_at||"default"!==e.type)}},c.MailPoet.I18n.t("moveToList"))},getData:function(){return{segment_id:Number(ke()("#move_to_segment").val())}},onSuccess:function(e){c.MailPoet.Notice.success(c.MailPoet.I18n.t("multipleSubscribersMovedToList").replace("%1$d",Number(e.meta.count).toLocaleString()).replace("%2$s",e.meta.segment))}},{name:"addToList",label:c.MailPoet.I18n.t("addToList"),onSelect:function(e,t){return ze(e,t,{id:"add_to_segment",name:"add_to_segment",endpoint:"segments",filter:function(e){return!(e.deleted_at||"default"!==e.type)}},c.MailPoet.I18n.t("addToList"))},getData:function(){return{segment_id:Number(ke()("#add_to_segment").val())}},onSuccess:function(e){c.MailPoet.Notice.success(c.MailPoet.I18n.t("multipleSubscribersAddedToList").replace("%1$d",Number(e.meta.count).toLocaleString()).replace("%2$s",e.meta.segment))}},{name:"removeFromList",label:c.MailPoet.I18n.t("removeFromList"),onSelect:function(e,t){return ze(e,t,{id:"remove_from_segment",name:"remove_from_segment",endpoint:"segments",filter:function(e){return!("default"!==e.type)}},c.MailPoet.I18n.t("removeFromList"))},getData:function(){return{segment_id:Number(ke()("#remove_from_segment").val())}},onSuccess:function(e){c.MailPoet.Notice.success(c.MailPoet.I18n.t("multipleSubscribersRemovedFromList").replace("%1$d",Number(e.meta.count).toLocaleString()).replace("%2$s",e.meta.segment))}},{name:"removeFromAllLists",label:c.MailPoet.I18n.t("removeFromAllLists"),onSuccess:function(e){c.MailPoet.Notice.success(c.MailPoet.I18n.t("multipleSubscribersRemovedFromAllLists").replace("%1$d",Number(e.meta.count).toLocaleString()))}},{name:"trash",label:c.MailPoet.I18n.t("moveToTrash"),onSuccess:He.onTrash},{name:"unsubscribe",label:c.MailPoet.I18n.t("unsubscribe"),onSelect:(e,t,i)=>{const a="all"!==i.selection?i.selected_ids.length:i.count;return(0,p.jsxs)(Ae.u,{title:c.MailPoet.I18n.t("unsubscribe"),onRequestClose:t,isDismissible:!0,children:[(0,p.jsx)("p",{children:c.MailPoet.I18n.t("unsubscribeConfirm").replace("%s",Number(a).toLocaleString())}),(0,p.jsx)("span",{className:"mailpoet-gap-half"}),(0,p.jsx)(r.Button,{onClick:e,dimension:"small",variant:"secondary",automationId:"bulk-unsubscribe-confirm",children:c.MailPoet.I18n.t("apply")})]})}},{name:"addTag",label:c.MailPoet.I18n.t("addTag"),onSelect:function(e,t){return ze(e,t,{id:"add_tag",name:"add_tag",endpoint:"tags"},c.MailPoet.I18n.t("addTag"))},getData:function(){return{tag_id:Number(ke()("#add_tag").val())}},onSuccess:function(e){c.MailPoet.Notice.success(c.MailPoet.I18n.t("tagAddedToMultipleSubscribers").replace("%1$s",e.meta.tag).replace("%2$d",Number(e.meta.count).toLocaleString()))}},{name:"removeTag",label:c.MailPoet.I18n.t("removeTag"),onSelect:function(e,t){return ze(e,t,{id:"remove_tag",name:"remove_tag",endpoint:"tags"},c.MailPoet.I18n.t("removeTag"))},getData:function(){return{tag_id:Number(ke()("#remove_tag").val())}},onSuccess:function(e){c.MailPoet.Notice.success(c.MailPoet.I18n.t("tagRemovedFromMultipleSubscribers").replace("%1$s",e.meta.tag).replace("%2$d",Number(e.meta.count).toLocaleString()))}}],Ye=[{name:"statistics",label:c.MailPoet.I18n.t("statsListingActionTitle"),link:function(e,t){return(0,p.jsx)(Me.Link,{to:{pathname:`/stats/${e.id}`,state:{backUrl:t?.pathname}},children:c.MailPoet.I18n.t("statsListingActionTitle")})}},{name:"edit",label:c.MailPoet.I18n.t("edit"),link:function(e,t){return(0,p.jsx)(Me.Link,{to:{pathname:`/edit/${e.id}`,state:{backUrl:t?.pathname}},children:c.MailPoet.I18n.t("edit")})}},{name:"sendConfirmationEmail",className:"mailpoet-hide-on-mobile",label:c.MailPoet.I18n.t("resendConfirmationEmail"),display:function(e){return"unconfirmed"===e.status&&e.count_confirmations<window.mailpoet_max_confirmation_emails},onClick:function(e){return c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"subscribers",action:"sendConfirmationEmail",data:{id:e.id}}).done((()=>c.MailPoet.Notice.success(c.MailPoet.I18n.t("oneConfirmationEmailSent")))).fail((e=>c.MailPoet.Notice.showApiErrorNotice(e)))}},{name:"trash",className:"mailpoet-hide-on-mobile"}],Ge=e=>0===Number(e.wp_user_id)&&0===Number(e.is_woocommerce_user),Ke=e=>{let t=null;return window.mailpoet_segments.forEach((i=>{i.id===e&&(t=i)})),t};function Qe(e){let{match:t}=e;const i=(0,Ne.TH)();return(0,p.jsxs)("div",{children:[(0,p.jsx)(We,{}),(0,p.jsx)(qe,{subscribersInPlan:c.MailPoet.subscribersCount,subscribersInPlanLimit:c.MailPoet.subscribersLimit}),(0,p.jsx)(w,{}),(0,p.jsx)(Fe,{cacheCalculation:window.mailpoet_subscribers_counts_cache_created_at}),(0,p.jsx)(Ee.N,{limit:window.mailpoet_listing_per_page,location:i,params:t.params,endpoint:"subscribers",onRenderItem:(e,t)=>{const a=ee()("manage-column","column-primary","has-row-actions","column-username");let s="";switch(e.status){case"subscribed":s=c.MailPoet.I18n.t("subscribed");break;case"unconfirmed":s=c.MailPoet.I18n.t("unconfirmed");break;case"unsubscribed":s=c.MailPoet.I18n.t("unsubscribed");break;case"inactive":s=c.MailPoet.I18n.t("inactive");break;case"bounced":s=c.MailPoet.I18n.t("bounced");break;default:s="Invalid"}const n=[];return e.subscriptions.length>0&&e.subscriptions.forEach((e=>{const t=Ke(e.segment_id);null!==t&&"subscribed"===e.status&&n.push(t)})),(0,p.jsxs)("div",{children:[(0,p.jsxs)("td",{className:a,children:[(0,p.jsx)(Me.Link,{className:"mailpoet-listing-title",to:{pathname:`/edit/${e.id}`,state:{backUrl:i?.pathname}},children:e.email}),(0,p.jsxs)("div",{className:"mailpoet-listing-subtitle",children:[e.first_name," ",e.last_name]}),t]}),(0,p.jsx)("td",{className:"column","data-colname":c.MailPoet.I18n.t("status"),children:s}),(0,p.jsx)("td",{className:"column","data-colname":c.MailPoet.I18n.t("lists"),children:(0,p.jsx)(r.SegmentTags,{segments:n,dimension:"large"})}),(0,p.jsx)("td",{className:"column","data-colname":c.MailPoet.I18n.t("tags"),children:(0,p.jsx)(r.SubscriberTags,{subscribers:e.tags,variant:"wordpress",isInverted:!0})}),!0===Ve?(0,p.jsx)("td",{className:"column mailpoet-listing-stats-column","data-colname":c.MailPoet.I18n.t("statisticsColumn"),children:(0,p.jsx)("div",{className:"mailpoet-listing-stats",children:(0,p.jsx)("a",{href:`#/stats/${e.id}`,children:(0,p.jsx)(fe,{id:e.id,engagementScore:e.engagement_score})},`stats-link-${e.id}`)})}):null,(0,p.jsxs)("td",{className:"column-date mailpoet-hide-on-mobile","data-colname":c.MailPoet.I18n.t("subscribedOn"),children:[c.MailPoet.Date.short(e.created_at),(0,p.jsx)("br",{}),c.MailPoet.Date.time(e.created_at)]})]})},columns:Ue,bulk_actions:Ze,item_actions:Ye,messages:He,sort_by:"created_at",sort_order:"desc",isItemDeletable:Ge})]})}Qe.propTypes={match:Te().shape({params:Te().object}).isRequired},Qe.displayName="SubscriberList";var Xe=i(73136),Je=i.n(Xe),et=i(93625),tt=i(26869),it=i.n(tt),at=i(3537);class st extends o.Component{render(){const e=this.props.field.name||null,t=this.props.item||{};let i,a;this.props.onValueChange instanceof Function&&(i=t[this.props.field.name],i=void 0===i?this.props.field.defaultValue||"":i),!i&&this.props.field.defaultValue&&(a=this.props.field.defaultValue);let s=this.props.field.id||null;!s&&this.props.field.name&&(s=`field_${this.props.field.name}`);let n,o=this.props.field.className||null;return o||this.props.field.size||(o="regular-text"),n="function"==typeof this.props.field.disabled?this.props.field.disabled(this.props.item):"boolean"==typeof this.props.field.disabled&&this.props.field.disabled,(0,p.jsx)(at.I,{type:"text",disabled:n,className:o,size:"auto"!==this.props.field.size&&this.props.field.size>0?this.props.field.size:null,name:e,id:s,value:i,defaultValue:a,placeholder:this.props.field.placeholder,onChange:this.props.onValueChange,onBlur:this.props.onBlurEvent,customLabel:this.props.field.customLabel,tooltip:this.props.field.tooltip,...this.props.field.validation})}}st.propTypes={onValueChange:Te().func,onBlurEvent:Te().func,field:Te().shape({name:Te().string.isRequired,defaultValue:Te().string,id:Te().string,className:Te().string,size:Te().oneOfType([Te().string,Te().number]),disabled:Te().oneOfType([Te().bool,Te().func]),placeholder:Te().string,validation:Te().shape({"data-parsley-required":Te().bool,"data-parsley-required-message":Te().string,"data-parsley-type":Te().string,"data-parsley-errors-container":Te().string,maxLength:Te().number}),customLabel:Te().string,tooltip:Te().string}).isRequired,item:Te().object.isRequired},st.defaultProps={onValueChange:function(){},onBlurEvent:function(){}};var nt=i(62865);function ot(e){return(0,p.jsx)(nt.g,{type:"text",name:e.field.name,id:`field_${e.field.name}`,value:e.item[e.field.name],placeholder:e.field.placeholder,defaultValue:e.field.defaultValue,onChange:e.onValueChange,className:e.field.className,customLabel:e.field.customLabel,tooltip:e.field.tooltip,...e.field.validation})}ot.propTypes={item:Te().object.isRequired,field:Te().shape({name:Te().string,placeholder:Te().string,defaultValue:Te().string,validation:Te().shape({"data-parsley-required":Te().bool,"data-parsley-required-message":Te().string,"data-parsley-type":Te().string,"data-parsley-errors-container":Te().string,maxLength:Te().number}),className:Te().string,customLabel:Te().string,tooltip:Te().string}).isRequired,onValueChange:Te().func.isRequired};var rt=i(43869),lt=i(67902);class dt extends o.Component{render(){if(void 0===this.props.field.values)return!1;let e,t=!1,i=!1,a=!1;void 0!==this.props.field.placeholder&&(i=(0,p.jsx)("option",{value:"",children:this.props.field.placeholder})),void 0!==this.props.field.filter&&(t=this.props.field.filter),rt.default.isFunction(this.props.field.sortBy)&&(a=this.props.field.sortBy),e=a?rt.default.map(rt.default.sortBy(rt.default.pairs(this.props.field.values),(e=>a(e[0],e[1]))),(e=>e[0])):Object.keys(this.props.field.values);const s=e.filter((e=>!1===t||t(this.props.item,e))).map((e=>(0,p.jsx)("option",{value:e,children:this.props.field.values[e]},`option-${e}`)));return(0,p.jsxs)(lt.Select,{name:this.props.field.name,id:`field_${this.props.field.name}`,value:this.props.item[this.props.field.name]||"",onChange:this.props.onValueChange,automationId:this.props.automationId,...this.props.field.validation,children:[i,s]})}}dt.propTypes={onValueChange:Te().func,field:Te().shape({name:Te().string.isRequired,values:Te().objectOf(Te().string),placeholder:Te().string,filter:Te().func,sortBy:Te().func,validation:Te().shape({"data-parsley-required":Te().bool,"data-parsley-required-message":Te().string,"data-parsley-type":Te().string,"data-parsley-errors-container":Te().string,maxLength:Te().number})}).isRequired,item:Te().object.isRequired,automationId:Te().string},dt.defaultProps={automationId:"",onValueChange:function(){}};var ct=i(60216);class mt extends o.Component{constructor(e){super(e),this.onValueChange=this.onValueChange.bind(this)}onValueChange=(e,t)=>this.props.onValueChange(t);render(){if(void 0===this.props.field.values)return!1;const e=this.props.item[this.props.field.name],t=Object.keys(this.props.field.values).map((t=>(0,p.jsx)("p",{children:(0,p.jsx)(ct.Y,{checked:e===t,value:t,onCheck:this.onValueChange,name:this.props.field.name,children:this.props.field.values[t]})},`radio-${t}`)));return(0,p.jsx)("div",{children:t})}}mt.propTypes={onValueChange:Te().func,field:Te().shape({name:Te().string.isRequired,values:Te().objectOf(Te().string)}).isRequired,item:Te().object.isRequired},mt.defaultProps={onValueChange:function(){}};var ut=i(49321);class pt extends o.Component{constructor(e){super(e),this.onValueChange=this.onValueChange.bind(this)}onValueChange=(e,t)=>(t.target.value=e?"1":"0",this.props.onValueChange(t));render(){if(void 0===this.props.field.values)return!1;const e=!!Number(this.props.item[this.props.field.name]),t=Object.keys(this.props.field.values).map((t=>(0,p.jsx)("p",{children:(0,p.jsx)(ut.X,{value:"1",checked:e,name:this.props.field.name,onCheck:this.onValueChange,children:this.props.field.values[t]})},`checkbox-${t}`)));return(0,p.jsx)("div",{children:t})}}function ht(e){const t=[];void 0!==e.placeholder&&t.push((0,p.jsx)("option",{value:"",children:e.placeholder},0));const i=Je()().year();for(let e=i;e>=i-100;e-=1)t.push((0,p.jsx)("option",{value:e,children:e},e));return(0,p.jsx)(r.Select,{isMinWidth:!0,name:`${e.name}[year]`,value:e.year,onChange:e.onValueChange,children:t})}function gt(e){const t=[];void 0!==e.placeholder&&t.push((0,p.jsx)("option",{value:"",children:e.placeholder},0));for(let i=1;i<=12;i+=1)t.push((0,p.jsx)("option",{value:i,children:e.monthNames[i-1]},i));return(0,p.jsx)(r.Select,{isMinWidth:!0,name:`${e.name}[month]`,value:e.month,onChange:e.onValueChange,children:t})}function ft(e){const t=[];void 0!==e.placeholder&&t.push((0,p.jsx)("option",{value:"",children:e.placeholder},0));for(let e=1;e<=31;e+=1)t.push((0,p.jsx)("option",{value:e,children:e},e));return(0,p.jsx)(r.Select,{isMinWidth:!0,name:`${e.name}[day]`,value:e.day,onChange:e.onValueChange,children:t})}pt.propTypes={onValueChange:Te().func.isRequired,field:Te().shape({name:Te().string.isRequired,values:Te().objectOf(Te().string)}).isRequired,item:Te().object.isRequired},ht.propTypes={name:Te().string.isRequired,placeholder:Te().string.isRequired,onValueChange:Te().func.isRequired,year:Te().oneOfType([Te().string,Te().number]).isRequired},gt.propTypes={name:Te().string.isRequired,placeholder:Te().string.isRequired,onValueChange:Te().func.isRequired,month:Te().oneOfType([Te().string,Te().number]).isRequired,monthNames:Te().arrayOf(Te().string).isRequired},ft.propTypes={name:Te().string.isRequired,placeholder:Te().string.isRequired,onValueChange:Te().func.isRequired,day:Te().oneOfType([Te().string,Te().number]).isRequired};class _t extends o.Component{constructor(e){super(e),this.state={year:"",month:"",day:""},this.onValueChange=this.onValueChange.bind(this)}componentDidMount(){this.extractDateParts()}componentDidUpdate(e){void 0!==this.props.item&&void 0!==e.item&&this.props.item.id!==e.item.id&&this.extractDateParts()}onValueChange(e){const t=e.target.name.match(/(.*?)\[(.*?)\]/);let i=null,a=null;if(null!==t&&3===t.length){[,i,a]=t;const s=Number(e.target.value);this.setState({[`${a}`]:s},(()=>{this.props.onValueChange({target:{name:i,value:this.formatValue()}})}))}}formatValue(){let e;switch(this.props.field.params.date_type){case"year_month_day":e={year:this.state.year,month:this.state.month,day:this.state.day};break;case"year_month":e={year:this.state.year,month:this.state.month};break;case"month":e={month:this.state.month};break;case"year":e={year:this.state.year};break;default:e={value:"invalid type"}}return e}extractDateParts(){const e=void 0!==this.props.item[this.props.field.name]?this.props.item[this.props.field.name].trim():"";if(""===e)return;const t=Je()(e);this.setState({year:t.format("YYYY"),month:t.format("M"),day:t.format("D")})}render(){const e=window.mailpoet_month_names||[];let t=(window.mailpoet_date_formats||{})[this.props.field.params.date_type][0];this.props.field.params.date_format&&(t=this.props.field.params.date_format);const i=t.split("/").map((t=>{switch(t){case"YYYY":return(0,p.jsx)(ht,{onValueChange:this.onValueChange,name:this.props.field.name,year:this.state.year,placeholder:this.props.field.year_placeholder},"year");case"MM":return(0,p.jsx)(gt,{onValueChange:this.onValueChange,name:this.props.field.name,month:this.state.month,monthNames:e,placeholder:this.props.field.month_placeholder},"month");case"DD":return(0,p.jsx)(ft,{onValueChange:this.onValueChange,name:this.props.field.name,day:this.state.day,placeholder:this.props.field.day_placeholder},"day");default:return(0,p.jsx)("div",{children:"Invalid date type"})}}));return(0,p.jsx)("div",{children:i})}}_t.propTypes={item:Te().object.isRequired,field:Te().shape({name:Te().string,day_placeholder:Te().string,month_placeholder:Te().string,year_placeholder:Te().string,params:Te().object}).isRequired,onValueChange:Te().func.isRequired};var bt=i(86104),xt=i(41745);function vt(e){const t=Array.isArray(e.item[e.field.name])?e.field.name&&e.item[e.field.name].map((t=>e.field.getName(t))):[];let i=[];return e.field.endpoint?i=function(e){let t=[];return void 0!==window[`mailpoet_${e}`]&&(t=window[`mailpoet_${e}`]),t}(String(e.field.endpoint)).map((t=>e.field.getName(t))):e.field.suggestedValues&&(i=e.field.suggestedValues),(0,p.jsx)(xt.T,{label:e.field.label,name:e.field.name,placeholder:e.field.placeholder,selectedValues:t,suggestedValues:i,onChange:e.onValueChange})}class yt extends o.Component{renderField=e=>{let t,i=!1;e.field.description&&(i=(0,p.jsx)("p",{className:"description",children:e.field.description}));let a=e.field;switch(void 0!==e.field.field&&(a=ke().merge(a,e.field.field)),a.type){case"text":t=(0,p.jsx)(st,{onValueChange:e.onValueChange,field:e.field,item:e.item,automationId:e.automationId,inline:e.inline,description:e.description});break;case"textarea":t=(0,p.jsx)(ot,{onValueChange:e.onValueChange,field:e.field,item:e.item,automationId:e.automationId,inline:e.inline,description:e.description});break;case"select":t=(0,p.jsx)(dt,{onValueChange:e.onValueChange,field:e.field,item:e.item,automationId:e.automationId,inline:e.inline,description:e.description});break;case"radio":t=(0,p.jsx)(mt,{onValueChange:e.onValueChange,field:e.field,item:e.item,automationId:e.automationId,inline:e.inline,description:e.description});break;case"checkbox":t=(0,p.jsx)(pt,{onValueChange:e.onValueChange,field:e.field,item:e.item,automationId:e.automationId,inline:e.inline,description:e.description});break;case"selection":t=(0,p.jsx)(Re.Y,{onValueChange:e.onValueChange,field:e.field,automationId:e.automationId,inline:e.inline,description:e.description,item:e.item},`selection-field-${a.name}`);break;case"date":t=(0,p.jsx)(_t,{onValueChange:e.onValueChange,field:e.field,item:e.item,automationId:e.automationId,inline:e.inline,description:e.description});break;case"reactComponent":t=(0,p.jsx)(e.field.component,{onValueChange:e.onValueChange,field:e.field,item:e.item,automationId:e.automationId,inline:e.inline,description:e.description});break;case"tokenField":t=(0,p.jsx)(vt,{onValueChange:e.onValueChange,field:e.field,item:e.item,automationId:e.automationId,description:e.description});break;case"empty":break;default:t="invalid"}const s="function"==typeof a.disabled?a.disabled(e.field):a.disabled,n={...a.onWrapperClick?{onClick:a.onWrapperClick}:{}};return(0,p.jsxs)("div",{className:ee()("mailpoet-form-field",{"mailpoet-form-field-disabled":s}),...n,children:[t,i]},`field-${e.index||0}`)};render(){let e=!1;e=void 0!==this.props.field.fields?this.props.field.fields.map(((e,t)=>this.renderField({index:t,field:e,item:this.props.item,onValueChange:this.props.onValueChange||!1}))):this.renderField(this.props);let t=!1;this.props.field.label&&(t=(0,p.jsx)(bt.X,{level:4,children:(0,p.jsx)("label",{htmlFor:`field_${this.props.field.name}`,children:this.props.field.label})}));let i=!1;return this.props.field.tip&&(i=(0,p.jsx)("p",{className:"mailpoet-form-description",children:this.props.field.tip})),(0,p.jsxs)("div",{className:`mailpoet-form-field-${this.props.field.name} form-field-row-${this.props.field.name}`,children:[t,i,e]})}}yt.propTypes={onValueChange:Te().func,field:Te().shape({name:Te().string.isRequired,values:Te().objectOf(Te().string),tip:Te().oneOfType([Te().array,Te().string]),label:Te().string,fields:Te().arrayOf(Te().object),description:Te().string,onWrapperClick:Te().func,disabled:Te().oneOfType([Te().func,Te().bool])}).isRequired,item:Te().object.isRequired},yt.defaultProps={onValueChange:function(){}},(0,r.registerTranslations)();class jt extends o.Component{constructor(e){super(e),this.formRef=(0,o.createRef)(),this.state={loading:!1,errors:[],item:{}}}componentDidMount(){void 0!==this.props.params.id?this.loadItem(this.props.params.id):it()((()=>{const e=ke()(".mailpoet_form").mailpoetSerializeObject(),t=Array.isArray(this.props.fields)&&this.props.fields.length>0&&this.props.fields.find((e=>"checkbox"===e?.type&&e?.isChecked));t&&t.name&&(e[t.name]="1"),this.setState({item:e})}))}componentDidUpdate(e){void 0===this.props.params.id&&e.location.pathname!==this.props.location.pathname&&(it()((()=>{this.setState({loading:!1,item:{}})})),void 0===this.props.item&&this.formRef.current.reset())}getValues=()=>this.props.item||this.state.item;getErrors=()=>this.props.errors||this.state.errors;loadItem=e=>{this.setState({loading:!0}),this.props.endpoint&&c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:this.props.endpoint,action:"get",data:{id:e}}).done((e=>{this.setState({loading:!1,item:e.data}),"function"==typeof this.props.onItemLoad&&this.props.onItemLoad(e.data)})).fail((()=>{this.setState({loading:!1,item:{}},(function(){this.props.history.push("/lists")}))}))};handleSubmit=e=>{if(e.preventDefault(),void 0!==this.props.isValid&&!1===this.props.isValid())return;this.setState({loading:!0});const t={};this.props.fields.forEach((e=>{void 0!==e.fields?e.fields.forEach((e=>{t[e.name]=this.state.item[e.name]})):t[e.name]=this.state.item[e.name]})),void 0!==this.props.params.id&&(t.id=this.props.params.id),this.props.endpoint&&c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:this.props.endpoint,action:"save",data:t}).always((()=>{this.setState({loading:!1})})).done((()=>{void 0!==this.props.onSuccess?this.props.onSuccess():this.props.history.push("/"),void 0!==this.props.params.id?this.props.messages.onUpdate():this.props.messages.onCreate()})).fail((e=>{e.errors.length>0&&this.setState({errors:e.errors})}))};handleValueChange=e=>{const{name:t,value:i}=Object.prototype.hasOwnProperty.call(e,"target")?e.target:e;return this.props.onChange?this.props.onChange(e):(this.setState((e=>{const a=e.item;return a[t]=i,{item:a}})),!0)};render(){let e;void 0!==this.getErrors()&&(e=this.getErrors().map((e=>(0,p.jsx)("div",{className:"mailpoet_notice notice inline error is-dismissible",children:(0,p.jsx)("p",{children:e.message})},`error-${e.message}`))));const t=ee()("mailpoet_form",{mailpoet_form_loading:this.state.loading||this.props.loading});let i=!1,a=!1;void 0!==this.props.beforeFormContent&&(i=this.props.beforeFormContent(this.getValues())),void 0!==this.props.afterFormContent&&(a=this.props.afterFormContent(this.getValues()));const s=this.props.fields.map((e=>{let t=this.handleValueChange;return e.onBeforeChange&&(t=t=>(e.onBeforeChange(t),this.handleValueChange(t))),(0,p.jsx)(yt,{field:e,item:this.getValues(),onValueChange:t,automationId:e.automationId},`field-${e.name}`)}));let n=!1;return n=this.props.children?this.props.children:(0,p.jsx)(r.Button,{type:"submit",isDisabled:this.state.loading,children:(0,Oe.__)("Save","mailpoet")}),(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{className:"mailpoet-form-content-around",children:i}),(0,p.jsxs)("form",{id:this.props.id,ref:this.formRef,className:t,onSubmit:void 0!==this.props.onSubmit?this.props.onSubmit:this.handleSubmit,"data-automation-id":this.props.automationId,children:[e,(0,p.jsxs)("div",{className:"mailpoet-form-grid",children:[s,(0,p.jsx)("div",{className:"mailpoet-form-actions",children:n})]})]}),(0,p.jsx)("div",{className:"mailpoet-form-content-around",children:a})]})}}jt.propTypes={params:Te().shape({id:Te().string}),location:Te().shape({pathname:Te().string}),item:Te().object,errors:Te().arrayOf(Te().object),endpoint:Te().string,fields:Te().arrayOf(Te().object),messages:Te().shape({onUpdate:Te().func,onCreate:Te().func}),loading:Te().bool,children:Te().array,id:Te().string,automationId:Te().string,beforeFormContent:Te().func,afterFormContent:Te().func,onItemLoad:Te().func,isValid:Te().func,onChange:Te().func,onSubmit:Te().func,onSuccess:Te().func,history:Te().shape({push:Te().func.isRequired}).isRequired},jt.defaultProps={params:{},location:{},errors:void 0,fields:void 0,item:void 0,onItemLoad:void 0,isValid:void 0,onSuccess:void 0,onChange:void 0,loading:!1,beforeFormContent:void 0,afterFormContent:void 0,children:void 0,id:"",onSubmit:void 0,automationId:"",messages:{onUpdate:()=>{},onCreate:()=>{}},endpoint:void 0};const wt=(0,Ne.EN)(jt);var St=i(92348);const Pt=[{name:"email",label:c.MailPoet.I18n.t("email"),type:"text",disabled:function(e){return Number(e.wp_user_id>0)||1===Number(e.is_woocommerce_user)}},{name:"first_name",label:c.MailPoet.I18n.t("firstname"),type:"text",disabled:function(e){return Number(e.wp_user_id>0)||1===Number(e.is_woocommerce_user)}},{name:"last_name",label:c.MailPoet.I18n.t("lastname"),type:"text",disabled:function(e){return Number(e.wp_user_id>0)||1===Number(e.is_woocommerce_user)}},{name:"status",label:c.MailPoet.I18n.t("status"),type:"select",automationId:"subscriber-status",values:{subscribed:c.MailPoet.I18n.t("subscribed"),unconfirmed:c.MailPoet.I18n.t("unconfirmed"),unsubscribed:c.MailPoet.I18n.t("unsubscribed"),inactive:c.MailPoet.I18n.t("inactive"),bounced:c.MailPoet.I18n.t("bounced")}},{name:"segments",label:c.MailPoet.I18n.t("lists"),type:"selection",placeholder:c.MailPoet.I18n.t("selectList"),tip:c.MailPoet.I18n.t("welcomeEmailTip"),api_version:window.mailpoet_api_version,endpoint:"segments",multiple:!0,selected:function(e){return!1===Array.isArray(e.subscriptions)?null:e.subscriptions.filter((e=>"subscribed"===e.status)).map((e=>e.segment_id))},filter:function(e){return!e.deleted_at&&"default"===e.type},getLabel:function(e){return e.name},getCount:function(e){return e.subscribers},getSearchLabel:function(e,t){let i="";return void 0!==t.subscriptions&&t.subscriptions.forEach((t=>{if(e.id===t.segment_id&&(i=e.name,"unsubscribed"===t.status)){const e=c.MailPoet.Date.format(t.updated_at);i+=" (%1$s)".replace("%1$s",c.MailPoet.I18n.t("unsubscribedOn").replace("%1$s",e))}})),i}},{name:"tags",label:c.MailPoet.I18n.t("tags"),type:"tokenField",placeholder:c.MailPoet.I18n.t("addNewTag"),suggestedValues:[],endpoint:"tags",getName:function(e){return Object.prototype.hasOwnProperty.call(e,"name")?e.name:e}}];(window.mailpoet_custom_fields||[]).forEach((e=>{const t={name:`cf_${e.id}`,label:e.name,type:e.type};switch(e.params&&(t.params=e.params,e.params.values&&(t.values=e.params.values)),e.type){case"date":t.year_placeholder=c.MailPoet.I18n.t("year"),t.month_placeholder=c.MailPoet.I18n.t("month"),t.day_placeholder=c.MailPoet.I18n.t("day");break;case"select":t.placeholder="-";break;default:t.placeholder=""}Pt.push(t)}));const Mt={onUpdate:function(){c.MailPoet.Notice.success(c.MailPoet.I18n.t("subscriberUpdated"))},onCreate:function(){c.MailPoet.Notice.success(c.MailPoet.I18n.t("subscriberAdded")),c.MailPoet.trackEvent("Subscribers > Add new")}};function Nt(e){if(Number(e.wp_user_id)>0)return(0,p.jsx)("p",{className:"description",children:_()(c.MailPoet.I18n.t("WPUserEditNotice"),/\[link\](.*?)\[\/link\]/g,((t,i)=>(0,p.jsx)("a",{href:`user-edit.php?user_id=${e.wp_user_id}`,children:t},i)))})}function It(e){return(0,p.jsxs)(p.Fragment,{children:[e?.unsubscribes?.map((e=>{const t=Je()(e.createdAt.date).format("dddd MMMM Do YYYY [at] h:mm:ss a");let i;return i="admin"===e.source?c.MailPoet.I18n.t("unsubscribedAdmin").replace("%1$d",t).replace("%2$d",e.meta):"manage"===e.source?c.MailPoet.I18n.t("unsubscribedManage").replace("%1$d",t):"newsletter"===e.source?_()(c.MailPoet.I18n.t("unsubscribedNewsletter").replace("%1$d",t),/\[link\]/g,((t,i)=>(0,p.jsx)("a",{href:`admin.php?page=mailpoet-newsletter-editor&id=${e.newsletterId}`,children:e.newsletterSubject},i))):"mp_api"===e.source?c.MailPoet.I18n.t("unsubscribedMpApi").replace("%1$d",t):c.MailPoet.I18n.t("unsubscribedUnknown").replace("%1$d",t),(0,p.jsx)("p",{className:"description",children:i},i)})),(0,p.jsxs)("p",{className:"description",children:[(0,p.jsx)("strong",{children:c.MailPoet.I18n.t("tip")})," ",c.MailPoet.I18n.t("customFieldsTip")]})]})}function kt(e){let{match:t}=e;const i=(0,Ne.TH)(),a=(0,Ne.k6)(),s=i.state?.backUrl||"/";return(0,p.jsxs)("div",{children:[(0,p.jsx)(et.A,{color:"#fff"}),(0,p.jsx)(St.B,{}),(0,p.jsxs)(bt.X,{level:1,className:"mailpoet-title",children:[(0,p.jsx)("span",{children:c.MailPoet.I18n.t("subscriber")}),(0,p.jsx)(Me.Link,{className:"mailpoet-button button button-secondary button-small",to:s,children:c.MailPoet.I18n.t("backToList")})]}),(0,p.jsx)(b,{}),(0,p.jsx)(wt,{automationId:"subscriber_edit_form",endpoint:"subscribers",fields:Pt,params:t.params,messages:Mt,beforeFormContent:Nt,afterFormContent:It,onSuccess:()=>a.push(s)})]})}kt.propTypes={match:Te().shape({params:Te().shape({id:Te().string}).isRequired}).isRequired},kt.displayName="SubscriberForm";var Ct=i(9515);function Tt(e){let{email:t}=e;const i=(0,Ne.TH)(),a=i.state?.backUrl||"/";return(0,p.jsxs)(bt.X,{level:1,className:"mailpoet-title",children:[(0,p.jsx)("span",{children:c.MailPoet.I18n.t("statsHeading").replace("%s",t)}),(0,p.jsx)(Me.Link,{className:"mailpoet-button button button-secondary button-small",to:a,children:c.MailPoet.I18n.t("backToList")})]})}var Et=i(74702);function At(e){let{stats:t,subscriber:i}=e;return(0,p.jsx)("div",{className:"mailpoet-tab-content mailpoet-subscriber-stats-summary",children:(0,p.jsx)("div",{className:"mailpoet-listing",children:(0,p.jsxs)("table",{className:"mailpoet-listing-table",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{}),t.periodic_stats.map((e=>(0,p.jsx)("td",{children:e.timeframe},e.timeframe)))]})}),(0,p.jsxs)("tbody",{children:[(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:c.MailPoet.I18n.t("statsSentEmail")}),t.periodic_stats.map((e=>(0,p.jsx)("td",{children:e.total_sent},e.timeframe)))]}),(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(0,p.jsx)(Et.V,{children:c.MailPoet.I18n.t("statsOpened")})}),t.periodic_stats.map((e=>{const t=e.total_sent>0;let i=e.open.toLocaleString();return t&&(i+=` (${Math.round(e.open/e.total_sent*100)}%)`),(0,p.jsx)("td",{children:i},e.timeframe)}))]}),(0,p.jsxs)("tr",{children:[(0,p.jsxs)("td",{children:[(0,p.jsx)(Et.V,{children:c.MailPoet.I18n.t("statsMachineOpened")}),(0,p.jsx)(De.Tooltip,{tooltip:_()(c.MailPoet.I18n.t("statsMachineOpenedTooltip"),/\[link](.*?)\[\/link]/,(e=>(0,p.jsx)("span",{style:{pointerEvents:"all"},children:(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/368-what-are-machine-opens",target:"_blank",rel:"noopener noreferrer",children:e},"kb-link")},"machine-opened-info")))})]}),t.periodic_stats.map((e=>{const t=e.total_sent>0;let i=e.machine_open.toLocaleString();return t&&(i+=` (${Math.round(e.machine_open/e.total_sent*100)}%)`),(0,p.jsx)("td",{children:i},e.timeframe)}))]}),(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(0,p.jsx)(Et.V,{isInverted:!0,children:c.MailPoet.I18n.t("statsClicked")})}),t.periodic_stats.map((e=>{const t=e.total_sent>0;let i=e.click.toLocaleString();return t&&(i+=` (${Math.round(e.click/e.total_sent*100)}%)`),(0,p.jsx)("td",{children:i},e.timeframe)}))]}),(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:c.MailPoet.I18n.t("statsNotClicked")}),t.periodic_stats.map((e=>{const t=e.total_sent-(e.open+e.machine_open),i=e.total_sent>0;let a=t.toLocaleString();return i&&(a+=` (${Math.round(t/e.total_sent*100)}%)`),(0,p.jsx)("td",{children:a},e.timeframe)}))]}),(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:c.MailPoet.I18n.t("statisticsColumn")}),(0,p.jsx)("td",{colSpan:t.periodic_stats.length,children:(0,p.jsx)("div",{className:"mailpoet-listing-stats",children:(0,p.jsx)(fe,{id:i.id,engagementScore:i.engagement_score})})})]})]})]})})})}function Rt(e){let{stats:t}=e;return(0,p.jsx)("div",{className:"mailpoet-tab-content mailpoet-subscriber-stats-summary",children:(0,p.jsx)("div",{className:"mailpoet-listing",children:(0,p.jsxs)("table",{className:"mailpoet-listing-table",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{}),t.periodic_stats.map((e=>(0,p.jsx)("td",{children:e.timeframe},e.timeframe)))]})}),(0,p.jsxs)("tbody",{children:[(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:"Orders created"}),t.periodic_stats.map((e=>(0,p.jsx)("td",{children:e.woocommerce.count.toLocaleString()},e.timeframe)))]}),(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:"Total revenue"}),t.periodic_stats.map((e=>(0,p.jsx)("td",{children:e.woocommerce.formatted},e.timeframe)))]}),(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:"Average revenue"}),t.periodic_stats.map((e=>(0,p.jsx)("td",{children:e.woocommerce.formatted_average},e.timeframe)))]})]})]})})})}var Ot=i(84209),Lt=i(83825);function Ft(e){let{limitReached:t,limitValue:i,subscribersCountTowardsLimit:a,premiumActive:s,hasValidApiKey:n,hasPremiumSupport:o}=e;return(0,p.jsxs)("table",{className:"mailpoet-listing-table","data-automation-id":"subscriber-stats-no-access",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:c.MailPoet.I18n.t("email")}),(0,p.jsx)("th",{children:c.MailPoet.I18n.t("columnAction")}),(0,p.jsx)("th",{children:c.MailPoet.I18n.t("columnCount")}),(0,p.jsx)("th",{children:c.MailPoet.I18n.t("columnActionOn")})]})}),(0,p.jsx)("tbody",{children:(0,p.jsx)("tr",{children:(0,p.jsx)("td",{colSpan:4,children:(0,p.jsx)("div",{className:"mailpoet-subscriber-stats-no-access-content",children:(0,p.jsx)(Lt.K,{title:s&&t?c.MailPoet.I18n.t("upgradeRequired"):c.MailPoet.I18n.t("premiumFeature"),message:(()=>{let e=c.MailPoet.I18n.t("premiumRequired");return s?(e=o?c.MailPoet.I18n.t("planLimitReached"):c.MailPoet.I18n.t("freeLimitReached"),(0,p.jsx)("p",{children:_()(e,/(\[subscribersCount]|\[subscribersLimit])/g,(e=>"[subscribersCount]"===e?a:i))})):(0,p.jsx)("p",{children:_()(e,/\[link](.*?)\[\/link]/g,(e=>(0,p.jsx)("a",{href:c.MailPoet.premiumLink,children:e},e)))})})(),actionButton:s&&t?(0,p.jsx)(Le.z,{href:n?c.MailPoet.MailPoetComUrlFactory.getUpgradeUrl():c.MailPoet.MailPoetComUrlFactory.getPurchasePlanUrl(a+1),children:c.MailPoet.I18n.t("premiumBannerCtaUpgrade")}):(0,p.jsx)(Le.z,{href:c.MailPoet.MailPoetComUrlFactory.getPurchasePlanUrl(c.MailPoet.subscribersCount,c.MailPoet.currentWpUserEmail,null,{utm_medium:"stats",utm_campaign:"signup"}),children:c.MailPoet.I18n.t("premiumBannerCtaFree")})})})})})})]})}function Dt(e){let{params:t,location:i}=e;const a=(0,o.useMemo)((()=>Ot.Hooks.applyFilters("mailpoet_subscribers_opened_emails_stats",(()=>(0,p.jsx)(Ft,{limitReached:c.MailPoet.subscribersLimitReached,limitValue:c.MailPoet.subscribersLimit,subscribersCountTowardsLimit:c.MailPoet.subscribersCount,premiumActive:c.MailPoet.premiumActive,hasValidApiKey:c.MailPoet.hasValidApiKey,hasPremiumSupport:c.MailPoet.hasPremiumSupport})),t,i)),[i,t]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(bt.X,{level:4,children:c.MailPoet.I18n.t("openedEmailsHeading")}),(0,p.jsx)(a,{})]})}function qt(e){return"string"==typeof e?c.MailPoet.Date.format(e):(0,Oe.__)("never","mailpoet")}function $t(e){let{stats:t}=e;const i=[{label:(0,Oe.__)("Last click","mailpoet"),date:t.last_click||null},{label:(0,Oe.__)("Last engagement","mailpoet"),date:t.last_engagement||null},{label:(0,Oe.__)("Last open","mailpoet"),date:t.last_open||null},{label:(0,Oe.__)("Last page view","mailpoet"),date:t.last_page_view||null},{label:(0,Oe.__)("Last sending","mailpoet"),date:t.last_sending||null}];return t.is_woo_active&&i.push({label:(0,Oe.__)("Last purchase","mailpoet"),date:t.last_purchase||null}),i.sort(((e,t)=>e.date===t.date?0:e.date?t.date?t.date.localeCompare(e.date):-1:1)),(0,p.jsx)("div",{className:"mailpoet-tab-content mailpoet-subscriber-stats-summary",children:(0,p.jsx)("div",{className:"mailpoet-listing",children:(0,p.jsx)("table",{className:"mailpoet-listing-table",children:(0,p.jsx)("tbody",{children:i.map((e=>{let{label:t,date:i}=e;return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:t}),(0,p.jsx)("td",{children:(0,p.jsx)("b",{children:qt(i)})})]},t)}))})})})})}function Bt(){const e=(0,Ne.$B)(),t=(0,Ne.TH)(),[i,a]=(0,o.useState)(null),[s,n]=(0,o.useState)(!0),r=(0,l.S)(window).notices.error;return(0,o.useEffect)((()=>{c.MailPoet.Ajax.post({api_version:c.MailPoet.apiVersion,endpoint:"subscriberStats",action:"get",data:{subscriber_id:e.params.id}}).done((e=>{a(e.data),n(!1)})).fail((e=>{n(!1),e.errors.length>0&&r((0,p.jsx)(p.Fragment,{children:e.errors.map((e=>(0,p.jsx)("p",{children:e.message},e.message)))}),{scroll:!0})}))}),[e.params.id,r]),s?(0,p.jsx)(Ct.g,{}):(0,p.jsxs)("div",{className:"mailpoet-subscriber-stats",children:[(0,p.jsx)(Tt,{email:i.email}),(0,p.jsxs)("div",{className:"mailpoet-subscriber-stats-summary-grid",children:[(0,p.jsx)(At,{stats:i,subscriber:{id:Number(e.params.id),engagement_score:i.engagement_score}}),(0,p.jsx)($t,{stats:i}),i.is_woo_active&&(0,p.jsx)(Rt,{stats:i})]}),(0,p.jsx)(Dt,{params:e.params,location:t})]})}function Wt(){return(0,p.jsx)(l.k.Provider,{value:(0,l.S)(window),children:(0,p.jsxs)(Me.HashRouter,{children:[(0,p.jsx)(m.w,{}),(0,p.jsxs)(Ne.rs,{children:[(0,p.jsx)(Ne.AW,{path:"/new",render:(0,r.withBoundary)(kt)}),(0,p.jsx)(Ne.AW,{path:"/edit/:id",render:(0,r.withBoundary)(kt)}),(0,p.jsx)(Ne.AW,{path:"/stats/:id/(.*)?",component:(0,r.withBoundary)(Bt)}),(0,p.jsx)(Ne.AW,{path:"*",component:(0,r.withBoundary)(Qe)})]})]})})}Bt.displayName="SubscriberStats";const Vt=document.getElementById("subscribers_container");Vt&&((0,r.registerTranslations)(),n.render((0,p.jsx)(Wt,{}),Vt));var Ut=i(83665),Ht=i(93399);class zt extends o.PureComponent{render(){const e=this.props.event,t=e.soon;let i;if(this.props.premium)i=(0,p.jsx)("a",{href:"?page=mailpoet-premium",target:"_blank",children:(0,Oe.__)("This is a Premium feature","mailpoet")});else if(e.actionButtonLink&&e.actionButtonTitle)i=(0,p.jsx)("a",{href:e.actionButtonLink,target:"_blank",rel:"noopener noreferrer",children:e.actionButtonTitle});else{const a=t?null:rt.default.partial(this.props.eventsConfigurator,e.slug);i=(0,p.jsx)(Le.z,{disabled:t,onClick:a,role:"presentation",automationId:`create_${e.slug}`,onKeyDown:e=>{["keydown","keypress"].includes(e.type)&&["Enter"," "].includes(e.key)&&(e.preventDefault(),a())},children:e.actionButtonTitle||(0,Oe.__)("Set up","mailpoet")})}return(0,p.jsxs)("div",{"data-type":e.slug,className:"mailpoet-newsletter-type",children:[(0,p.jsx)("div",{className:"mailpoet-newsletter-type-image",children:e.badge&&(0,p.jsx)(Ht.C,{title:e.badge.text})}),(0,p.jsxs)("div",{className:"mailpoet-newsletter-type-content",children:[(0,p.jsxs)(bt.X,{level:4,children:[e.title," ",e.soon&&`(${(0,Oe.__)("Soon","mailpoet")})`]}),(0,p.jsx)("p",{children:e.description}),(0,p.jsx)("div",{className:"mailpoet-flex-grow"}),(0,p.jsx)("div",{className:"mailpoet-newsletter-type-action",children:i})]})]})}}zt.defaultProps={premium:!1},zt.propTypes={premium:Te().bool,eventsConfigurator:Te().func.isRequired,event:Te().shape({slug:Te().string.isRequired,actionButtonLink:Te().string,title:Te().string.isRequired,soon:Te().bool,badge:Te().shape({style:Te().string,text:Te().string}),description:Te().string.isRequired,actionButtonTitle:Te().string}).isRequired};class Zt extends o.Component{constructor(e){super(e),this.email=this.props.email,this.emailEvents=this.email.events,this.eventsConfigurator=this.eventsConfigurator.bind(this)}eventsConfigurator(e){c.MailPoet.trackEvent("Emails > Automatic Type selected",{"Email type":e}),this.props.history.push(`/new/${this.email.slug}/${e}/conditions`)}render(){return rt.default.map(this.emailEvents,((e,t)=>(0,p.jsx)(zt,{premium:this.email.premium,event:e,eventsConfigurator:this.eventsConfigurator},t)))}}Zt.propTypes={email:Te().shape({title:Te().string.isRequired,slug:Te().string.isRequired,premium:Te().bool}).isRequired,history:Te().shape({push:Te().func.isRequired}).isRequired};const Yt=(0,Ne.EN)(Zt),Gt={woocommerce:(0,p.jsxs)("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 120 71",style:{enableBackground:"new 0 0 120 71"},children:[(0,p.jsx)("path",{fill:"#9ca6cc",d:"M11.4,0.7h97.1c6.1,0,11.1,4.9,11.1,11v36.7c0,6.1-5,11-11.1,11H73.7L78.5,71l-21-11.6h-46 c-6.1,0-11.1-4.9-11.1-11V11.7C0.3,5.7,5.3,0.7,11.4,0.7z"}),(0,p.jsx)("path",{fill:"#fff",d:"M7.2,10.7c0.7-0.9,1.7-1.4,3.1-1.5c2.5-0.2,3.9,1,4.2,3.5c1.5,10,3.2,18.5,4.9,25.5l10.6-20 c1-1.8,2.2-2.8,3.6-2.9c2.1-0.1,3.4,1.2,4,4c1.2,6.4,2.8,11.8,4.6,16.4c1.3-12.2,3.4-21,6.4-26.4c0.7-1.3,1.8-2,3.2-2.1 c1.1-0.1,2.1,0.2,3.1,1c0.9,0.7,1.4,1.6,1.5,2.7c0,0.9-0.1,1.6-0.5,2.3c-1.9,3.5-3.4,9.3-4.7,17.3c-1.2,7.8-1.6,13.9-1.4,18.3 c0.1,1.2-0.1,2.3-0.6,3.2c-0.6,1.1-1.5,1.6-2.6,1.7c-1.3,0.1-2.6-0.5-3.8-1.8c-4.5-4.6-8.1-11.4-10.7-20.5c-3.2,6.1-5.5,10.8-7,13.8 c-2.9,5.4-5.3,8.2-7.3,8.4c-1.3,0.1-2.4-1-3.4-3.3C11.9,44.1,9.3,32,6.4,14C6.2,12.7,6.5,11.6,7.2,10.7z M111.3,18.3 c-1.7-3-4.3-4.9-7.8-5.6c-0.9-0.2-1.8-0.3-2.6-0.3c-4.7,0-8.4,2.4-11.4,7.2c-2.5,4.1-3.8,8.6-3.8,13.5c0,3.7,0.8,6.9,2.3,9.5 c1.7,3,4.3,4.9,7.8,5.6c0.9,0.2,1.8,0.3,2.6,0.3c4.7,0,8.5-2.4,11.4-7.2c2.5-4.1,3.8-8.6,3.8-13.6C113.7,24,112.9,20.9,111.3,18.3z M105.2,31.6c-0.7,3.2-1.9,5.5-3.7,7.1c-1.4,1.2-2.7,1.8-3.9,1.5c-1.2-0.2-2.1-1.2-2.9-3.1c-0.6-1.5-0.9-3-0.9-4.4 c0-1.2,0.1-2.4,0.3-3.5c0.4-2,1.3-3.9,2.6-5.7c1.6-2.4,3.3-3.3,5-3c1.2,0.2,2.1,1.2,2.9,3.1c0.6,1.5,0.9,3,0.9,4.4 C105.6,29.3,105.5,30.5,105.2,31.6z M81,18.3c-1.7-3-4.4-4.9-7.8-5.6c-0.9-0.2-1.8-0.3-2.6-0.3c-4.7,0-8.4,2.4-11.4,7.2 c-2.5,4.1-3.8,8.6-3.8,13.5c0,3.7,0.8,6.9,2.3,9.5c1.7,3,4.3,4.9,7.8,5.6c0.9,0.2,1.8,0.3,2.6,0.3c4.7,0,8.5-2.4,11.4-7.2 c2.5-4.1,3.8-8.6,3.8-13.6C83.3,24,82.5,20.9,81,18.3z M74.8,31.6c-0.7,3.2-1.9,5.5-3.7,7.1c-1.4,1.2-2.7,1.8-3.9,1.5 c-1.2-0.2-2.1-1.2-2.9-3.1c-0.6-1.5-0.9-3-0.9-4.4c0-1.2,0.1-2.4,0.3-3.5c0.4-2,1.3-3.9,2.6-5.7c1.6-2.4,3.3-3.3,5-3 c1.2,0.2,2.1,1.2,2.9,3.1c0.6,1.5,0.9,3,0.9,4.4C75.2,29.3,75.1,30.5,74.8,31.6z"})]})};var Kt=i(3243),Qt=i(63062);function Xt(e){let{legacyEditorCallback:t,isModalOpen:i,onClose:a}=e;return i?(0,p.jsxs)(Qt.Z,{title:(0,Oe.__)("Choose an email editor","mailpoet"),onRequestClose:a,children:[(0,p.jsx)("p",{children:(0,Oe.__)("Which editor do you want to use?","mailpoet")}),(0,p.jsx)("p",{children:(0,p.jsx)(ue.ZP,{type:"button",variant:"primary",onClick:()=>{t(),a()},children:(0,Oe.__)("Legacy editor","mailpoet")})}),(0,p.jsx)("p",{children:(0,p.jsx)(ue.ZP,{type:"button",variant:"primary",onClick:()=>{window.location.href="post-new.php?post_type=mailpoet_email"},children:(0,Oe.__)("Gutenberg Editor","mailpoet")})})]}):null}function Jt(e){let{errors:t}=e;return t.length<1?null:(0,p.jsx)(u.q,{type:"error",closable:!1,children:t.map((e=>(0,p.jsx)("p",{children:e.message},e.message)))})}var ei=i(96300);function ti(e){let{filter:t,history:i,hideClosingButton:a=!1,hideScreenOptions:s=!0}=e;const[n,r]=(0,o.useState)(!1),[l,d]=(0,o.useState)(!1),[m,u]=(0,o.useState)((()=>()=>null)),h=c.MailPoet.FeaturesController.isSupported("gutenberg_email_editor"),g=e=>{void 0!==e&&(i.push(`/new/${e}`),c.MailPoet.trackEvent("Emails > Type selected",{"Email type":e}))},f=async()=>{c.MailPoet.trackEvent("Emails > Type selected",{"Email type":"wc_transactional"});let e=window.mailpoet_woocommerce_transactional_email_id;if(!e)try{e=(await c.MailPoet.Ajax.post({api_version:c.MailPoet.apiVersion,endpoint:"settings",action:"set",data:{"woocommerce.use_mailpoet_editor":1}})).data.woocommerce.transactional_email_id,c.MailPoet.trackEvent("Emails > WooCommerce email customizer enabled")}catch(e){return(0,ei.q)(e)&&e.errors.length>0?(0,p.jsx)(Jt,{errors:e.errors}):null}return window.location.href=`?page=mailpoet-newsletter-editor&id=${e}`,null},_=e=>{const t=!0===window.mailpoet_is_new_user?"mailpoet_badge mailpoet_badge_video":"mailpoet_badge mailpoet_badge_video mailpoet_badge_video_grey";return(0,p.jsxs)("div",{"data-type":e.slug,className:"mailpoet-newsletter-type",children:[(0,p.jsx)("div",{className:"mailpoet-newsletter-type-image"}),(0,p.jsxs)("div",{className:"mailpoet-newsletter-type-content",children:[(0,p.jsxs)(bt.X,{level:4,children:[e.title," ",e.beta?`(${(0,Oe.__)("Beta","mailpoet")})`:""]}),(0,p.jsx)("p",{children:e.description}),e.videoGuide&&(0,p.jsxs)("a",{className:t,href:e.videoGuide,target:"_blank",rel:"noopener noreferrer",children:[(0,p.jsx)("span",{className:"dashicons dashicons-format-video"}),(0,Oe.__)("See video guide","mailpoet")]}),e.kbLink&&(0,p.jsx)("a",{href:e.kbLink,target:"_blank",rel:"noopener noreferrer",children:(0,Oe.__)("Read more.","mailpoet")}),(0,p.jsx)("div",{className:"mailpoet-flex-grow"}),(0,p.jsx)("div",{className:"mailpoet-newsletter-type-action",children:e.action})]})]},e.slug)},b=()=>{if(!c.MailPoet.isWoocommerceActive)return[];const e=[{slug:"wc_transactional",title:(0,Oe.__)("WooCommerce Emails Customizer","mailpoet"),description:(0,Oe.__)("Customize the template used for your WooCommerce emails using MailPoet's editor. Example of WooCommerce email: Order processing notification, Order failed notification, ...","mailpoet"),action:(0,p.jsx)(Le.z,{automationId:"customize_woocommerce",onClick:f,tabIndex:0,onKeyDown:async e=>{["keydown","keypress"].includes(e.type)&&["Enter"," "].includes(e.key)&&(e.preventDefault(),await f())},children:(0,Oe.__)("Customize","mailpoet")})}];return c.MailPoet.hideAutomations&&e.push((()=>{const e=()=>{c.MailPoet.trackEvent("Emails > Type selected",{"Email type":"woocommerce_automatewoo"},{send_immediately:!0},(()=>{window.location.href="edit.php?post_type=aw_workflow#presets"}))};return{slug:"woocommerce_automatewoo",title:(0,Oe.__)("Automations","mailpoet"),description:(0,Oe.__)("Convert and retain customers with automated marketing that does the hard work for you. AutomateWoo has the tools you need to grow your store and make more money.","mailpoet"),kbLink:"https://kb.mailpoet.com/article/408-integration-with-automatewoo",action:(0,p.jsx)(Le.z,{automationId:"woocommerce_automatewoo",onClick:e,tabIndex:0,onKeyDown:t=>{["keydown","keypress"].includes(t.type)&&["Enter"," "].includes(t.key)&&(t.preventDefault(),e())},children:(0,Oe.__)("Set up","mailpoet")})}})()),e},x=e=>{r(!0),c.MailPoet.trackEvent("Emails > Type selected",{"Email type":e}),c.MailPoet.Ajax.post({api_version:c.MailPoet.apiVersion,endpoint:"newsletters",action:"create",data:{type:e,subject:(0,Oe.__)("Subject","mailpoet")}}).done((e=>{i.push(`/template/${e.data.id}`)})).fail((e=>(r(!1),e.errors.length>0?(0,p.jsx)(Jt,{errors:e.errors}):null)))};let v=rt.default.partial(x,"standard");h&&(v=()=>{u((()=>rt.default.partial(x,"standard"))),d(!0)});const y=rt.default.partial(g,"notification"),j=rt.default.partial(g,"welcome"),w=rt.default.partial(g,"re-engagement"),S=[{slug:"standard",title:(0,Oe.__)("Newsletter","mailpoet"),description:(0,Oe.__)("Send a newsletter with images, buttons, dividers, and social bookmarks. Or, just send a basic text email.","mailpoet"),action:(0,p.jsx)(Le.z,{automationId:"create_standard",onClick:v,tabIndex:0,withSpinner:n,onKeyDown:e=>{["keydown","keypress"].includes(e.type)&&["Enter"," "].includes(e.key)&&(e.preventDefault(),v())},children:(0,Oe.__)("Create","mailpoet")})},{slug:"welcome",title:(0,Oe.__)("Welcome Email","mailpoet"),description:(0,Oe.__)("Automatically send an email (or series of emails) to new subscribers or WordPress users. Send a day, a week, or a month after they sign up.","mailpoet"),videoGuide:"https://kb.mailpoet.com/article/254-video-guide-to-welcome-emails",action:(0,p.jsx)(Le.z,{onClick:j,automationId:"create_welcome",withSpinner:n,onKeyDown:e=>{["keydown","keypress"].includes(e.type)&&["Enter"," "].includes(e.key)&&(e.preventDefault(),j())},tabIndex:0,children:(0,Oe.__)("Set up","mailpoet")})},{slug:"notification",title:(0,Oe.__)("Latest Post Notifications","mailpoet"),description:(0,Oe.__)("Let MailPoet email your subscribers with your latest content. You can send daily, weekly, monthly, or even immediately after publication.","mailpoet"),videoGuide:"https://kb.mailpoet.com/article/210-video-guide-to-post-notifications",action:(0,p.jsx)(Le.z,{automationId:"create_notification",onClick:y,withSpinner:n,tabIndex:0,onKeyDown:e=>{["keydown","keypress"].includes(e.type)&&["Enter"," "].includes(e.key)&&(e.preventDefault(),y())},children:(0,Oe.__)("Set up","mailpoet")})},{slug:"re_engagement",title:(0,Oe.__)("Re-engagement Emails","mailpoet"),description:(0,Oe.__)("Automatically email and win back subscribers who have recently lost interest and stopped engaging with your emails.","mailpoet"),action:(0,p.jsx)(Le.z,{automationId:"create_notification",onClick:w,withSpinner:n,tabIndex:0,onKeyDown:e=>{["keydown","keypress"].includes(e.type)&&["Enter"," "].includes(e.key)&&(e.preventDefault(),w())},children:(0,Oe.__)("Set up","mailpoet")})}];let P=Ot.Hooks.applyFilters("mailpoet_newsletters_types",[...S],this);t&&(P=P.filter(t));const M=c.MailPoet.Ajax.constructGetUrl({api_version:c.MailPoet.apiVersion,endpoint:"newsletterTemplates",action:"getAll"});return(0,p.jsxs)(p.Fragment,{children:[s&&(0,p.jsx)(St.B,{}),(0,p.jsx)("link",{rel:"prefetch",href:window.mailpoet_editor_javascript_url,as:"script"}),(0,p.jsxs)("div",{className:"mailpoet-newsletter-types",children:[!a&&(0,p.jsx)("div",{className:"mailpoet-newsletter-types-close",children:(0,p.jsx)("button",{type:"button",onClick:()=>i.push("/"),className:"mailpoet-modal-close",children:Kt.X})}),P.map((e=>_(e)),this),(()=>{if(!window.mailpoet_woocommerce_automatic_emails)return[];let e=window.mailpoet_woocommerce_automatic_emails;return t&&(e=rt.default.filter(e,t)),rt.default.map(e,(e=>{const a=e;return(0,p.jsxs)(o.Fragment,{children:[!t&&(0,p.jsxs)("div",{className:"mailpoet-newsletter-types-separator",children:[(0,p.jsx)("div",{className:"mailpoet-newsletter-types-separator-line"}),(0,p.jsx)("div",{className:"mailpoet-newsletter-types-separator-logo",children:Gt[a.slug]||null}),(0,p.jsx)("div",{className:"mailpoet-newsletter-types-separator-line"})]}),"woocommerce"===a.slug&&!c.MailPoet.hideAutomations&&(0,p.jsx)(Yt,{email:a,history:i}),"woocommerce"===a.slug&&b().map((e=>_(e)),this)]},a.slug)}))})()]}),(0,p.jsx)("link",{rel:"prefetch",href:M,as:"fetch"}),(0,p.jsx)(Xt,{legacyEditorCallback:m,onClose:()=>d(!1),isModalOpen:l})]})}ti.defaultProps={filter:null,hideScreenOptions:!0,hideClosingButton:!1};const ii=(0,Ne.EN)(ti);var ai=i(40292);function si(e){let{newsletter:t,isSent:i,currentTime:a}=e,s=i;if(void 0===s&&(s=t.statistics&&t.queue&&"scheduled"!==t.queue.status),!s)return null;const n={link:`/stats/${t.id}`,onClick:Ot.Hooks.applyFilters("mailpoet_newsletters_listing_stats_tracking",Ut.gP)},o=Number(t.total_sent||t.queue.count_processed);let l,d,c,m,u,h=0,g=0,f=null;o>0&&(h=100*t.statistics.clicked/o,g=100*t.statistics.opened/o,f=t.statistics.revenue),void 0!==a?(l=6,d=t.queue.scheduled_at||t.queue.created_at,c=Je()(a).diff(Je()(d),"hours"),m=c<l,u=!0):(m=!1,u=!1);const _=o>=20&&t.statistics.opened>=5&&!m,b=(e,i)=>((e,t,i,a)=>a<=0||!t.link?e:t.externalLink?(0,p.jsx)("a",{href:t.link,onClick:t.onClick||null,children:e},`stats-${i}`):(0,p.jsx)(Me.Link,{to:t.link,onClick:t.onClick||null,children:e},`stats-${i}`))(e,n,`${i}-${t.id}`,o),x=(0,p.jsx)(ai.M,{opened:g,clicked:h,revenues:f&&f.value>0?f.formatted:null,hideBadges:!_,newsletterId:t.id,wrapContentInLink:b}),v=(0,p.jsxs)(p.Fragment,{children:[x,m&&b((0,p.jsx)(r.Tag,{className:"mailpoet-listing-stats-too-early",dimension:"large",variant:"excellent",isInverted:!0,children:(0,Oe.__)("Nice job! Check back in %1$d hour(s) for more stats.","mailpoet").replace("%1$d",l-c)}),"check-back")]});let y;return u&&g<5&&c>=24&&o>=10&&(y=(0,p.jsx)("div",{children:(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/191-how-to-improve-my-open-and-click-rates",target:"_blank",rel:"noopener noreferrer",className:"mailpoet_stat_link_small",children:(0,Oe.__)("What can I do to improve this?","mailpoet")})})),(0,p.jsxs)(p.Fragment,{children:[v,y]})}const ni=Te().shape({clicked:Te().number,opened:Te().number,unsubscribed:Te().number,revenue:Te().shape({count:Te().number,currency:Te().string,formatted:Te().string,value:Te().number})}),oi=Te().shape({status:Te().string,count_processed:Te().string.isRequired,count_total:Te().string.isRequired,created_at:Te().string,scheduled_at:Te().string});si.propTypes={newsletter:Te().shape({id:Te().number.isRequired,queue:Te().oneOfType([oi,Te().bool]),total_sent:Te().number,statistics:Te().oneOfType([ni,Te().bool])}).isRequired,isSent:Te().bool,currentTime:Te().string},si.defaultProps={isSent:void 0,currentTime:void 0},si.displayName="NewsletterStatistics";const ri=(0,r.withBoundary)(si),li=c.MailPoet.trackingConfig.emailTrackingEnabled,di=window.mailpoet_woocommerce_automatic_emails||{},ci={onTrash:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email was moved to the trash.","mailpoet"):(0,Oe.__)("%1$d emails were moved to the trash.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onDelete:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email was permanently deleted.","mailpoet"):(0,Oe.__)("%1$d emails were permanently deleted.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onRestore:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email has been restored from the Trash.","mailpoet"):(0,Oe.__)("%1$d emails have been restored from the Trash.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)}},mi=[{name:"subject",label:(0,Oe.__)("Subject","mailpoet"),sortable:!0},{name:"settings",label:(0,Oe.__)("Settings","mailpoet")},{name:"statistics",label:(0,Oe.__)("Clicked, Opened","mailpoet"),display:li},{name:"status",label:(0,Oe.__)("Status","mailpoet"),width:145},{name:"updated_at",label:(0,Oe.__)("Last modified on","mailpoet"),sortable:!0}],ui=[{name:"trash",label:(0,Oe.__)("Move to trash","mailpoet"),onSuccess:ci.onTrash}];let pi=[{name:"view",link:function(e){return(0,p.jsx)("a",{href:e.preview_url,target:"_blank",rel:"noopener noreferrer",children:(0,Oe.__)("Preview","mailpoet")})}},{name:"edit",className:"mailpoet-hide-on-mobile",label:(0,Oe.__)("Edit","mailpoet"),onClick:Ut.Q2},{name:"duplicate",className:"mailpoet-hide-on-mobile",label:(0,Oe.__)("Duplicate","mailpoet"),onClick:(e,t)=>c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"duplicate",data:{id:e.id}}).done((e=>{c.MailPoet.Notice.success((0,Oe.__)('Email "%1$s" has been duplicated.',"mailpoet").replace("%1$s",e.data.subject)),t()})).fail((e=>{e.errors.length>0&&c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0})}))},{name:"trash",className:"mailpoet-hide-on-mobile"}];pi=(0,Ut.y8)(pi);class hi extends o.Component{constructor(e){super(e),this.state={eventCounts:{},newslettersCount:void 0},this.afterGetItems=this.afterGetItems.bind(this)}updateStatus=(e,t)=>{t.persist(),c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"setStatus",data:{id:Number(t.target.getAttribute("data-id")),status:e?"active":"draft"}}).done((e=>{if("active"===e.data.status){const e=t.target.getAttribute("data-group"),i=di[e];c.MailPoet.Notice.success((0,Oe.__)("Your %1s Automatic Email is now activated!","mailpoet").replace("%1s",i.title))}this.forceUpdate()})).fail((i=>{c.MailPoet.Notice.showApiErrorNotice(i),t.target.checked=!e}))};renderStatus=e=>{const t=parseInt(e.total_sent,10)>-1?(0,Oe.__)("Sent to %1$d customers","mailpoet").replace("%1$d",e.total_sent.toLocaleString()):null;return(0,p.jsxs)("div",{children:[(0,p.jsx)(r.Toggle,{className:"mailpoet-listing-status-toggle",onCheck:this.updateStatus,"data-id":e.id,"data-group":e.options.group,dimension:"small",defaultChecked:"active"===e.status}),(0,p.jsxs)("p",{className:"mailpoet-listing-notification-status",children:[t&&(0,p.jsx)(Me.Link,{to:`/sending-status/${e.id}`,children:t}),!t&&(0,p.jsx)("span",{className:"mailpoet-listing-status-unknown mailpoet-font-extra-small",children:(0,Oe.__)("Not sent yet","mailpoet")})]})]})};renderSettings=e=>{const t=di[e.options.group].events[e.options.event];let i;try{i=JSON.parse(e.options.meta||null)}catch(t){i=e.options.meta||null}const a=i&&i.option?rt.default.pluck(i.option,"name"):[];if(i&&rt.default.isEmpty(a))return(0,p.jsx)("span",{className:"mailpoet-listing-error",children:(0,Oe.__)("You need to configure email options before this email can be sent.","mailpoet")});let s,n;if(s=a.length>1&&"listingScheduleDisplayTextPlural"in t?_()(t.listingScheduleDisplayTextPlural,"%s",((e,t)=>(0,p.jsx)(r.StringTags,{strings:a},t))):_()(t.listingScheduleDisplayText,"%s",((e,t)=>(0,p.jsx)(r.StringTags,{strings:a},t))),s&&"immediate"!==e.options.afterTimeType)switch(e.options.afterTimeType){case"minutes":n=(0,Oe.__)("%1$d minute(s) later","mailpoet").replace("%1$d",e.options.afterTimeNumber);break;case"hours":n=(0,Oe.__)("%1$d hour(s) later","mailpoet").replace("%1$d",e.options.afterTimeNumber);break;case"days":n=(0,Oe.__)("%1$d day(s) later","mailpoet").replace("%1$d",e.options.afterTimeNumber);break;case"weeks":n=(0,Oe.__)("%1$d week(s) later","mailpoet").replace("%1$d",e.options.afterTimeNumber);break;default:n=(0,Oe.__)("Invalid sending delay.","mailpoet")}return(0,p.jsxs)("span",{children:[s,n&&(0,p.jsxs)("div",{className:"mailpoet-listing-schedule",children:[(0,p.jsx)("div",{className:"mailpoet-listing-schedule-icon",children:(0,p.jsx)(r.ScheduledIcon,{})}),n]})]})};renderItem=(e,t)=>{const i=ee()("manage-column","column-primary","has-row-actions");return(0,p.jsxs)("div",{children:[(0,p.jsxs)("td",{className:i,children:[(0,p.jsx)("a",{className:"mailpoet-listing-title",href:`?page=mailpoet-newsletter-editor&id=${e.id}`,onClick:t=>{t.preventDefault(),(0,Ut.Q2)(e)},children:e.subject}),t]}),(0,p.jsx)("td",{className:"column mailpoet-hide-on-mobile","data-colname":(0,Oe.__)("Settings","mailpoet"),children:this.renderSettings(e)}),!0===li?(0,p.jsx)("td",{className:"column mailpoet-listing-stats-column","data-colname":(0,Oe.__)("Clicked, Opened","mailpoet"),children:(0,p.jsx)(ri,{newsletter:e,isSent:e.total_sent>0&&!!e.statistics})}):null,(0,p.jsx)("td",{className:"column","data-colname":(0,Oe.__)("Status","mailpoet"),children:this.renderStatus(e)}),(0,p.jsxs)("td",{className:"column-date mailpoet-hide-on-mobile","data-colname":(0,Oe.__)("Last modified on","mailpoet"),children:[c.MailPoet.Date.short(e.updated_at),(0,p.jsx)("br",{}),c.MailPoet.Date.time(e.updated_at)]})]})};isItemInactive=e=>"draft"===e.status;afterGetItems(e){(0,Ut._X)(e),this.countEmailTypes(e)}countEmailTypes(e){const t={woocommerce_product_purchased:0,woocommerce_product_purchased_in_category:0,woocommerce_first_purchase:0};if(Array.isArray(e.items)){const i=e.items.map((e=>e.options.event)).reduce(((e,t)=>(e[t]?e[t]+=1:e[t]=1,e)),t);this.setState({eventCounts:i})}}renderWarning(){const{eventCounts:e}=this.state;return e.woocommerce_product_purchased+e.woocommerce_product_purchased_in_category+e.woocommerce_first_purchase?"1"===window.mailpoet_woocommerce_optin_on_checkout?null:(0,p.jsxs)("div",{className:"notice error",children:[(0,p.jsx)("p",{children:(0,Oe.__)("WooCommerce emails won’t be sent to new customers because the opt-in on checkout is disabled. Enable it so they can immediately get your emails after their first purchase.","mailpoet")}),(0,p.jsx)("p",{children:(0,p.jsx)("a",{href:"?page=mailpoet-settings#woocommerce",children:(0,Oe.__)("Edit WooCommerce settings","mailpoet")})})]}):null}render(){const{match:e,location:t}=this.props;return(0,p.jsxs)(p.Fragment,{children:[this.renderWarning(),0===this.state.newslettersCount&&(0,p.jsx)(ii,{filter:e=>"woocommerce"===e.slug,hideScreenOptions:!1,hideClosingButton:!0}),0!==this.state.newslettersCount&&(0,p.jsx)(Ee.N,{limit:window.mailpoet_listing_per_page,location:t,params:e.params,endpoint:"newsletters",type:"automatic",base_url:"woocommerce",onRenderItem:this.renderItem,isItemInactive:this.isItemInactive,columns:mi,bulk_actions:ui,item_actions:pi,messages:ci,auto_refresh:!0,sort_by:"updated_at",sort_order:"desc",afterGetItems:e=>{if(!e.loading){const t=e.groups.reduce(((e,t)=>e+t.count),0);this.setState({newslettersCount:t})}this.afterGetItems(e)}})]})}}hi.propTypes={match:Te().shape({params:Te().shape({tab:Te().string}).isRequired}).isRequired,location:Te().object.isRequired},hi.displayName="ListingsComponent";const gi=(0,Ne.EN)((0,r.withBoundary)(hi));var fi=i(23525),_i=i(11103);const bi=(0,Ne.EN)((e=>(0,p.jsx)(_i.b,{...e})));var xi=i(26050),vi=i(16424);class yi extends o.Component{constructor(e){super(e),this.onPreview=this.onPreview.bind(this),this.onDelete=this.onDelete.bind(this),this.onSelect=this.onSelect.bind(this)}onDelete(){const{id:e,name:t,beforeDelete:i,afterDelete:a}=this.props;(0,vi._)({message:(0,Oe.__)('You are about to delete the template named "%1$s".',"mailpoet").replace("%1$s",t),onConfirm:()=>{i(),c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletterTemplates",action:"delete",data:{id:e}}).done((()=>{a(!0,e)})).fail((e=>{e.errors.length>0&&this.context.notices.error(e.errors.map((e=>(0,p.jsx)("p",{children:e.message},e.message))),{scroll:!0}),a(!1)}))}})}onPreview(){c.MailPoet.Modal.popup({title:this.props.name,template:'<img src="{{ thumbnail }}" />',data:this.props})}onSelect(){const{newsletterId:e,name:t,beforeSelect:i,afterSelect:a}=this.props;i(),c.MailPoet.trackEvent("Emails > Template selected",{"Email name":t}),c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"save",data:{id:e,template_id:this.props.id}}).done((e=>{a(!0,e.data.id)})).fail((e=>{e.errors.length>0&&this.context.notices.error(e.errors.map((e=>(0,p.jsx)("p",{children:e.message},e.message))),{scroll:!0}),a(!1)}))}render(){const{index:e,name:t,thumbnail:i,readonly:a}=this.props;let s="";return"string"==typeof i&&i.length>0&&(s=(0,p.jsxs)("a",{className:"mailpoet-template-preview",href:"#",onClick:e=>{e.preventDefault(),this.onPreview(e)},children:[(0,p.jsx)("div",{className:"mailpoet-template-thumbnail",children:i?(0,p.jsx)("img",{src:i,alt:(0,Oe.__)("Template preview","mailpoet"),loading:"lazy"}):""}),(0,p.jsx)("div",{className:"mailpoet-template-preview-overlay",children:(0,p.jsx)(Le.z,{children:(0,Oe.__)("Preview","mailpoet")})})]})),(0,p.jsx)(xi.G,{label:t,onSelect:this.onSelect,onDelete:!1===a?this.onDelete:void 0,automationId:`select_template_${e}`,className:"mailpoet-template-two-lines",children:s})}}yi.contextType=l.k,yi.propTypes={index:Te().number.isRequired,id:Te().number.isRequired,newsletterId:Te().string.isRequired,name:Te().string.isRequired,thumbnail:Te().string,readonly:Te().bool.isRequired,beforeDelete:Te().func.isRequired,afterDelete:Te().func.isRequired,beforeSelect:Te().func.isRequired,afterSelect:Te().func.isRequired},yi.defaultProps={thumbnail:null},yi.displayName="TemplateBox";class ji extends o.Component{constructor(e){super(e),this.fileRef=(0,o.createRef)(),this.handleSubmit=this.handleSubmit.bind(this)}handleSubmit(e){if(e.preventDefault(),rt.default.size(this.fileRef.current.files)<=0)return!1;const t=rt.default.first(this.fileRef.current.files),i=new FileReader;return i.onload=e=>{try{this.saveTemplate(JSON.parse(e.target.result)),c.MailPoet.trackEvent("Emails > Template imported")}catch(e){this.context.notices.error((0,p.jsx)("p",{children:(0,Oe.__)("This template file appears to be damaged. Please try another one.","mailpoet")}))}},i.readAsText(t),!0}saveTemplate(e){const t=e,{beforeImport:i,afterImport:a}=this.props;rt.default.isUndefined(t.body)||(t.body=JSON.stringify(t.body));try{t.categories=JSON.parse(t.categories)}catch(e){t.categories=[]}-1===t.categories.indexOf("saved")&&t.categories.push("saved"),-1===t.categories.indexOf("standard")&&-1===t.categories.indexOf("welcome")&&-1===t.categories.indexOf("notification")&&t.categories.push("standard"),t.categories=JSON.stringify(t.categories),i(),c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletterTemplates",action:"save",data:t}).done((e=>{a(!0,e.data)})).fail((e=>{e.errors.length>0&&this.context.notices.error(e.errors.map((e=>(0,p.jsx)("p",{children:e.message},e.message))),{scroll:!0}),a(!1)}))}render(){return(0,p.jsxs)("div",{className:"mailpoet-template-import",children:[(0,p.jsxs)("h4",{children:[(0,Oe.__)("Import a template","mailpoet"),(0,p.jsx)(De.Tooltip,{tooltip:(0,Oe.__)("You can only upload .json templates that were originally created with MailPoet.","mailpoet"),place:"right",className:"tooltip-help-import-template"})]}),(0,p.jsxs)("form",{onSubmit:this.handleSubmit,children:[(0,p.jsx)("input",{type:"file",placeholder:(0,Oe.__)("Select a .json file to upload","mailpoet"),ref:this.fileRef}),(0,p.jsx)("p",{className:"submit",children:(0,p.jsx)("input",{className:"button button-primary",type:"submit",value:(0,Oe.__)("Upload","mailpoet")})})]})]})}}ji.contextType=l.k,ji.propTypes={beforeImport:Te().func.isRequired,afterImport:Te().func.isRequired};const wi=[];window.mailpoet_newsletters_templates_recently_sent_count&&wi.push({name:"recent",label:(0,Oe.__)("Recently sent","mailpoet")}),wi.push({name:"standard",label:(0,Oe.__)("Newsletters","mailpoet")},{name:"welcome",label:(0,Oe.__)("Welcome Emails","mailpoet")},{name:"notification",label:(0,Oe.__)("Post Notifications","mailpoet")},{name:"re_engagement",label:(0,Oe.__)("Re-engagement Emails","mailpoet")},{name:"blank",label:(0,Oe.__)("Simple text","mailpoet")}),window.mailpoet_woocommerce_active&&wi.push({name:"woocommerce",label:(0,Oe.__)("WooCommerce Emails","mailpoet")}),wi.push({name:"saved",label:(0,Oe.__)("Your saved templates","mailpoet")});class Si extends o.Component{constructor(e){super(e),this.state={loading:!0,templates:{},emailType:null,emailOptions:{},selectedTab:""},this.templates={},this.addTemplate=this.addTemplate.bind(this),this.afterTemplateDelete=this.afterTemplateDelete.bind(this),this.afterTemplateSelect=this.afterTemplateSelect.bind(this),this.afterTemplateImport=this.afterTemplateImport.bind(this)}componentDidMount(){c.MailPoet.Ajax.get({api_version:window.mailpoet_api_version,endpoint:"newsletterTemplates",action:"getAll"}).done((e=>{0===e.data.length&&(e.data=[{name:(0,Oe.__)("MailPoet's Guide","mailpoet"),categories:'["welcome", "notification", "standard", "woocommerce"]',readonly:!0}]),e.data.forEach(this.addTemplate),this.sortTemplates()})).fail((e=>{e.errors.length>0&&this.context.notices.error(e.errors.map((e=>(0,p.jsx)("p",{children:e.message},e.message))),{scroll:!0})})).always((()=>{this.selectInitialTab()}))}addTemplate(e){const t=wi.map((e=>e.name));let i;-1===t.indexOf("woocommerce")&&t.push("woocommerce");try{i=JSON.parse(e.categories).filter((e=>-1!==t.indexOf(e)))}catch(e){i=[]}0===i.length&&i.push("saved"),i.forEach((t=>{void 0===this.templates[t]&&(this.templates[t]=[]),this.templates[t].unshift(e)}))}sortTemplates(){const e=["welcome","notification","standard"];Object.keys(this.templates).forEach((t=>{this.templates[t].sort(((i,a)=>{if(e.includes(t)){if(i.categories.includes('"blank"')&&!a.categories.includes('"blank"'))return-1;if(!i.categories.includes('"blank"')&&a.categories.includes('"blank"'))return 1}return i.id<a.id?1:-1}))}))}selectInitialTab(){let e,t,i="standard";c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"get",data:{id:this.props.match.params.id}}).done((a=>{e=a.data.type,t=a.data.options,"automatic"===e&&(e=a.data.options.group||e),window.mailpoet_newsletters_templates_recently_sent_count?i="recent":rt.default.findWhere(wi,{name:a.data.type})?i=a.data.type:"automatic"===a.data.type&&rt.default.findWhere(wi,{name:a.data.options.group})&&(i=a.data.options.group)})).fail((e=>{e.errors.length>0&&this.context.notices.error(e.errors.map((e=>(0,p.jsx)("p",{children:e.message},e.message))),{scroll:!0})})).always((()=>{this.setState({templates:this.templates,emailType:e,emailOptions:t,selectedTab:i,loading:!1})}))}afterTemplateDelete(e,t){e&&Object.keys(this.templates).forEach((e=>{this.templates[e]=this.templates[e].filter((e=>e.id!==t))})),this.setState({templates:this.templates,loading:!1})}afterTemplateSelect(e,t){e?window.location=(e=>{const t=new URLSearchParams(window.location.search).get("context"),i=`admin.php?page=mailpoet-newsletter-editor&id=${e}`;return t?`${i}&context=${t}`:i})(t):this.setState({loading:!1})}afterTemplateImport(e,t){e&&this.addTemplate(t),this.setState({templates:this.templates,selectedTab:e?"saved":"import",loading:!1})}render(){if(this.state.loading)return(0,p.jsx)(Ct.g,{});const e=wi.concat({name:"import",label:(0,Oe._x)("Import","Importing template tab title","mailpoet")}).map((e=>Object.assign(e,{automationId:`templates-${e.name.replace(/\s+/g,"-").toLowerCase()}`})));let t=null;if("import"===this.state.selectedTab)t=(0,p.jsx)(ji,{beforeImport:()=>this.setState({loading:!0}),afterImport:this.afterTemplateImport});else{let e=this.state.templates[this.state.selectedTab]||[];e=0===e.length?this.state.loading?null:(0,p.jsx)("p",{children:(0,Oe.__)("This category does not contain any template yet!","mailpoet")}):e.map(((e,t)=>(0,p.jsx)(yi,{index:t,newsletterId:this.props.match.params.id,beforeDelete:()=>this.setState({loading:!0}),afterDelete:this.afterTemplateDelete,beforeSelect:()=>this.setState({loading:!0}),afterSelect:this.afterTemplateSelect,id:e.id,name:e.name,thumbnail:e.thumbnail,readonly:e.readonly},e.id))),t=e}let i,a=null;if("automation"===this.state.emailType){const e=this.state.emailOptions?.automationId,t=e?`admin.php?page=mailpoet-automation-editor&id=${e}`:"admin.php?page=mailpoet-automation";i=()=>{window.location=t},a=(0,p.jsx)("input",{type:"button",className:"button link-button",onClick:i,value:"Cancel"})}return(0,p.jsxs)("div",{children:[(0,p.jsx)(et.A,{color:"#fff"}),(0,p.jsx)(bi,{emailType:this.state.emailType,automationId:"email_template_selection_heading",buttons:a,onLogoClick:i}),(0,p.jsxs)("div",{className:"mailpoet-templates",children:[(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(fi.R,{categories:e,active:this.state.selectedTab,onSelect:e=>this.setState({selectedTab:e})})}),(0,p.jsx)(r.ErrorBoundary,{children:t})]})]})}}Si.contextType=l.k,Si.propTypes={match:Te().shape({params:Te().shape({id:Te().string}).isRequired}).isRequired},Si.display="NewsletterTemplates";var Pi=i(61888),Mi=i.n(Pi),Ni=i(5837),Ii=i.n(Ni),ki=i(24581),Ci=i(61515),Ti=i(93676),Ei=i(28270),Ai=i.n(Ei),Ri=i(40612);const Oi={abbreviated:[(0,Oe.__)("Jan","mailpoet"),(0,Oe.__)("Feb","mailpoet"),(0,Oe.__)("Mar","mailpoet"),(0,Oe.__)("Apr","mailpoet"),(0,Oe.__)("May","mailpoet"),(0,Oe.__)("Jun","mailpoet"),(0,Oe.__)("Jul","mailpoet"),(0,Oe.__)("Aug","mailpoet"),(0,Oe.__)("Sep","mailpoet"),(0,Oe.__)("Oct","mailpoet"),(0,Oe.__)("Nov","mailpoet"),(0,Oe.__)("Dec","mailpoet")],wide:[(0,Oe.__)("January","mailpoet"),(0,Oe.__)("February","mailpoet"),(0,Oe.__)("March","mailpoet"),(0,Oe.__)("April","mailpoet"),(0,Oe.__)("May","mailpoet"),(0,Oe.__)("June","mailpoet"),(0,Oe.__)("July","mailpoet"),(0,Oe.__)("August","mailpoet"),(0,Oe.__)("September","mailpoet"),(0,Oe.__)("October","mailpoet"),(0,Oe.__)("November","mailpoet"),(0,Oe.__)("December","mailpoet")]},Li={narrow:[(0,Oe._x)("S","Sunday - one letter abbreviation","mailpoet"),(0,Oe._x)("M","Monday - one letter abbreviation","mailpoet"),(0,Oe._x)("T","Tuesday - one letter abbreviation","mailpoet"),(0,Oe._x)("W","Wednesday - one letter abbreviation","mailpoet"),(0,Oe._x)("T","Thursday - one letter abbreviation","mailpoet"),(0,Oe._x)("F","Friday - one letter abbreviation","mailpoet"),(0,Oe._x)("S","Saturday - one letter abbreviation","mailpoet")],abbreviated:[(0,Oe.__)("Sun","mailpoet"),(0,Oe.__)("Mon","mailpoet"),(0,Oe.__)("Tue","mailpoet"),(0,Oe.__)("Wed","mailpoet"),(0,Oe.__)("Thu","mailpoet"),(0,Oe.__)("Fri","mailpoet"),(0,Oe.__)("Sat","mailpoet")],wide:[(0,Oe.__)("Sunday","mailpoet"),(0,Oe.__)("Monday","mailpoet"),(0,Oe.__)("Tuesday","mailpoet"),(0,Oe.__)("Wednesday","mailpoet"),(0,Oe.__)("Thursday","mailpoet"),(0,Oe.__)("Friday","mailpoet"),(0,Oe.__)("Saturday","mailpoet")]};Ti.Z.localize.month=Ai()({values:Oi,defaultWidth:"wide"}),Ti.Z.localize.day=Ai()({values:Li,defaultWidth:"wide"}),Ti.Z.options.weekStartsOn=void 0!==c.MailPoet.wpWeekStartsOn?c.MailPoet.wpWeekStartsOn:1,(0,Ci.registerLocale)("mailpoet",Ti.Z);class Fi extends o.Component{onChange=(e,t)=>{const i=t,a=this.getStorageDate(e);i.target.name=this.getFieldName(),i.target.value=a,this.props.onChange(i)};getFieldName=()=>this.props.name||"date";getDisplayDateFormat=e=>c.MailPoet.Date.convertFormat(e).replace(/D/g,"d").replace(/Y/g,"y").replace(/A/g,"a").replace(/o/g,"Y").replace(/\[/g,"").replace(/\]/g,"");getDate=e=>{const t={parseFormat:this.props.storageFormat};return c.MailPoet.Date.toDate(e,t)};getStorageDate=e=>{const t={format:this.props.storageFormat};return c.MailPoet.Date.format(e,t)};render(){return(0,p.jsx)(Ri.a,{name:this.getFieldName(),selected:this.getDate(this.props.value),dateFormat:this.getDisplayDateFormat(this.props.displayFormat),disabled:this.props.disabled,onChange:this.onChange,minDate:this.getDate(window.mailpoet_current_date),maxDate:this.props.maxDate,locale:"mailpoet",...this.props.validation})}}class Di extends o.Component{render(){const e=Object.keys(this.props.timeOfDayItems).map((e=>(0,p.jsx)("option",{value:e,children:this.props.timeOfDayItems[e]},`option-${this.props.timeOfDayItems[e]}`)));return(0,p.jsx)(lt.Select,{name:this.props.name||"time",value:this.props.value,disabled:this.props.disabled,onChange:this.props.onChange,isMinWidth:!0,...this.props.validation,children:e})}}Di.propTypes={timeOfDayItems:Te().objectOf(Te().string).isRequired,name:Te().string,value:Te().string.isRequired,disabled:Te().bool,onChange:Te().func.isRequired,validation:Te().object},Di.defaultProps={name:"time",disabled:!1,validation:{}},Di.displayName="TimeSelect";class qi extends o.Component{DATE_TIME_SEPARATOR=" ";constructor(e){super(e),this.state=this.buildStateFromProps(e)}componentDidUpdate(e){this.props.value===e.value&&this.props.defaultDateTime===e.defaultDateTime||it()((()=>{this.setState(this.buildStateFromProps(this.props))}))}getDateTime=()=>[this.state.date,this.state.time].join(this.DATE_TIME_SEPARATOR);buildStateFromProps=e=>{const t=e.value||this.props.defaultDateTime,[i,a]=t.split(this.DATE_TIME_SEPARATOR);return{date:i,time:a}};handleChange=e=>{const t={};t[e.target.name]=e.target.value,this.setState(t,this.propagateChange)};propagateChange=()=>{this.props.onChange&&this.props.onChange({target:{name:this.props.name||"",value:this.getDateTime()}})};render(){return(0,p.jsx)(ki.Grid.Column,{className:"mailpoet-datetime-container",children:(0,p.jsxs)(r.ErrorBoundary,{children:[(0,p.jsx)(Fi,{name:"date",value:this.state.date,onChange:this.handleChange,displayFormat:this.props.dateDisplayFormat,storageFormat:this.props.dateStorageFormat,disabled:this.props.disabled,validation:this.props.dateValidation,maxDate:this.props.maxDate}),(0,p.jsx)(Di,{name:"time",value:this.state.time,onChange:this.handleChange,disabled:this.props.disabled,validation:this.props.timeValidation,timeOfDayItems:this.props.timeOfDayItems})]})})}}qi.propTypes={value:Te().string,defaultDateTime:Te().string.isRequired,dateDisplayFormat:Te().string.isRequired,dateStorageFormat:Te().string.isRequired,onChange:Te().func,name:Te().string,disabled:Te().bool,dateValidation:Te().object.isRequired,timeValidation:Te().any,timeOfDayItems:Te().objectOf(Te().string).isRequired,maxDate:Te().instanceOf(Date)},qi.defaultProps={onChange:void 0,name:"",disabled:!1,timeValidation:void 0,value:void 0,maxDate:null};var $i=i(86656),Bi=i(57036),Wi=i(44584),Vi=i(50438);class Ui extends o.Component{constructor(e){super(e),this.state={emailAddress:e.item.sender_address,showSenderDomainWarning:!1,showAuthEmailsError:!1},this.onChange=this.onChange.bind(this),this.onBlur=this.onBlur.bind(this),window.mailpoet_sender_address_field_blur=this.onBlur;const t=e.field.id||`field_${e.field.name}`;this.domElementSelector=`#${t}`,this.parsleyFieldName="invalidFromAddress"}componentDidMount(){this.validateEmailAddress()}onChange(e){const t=e.target.value.toLowerCase();this.setState({emailAddress:t}),this.props.onValueChange({...e,target:{...e.target,name:e.target.name,value:t}}),this.setState({showAuthEmailsError:!1,showSenderDomainWarning:!1}),(0,Bi.dy)(this.domElementSelector,this.parsleyFieldName)}onBlur(){this.validateEmailAddress()}isEmailAddressAuthorized=e=>(window.mailpoet_authorized_emails||[]).includes(e);showInvalidFromAddressError=()=>{(0,Bi.Ib)(this.domElementSelector,this.parsleyFieldName," "),this.setState({showAuthEmailsError:!0})};showSenderFieldError=(e,t)=>{window.mailpoet_mss_active&&((0,Bi.dy)(this.domElementSelector,this.parsleyFieldName),(0,Bi.K0)(this.domElementSelector)?e||this.showInvalidFromAddressError(t):(0,Bi.OP)(this.domElementSelector))};showSenderDomainError=e=>{e&&this.setState({showSenderDomainWarning:!0})};validateEmailAddress(){if(!window.mailpoet_mss_active)return;const e=this.state.emailAddress,t=(0,Wi.DA)(e);if(window.mailpoet_verified_sender_domains.includes(t))return;const i=this.isEmailAddressAuthorized(e);this.showSenderFieldError(i,e),c.MailPoet.freeMailDomains.indexOf(t)>-1||(0,Vi.g)(e).then((t=>{this.showSenderDomainError(t,e)})).catch((()=>{}))}render(){return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(st,{item:{...this.props.item,sender_address:this.state.emailAddress},field:this.props.field,onValueChange:this.onChange,onBlurEvent:this.onBlur}),(0,p.jsx)("div",{className:"regular-text regular-text-full-width",children:(0,p.jsx)($i.L,{emailAddress:this.state.emailAddress,mssActive:window.mailpoet_mss_active,isEmailAuthorized:!this.state.showAuthEmailsError,showSenderDomainWarning:this.state.showSenderDomainWarning,onSuccessfulEmailOrDomainAuthorization:e=>{"email"===e.type&&(this.setState({showAuthEmailsError:!1}),c.MailPoet.trackEvent("MSS in plugin authorize email",{"authorized email source":"newsletter",wasSuccessful:"yes"})),"domain"===e.type&&(this.setState({showSenderDomainWarning:!1}),c.MailPoet.trackEvent("MSS in plugin verify sender domain",{"verify sender domain source":"newsletter",wasSuccessful:"yes"})),(0,Bi.dy)(this.domElementSelector,this.parsleyFieldName)}})})]})}}Ui.propTypes={field:Te().object.isRequired,item:Te().shape({sender_address:Te().string.isRequired}).isRequired,onValueChange:Te().func},Ui.defaultProps={onValueChange:function(){}},Ui.displayName="SenderField";const Hi=rt.default.once((()=>c.MailPoet.trackEvent("User has typed a GA campaign name"))),zi=_()((0,Oe.__)("For example, “Spring email”. [link]Read the guide.[/link]","mailpoet"),/\[link\](.*?)\[\/link\]/g,((e,t)=>(0,p.jsxs)("span",{children:[(0,p.jsx)("br",{}),(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/187-track-your-newsletters-subscribers-in-google-analytics",target:"_blank",rel:"noopener noreferrer",className:"mailpoet-link",children:e})]},t))),Zi={name:"ga_campaign",label:(0,Oe.__)("Google Analytics Campaign","mailpoet"),tip:zi,type:"text",onBeforeChange:Hi};var Yi=i(76545),Gi=i(42305),Ki=i(20174),Qi=i(81207),Xi=i(85180),Ji=i(53124),ea=i(79951);function ta(e,t){return`segments:${e.join(",")}|filterSegmentId:${t}`}const ia=[{name:"segments",label:(0,Oe.__)("Send to","mailpoet"),type:"selection",placeholder:(0,Oe.__)("Choose","mailpoet"),id:"mailpoet_segments",api_version:window.mailpoet_api_version,endpoint:"segments",multiple:!0,filter:function(e){return!e?.deleted_at},getLabel:function(e){return e.name},getCount:function(e){return parseInt(e.subscribers,10).toLocaleString()},transformChangedValue:function(e){const t=this.getItems()||[];return e.map((e=>t.find((t=>t.id===e))))},validation:{"data-parsley-required":!0,"data-parsley-required-message":(0,Oe.__)("Please select a list","mailpoet"),"data-parsley-segments-with-subscribers":(0,Oe.__)("Please select a list with subscribers.","mailpoet")}},{name:"filter-segment-toggle",type:"reactComponent",component:(0,r.withBoundary)((function(e){let{item:t,onValueChange:i,field:a}=e;const s=t?.options.filterSegmentId,[n,l]=(0,o.useState)(Ki.P$&&!!s),d=(0,o.useCallback)((e=>{i({target:{name:"options",value:{...t?.options??{},filterSegmentId:e}}})}),[t,i]);(0,o.useEffect)((()=>{Ki.P$||""===s||d("")}),[d,s]);const c=(0,o.useCallback)((e=>{i({target:{name:a.name,value:e}}),e||d(""),l(e)}),[a,i,d]);let m;if(n){const e={name:"filter-segment",type:"selection",placeholder:(0,Oe.__)("Choose","mailpoet"),id:"mailpoetFilterSegment",api_version:window.mailpoet_api_version,endpoint:"segments",multiple:!1,forceSelect2:!0,selected:e=>e.options.filterSegmentId,filter:function(e){return!e.deleted_at&&"dynamic"===e.type},getLabel:function(e){return e.name},getCount:function(e){return parseInt(e.subscribers,10).toLocaleString()},validation:{"data-parsley-required":!0,"data-parsley-required-message":(0,Oe.__)("Please select a filter segment","mailpoet")}};m=(0,p.jsx)(Re.Y,{item:t,field:e,onValueChange:e=>{d(e.target.value)}})}return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(r.Toggle,{checked:n,disabled:a.disabled,name:"isFilterSegmentEnabled",onCheck:c,automationId:"filter-segment-toggle"}),(0,p.jsxs)("span",{className:"mailpoet-form-toggle-text",children:[(0,Oe.__)("Filter by segment","mailpoet"),(0,p.jsx)(Xi.Z,{"data-tip":!0,"data-for":"filter-segment-tooltip",className:"filter-segment-tooltip",icon:Ji.Z})]}),(0,p.jsx)(Qi.u,{place:"right",multiline:!0,id:"filter-segment-tooltip",children:(0,p.jsx)("div",{children:(0,Oe.__)("Subscribers selected in 'Send to' will only receive an email if they also belong to this segment.","mailpoet")})}),(0,p.jsx)("div",{className:"mailpoet-gap"}),m]})}))}],aa={name:"recipient-count",type:"reactComponent",component:(0,r.withBoundary)((function(e){const[t,i]=(0,o.useState)(!0),[a,s]=(0,o.useState)(0),n=(0,o.useMemo)((()=>(e.item.segments||[]).map((e=>e.id))),[e.item.segments]),r=(0,o.useMemo)((()=>e.item.options?.filterSegmentId||null),[e.item.options?.filterSegmentId]),l=(0,o.useRef)(""),d=(0,o.useRef)({});return(0,o.useEffect)((()=>{const e=ta(n,r);return l.current=e,n.length<1?(s(0),void i(!1)):e in d.current?(s(d.current[e]),void i(!1)):(i(!0),void c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"segments",action:"subscriberCount",data:{segmentIds:n,filterSegmentId:r}}).done((t=>{const i=t.data.count;d.current[e]=i;const a=ta(n,r);l.current===a&&s(i)})).always((()=>i(!1))))}),[n,r]),(0,p.jsxs)("div",{children:[(0,Oe.__)("Estimated recipients","mailpoet"),":",t&&(0,p.jsx)(ea.ZP,{className:"mailpoet-recipient-count-spinner"}),!t&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Qi.u,{place:"right",multiline:!0,id:"estimated-count-tooltip",children:(0,Oe.__)("This count may change at the time of sending.","mailpoet")}),(0,p.jsx)("span",{"data-tip":!0,"data-for":"estimated-count-tooltip",className:"estimated-recipient-count",children:a.toLocaleString()})]})]})}))},sa={name:"send-to",label:(0,Oe.__)("Send to","mailpoet"),tip:(0,Oe.__)("Subscribers in multiple lists will only receive one email.","mailpoet"),fields:ia},na={name:"send-to",label:(0,Oe.__)("Send to","mailpoet"),tip:(0,Oe.__)("Subscribers in multiple lists will only receive one email.","mailpoet"),fields:[...ia,aa]},oa=window.mailpoet_current_time||"00:00",ra=`${window.mailpoet_tomorrow_date} 08:00:00`,la=window.mailpoet_schedule_time_of_day,da=window.mailpoet_date_format,ca=window.mailpoet_date_storage_format;class ma extends o.Component{getCurrentValue=()=>({isScheduled:"0",scheduledAt:ra,...this.props.item?.[this.props.field.name]??{}});getDateValidation=()=>({"data-parsley-required":!0,"data-parsley-required-message":(0,Oe.__)("Please enter the scheduled date.","mailpoet"),"data-parsley-errors-container":"#mailpoet_scheduling"});isScheduled=()=>"1"===this.getCurrentValue().isScheduled;handleCheckboxChange=(e,t)=>{const i={...t};i.target.value=t.target.checked?"1":"0",this.handleValueChange(i)};handleValueChange=e=>{const t=this.getCurrentValue(),i={};i[e.target.name]=e.target.value,this.props.onValueChange({target:{name:this.props.field.name,value:{...t,...i}}})};render(){let e;const t=new Date;return t.setFullYear(t.getFullYear()+5),this.isScheduled()&&(e=(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("span",{className:"mailpoet-form-schedule-time",children:[(0,Oe.__)("Your website’s time is","mailpoet")," ",oa]}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)("div",{id:"mailpoet_scheduling",children:(0,p.jsx)(qi,{name:"scheduledAt",value:this.getCurrentValue().scheduledAt,onChange:this.handleValueChange,disabled:this.props.field.disabled,dateValidation:this.getDateValidation(),defaultDateTime:ra,timeOfDayItems:la,dateDisplayFormat:da,dateStorageFormat:ca,maxDate:t})})]})),(0,p.jsxs)("div",{children:[(0,p.jsx)(Yi.Z,{checked:this.isScheduled(),disabled:this.props.field.disabled,name:"isScheduled",onCheck:this.handleCheckboxChange,automationId:"email-schedule-checkbox"}),e]})}}let ua=[{name:"email-header",label:null,tip:null,fields:[{name:"subject",customLabel:(0,Oe.__)("Subject","mailpoet"),className:"mailpoet-form-field-subject",placeholder:(0,Oe.__)("Type newsletter subject","mailpoet"),tooltip:(0,Oe.__)("Be creative! It's the first thing that your subscribers see. Tempt them to open your email.","mailpoet"),type:"text",validation:{"data-parsley-required":!0,"data-parsley-required-message":(0,Oe.__)("Please specify a subject","mailpoet"),maxLength:250}},{name:"preheader",customLabel:(0,Oe.__)("Preview text","mailpoet"),className:"mailpoet-form-field-preheader",placeholder:(0,Oe.__)("Type preview text (usually displayed underneath the subject line in the inbox)","mailpoet"),tooltip:`${(0,Oe.__)("This optional text will appear in your subscribers' inboxes, beside the subject line. Write something enticing!","mailpoet")} ${(0,Oe.__)("Max length is 250 characters, however, we recommend 80 characters on a single line.","mailpoet")}`,type:"textarea",validation:{maxLength:250}}]},na,{name:"options",label:(0,Oe.__)("Schedule it","mailpoet"),type:"reactComponent",component:(0,r.withBoundary)(ma)},{name:"sender",label:(0,Oe.__)("Sender","mailpoet"),tip:(0,Oe.__)("Your name and email","mailpoet"),fields:[{name:"sender_name",type:"text",placeholder:(0,Oe.__)("John Doe","mailpoet"),validation:{"data-parsley-required":!0}},{name:"sender_address",type:"reactComponent",component:(0,r.withBoundary)(Ui),placeholder:(0,Oe.__)("john.doe@email.com","mailpoet"),validation:{"data-parsley-required":!0,"data-parsley-type":"email"}}]},Zi,{name:"reply-to",label:(0,Oe.__)("Reply-to","mailpoet"),tip:(0,Oe.__)("When your subscribers reply to your emails, their emails will go to this address.","mailpoet"),inline:!0,fields:[{name:"reply_to_name",type:"text",placeholder:(0,Oe.__)("John Doe","mailpoet")},{name:"reply_to_address",type:"text",placeholder:(0,Oe.__)("john.doe@email.com","mailpoet"),validation:{"data-parsley-type":"email"}}]}];ua=Ot.Hooks.applyFilters("mailpoet_newsletters_3rd_step_fields",ua);const pa={getFields:()=>ua,getSendButtonOptions:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Je()(window.mailpoet_current_date_time),i={value:"object"==typeof e.options&&"1"===e.options?.isScheduled&&c.MailPoet.Date.isInFuture(e.options?.scheduledAt,t)?(0,Oe.__)("Schedule","mailpoet"):(0,Oe.__)("Send","mailpoet")};return e.status!==Gi.sj.Sent&&e.status!==Gi.sj.Sending||(i.disabled="disabled"),i}},ha=window.mailpoet_time_format||"H:i",ga={immediate:(0,Oe.__)("immediately","mailpoet"),minutes:(0,Oe.__)("minute(s) later","mailpoet"),hours:(0,Oe.__)("hour(s) later","mailpoet"),days:(0,Oe.__)("day(s) later","mailpoet"),weeks:(0,Oe.__)("week(s) later","mailpoet")},fa={daily:(0,Oe.__)("Once a day at...","mailpoet"),weekly:(0,Oe.__)("Weekly on...","mailpoet"),monthly:(0,Oe.__)("Monthly on the...","mailpoet"),nthWeekDay:(0,Oe.__)("Monthly every...","mailpoet"),immediately:(0,Oe.__)("Immediately","mailpoet")},_a=rt.default.object(rt.default.map(rt.default.times(96,(e=>900*e)),(e=>{const t=new Date(null);return t.setSeconds(e),[e,c.MailPoet.Date.format(t,{format:ha,offset:0})]}))),ba={0:(0,Oe.__)("Sunday","mailpoet"),1:(0,Oe.__)("Monday","mailpoet"),2:(0,Oe.__)("Tuesday","mailpoet"),3:(0,Oe.__)("Wednesday","mailpoet"),4:(0,Oe.__)("Thursday","mailpoet"),5:(0,Oe.__)("Friday","mailpoet"),6:(0,Oe.__)("Saturday","mailpoet")},xa=rt.default.object(rt.default.map(rt.default.times(28,(e=>e)),(e=>{const t={0:(0,Oe.__)("1st","mailpoet"),1:(0,Oe.__)("2nd","mailpoet"),2:(0,Oe.__)("3rd","mailpoet")};let i;return i=void 0!==t[e]?t[e]:(0,Oe.__)("%1$dth","mailpoet").replace("%1$d",e+1),[e+1,i]}))),va={1:(0,Oe.__)("1st","mailpoet"),2:(0,Oe.__)("2nd","mailpoet"),3:(0,Oe.__)("3rd","mailpoet"),L:(0,Oe._x)("last","e.g. monthly every last Monday","mailpoet")},ya={name:"intervalType",values:fa},ja={name:"timeOfDay",values:_a},wa={name:"weekDay",values:ba},Sa={name:"monthDay",values:xa},Pa={name:"nthWeekDay",values:va};class Ma extends o.Component{getCurrentValue=()=>this.props.item[this.props.field.name]||{};handleValueChanges=e=>{const t=this.getCurrentValue();return this.props.onValueChange({target:{name:this.props.field.name,value:rt.default.extend({},t,e)}})};handleIntervalChange=e=>{const t=e.target.value,i={};i.intervalType=t,"monthly"===t&&(i.monthDay="1"),this.handleValueChanges(i)};handleTimeOfDayChange=e=>this.handleValueChanges({timeOfDay:e.target.value});handleWeekDayChange=e=>this.handleValueChanges({weekDay:e.target.value});handleMonthDayChange=e=>this.handleValueChanges({monthDay:e.target.value});handleNthWeekDayChange=e=>this.handleValueChanges({nthWeekDay:e.target.value});render(){const e=this.getCurrentValue();let t,i,a,s;return"immediately"!==e.intervalType&&(t=(0,p.jsx)(dt,{field:ja,item:this.getCurrentValue(),onValueChange:this.handleTimeOfDayChange})),"weekly"!==e.intervalType&&"nthWeekDay"!==e.intervalType||(i=(0,p.jsx)(dt,{field:wa,item:this.getCurrentValue(),onValueChange:this.handleWeekDayChange})),"monthly"===e.intervalType&&(a=(0,p.jsx)(dt,{field:Sa,item:this.getCurrentValue(),onValueChange:this.handleMonthDayChange})),"nthWeekDay"===e.intervalType&&(s=(0,p.jsx)(dt,{field:Pa,item:this.getCurrentValue(),onValueChange:this.handleNthWeekDayChange})),(0,p.jsxs)("div",{children:[(0,p.jsxs)(ki.Grid.CenteredRow,{children:[(0,p.jsx)(dt,{field:ya,item:this.getCurrentValue(),onValueChange:this.handleIntervalChange,automationId:"newsletter_interval_type"}),"immediately"===e.intervalType&&(0,p.jsx)("div",{children:(0,p.jsx)("p",{children:(0,Oe.__)("after publishing a post","mailpoet")})})]}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsxs)("div",{className:"mailpoet-grid-column mailpoet-flex",children:[s,a,i,t]}),"immediately"!==e.intervalType&&(0,p.jsx)("div",{className:"mailpoet-gap"})]})}}Ma.propTypes={item:Te().object.isRequired,field:Te().shape({name:Te().string}).isRequired,onValueChange:Te().func.isRequired};let Na=[{name:"email-header",label:null,tip:null,fields:[{name:"subject",customLabel:(0,Oe.__)("Subject","mailpoet"),className:"mailpoet-form-field-subject",placeholder:(0,Oe.__)("Type newsletter subject","mailpoet"),tooltip:(0,Oe.__)("Be creative! It's the first thing that your subscribers see. Tempt them to open your email.","mailpoet"),type:"text",validation:{"data-parsley-required":!0,"data-parsley-required-message":(0,Oe.__)("Please specify a subject","mailpoet"),maxLength:250}},{name:"preheader",customLabel:(0,Oe.__)("Preview text","mailpoet"),className:"mailpoet-form-field-preheader",placeholder:(0,Oe.__)("Type preview text (usually displayed underneath the subject line in the inbox)","mailpoet"),tooltip:`${(0,Oe.__)("This optional text will appear in your subscribers' inboxes, beside the subject line. Write something enticing!","mailpoet")} ${(0,Oe.__)("Max length is 250 characters, however, we recommend 80 characters on a single line.","mailpoet")}`,type:"textarea",validation:{maxLength:250}}]},{name:"options",label:(0,Oe.__)("Select a frequency","mailpoet"),type:"reactComponent",component:Ma},na,{name:"sender",label:(0,Oe.__)("Sender","mailpoet"),tip:(0,Oe.__)("Your name and email","mailpoet"),fields:[{name:"sender_name",type:"text",placeholder:(0,Oe.__)("John Doe","mailpoet"),validation:{"data-parsley-required":!0}},{name:"sender_address",type:"reactComponent",component:(0,r.withBoundary)(Ui),placeholder:(0,Oe.__)("john.doe@email.com","mailpoet"),validation:{"data-parsley-required":!0,"data-parsley-type":"email"}}]},Zi,{name:"reply-to",label:(0,Oe.__)("Reply-to","mailpoet"),tip:(0,Oe.__)("When your subscribers reply to your emails, their emails will go to this address.","mailpoet"),inline:!0,fields:[{name:"reply_to_name",type:"text",placeholder:(0,Oe.__)("John Doe","mailpoet")},{name:"reply_to_address",type:"text",placeholder:(0,Oe.__)("john.doe@email.com","mailpoet"),validation:{"data-parsley-type":"email"}}]}];Na=Ot.Hooks.applyFilters("mailpoet_newsletters_3rd_step_fields",Na);const Ia={getFields:function(){return Na},getSendButtonOptions:function(){return{value:(0,Oe.__)("Activate","mailpoet")}}},ka=window.mailpoet_roles||{},Ca=rt.default.filter(window.mailpoet_segments||[],(e=>"default"===e.type)),Ta={name:"event",values:{segment:(0,Oe.__)("When someone subscribes to the list...","mailpoet"),user:(0,Oe.__)("When a new WordPress user is added to your site...","mailpoet")}},Ea={name:"segment",placeholder:(0,Oe.__)("Select a list","mailpoet"),forceSelect2:!0,values:Ca,getCount:e=>parseInt(e.subscribers,10).toLocaleString(),getLabel:e=>e.name,getValue:e=>e.id},Aa={name:"role",values:ka},Ra={name:"afterTimeNumber",size:3,validation:{"data-parsley-required":!0,"data-parsley-errors-container":".mailpoet-form-errors","data-parsley-scheduled-at":(0,Oe.__)("An email can only be scheduled up to 5 years in the future. Please choose a shorter period.","mailpoet")}},Oa={name:"afterTimeType",values:ga};class La extends o.Component{getCurrentValue=()=>this.props.item[this.props.field.name]||{};handleValueChange=(e,t)=>{const i=this.getCurrentValue(),a={};let s=t;return"afterTimeNumber"===e&&(s=parseInt(t,10),s=Number.isNaN(s)?"":s),a[e]=s,this.props.onValueChange({target:{name:this.props.field.name,value:rt.default.extend({},i,a)}})};handleEventChange=e=>this.handleValueChange("event",e.target.value);handleSegmentChange=e=>this.handleValueChange("segment",e.target.value);handleRoleChange=e=>this.handleValueChange("role",e.target.value);handleAfterTimeNumberChange=e=>this.handleValueChange("afterTimeNumber",e.target.value);handleAfterTimeTypeChange=e=>this.handleValueChange("afterTimeType",e.target.value);render(){const e=this.getCurrentValue();let t,i;return t="user"===e.event?(0,p.jsx)(dt,{field:Aa,item:this.getCurrentValue(),onValueChange:this.handleRoleChange}):(0,p.jsx)(Re.Y,{field:Ea,item:this.getCurrentValue(),onValueChange:this.handleSegmentChange}),"immediate"!==e.afterTimeType&&(i=(0,p.jsx)(st,{field:Ra,item:this.getCurrentValue(),onValueChange:this.handleAfterTimeNumberChange})),(0,p.jsxs)("div",{children:[(0,p.jsx)(dt,{field:Ta,item:this.getCurrentValue(),onValueChange:this.handleEventChange}),(0,p.jsx)("div",{className:"mailpoet-gap"}),t,(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsxs)("div",{className:"mailpoet-grid-column mailpoet-flex",children:[i,(0,p.jsx)(dt,{field:Oa,item:this.getCurrentValue(),onValueChange:this.handleAfterTimeTypeChange})]}),(0,p.jsx)("div",{className:"mailpoet-form-errors"}),(0,p.jsx)("div",{className:"mailpoet-gap"})]})}}La.propTypes={history:Te().shape({push:Te().func.isRequired}).isRequired,item:Te().object.isRequired,field:Te().shape({name:Te().string}).isRequired,onValueChange:Te().func.isRequired},La.displayName="WelcomeScheduling";const Fa=(0,Ne.EN)(La);let Da=[{name:"email-header",label:null,tip:null,fields:[{name:"subject",customLabel:(0,Oe.__)("Subject","mailpoet"),className:"mailpoet-form-field-subject",placeholder:(0,Oe.__)("Type newsletter subject","mailpoet"),tooltip:(0,Oe.__)("Be creative! It's the first thing that your subscribers see. Tempt them to open your email.","mailpoet"),type:"text",validation:{"data-parsley-required":!0,"data-parsley-required-message":(0,Oe.__)("Please specify a subject","mailpoet"),maxLength:250}},{name:"preheader",customLabel:(0,Oe.__)("Preview text","mailpoet"),className:"mailpoet-form-field-preheader",placeholder:(0,Oe.__)("Type preview text (usually displayed underneath the subject line in the inbox)","mailpoet"),tooltip:`${(0,Oe.__)("This optional text will appear in your subscribers' inboxes, beside the subject line. Write something enticing!","mailpoet")} ${(0,Oe.__)("Max length is 250 characters, however, we recommend 80 characters on a single line.","mailpoet")}`,type:"textarea",validation:{maxLength:250}}]},{name:"options",label:(0,Oe.__)("When to send this welcome email?","mailpoet"),type:"reactComponent",component:(0,r.withBoundary)(Fa)},Zi,{name:"sender",label:(0,Oe.__)("Sender","mailpoet"),tip:(0,Oe.__)("Your name and email","mailpoet"),fields:[{name:"sender_name",type:"text",placeholder:(0,Oe.__)("John Doe","mailpoet"),validation:{"data-parsley-required":!0}},{name:"sender_address",type:"reactComponent",component:(0,r.withBoundary)(Ui),placeholder:(0,Oe.__)("john.doe@email.com","mailpoet"),validation:{"data-parsley-required":!0,"data-parsley-type":"email"}}]},{name:"empty",type:"empty"},{name:"reply-to",label:(0,Oe.__)("Reply-to","mailpoet"),tip:(0,Oe.__)("When your subscribers reply to your emails, their emails will go to this address.","mailpoet"),inline:!0,fields:[{name:"reply_to_name",type:"text",placeholder:(0,Oe.__)("John Doe","mailpoet")},{name:"reply_to_address",type:"text",placeholder:(0,Oe.__)("john.doe@email.com","mailpoet"),validation:{"data-parsley-type":"email"}}]}];Da=Ot.Hooks.applyFilters("mailpoet_newsletters_3rd_step_fields",Da);const qa={getFields:function(){return Da},getSendButtonOptions:function(){return{value:(0,Oe.__)("Activate","mailpoet")}}};class $a extends o.Component{constructor(e){super(e);const{item:t,event:i}=this.props;this.handleChange=this.handleChange.bind(this);const a=t.afterTimeType||i.defaultAfterTimeType||"immediate",s="minutes"===a?30:1,n=t.afterTimeNumber||s;this.state={afterTimeType:a,afterTimeNumber:n},t.afterTimeNumber===n&&t.afterTimeType===a||this.propagateChange(this.state)}handleChange(e,t){let{value:i}=e.target;"afterTimeNumber"===t&&(i=parseInt(e.target.value,10),i=Number.isNaN(i)?null:i);const a={[t]:i},{afterTimeType:s}=this.state;"afterTimeType"===t&&s!==i&&("minutes"===s&&(a.afterTimeNumber=1),"minutes"===i&&(a.afterTimeNumber=30)),this.setState(a,this.propagateChange(a))}displayAfterTimeTypeOptions(){const{event:e}=this.props;let t=ga;e.timeDelayValues&&(t=Object.entries(e.timeDelayValues).reduce(((e,t)=>{let[i,a]=t;return e[i]=a.text,e}),{}));const{afterTimeType:i}=this.state,a={field:{id:"scheduling_time_interval",name:"scheduling_time_interval",forceSelect2:!0,values:rt.default.map(t,((e,t)=>({name:e,id:t}))),extendSelect2Options:{minimumResultsForSearch:1/0},selected:()=>i},onValueChange:rt.default.partial(this.handleChange,rt.default,"afterTimeType")};return(0,p.jsx)(Re.Y,{field:a.field,onValueChange:a.onValueChange})}displayAfterTimeNumberField(){const{afterTimeNumberSize:e,event:t}=this.props,{afterTimeType:i,afterTimeNumber:a}=this.state;if("immediate"===i)return null;if(t.timeDelayValues&&t.timeDelayValues[i]&&!t.timeDelayValues[i].displayAfterTimeNumberField)return null;const s={field:{id:"scheduling_time_duration",name:"scheduling_time_duration",className:"mailpoet-form-input-small",defaultValue:a?a.toString():"",size:e,validation:{"data-parsley-required":!0,"data-parsley-errors-container":".mailpoet-form-errors","data-parsley-scheduled-at":(0,Oe.__)("An email can only be scheduled up to 5 years in the future. Please choose a shorter period.","mailpoet")}},item:{},onValueChange:rt.default.partial(this.handleChange,rt.default,"afterTimeNumber")};return(0,p.jsx)(st,{field:s.field,item:s.item,onValueChange:s.onValueChange})}propagateChange(e){const{onValueChange:t}=this.props;t&&t(e)}render(){const{event:e}=this.props;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("h4",{children:[" ",(0,Oe.__)("When to send this email?","mailpoet")," "]}),(0,p.jsxs)(ki.Grid.CenteredRow,{className:"mailpoet-re-engagement-scheduling",children:[this.displayAfterTimeNumberField(),this.displayAfterTimeTypeOptions(),e.afterDelayText&&(0,p.jsx)("p",{children:e.afterDelayText})]}),(0,p.jsx)("div",{className:"mailpoet-form-errors"}),(0,p.jsx)("div",{className:"mailpoet-gap"}),e.schedulingReadMoreLink&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("a",{href:e.schedulingReadMoreLink.link,target:"_blank",rel:"noopener noreferrer",className:"event-scheduling-read-more-link",children:e.schedulingReadMoreLink.text}),(0,p.jsx)("div",{className:"mailpoet-gap"})]})]})}}function Ba(e){const t=e&&e.values?e.values:[];return t?t.map((e=>({id:e.id,name:e.name}))):t}function Wa(e){let{eventOptions:t,eventSlug:i,selected:a,onValueChange:s}=e;function n(e){s&&s({eventOptionValue:e.target.value})}return(0,p.jsx)("div",{children:(0,p.jsx)("div",{className:"event-option-selection",children:function(){if(!t)return null;const e={field:{name:`event_options_${i}`,forceSelect2:!0,endpoint:t.endpoint,resetSelect2OnUpdate:!0,values:Ba(t),multiple:t.multiple||!1,placeholder:t.placeholder||!1,transformChangedValue:(e,t)=>rt.default.map(t,(e=>({id:e.id,name:e.text}))),selected:()=>a,getLabel:rt.default.property("name"),getValue:rt.default.property("id"),validation:{"data-parsley-required":!0}},onValueChange:n,item:{action:""}};return"product_categories"===t.endpoint&&(e.field.name="category_ids",e.item={action:"purchasedCategory"}),"products"===t.endpoint&&(e.field.name="product_ids",e.item={action:"purchasedProduct"}),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Re.Y,{field:e.field,onValueChange:e.onValueChange,item:e.item}),(0,p.jsx)("div",{className:"mailpoet-gap"})]})}()})})}$a.propTypes={item:Te().shape({afterTimeType:Te().string.isRequired,afterTimeNumber:Te().number}).isRequired,afterTimeNumberSize:Te().number,onValueChange:Te().func,event:Te().shape({defaultAfterTimeType:Te().string,afterDelayText:Te().string,timeDelayValues:Te().objectOf(Te().shape({text:Te().string,displayAfterTimeNumberField:Te().bool})),schedulingReadMoreLink:Te().shape({link:Te().string.isRequired,text:Te().string.isRequired})}).isRequired},$a.defaultProps={afterTimeNumberSize:3,onValueChange:null},$a.displayName="EventScheduling",Wa.displayName="EventOptions";const Va=(0,r.withBoundary)(Wa);class Ua extends o.Component{constructor(e){super(e);const{field:t}=e;this.handleChange=this.handleChange.bind(this),this.email=t.email,this.emailOptions=t.emailOptions,this.events=rt.default.indexBy(this.email.events,"slug"),this.segments=rt.default.filter(window.mailpoet_segments,(e=>null===e.deleted_at));const i=this.events[this.emailOptions.event],a=this.emailOptions.afterTimeType||i.defaultAfterTimeType||"immediate";this.state={event:i,afterTimeType:a,eventSlug:this.emailOptions.event,eventOptionValue:null,afterTimeNumber:this.emailOptions.afterTimeNumber||1,segment:this.emailOptions.segment?this.emailOptions.segment:null}}handleChange(e){const{afterTimeNumber:t}=this.state,i=e;i.afterTimeType&&"immediate"===i.afterTimeType?i.afterTimeNumber=null:!i.afterTimeType||i.afterTimeNumber||t||(i.afterTimeNumber=1),this.setState(e,this.propagateChange)}displayScheduling(){const{afterTimeNumber:e,afterTimeType:t,event:i}=this.state,a={item:{afterTimeNumber:e,afterTimeType:t},event:i,onValueChange:this.handleChange};return(0,p.jsx)($a,{item:a.item,event:a.event,onValueChange:a.onValueChange})}displaySegments(){const{segment:e}=this.state;if("user"===this.emailOptions.sendTo)return null;const t={field:{id:"segments",forceSelect2:!0,values:this.segments,extendSelect2Options:{minimumResultsForSearch:1/0},selected:()=>e},onValueChange:e=>this.handleChange({segment:e.target.value})};return(0,p.jsx)("div",{className:"event-segment-selection",children:(0,p.jsx)(Re.Y,{field:t.field,onValueChange:t.onValueChange})})}displayEventOptions(){const{event:e,eventSlug:t}=this.state;let i;try{i=JSON.parse(this.emailOptions.meta||null)}catch(e){i=this.emailOptions.meta||null}const a={emailSlug:this.email.slug,eventSlug:t,onValueChange:this.handleChange,eventOptions:e.options||null};return i&&i.option&&("remote"===a.eventOptions.type&&(a.eventOptions.values=i.option),a.selected=rt.default.map(i.option,(e=>e.id))),(0,p.jsx)(Va,{emailSlug:a.emailSlug,eventSlug:a.eventSlug,eventOptions:a.eventOptions,onValueChange:a.onValueChange,selected:a.selected})}displayHeader(){const{event:e}=this.state;return e.title}propagateChange(){const{eventSlug:e,afterTimeType:t,afterTimeNumber:i,segment:a,eventOptionValue:s}=this.state,{onValueChange:n}=this.props;if(!n)return;const o={group:this.email.slug,event:e,afterTimeType:t};i&&(o.afterTimeNumber=i),a&&(o.segment=a),s&&(o.meta=JSON.stringify({option:this.state.eventOptionValue})),n({target:{name:"options",value:o}})}render(){return(0,p.jsxs)("div",{children:[(0,p.jsx)(bt.X,{level:5,children:this.displayHeader()}),this.displayEventOptions(),this.displaySegments(),this.displayScheduling()]})}}Ua.propTypes={field:Te().shape({email:Te().shape({events:Te().object.isRequired}).isRequired,emailOptions:Te().object.isRequired}).isRequired,onValueChange:Te().func},Ua.defaultProps={onValueChange:null},Ua.displayName="SendEventConditions";const Ha=window.mailpoet_woocommerce_automatic_emails||[],za={getFields:function(e){return(e=>{const t=Ha[e.options.group];if(!t)return!1;const i=e.options;return[{name:"email-header",label:null,tip:null,fields:[{name:"subject",customLabel:(0,Oe.__)("Subject","mailpoet"),className:"mailpoet-form-field-subject",placeholder:(0,Oe.__)("Type newsletter subject","mailpoet"),tooltip:(0,Oe.__)("Be creative! It's the first thing that your subscribers see. Tempt them to open your email.","mailpoet"),type:"text",validation:{"data-parsley-required":!0,"data-parsley-required-message":(0,Oe.__)("Please specify a subject","mailpoet"),maxLength:250}},{name:"preheader",customLabel:(0,Oe.__)("Preview text","mailpoet"),className:"mailpoet-form-field-preheader",placeholder:(0,Oe.__)("Type preview text (usually displayed underneath the subject line in the inbox)","mailpoet"),tooltip:`${(0,Oe.__)("This optional text will appear in your subscribers' inboxes, beside the subject line. Write something enticing!","mailpoet")} ${(0,Oe.__)("Max length is 250 characters, however, we recommend 80 characters on a single line.","mailpoet")}`,type:"textarea",validation:{maxLength:250}}]},{name:"options",label:(0,Oe.__)("Send this %1s Automatic Email when...","mailpoet").replace("%1s",t.title),type:"reactComponent",component:(0,r.withBoundary)(Ua),email:t,emailOptions:i},Zi,{name:"sender",label:(0,Oe.__)("Sender","mailpoet"),tip:(0,Oe.__)("Your name and email","mailpoet"),fields:[{name:"sender_name",type:"text",placeholder:(0,Oe.__)("John Doe","mailpoet"),validation:{"data-parsley-required":!0}},{name:"sender_address",type:"text",placeholder:(0,Oe.__)("john.doe@email.com","mailpoet"),validation:{"data-parsley-required":!0,"data-parsley-type":"email"}}]},{name:"empty",type:"empty"},{name:"reply-to",label:(0,Oe.__)("Reply-to","mailpoet"),tip:(0,Oe.__)("When your subscribers reply to your emails, their emails will go to this address.","mailpoet"),inline:!0,fields:[{name:"reply_to_name",type:"text",placeholder:(0,Oe.__)("John Doe","mailpoet")},{name:"reply_to_address",type:"text",placeholder:(0,Oe.__)("john.doe@email.com","mailpoet"),validation:{"data-parsley-type":"email"}}]}]})(e)},getSendButtonOptions:function(){return{value:(0,Oe.__)("Activate","mailpoet")}}};var Za=i(30211);function Ya(e){let{afterTimeNumber:t,afterTimeType:i,updateAfterTimeNumber:a,updateAfterTimeType:s,inactiveSubscribersPeriod:n}=e;const o="weeks"===i?7:30,r=Number(t)*o;let l=n;return 365===n&&(l=360),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(bt.X,{level:4,children:(0,Oe.__)("When to send this re-engagement email?","mailpoet")}),(0,p.jsxs)(ki.Grid.CenteredRow,{className:"mailpoet-re-engagement-scheduling",children:[(0,p.jsx)("p",{children:(0,Oe.__)("After no activity for","mailpoet")}),(0,p.jsx)(at.I,{type:"text",placeholder:(0,Oe.__)("count","mailpoet"),value:t,onChange:(0,Wi.z2)(a)}),(0,p.jsxs)(lt.Select,{value:i,onChange:(0,Wi.z2)(s),children:[(0,p.jsx)("option",{value:"weeks",children:"weeks"}),(0,p.jsx)("option",{value:"months",children:"months"})]})]}),!!n&&l<=r&&(0,p.jsx)("p",{className:"mailpoet-re-engagement-scheduling-note",children:_()((0,Oe.__)("Disengaged subscribers will [link]become inactive[/link] after {$months} months and won’t receive this email. Please select a shorter period.","mailpoet").replace("{$months}",`${Math.floor(n/30)}`),/\[link\](.*?)\[\/link\]/g,(e=>(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/264-inactive-subscribers",target:"_blank",rel:"noopener noreferrer",children:e},"link")))})]})}const Ga=[{name:"email-header",label:null,tip:null,fields:[{name:"subject",customLabel:(0,Oe.__)("Subject","mailpoet"),className:"mailpoet-form-field-subject",placeholder:(0,Oe.__)("Type newsletter subject","mailpoet"),tooltip:(0,Oe.__)("Be creative! It's the first thing that your subscribers see. Tempt them to open your email.","mailpoet"),type:"text",validation:{"data-parsley-required":!0,"data-parsley-required-message":(0,Oe.__)("Please specify a subject","mailpoet"),maxLength:250}},{name:"preheader",customLabel:(0,Oe.__)("Preview text","mailpoet"),className:"mailpoet-form-field-preheader",placeholder:(0,Oe.__)("Type preview text (usually displayed underneath the subject line in the inbox)","mailpoet"),tooltip:`${(0,Oe.__)("This optional text will appear in your subscribers' inboxes, beside the subject line. Write something enticing!","mailpoet")} ${(0,Oe.__)("Max length is 250 characters, however, we recommend 80 characters on a single line.","mailpoet")}`,type:"textarea",validation:{maxLength:250}}]},{name:"options",type:"reactComponent",component:function(e){return(0,p.jsx)(Ya,{afterTimeNumber:e.item.options.afterTimeNumber.toString(),afterTimeType:e.item.options.afterTimeType,inactiveSubscribersPeriod:Number(c.MailPoet.deactivateSubscriberAfterInactiveDays),updateAfterTimeNumber:t=>{e.onValueChange({target:{name:"options",value:(0,Za.assoc)("afterTimeNumber",t,e.item.options)}})},updateAfterTimeType:t=>{e.onValueChange({target:{name:"options",value:(0,Za.assoc)("afterTimeType",t,e.item.options)}})}})}},sa,{name:"sender",label:(0,Oe.__)("Sender","mailpoet"),tip:(0,Oe.__)("Your name and email","mailpoet"),fields:[{name:"sender_name",type:"text",placeholder:(0,Oe.__)("John Doe","mailpoet"),validation:{"data-parsley-required":!0}},{name:"sender_address",type:"reactComponent",component:Ui,placeholder:(0,Oe.__)("john.doe@email.com","mailpoet"),validation:{"data-parsley-required":!0,"data-parsley-type":"email"}}]},{name:"reply-to",label:(0,Oe.__)("Reply-to","mailpoet"),tip:(0,Oe.__)("When your subscribers reply to your emails, their emails will go to this address.","mailpoet"),inline:!0,fields:[{name:"reply_to_name",type:"text",placeholder:(0,Oe.__)("John Doe","mailpoet")},{name:"reply_to_address",type:"text",placeholder:(0,Oe.__)("john.doe@email.com","mailpoet"),validation:{"data-parsley-type":"email"}}]},Zi],Ka={getFields(){return Ga},getSendButtonOptions(){return{value:(0,Oe.__)("Activate","mailpoet")}}};var Qa=i(86194);let Xa=null;function Ja(e){let{toggleLoadingState:t,updatePendingState:i}=e;const a=(0,o.useCallback)((async()=>{try{const{success:e,res:t}=await(0,r.callApi)({endpoint:"services",action:"refreshMSSKeyStatus"});!0===e?i(!(0,r.isTruthy)(t.data.result.data.is_approved)):c.MailPoet.Notice.showApiErrorNotice(t)}catch(e){c.MailPoet.Notice.showApiErrorNotice(e)}}),[i]),[s,n]=(0,o.useState)(!0),l=async e=>{e.preventDefault(),t(!0),await a(),n(!1),t(!1)};return(0,p.jsxs)("div",{className:"mailpoet_error",children:[_()((0,Oe.__)("You’ll soon be able to send once our team reviews your account. In the meantime, you can send previews to [link]your authorized emails[/link].","mailpoet"),(0,r.getLinkRegex)(),(e=>(0,p.jsx)("a",{href:"https://account.mailpoet.com/authorization",target:"_blank",rel:"noopener noreferrer",children:e})))," ",s&&_()((0,Oe.__)("If you have already received approval email, click [link]here[/link] to update the status.","mailpoet"),(0,r.getLinkRegex)(),(e=>(0,p.jsx)("a",{href:"#",onClick:l,children:e})))]})}Ja.displayName="PendingNewsletterMessage";const es=(0,r.withBoundary)(Ja),ts=window.mailpoet_woocommerce_automatic_emails||{},is=(e,t)=>`${Ii()(t,{strict:!0,lower:!0})||"email"}-${e}`,as=e=>"immediate"===e.afterTimeType?"immediate":`${e.afterTimeNumber} ${e.afterTimeType}`;function ss(e){let t,i;if(!c.MailPoet.FeaturesController.isSupported("gutenberg_email_editor")||null===e.wp_post_id)return e&&e.body&&e.body.content&&(i=e.body.content,t=JSON.stringify(e.body.content),!i.blocks||!Array.isArray(i.blocks)||0===i.blocks.length)?(0,Oe.__)("Poet, please add prose to your masterpiece before you send it to your followers.","mailpoet"):window.mailpoet_mss_active&&t.indexOf("[link:subscription_unsubscribe_url]")<0&&t.indexOf("[link:subscription_unsubscribe]")<0?(0,Oe.__)('All emails must include an "Unsubscribe" link. Add a footer widget to your email to continue.',"mailpoet"):"re_engagement"===e.type&&t.indexOf("[link:subscription_re_engage_url]")<0?(0,Oe.__)("A re-engagement email must include a link with [link:subscription_re_engage_url] shortcode.","mailpoet"):"notification"===e.type&&t.indexOf('"type":"automatedLatestContent"')<0&&t.indexOf('"type":"automatedLatestContentLayout"')<0?(0,Oe._x)("Please add an “Automatic Latest Content” widget to the email from the right sidebar.","(Please reuse the current translation used for the string “Automatic Latest Content”) This Error message is displayed when a user tries to send a “Post Notification” email without any “Automatic Latest Content” widget inside","mailpoet"):"standard"===e.type&&"sent"===e.status?(0,Oe.__)("This email has already been sent. It can be edited, but not sent again. Duplicate this email if you want to send it again.","mailpoet"):"re_engagement"!==e.type||c.MailPoet.trackingConfig.emailTrackingEnabled?void 0:(0,p.jsx)("span",{style:{pointerEvents:"all"},children:_()((0,Oe.__)("Re-engagement emails are disabled because [link]open and click tracking[/link] is disabled.","mailpoet"),/\[link\](.*?)\[\/link\]/g,(e=>(0,p.jsx)("a",{href:"?page=mailpoet-settings#/advanced",rel:"noopener noreferrer",children:e},"advancedSettingsTabLink")))})}class ns extends o.Component{constructor(e){super(e),this.state={fields:[],item:{},loading:!0,thumbnailPromise:null,showPremiumModal:!1,mssKeyPendingApproval:window.mailpoet_mss_key_pending_approval}}componentDidMount(){this.loadItem(this.props.match.params.id).always((()=>{this.setState({loading:!1})})),ke()("#mailpoet_newsletter").parsley({successClass:""})}componentDidUpdate(e){this.props.match.params.id!==e.match.params.id&&this.loadItem(this.props.match.params.id).always((()=>{this.setState({loading:!1})}))}getFieldsByNewsletter=e=>this.getSubtype(e).getFields(e);getSendButtonOptions=()=>this.getSubtype(this.state.item).getSendButtonOptions(this.state.item);getSubtype=e=>{if(e.type===Gi.j9.Automatic&&ts[e.options.group])return za;switch(e.type){case"notification":return Ia;case"welcome":return qa;case"re_engagement":return Ka;default:return pa}};getThumbnailPromise=e=>this.state?.thumbnailPromise??(0,Qa.W0)(e);isValid=()=>ke()("#mailpoet_newsletter").parsley().isValid();isValidFromAddress=async()=>{if("MailPoet"!==window.mailpoet_mta_method)return!0;const e=await this.loadVerifiedSenderDomains(),t=(0,Wi.DA)(this.state.item.sender_address);if(-1!==e.indexOf(t))return!0;const i=await this.loadAuthorizedEmailAddresses(),a=this.state.item.sender_address;return-1!==i.indexOf(a)};loadItem=e=>(this.setState({loading:!0}),c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"get",data:{id:e}}).done((e=>{const t="draft"===e.data.status?this.getThumbnailPromise(e.meta.preview_url):null,i=e.data;if(i.type===Gi.j9.Automation){const e=i.options?.automationId,t=e?`admin.php?page=mailpoet-automation-editor&id=${e}`:"/new";return this.setState({item:{}},(()=>{this.props.history.push(t)}))}return!i.ga_campaign&&Ki.P$&&(i.ga_campaign=is(i.id,i.subject)),this.setState({item:e.data,fields:this.getFieldsByNewsletter(e.data),thumbnailPromise:t,validationError:ss(e.data)}),!0})).fail((()=>{this.setState({item:{}},(()=>{this.props.history.push("/new")}))})));saveTemplate=(e,t)=>{this.getThumbnailPromise(e.meta.preview_url).then((i=>{c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletterTemplates",action:"save",data:{newsletter_id:e.data.id,name:e.data.subject,thumbnail_data:i,body:JSON.stringify(e.data.body),categories:'["recent"]'}}).fail((e=>{this.showError(e),this.setState({loading:!1}),c.MailPoet.Modal.loading(!1)})),t()})).catch((e=>{this.showError({errors:[e]})}))};loadAuthorizedEmailAddresses=async()=>{if("MailPoet"!==window.mailpoet_mta_method)return[];const e=(await c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"mailer",action:"getAuthorizedEmailAddresses"})).data||[];return window.mailpoet_authorized_emails=e,e};loadVerifiedSenderDomains=async()=>"MailPoet"!==window.mailpoet_mta_method?[]:(await c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"mailer",action:"getVerifiedSenderDomains"})).data||[];handleSend=e=>(e.preventDefault(),this.isValid()?(c.MailPoet.Modal.loading(!0),this.isValidFromAddress().then((e=>{e?this.saveNewsletter().done((()=>{this.setState({loading:!0})})).done((e=>{switch(e.data.type){case"notification":case"welcome":case"automatic":case"re_engagement":this.activateNewsletter(e);break;default:this.sendNewsletter(e)}})).fail((e=>{this.showError(e),this.setState({loading:!1}),c.MailPoet.Modal.loading(!1)})):(window.mailpoet_sender_address_field_blur(),c.MailPoet.Modal.loading(!1))}))):ke()("#mailpoet_newsletter").parsley().validate());sendNewsletter=e=>c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"sendingQueue",action:"add",data:{newsletter_id:this.state.item.id}}).done((t=>{this.saveTemplate(e,(()=>{if(window.mailpoet_show_congratulate_after_first_newsletter)return c.MailPoet.Modal.loading(!1),void this.props.history.push(`/send/congratulate/${this.state.item.id}`);this.props.history.push(`/${this.state.item.type||""}`);let i=[];e.data.segments.map((e=>i.push(...e.filters))),i=Mi().uniqWith(i,((e,t)=>e.action===t.action&&e.type===t.type));const a=i.map((e=>function(e){const t=e.action,i=e.type;if("email"===i)switch(t){case"machineOpensAbsoluteCount":return"number of machine-opens";case"opensAbsoluteCount":return"number of opens";case"numberOfOrders":return"number of orders";case"clicked":return"clicked";case"clickedAny":return"clicked any email";case"opened":return"opened";case"machineOpened":return"machine-opened";default:return""}if("userRole"===i)switch(t){case"subscriberTag":return"subscriber tags";case"subscribedToList":return"subscribed to list";case"subscriberScore":return"score";case"wordpressRole":return"WordPress user role";case"mailpoetCustomField":return"MailPoet custom field";default:return""}if("woocommerce"===i)switch(t){case"customerInCountry":return"is in country";case"purchasedCategory":return"purchased in category";case"purchasedProduct":return"purchased product";case"subscribedDate":return"subscribed date";case"totalSpent":return"total spent";default:return""}return"woocommerceSubscription"===i&&"hasActiveSubscription"===t?"has an active subscription":"woocommerceMembership"===i&&"isMemberOf"===t?"is active member of":""}(e))).join(", ");"scheduled"===t.data.status?(this.context.notices.success((0,p.jsx)("p",{children:(0,Oe.__)("The newsletter has been scheduled.","mailpoet")})),c.MailPoet.trackEvent("Emails > Newsletter sent",{scheduled:!0,segments:a})):(this.context.notices.success((0,p.jsx)("p",{children:(0,Oe.__)("The newsletter is being sent...","mailpoet")}),{id:"mailpoet_notice_being_sent"}),c.MailPoet.trackEvent("Emails > Newsletter sent",{scheduled:!1,segments:a})),c.MailPoet.Modal.loading(!1)}))})).fail((e=>{this.showError(e),this.setState({loading:!1}),c.MailPoet.Modal.loading(!1)}));activateNewsletter=e=>c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"setStatus",data:{id:this.props.match.params.id,status:"active"}}).done((t=>{this.saveTemplate(e,(()=>{if(window.mailpoet_show_congratulate_after_first_newsletter)return c.MailPoet.Modal.loading(!1),void this.props.history.push(`/send/congratulate/${this.state.item.id}`);const e=this.state.item.options;this.props.history.push("automatic"===this.state.item.type?`/${e.group}`:`/${this.state.item.type||""}`),"automatic"===this.state.item.type&&ts[e.group]?(this.context.notices.success((0,p.jsx)("p",{children:(0,Oe.sprintf)((0,Oe.__)("Your %1s Automatic Email is now activated!","mailpoet"),ts[e.group]?.title??"")})),c.MailPoet.trackEvent("Emails > Automatic email activated",{Type:Ii()(`${e.group}-${e.event}`),Delay:as(e)})):"welcome"===t.data.type?(this.context.notices.success((0,p.jsx)("p",{children:(0,Oe.__)("Your Welcome Email is now activated!","mailpoet")})),c.MailPoet.trackEvent("Emails > Welcome email activated",{"List type":e.event,Delay:as(e)})):"re_engagement"===t.data.type?(this.context.notices.success((0,p.jsx)("p",{children:(0,Oe.__)("Your Re-engagement Email is now activated!","mailpoet")})),c.MailPoet.trackEvent("Emails > Re-engagement email activated",{Inactivity:as(e)})):"notification"===t.data.type&&(this.context.notices.success((0,p.jsx)("p",{children:(0,Oe.__)("Your post notification is now active!","mailpoet")})),c.MailPoet.trackEvent("Emails > Post notifications activated",{Frequency:e.intervalType})),c.MailPoet.Modal.loading(!1)}))})).fail((e=>{this.showError(e),this.setState({loading:!1}),c.MailPoet.Modal.loading(!1)}));handleResume=e=>(e.preventDefault(),this.isValid()?this.saveNewsletter().done((()=>{this.setState({loading:!0})})).done((()=>{c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"sendingQueue",action:"resume",data:{newsletter_id:this.state.item.id}}).done((()=>{this.props.history.push(`/${this.state.item.type||""}`),this.context.notices.success((0,p.jsx)("p",{children:(0,Oe.__)("The newsletter sending has been resumed.","mailpoet")}))})).fail((e=>{this.showError(e)}))})).fail((e=>{this.showError(e)})).always((()=>{this.setState({loading:!1})})):ke()("#mailpoet_newsletter").parsley().validate(),!1);handleSave=e=>{e.preventDefault(),this.saveNewsletter().done((()=>{this.context.notices.success((0,p.jsx)("p",{children:(0,Oe.__)("Email was updated successfully!","mailpoet")}))})).done((()=>{const e="automatic"===this.state.item.type?this.state.item.options.group:this.state.item.type;this.props.history.push(`/${e||""}`)})).fail((e=>{this.showError(e)}))};handleRedirectToDesign=e=>{e.preventDefault();const t=e.target.href;this.saveNewsletter().done((()=>{this.context.notices.success((0,p.jsx)("p",{children:(0,Oe.__)("Email was updated successfully!","mailpoet")}))})).done((()=>{window.location=t})).fail((e=>{this.showError(e)}))};saveNewsletter=()=>{const e=this.state.item;e.queue=void 0,this.setState({loading:!0});const t=Mi().omit(e,["body","created_at","deleted_at","hash","status","updated_at","type"]);return c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"save",data:t})};showError=e=>{e.errors.length>0&&this.context.notices.error(e.errors.map((e=>(0,p.jsx)("p",{children:e.message},e.message))),{scroll:!0,timeout:!1})};handleFormChange=e=>{const t=e.target.name,i=e.target.value;return this.setState((e=>{const a={...e.item},s=a.subject,n=a.ga_campaign;return a[t]=i,"subject"===t&&n===is(a.id,s)&&(a.ga_campaign=is(a.id,i)),"reply_to_address"===t&&(a[t]=i.toLowerCase()),{item:a}})),!0};handleSaveDraft=()=>{ke()("#mailpoet_newsletter").parsley().destroy()};disableSegmentsSelectorWhenPaused=e=>t=>"segments"===t.name||"options"===t.name?{...t,disabled:e}:t;disableGAIfPremiumInactive=()=>e=>Ki.P$||"ga_campaign"!==e.name?e:{...e,disabled:!0,onWrapperClick:()=>this.setState({showPremiumModal:!0,premiumModalMessage:(0,Oe.__)("Google Analytics tracking is not available in the free version of the MailPoet plugin.","mailpoet")})};disableFilterSegmentToggleIfPremiumInactive=()=>e=>{if(!Array.isArray(e.fields))return e;const t={...e};return t.fields=t.fields.map((e=>"filter-segment-toggle"!==e.name||Ki.P$?e:{...e,disabled:!0,onWrapperClick:e=>{e.preventDefault(),this.setState({showPremiumModal:!0,premiumModalMessage:(0,Oe.__)("Filtering by segment is not available in the free version of the MailPoet plugin.","mailpoet")})}})),t};getPreparedFields=e=>Array.isArray(this.state.fields)?this.state.fields.map(this.disableSegmentsSelectorWhenPaused(e)).map(this.disableGAIfPremiumInactive()).map(this.disableFilterSegmentToggleIfPremiumInactive()):[];closePremiumModal=()=>this.setState({showPremiumModal:!1});toggleLoadingState=e=>this.setState({loading:e});updatePendingApprovalState=e=>this.setState({mssKeyPendingApproval:e});render(){const{showPremiumModal:e,item:{status:t,queue:i,type:a,options:s,wp_post_id:n},mssKeyPendingApproval:o}=this.state,l="sending"===t&&i&&"paused"===i.status,d=this.getSendButtonOptions(),m=this.getPreparedFields(l),u=!(!window.mailpoet_subscribers_limit_reached&&!o&&void 0===this.state.validationError);let h=a;return h===Gi.j9.Automatic&&(h=s.group||h),(0,p.jsxs)("div",{className:"mailpoet-form-send-email",children:[(0,p.jsx)(et.A,{color:"#fff"}),(0,p.jsx)(bi,{emailType:h,automationId:"newsletter_send_heading"}),(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsxs)(wt,{id:"mailpoet_newsletter",fields:m,automationId:"newsletter_send_form",item:this.state.item,loading:this.state.loading,onChange:this.handleFormChange,onSubmit:this.handleSave,children:[(0,p.jsxs)(ki.Grid.CenteredRow,{className:"send-newsletter-buttons",children:[(0,p.jsx)(r.Button,{variant:"secondary",type:"submit",automationId:"email-save-draft",onClick:this.handleSaveDraft,isDisabled:this.state.loading,children:(0,Oe.__)("Save as draft and close","mailpoet")}),l?(0,p.jsx)(r.Button,{type:"button",onClick:this.handleResume,isDisabled:u||this.state.loading,automationId:"email-resume",children:(0,Oe.__)("Resume","mailpoet")}):(0,p.jsx)(r.Button,{type:"button",onClick:this.handleSend,...d,isDisabled:u||this.state.loading,automationId:"email-submit",children:d.value||(0,Oe.__)("Send","mailpoet")}),void 0!==this.state.validationError&&(0,p.jsx)(De.Tooltip,{tooltip:(0,p.jsx)("div",{children:this.state.validationError}),tooltipId:"helpTooltipSendEmail"})]}),(0,p.jsxs)("p",{children:[(0,Oe.__)("or simply","mailpoet")," ",(0,p.jsx)("a",{className:"mailpoet-link",href:c.MailPoet.FeaturesController.isSupported("gutenberg_email_editor")&&n?`post.php?post=${n}&action=edit`:`?page=mailpoet-newsletter-editor&id=${this.props.match.params.id}`,onClick:this.handleRedirectToDesign,children:(0,Oe.__)("go back to the Design page","mailpoet")}),"."]}),o&&(0,p.jsx)(es,{toggleLoadingState:this.toggleLoadingState,updatePendingState:this.updatePendingApprovalState}),e&&(0,p.jsx)(Ki.ZG,{onRequestClose:this.closePremiumModal,children:this.state.premiumModalMessage})]})})]})}}ns.contextType=l.k;const os=(0,Ne.EN)(ns);function rs(e){const[t,i]=(0,o.useState)(!1);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(bt.X,{level:0,children:(0,Oe.__)("Congratulations!","mailpoet")}),(0,p.jsx)(bt.X,{level:3,children:(a=e.newsletter,"welcome"===a.type?(0,Oe.__)("Your Welcome Email is now active.","mailpoet"):"notification"===a.type?(0,Oe.__)("Your Post Notification is now active.","mailpoet"):"automatic"===a.type?(0,Oe.__)("Your WooCommerce email has been activated.","mailpoet"):"scheduled"===a.status?(0,Oe.__)("Your newsletter is scheduled to be sent.","mailpoet"):(0,Oe.__)("Your newsletter is being sent!","mailpoet"))}),(0,p.jsx)("div",{className:"mailpoet-gap-large"}),(0,p.jsx)("div",{className:"mailpoet-gap-large"}),(0,p.jsx)("img",{src:e.illustrationImageUrl,alt:"",width:"500"}),(0,p.jsx)("div",{className:"mailpoet-gap-large"}),(0,p.jsx)(r.Button,{type:"button",dimension:"small",onClick:()=>{e.successClicked(),i(!0)},withSpinner:t,children:(0,Oe.__)("Close","mailpoet")})]});var a}function ls(e){return(0,p.jsxs)("div",{className:"mailpoet-wizard-step",children:[(0,p.jsx)("div",{className:"mailpoet-wizard-step-illustration",children:(0,p.jsx)("img",{src:e.illustrationUrl,width:"500",alt:""})}),(0,p.jsx)("div",{className:"mailpoet-wizard-step-content",children:e.children})]})}function ds(){return(0,p.jsxs)(r.List,{children:[(0,p.jsx)("li",{children:(0,Oe.__)("Reliable marketing and transactional email delivery. Reach inboxes, not spam boxes","mailpoet")}),(0,p.jsx)("li",{children:(0,Oe.__)("Send your emails super fast (up to 50,000 emails per hour)","mailpoet")}),(0,p.jsx)("li",{children:(0,Oe.__)("Maintain your sender reputation and improve engagement levels with automated bounce and complaint handling. Stop sending to non-deliverable and complaining addresses, automatically","mailpoet")}),(0,p.jsx)("li",{children:(0,Oe.__)("Authenticate your emails (with SPF and DKIM) to improve deliverability and avoid spam boxes","mailpoet")})]})}function cs(e){const[t,i]=(0,o.useState)(!1),a=()=>{e.onFinish(),i(!0)};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(r.Heading,{level:1,children:(s=e.newsletter.type,{standard:(0,Oe.__)("Your email has been sent!","mailpoet"),welcome:(0,Oe.__)("You are all set up and ready to go!","mailpoet"),notification:(0,Oe.__)("You are all set up and ready to go!","mailpoet"),woocommerce:(0,Oe.__)("You are all set up and ready to go!","mailpoet")}[s]||(0,Oe.__)("You are all set up and ready to go!","mailpoet"))}),(0,p.jsx)(ls,{illustrationUrl:e.MSSPitchIllustrationUrl,children:(0,p.jsxs)("div",{className:"mailpoet-welcome-wizard-step-content",children:[(0,p.jsx)(r.Heading,{level:4,children:(0,Oe.__)("What’s next? Sign up to the MailPoet Starter plan for fast and reliable email delivery","mailpoet")}),(0,p.jsx)("p",{children:e.subscribersCount<1e3?(0,Oe._x)("Did you know? Users with 1,000 subscribers or less get the Starter plan for free.","Promotion for our email sending service: Paragraph","mailpoet"):(0,Oe._x)("Starting at only $10 per month, MailPoet Business offers the following features","Promotion for our email sending service: Paragraph","mailpoet")}),(0,p.jsxs)(r.Heading,{level:5,children:[(0,Oe._x)("You’ll get","Promotion for our email sending service: Paragraph","mailpoet"),":"]}),(0,p.jsx)(ds,{}),(0,p.jsx)("p",{children:_()((0,Oe.__)("Please enter your key in [link]the Settings[/link] if you have already purchased it.","mailpoet"),/\[link\](.*?)\[\/link\]/g,((e,t)=>(0,p.jsx)("a",{href:"admin.php?page=mailpoet-settings#/premium",children:e},t)))}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)(r.Button,{isFullWidth:!0,href:e.purchaseUrl,target:"_blank",rel:"noopener noreferrer",onClick:t=>{t.preventDefault(),window.open(e.purchaseUrl),a()},children:(0,Oe._x)("Sign up for free","Promotion for our email sending service: Button","mailpoet")}),(0,p.jsx)(r.Button,{isFullWidth:!0,variant:"tertiary",onClick:a,onKeyDown:e=>{["keydown","keypress"].includes(e.type)&&["Enter"," "].includes(e.key)&&(e.preventDefault(),a())},withSpinner:t,children:(0,Oe._x)("No thanks!","Promotion for our email sending service: Skip link","mailpoet")})]})})]});var s}function ms(e){return window.has_mss_key_specified?(0,p.jsx)(rs,{successClicked:e.successClicked,illustrationImageUrl:e.illustrationImageUrl,newsletter:e.newsletter}):(0,p.jsx)(cs,{MSSPitchIllustrationUrl:e.MSSPitchIllustrationUrl,onFinish:e.successClicked,subscribersCount:e.subscribersCount,purchaseUrl:e.purchaseUrl,newsletter:e.newsletter})}function us(e){const[t,i]=(0,o.useState)(!1);return(0,p.jsxs)("div",{children:[(0,p.jsx)(bt.X,{level:1,children:(0,Oe.__)("Oops! We can’t send your newsletter","mailpoet")}),(0,p.jsx)(bt.X,{level:3,children:_()((0,Oe.__)("Rest assured, this is fairly common and is usually fixed quickly. [link]See our quick guide[/link] to help you solve this and get your website sending.","mailpoet"),/\[link\](.*?)\[\/link\]/g,((e,t)=>(0,p.jsx)("a",{target:"_blank",rel:"noopener noreferrer",href:"https://kb.mailpoet.com/article/231-sending-does-not-work",children:e},t)))}),(0,p.jsx)("div",{className:"mailpoet-gap-large"}),(0,p.jsx)("div",{className:"mailpoet-gap-large"}),(0,p.jsx)("img",{src:window.mailpoet_congratulations_error_image,alt:"",width:"500"}),(0,p.jsx)("div",{className:"mailpoet-gap-large"}),(0,p.jsx)(r.Button,{dimension:"small",type:"button",onClick:()=>{e.failClicked(),i(!0)},withSpinner:t,children:(0,Oe.__)("Close","mailpoet")})]})}rs.propTypes={successClicked:Te().func.isRequired,illustrationImageUrl:Te().string.isRequired,newsletter:Te().shape({status:Te().string.isRequired,type:Te().string.isRequired}).isRequired},ls.propTypes={illustrationUrl:Te().string.isRequired,children:Te().oneOfType([Te().arrayOf(Te().node),Te().node]).isRequired},ms.propTypes={successClicked:Te().func.isRequired,illustrationImageUrl:Te().string.isRequired,MSSPitchIllustrationUrl:Te().string.isRequired,newsletter:Te().shape({status:Te().string.isRequired,type:Te().string.isRequired}).isRequired,subscribersCount:Te().number.isRequired,purchaseUrl:Te().string.isRequired},us.propTypes={failClicked:Te().func.isRequired};var ps=i(16065);function hs(e){return(0,p.jsx)("div",{className:"mailpoet-congratulate-loading",children:e.showRichLoadingScreen&&(0,p.jsxs)("div",{children:[(0,p.jsx)(bt.X,{level:0,children:(0,Oe.__)("Verification","mailpoet")}),(0,p.jsx)(bt.X,{level:3,children:(0,Oe.__)("Congrats, you’re sending your first newsletter! We’re doing a quick verification to make sure everything works fine.","mailpoet")}),(0,p.jsx)("div",{className:"mailpoet-gap-large"}),(0,p.jsx)("div",{className:"mailpoet-gap-large"}),(0,p.jsx)(ps.a,{size:64})]})})}hs.propTypes={showRichLoadingScreen:Te().bool.isRequired};const gs=Math.floor(4*Math.random());function fs(){return c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"settings",action:"set",data:{show_congratulate_after_first_newsletter:!1}}).always((()=>{window.location=window.mailpoet_emails_page}))}class _s extends o.Component{constructor(e){super(e),this.state={loading:!0,newsletter:null,testingPassed:!1,timeStart:Je()(),minimumLoadingTimePassed:!1},this.tick=this.tick.bind(this)}componentDidMount(){this.loadNewsletter(this.props.match.params.id),this.tick()}componentDidUpdate(e){e.match.params.id!==this.props.match.params.id&&this.loadNewsletter(this.props.match.params.id)}tick(){Je()().subtract(20,"second").isAfter(this.state.timeStart)&&this.setState({error:!0,loading:!1}),this.state.loading&&this.loadNewsletter(this.props.match.params.id),Je()().subtract(6,"seconds").isAfter(this.state.timeStart)&&this.setState({minimumLoadingTimePassed:!0}),!this.state.loading&&this.state.minimumLoadingTimePassed||setTimeout(this.tick,2e3)}loadNewsletter(e){c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"get",data:{id:e}}).done((e=>this.newsletterLoaded(e.data)))}newsletterLoaded(e){"standard"!==e.type||"scheduled"===e.status?this.setState({newsletter:e,loading:!1,minimumLoadingTimePassed:!0}):"sent"===e.status||"sending"===e.status?this.setState({newsletter:e,loading:!1,testingPassed:!0}):this.setState({newsletter:e})}renderContent(){return this.state.loading||!this.state.minimumLoadingTimePassed?(e=!this.state.newsletter,(0,p.jsx)(hs,{illustrationImageUrl:window.mailpoet_congratulations_loading_image,successClicked:fs,showRichLoadingScreen:e})):this.state.error?(c.MailPoet.trackEvent("Cron testing done",{"Cron is working":"false"}),(0,p.jsx)(us,{failClicked:()=>{window.location=window.mailpoet_emails_page}})):(t=this.state.newsletter,this.state.testingPassed&&c.MailPoet.trackEvent("Cron testing done",{"Cron is working":"true"}),(0,p.jsx)(ms,{illustrationImageUrl:window.mailpoet_congratulations_success_images[gs],MSSPitchIllustrationUrl:window.mailpoet_congratulations_success_images[gs],successClicked:fs,newsletter:t,isWoocommerceActive:window.mailpoet_woocommerce_active,subscribersCount:window.mailpoet_subscribers_count,purchaseUrl:c.MailPoet.MailPoetComUrlFactory.getPurchasePlanUrl(c.MailPoet.subscribersCount,c.MailPoet.currentWpUserEmail,"starter",{utm_medium:"first-newsletter-congratulations",utm_campaign:"purchase"})}));var e,t}render(){return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("style",{dangerouslySetInnerHTML:{__html:"body { background: #fff; overflow-x: hidden; }"}}),(0,p.jsxs)("div",{className:"mailpoet-congratulate",children:[(0,p.jsx)("div",{className:"mailpoet-gap-large"}),this.renderContent()]})]})}}_s.propTypes={match:Te().shape({params:Te().shape({id:Te().string}).isRequired}).isRequired},_s.displayName="Congratulate";class bs extends o.Component{componentDidMount(){c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"create",data:{type:"standard"}}).done((e=>{this.showTemplateSelection(e.data.id)})).fail((e=>{e.errors.length>0&&this.context.notices.error(e.errors.map((e=>(0,p.jsx)("p",{children:e.message},e.message))),{scroll:!0})}))}showTemplateSelection=e=>{this.props.history.push(`/template/${e}`)};render(){return(0,p.jsx)("div",{children:(0,p.jsx)(bi,{emailType:"standard",automationId:"standard_newsletter_creation_heading"})})}}bs.contextType=l.k,bs.propTypes={history:Te().shape({push:Te().func.isRequired}).isRequired},bs.displayName="NewsletterStandard";const xs=(0,Ne.EN)(bs),vs={name:"options",type:"reactComponent",component:Ma};class ys extends o.Component{constructor(e){super(e),this.state={options:{intervalType:"daily",timeOfDay:0,weekDay:1,monthDay:0,nthWeekDay:1}}}handleValueChange=e=>{const t=this.state;t[e.target.name]=e.target.value,this.setState(t)};handleNext=()=>{c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"create",data:rt.default.extend({},this.state,{type:"notification",subject:(0,Oe.__)("The last [newsletter:total] posts from our blog","mailpoet")})}).done((e=>{this.showTemplateSelection(e.data.id)})).fail((e=>{e.errors.length>0&&this.context.notices.error(e.errors.map((e=>(0,p.jsx)("p",{children:e.message},e.message))),{scroll:!0})}))};showTemplateSelection=e=>{this.props.history.push(`/template/${e}`)};render(){return(0,p.jsxs)("div",{children:[(0,p.jsx)(et.A,{color:"#fff"}),(0,p.jsx)(bi,{emailType:"notification",automationId:"post_notification_creation_heading"}),(0,p.jsxs)(ki.Grid.Column,{align:"center",className:"mailpoet-schedule-email",children:[(0,p.jsx)(bt.X,{level:4,children:(0,Oe.__)("When to send this post notification email?","mailpoet")}),(0,p.jsx)(Ma,{item:this.state,field:vs,onValueChange:this.handleValueChange}),(0,p.jsx)(Le.z,{isFullWidth:!0,onClick:this.handleNext,type:"button",children:(0,Oe.__)("Next","mailpoet")})]})]})}}ys.contextType=l.k,ys.propTypes={history:Te().shape({push:Te().func.isRequired}).isRequired},ys.displayName="NewsletterNotification";const js=(0,Ne.EN)(ys),ws={name:"options",label:"Event",type:"reactComponent",component:Fa};class Ss extends o.Component{constructor(e){super(e);let t=window.mailpoet_segments||[],i=1;t=t.filter((e=>"default"===e.type)),rt.default.size(t)>0&&(i=rt.default.first(t).id),this.state={options:{event:"segment",segment:i,role:"subscriber",afterTimeNumber:1,afterTimeType:"immediate"}},this.handleValueChange=this.handleValueChange.bind(this),this.handleNext=this.handleNext.bind(this)}handleValueChange(e){const{state:t}=this;t[e.target.name]=e.target.value,this.setState(t)}handleNext(e){e.preventDefault(),this.isValid()?c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"create",data:rt.default.extend({},this.state,{type:"welcome",subject:(0,Oe.__)("Subject","mailpoet")})}).done((e=>{this.showTemplateSelection(e.data.id)})).fail((e=>{e.errors.length>0&&c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0})})):this.validate()}isValid=()=>ke()("#welcome_scheduling").parsley().isValid();validate=()=>ke()("#welcome_scheduling").parsley().validate();showTemplateSelection(e){this.props.history.push(`/template/${e}`)}render(){return(0,p.jsxs)("div",{children:[(0,p.jsx)(et.A,{color:"#fff"}),(0,p.jsx)(bi,{emailType:"welcome",automationId:"welcome_email_creation_heading"}),(0,p.jsxs)(ki.Grid.Column,{align:"center",className:"mailpoet-schedule-email",children:[(0,p.jsx)(bt.X,{level:4,children:(0,Oe.__)("When to send this welcome email?","mailpoet")}),(0,p.jsxs)("form",{id:"welcome_scheduling",children:[(0,p.jsx)(Fa,{item:this.state,field:ws,onValueChange:this.handleValueChange}),(0,p.jsx)(Le.z,{isFullWidth:!0,type:"submit",onClick:this.handleNext,children:(0,Oe.__)("Next","mailpoet")})]})]})]})}}function Ps(){let e="";c.MailPoet.deactivateSubscriberAfterInactiveDays&&(e=(Math.floor(Number(c.MailPoet.deactivateSubscriberAfterInactiveDays)/30)-1).toString());const[t,i]=(0,o.useState)({afterTimeNumber:e,afterTimeType:"months"}),[a,s]=(0,o.useState)([]),[n,r]=(0,o.useState)(!1),l=(0,Ne.k6)();return(0,p.jsxs)("div",{children:[(0,p.jsx)(et.A,{color:"#fff"}),a&&(0,p.jsx)(Jt,{errors:a}),(0,p.jsx)(bi,{emailType:"re_engagement",automationId:"re_engagement_heading_creation_heading"}),(0,p.jsxs)(ki.Grid.Column,{align:"center",className:"mailpoet-schedule-email",children:[(0,p.jsx)(Ya,{afterTimeNumber:t.afterTimeNumber,afterTimeType:t.afterTimeType,inactiveSubscribersPeriod:Number(c.MailPoet.deactivateSubscriberAfterInactiveDays),updateAfterTimeNumber:(0,Za.compose)([i,(0,Za.assoc)("afterTimeNumber",Za.__,t)]),updateAfterTimeType:(0,Za.compose)([i,(0,Za.assoc)("afterTimeType",Za.__,t)])}),(0,p.jsx)(Le.z,{isFullWidth:!0,onClick:()=>(s([]),r(!0),void c.MailPoet.Ajax.post({api_version:c.MailPoet.apiVersion,endpoint:"newsletters",action:"create",data:{type:"re_engagement",subject:(0,Oe.__)("Subject","mailpoet"),options:t}}).done((e=>{var t;t=e.data.id,l.push(`/template/${t}`)})).fail((e=>{r(!1),e.errors&&s(e.errors)}))),type:"button",isDisabled:!t.afterTimeNumber||n,withSpinner:n,children:(0,Oe.__)("Next","mailpoet")})]})]})}Ss.propTypes={history:Te().shape({push:Te().func.isRequired}).isRequired},Ss.displayName="NewsletterWelcome",Ps.displayName="NewsletterTypeReEngagement";class Ms extends o.Component{static getEventOptions(e){return e.options||null}static getEventOptionsFirstValue(e){return e&&rt.default.isArray(e.values)&&e.values[0].id?e.values[0].id:null}constructor(e){super(e);const{email:t,name:i}=e;this.handleChange=this.handleChange.bind(this),this.handleNextStep=this.handleNextStep.bind(this),this.email=t,this.emailEvents=this.email.events,this.segments=rt.default.filter(window.mailpoet_segments,(e=>null===e.deleted_at));const a=this.getEvent(i),s=this.constructor.getEventOptions(a),n=this.constructor.getEventOptionsFirstValue(s);this.state={event:a,eventSlug:a.slug,eventOptionValue:n,segment:a.sendToLists?this.getFirstSegment():null,afterTimeType:a.defaultAfterTimeType||"immediate",afterTimeNumber:null}}handleChange(e){const{segment:t,afterTimeNumber:i}=this.state,a=e;if(a.eventSlug){a.event=this.getEvent(a.eventSlug),a.segment=a.event.sendToLists?t||this.getFirstSegment():null;const e=this.constructor.getEventOptions(a.event);a.eventOptionValue=e?this.constructor.getEventOptionsFirstValue(e):null}a.afterTimeType&&"immediate"===a.afterTimeType?a.afterTimeNumber=null:!a.afterTimeType||a.afterTimeNumber||i||(a.afterTimeNumber=1),this.setState(a),this.resetValidationErrors(),this.isValid()&&this.validate()}handleNextStep(e){if(e.preventDefault(),!this.isValid())return void this.validate();const{history:t}=this.props,{eventSlug:i,afterTimeType:a,afterTimeNumber:s,event:n,segment:o,eventOptionValue:r}=this.state,l={group:this.email.slug,event:i,afterTimeType:a};s&&(l.afterTimeNumber=s),l.sendTo=n.sendToLists?"segment":"user",o&&(l.segment=o),r&&(l.meta=JSON.stringify({option:r})),c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"create",data:{type:"automatic",subject:(0,Oe.__)("Subject","mailpoet"),options:l}}).done((e=>{c.MailPoet.trackEvent("Emails > New Automatic Email Created",{"Event type":l.event,"Schedule type":l.afterTimeType,"Schedule value":l.afterTimeNumber}),t.push(`/template/${e.data.id}`)})).fail((e=>{e.errors.length>0&&this.context.notices.error(e.errors.map((e=>(0,p.jsx)("p",{children:e.message},e.message))),{scroll:!0})}))}getEvent(e){return this.emailEvents[e]}getFirstSegment(){return rt.default.isArray(this.segments)&&this.segments[0].id?this.segments[0].id:null}isValid=()=>!ke()("#newsletter_scheduling").parsley()||ke()("#newsletter_scheduling").parsley().isValid();validate=()=>{ke()("#newsletter_scheduling").parsley()&&ke()("#newsletter_scheduling").parsley().validate()};resetValidationErrors=()=>{ke()("#newsletter_scheduling").parsley()&&ke()("#newsletter_scheduling").parsley().reset()};displayHeader(){const{event:e}=this.state;return e.title}displayEventOptions(){const{eventSlug:e,event:t}=this.state,i={emailSlug:this.email.slug,eventSlug:e,eventOptions:this.constructor.getEventOptions(t),onValueChange:this.handleChange};return(0,p.jsx)(Va,{emailSlug:i.emailSlug,eventSlug:i.eventSlug,eventOptions:i.eventOptions,onValueChange:i.onValueChange})}displaySegments(){const{event:e}=this.state;if(!e.sendToLists)return null;const t={field:{id:"segments",forceSelect2:!0,values:this.segments,extendSelect2Options:{minimumResultsForSearch:1/0}},onValueChange:e=>this.handleChange({segment:e.target.value})};return(0,p.jsx)("div",{className:"event-segment-selection",children:(0,p.jsx)(Re.Y,{field:t.field,onValueChange:t.onValueChange})})}displayScheduling(){const{afterTimeNumber:e,afterTimeType:t,event:i}=this.state,a={item:{afterTimeNumber:e,afterTimeType:t},event:i,onValueChange:this.handleChange};return(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)($a,{item:a.item,event:a.event,onValueChange:a.onValueChange})})}displayEventTip(){const{event:e}=this.state;return e.tip?(0,p.jsxs)("p",{className:"description",children:[(0,p.jsx)("strong",{children:(0,Oe.__)("Tip:","mailpoet")})," ",e.tip]}):null}render(){return(0,p.jsxs)("div",{children:[(0,p.jsx)(et.A,{color:"#fff"}),(0,p.jsx)(bi,{emailType:"woocommerce",automationId:"woocommerce_email_creation_heading"}),(0,p.jsx)(ki.Grid.Column,{align:"center",className:"mailpoet-schedule-email",children:(0,p.jsxs)("form",{id:"newsletter_scheduling",children:[(0,p.jsx)(bt.X,{level:4,children:this.displayHeader()}),(0,p.jsx)("div",{children:this.displayEventOptions()}),(0,p.jsx)("div",{children:this.displaySegments()}),(0,p.jsx)("div",{children:this.displayScheduling()}),(0,p.jsx)(Le.z,{isFullWidth:!0,onClick:this.handleNextStep,type:"submit",children:(0,Oe._x)("Next","Button label: Next step","mailpoet")})]})}),this.displayEventTip()]})}}Ms.contextType=l.k,Ms.propTypes={history:Te().shape({push:Te().func.isRequired}).isRequired,name:Te().string.isRequired,email:Te().shape({title:Te().string.isRequired,slug:Te().string.isRequired}).isRequired},Ms.displayName="EventsConditions";var Ns=i(5934),Is=i(41991),ks=i(10235);function Cs(e){let{newsletter:t}=e;const[i,a]=(0,o.useState)("paused"===t.queue.status),[s,n]=(0,o.useState)([]),l=async()=>{n([]),await(async()=>{await c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"sendingQueue",action:"resume",data:{newsletter_id:t.id}}).done((()=>a(!1))).fail((e=>n(e.errors)))})()};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Jt,{errors:s}),i&&(0,p.jsx)(Le.z,{dimension:"small",onClick:t.status===Gi.sj.Corrupt?async()=>{(0,r.confirmAlert)({message:(0,Oe.__)("The was an issue sending this email before, please confirm the issues are fixed to proceed."),onConfirm:l})}:l,children:(0,Oe.__)("Resume","mailpoet")}),!i&&(0,p.jsx)(Le.z,{dimension:"small",onClick:async()=>{n([]),await c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"sendingQueue",action:"pause",data:{newsletter_id:t.id}}).done((()=>a(!0))).fail((e=>n(e.errors)))},children:(0,Oe.__)("Pause","mailpoet")})]})}function Ts(e){let{newsletter:t,mailerLog:i}=e;const a=t.sent_at||t.queue.scheduled_at,s=a?(0,Is.default)(a,"yyyy-MM-dd HH:mm:ss",new Date):void 0,n=t.queue&&"scheduled"!==t.queue.status,o="paused"===i.status,r=(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Me.Link,{to:`/sending-status/${t.id}`,"data-automation-id":`sending_status_${t.id}`,children:(0,p.jsx)(ks.sj,{processed:parseInt(t.queue.count_processed,10),scheduledFor:s,total:parseInt(t.queue.count_total,10),isPaused:o,status:t.status,logs:t.logs})}),"completed"!==t.queue.status&&!o&&(0,p.jsx)(Cs,{newsletter:t})]}),l=(0,p.jsx)(ks.sj,{scheduledFor:s,isPaused:"scheduled"===t.queue.status&&o,status:t.status,logs:t.logs});return(0,p.jsxs)(p.Fragment,{children:[n&&r,!n&&l]})}Ts.displayName="QueueStatus";const Es=(0,r.withBoundary)(Ts),As=c.MailPoet.trackingConfig.emailTrackingEnabled,Rs={onNoItemsFound:(e,t)=>t?(0,Oe.__)("No emails found.","mailpoet"):(0,Oe.__)("Nothing here yet! But, don't fret - there's no reason to get upset. Pretty soon, you’ll be sending emails faster than a turbo-jet.","mailpoet"),onTrash:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email was moved to the trash.","mailpoet"):(0,Oe.__)("%1$d emails were moved to the trash.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onDelete:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email was permanently deleted.","mailpoet"):(0,Oe.__)("%1$d emails were permanently deleted.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onRestore:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email has been restored from the Trash.","mailpoet"):(0,Oe.__)("%1$d emails have been restored from the Trash.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)}},Os=[{name:"subject",label:(0,Oe.__)("Subject","mailpoet"),sortable:!0},{name:"status",label:(0,Oe.__)("Status","mailpoet")},{name:"segments",label:(0,Oe.__)("Lists","mailpoet")},{name:"statistics",label:(0,Oe.__)("Clicked, Opened","mailpoet"),display:As},{name:"sent_at",label:(0,Oe.__)("Sent on","mailpoet"),sortable:!0}],Ls=[{name:"trash",label:(0,Oe.__)("Move to trash","mailpoet"),onSuccess:Rs.onTrash}],Fs=e=>{let t=`?page=mailpoet-newsletter-editor&id=${e.id}`;c.MailPoet.FeaturesController.isSupported("gutenberg_email_editor")&&e.wp_post_id&&(t=`post.php?post=${e.wp_post_id}&action=edit`),e.queue&&"sending"===e.status&&null===e.queue.status?(0,vi._)({message:(0,Oe.__)("Sending is in progress. Do you want to pause sending and edit the newsletter?","mailpoet"),onConfirm:()=>{window.location.href=`${t}&pauseConfirmed=yes`}}):window.location.href=t};let Ds=[{name:"view",link:function(e){return(0,p.jsx)("a",{href:e.preview_url,target:"_blank",rel:"noopener noreferrer",children:(0,Oe.__)("Preview","mailpoet")})}},{name:"edit",className:"mailpoet-hide-on-mobile",label:(0,Oe.__)("Edit","mailpoet"),onClick:Fs},{name:"duplicate",className:"mailpoet-hide-on-mobile",label:(0,Oe.__)("Duplicate","mailpoet"),onClick:function(e,t){return c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"duplicate",data:{id:e.id}}).done((e=>{c.MailPoet.Notice.success((0,Oe.__)('Email "%1$s" has been duplicated.',"mailpoet").replace("%1$s",e.data.subject)),t()})).fail((e=>{e.errors.length>0&&c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0})}))}},{name:"trash",className:"mailpoet-hide-on-mobile"}];Ds=(0,Ut.y8)(Ds);class qs extends o.Component{constructor(e){super(e),this.state={newslettersCount:void 0}}renderItem=(e,t,i)=>{const a=ee()("manage-column","column-primary","has-row-actions");return(0,p.jsxs)("div",{children:[(0,p.jsxs)("td",{className:a,children:[(0,p.jsx)("a",{className:"mailpoet-listing-title",href:"#",onClick:t=>{t.preventDefault(),Fs(e)},children:e.queue.newsletter_rendered_subject||e.subject}),t]}),(0,p.jsx)("td",{className:"column mailpoet-listing-status-column","data-colname":(0,Oe.__)("Status","mailpoet"),children:(0,p.jsx)(Es,{newsletter:e,mailerLog:i.mta_log})}),(0,p.jsx)("td",{className:"column mailpoet-hide-on-mobile","data-colname":(0,Oe.__)("Lists","mailpoet"),children:(0,p.jsxs)(r.ErrorBoundary,{children:[(0,p.jsx)(Ns.Eg,{segments:e.segments,dimension:"large"}),(0,p.jsx)(Ns.$6,{newsletter:e,dimension:"large"})]})}),!0===As?(0,p.jsx)("td",{className:"column mailpoet-listing-stats-column","data-colname":(0,Oe.__)("Clicked, Opened","mailpoet"),children:(0,p.jsx)(ri,{newsletter:e,currentTime:i.current_time})}):null,(0,p.jsx)("td",{className:"column-date mailpoet-hide-on-mobile","data-colname":(0,Oe.__)("Sent on","mailpoet"),children:e.sent_at?(0,p.jsxs)(p.Fragment,{children:[c.MailPoet.Date.short(e.sent_at),(0,p.jsx)("br",{}),c.MailPoet.Date.time(e.sent_at)]}):null})]})};isItemInactive=e=>"draft"===e.status;render(){return(0,p.jsxs)(p.Fragment,{children:[0===this.state.newslettersCount&&(0,p.jsx)(ii,{filter:e=>"standard"===e.slug,hideScreenOptions:!1,hideClosingButton:!0}),0!==this.state.newslettersCount&&(0,p.jsx)(Ee.N,{limit:window.mailpoet_listing_per_page,location:this.props.location,params:this.props.match.params,endpoint:"newsletters",type:"standard",base_url:"standard",onRenderItem:this.renderItem,isItemInactive:this.isItemInactive,columns:Os,bulk_actions:Ls,item_actions:Ds,messages:Rs,auto_refresh:!0,sort_by:"sent_at",sort_order:"desc",afterGetItems:e=>{if(!e.loading){const t=e.groups.reduce(((e,t)=>e+t.count),0);this.setState({newslettersCount:t})}(0,Ut._X)(e),(0,Ut.bF)(e)}})]})}}qs.contextType=l.k,qs.propTypes={location:Te().object.isRequired,match:Te().shape({params:Te().object}).isRequired},qs.displayName="NewsletterListStandard";const $s=(0,Ne.EN)((0,r.withBoundary)(qs));var Bs=i(45959);const Ws=window.mailpoet_roles||{},Vs=window.mailpoet_segments||{},Us=c.MailPoet.trackingConfig.emailTrackingEnabled,Hs={onNoItemsFound:(e,t)=>t?(0,Oe.__)("No emails found.","mailpoet"):(0,Oe.__)("Nothing here yet! But, don't fret - there's no reason to get upset. Pretty soon, you’ll be sending emails faster than a turbo-jet.","mailpoet"),onTrash:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email was moved to the trash.","mailpoet"):(0,Oe.__)("%1$d emails were moved to the trash.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onDelete:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email was permanently deleted.","mailpoet"):(0,Oe.__)("%1$d emails were permanently deleted.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onRestore:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email has been restored from the Trash.","mailpoet"):(0,Oe.__)("%1$d emails have been restored from the Trash.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)}},zs=[{name:"subject",label:(0,Oe.__)("Subject","mailpoet"),sortable:!0},{name:"settings",label:(0,Oe.__)("Settings","mailpoet")},{name:"statistics",label:(0,Oe.__)("Statistics","mailpoet"),display:Us},{name:"status",label:(0,Oe.__)("Status","mailpoet"),width:145},{name:"updated_at",label:(0,Oe.__)("Last modified on","mailpoet"),sortable:!0}],Zs=[{name:"trash",label:(0,Oe.__)("Move to trash","mailpoet"),onSuccess:Hs.onTrash}];let Ys=[{name:"view",link:function(e){return(0,p.jsx)("a",{href:e.preview_url,target:"_blank",rel:"noopener noreferrer",children:(0,Oe.__)("Preview","mailpoet")})}},{name:"duplicate",className:"mailpoet-hide-on-mobile",label:(0,Oe.__)("Duplicate","mailpoet"),onClick:(e,t)=>c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"duplicate",data:{id:e.id}}).done((e=>{c.MailPoet.Notice.success((0,Oe.__)('Email "%1$s" has been duplicated.',"mailpoet").replace("%1$s",e.data.subject)),t()})).fail((e=>{e.errors.length>0&&c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0})}))},{name:"edit",className:"mailpoet-hide-on-mobile",label:(0,Oe.__)("Edit","mailpoet"),onClick:Ut.Q2},{name:"trash",className:"mailpoet-hide-on-mobile"}];Ys=(0,Ut.y8)(Ys);class Gs extends o.Component{constructor(e){super(e),this.state={newslettersCount:void 0}}updateStatus=(e,t)=>{t.persist(),c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"setStatus",data:{id:Number(t.target.getAttribute("data-id")),status:e?"active":"draft"}}).done((e=>{"active"===e.data.status&&c.MailPoet.Notice.success((0,Oe.__)("Your Welcome Email is now activated!","mailpoet")),this.forceUpdate()})).fail((i=>{c.MailPoet.Notice.showApiErrorNotice(i),t.target.checked=!e}))};renderStatus=e=>{const t=(0,Oe._x)("%1$d sent","number of welcome emails sent","mailpoet").replace("%1$d",e.total_sent.toLocaleString()),i=(0,Oe._x)("%1$d scheduled","number of welcome emails scheduled to be sent","mailpoet").replace("%1$d",e.total_scheduled.toLocaleString());return(0,p.jsxs)("div",{children:[(0,p.jsx)(Yi.Z,{className:"mailpoet-listing-status-toggle",onCheck:this.updateStatus,"data-id":e.id,dimension:"small",defaultChecked:"active"===e.status}),(0,p.jsxs)("p",{className:"mailpoet-listing-stats-description",children:[(0,p.jsx)(Me.Link,{to:`/sending-status/${e.id}`,"data-automation-id":`sending_status_${e.id}`,children:t})," ",(0,p.jsx)("br",{}),i]})]})};renderSettings=e=>{let t,i,a;if("user"===e.options.event)t="mailpoet_all"===e.options.role?(0,Oe.__)("Sent when a new WordPress user is added to your site.","mailpoet"):_()((0,Oe.__)("Sent when a new WordPress user with the role %1$s is added to your site.","mailpoet"),"%1$s",((t,i)=>(0,p.jsx)(Et.V,{variant:"list",children:Ws[e.options.role]},i)));else{if(a=rt.default.find(Vs,(t=>Number(t.id)===Number(e.options.segment))),void 0===a)return(0,p.jsx)(Me.Link,{className:"mailpoet-listing-error",to:`/send/${e.id}`,children:(0,Oe.__)("You need to select a list to send to.","mailpoet")});t=_()((0,Oe.__)("Sent when someone subscribes to the list: %1$s.","mailpoet"),"%1$s",((e,t)=>(0,p.jsx)(Et.V,{variant:"list",children:a.name},t)))}if(t&&"immediate"!==e.options.afterTimeType)switch(e.options.afterTimeType){case"minutes":i=(0,Oe.__)("%1$d minute(s) later","mailpoet").replace("%1$d",e.options.afterTimeNumber);break;case"hours":i=(0,Oe.__)("%1$d hour(s) later","mailpoet").replace("%1$d",e.options.afterTimeNumber);break;case"days":i=(0,Oe.__)("%1$d day(s) later","mailpoet").replace("%1$d",e.options.afterTimeNumber);break;case"weeks":i=(0,Oe.__)("%1$d week(s) later","mailpoet").replace("%1$d",e.options.afterTimeNumber);break;default:i=(0,Oe.__)("Invalid sending delay.","mailpoet")}return(0,p.jsxs)("span",{children:[t,i&&(0,p.jsxs)("div",{className:"mailpoet-listing-schedule",children:[(0,p.jsx)("div",{className:"mailpoet-listing-schedule-icon",children:(0,p.jsx)(Bs.P,{})}),i]})]})};renderItem=(e,t)=>{const i=ee()("manage-column","column-primary","has-row-actions");return(0,p.jsxs)("div",{children:[(0,p.jsxs)("td",{className:i,children:[(0,p.jsx)("a",{className:"mailpoet-listing-title",href:`?page=mailpoet-newsletter-editor&id=${e.id}`,onClick:t=>{t.preventDefault(),(0,Ut.Q2)(e)},children:e.subject}),t]}),(0,p.jsx)("td",{className:"column mailpoet-hide-on-mobile","data-colname":(0,Oe.__)("Settings","mailpoet"),children:this.renderSettings(e)}),!0===Us?(0,p.jsx)("td",{className:"column mailpoet-listing-stats-column","data-colname":(0,Oe.__)("Clicked, Opened","mailpoet"),children:(0,p.jsx)(ri,{newsletter:e,isSent:e.total_sent>0&&!!e.statistics})}):null,(0,p.jsx)("td",{className:"column","data-colname":(0,Oe.__)("Status","mailpoet"),children:this.renderStatus(e)}),(0,p.jsxs)("td",{className:"column-date mailpoet-hide-on-mobile","data-colname":(0,Oe.__)("Last modified on","mailpoet"),children:[c.MailPoet.Date.short(e.updated_at),(0,p.jsx)("br",{}),c.MailPoet.Date.time(e.updated_at)]})]})};isItemInactive=e=>"draft"===e.status;render(){return(0,p.jsxs)(p.Fragment,{children:[0===this.state.newslettersCount&&(0,p.jsx)(ii,{filter:e=>"welcome"===e.slug,hideScreenOptions:!1,hideClosingButton:!0}),0!==this.state.newslettersCount&&(0,p.jsx)(Ee.N,{limit:window.mailpoet_listing_per_page,location:this.props.location,params:this.props.match.params,endpoint:"newsletters",type:"welcome",base_url:"welcome",onRenderItem:this.renderItem,isItemInactive:this.isItemInactive,columns:zs,bulk_actions:Zs,item_actions:Ys,messages:Hs,auto_refresh:!0,sort_by:"updated_at",sort_order:"desc",afterGetItems:e=>{if(!e.loading){const t=e.groups.reduce(((e,t)=>e+t.count),0);this.setState({newslettersCount:t})}(0,Ut._X)(e),(0,Ut.bF)(e)}})]})}}Gs.propTypes={location:Te().object.isRequired,match:Te().shape({params:Te().object}).isRequired},Gs.displayName="NewsletterListWelcome";const Ks=(0,Ne.EN)((0,r.withBoundary)(Gs)),Qs={onNoItemsFound:(e,t)=>t?(0,Oe.__)("No emails found.","mailpoet"):(0,Oe.__)("Nothing here yet! But, don't fret - there's no reason to get upset. Pretty soon, you’ll be sending emails faster than a turbo-jet.","mailpoet"),onTrash:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email was moved to the trash.","mailpoet"):(0,Oe.__)("%1$d emails were moved to the trash.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onDelete:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email was permanently deleted.","mailpoet"):(0,Oe.__)("%1$d emails were permanently deleted.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onRestore:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email has been restored from the Trash.","mailpoet"):(0,Oe.__)("%1$d emails have been restored from the Trash.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)}},Xs=[{name:"subject",label:(0,Oe.__)("Subject","mailpoet"),sortable:!0},{name:"settings",label:(0,Oe.__)("Settings","mailpoet")},{name:"history",label:(0,Oe.__)("History","mailpoet"),width:100},{name:"status",label:(0,Oe.__)("Status","mailpoet"),width:100},{name:"updated_at",label:(0,Oe.__)("Last modified on","mailpoet"),sortable:!0}],Js=[{name:"trash",label:(0,Oe.__)("Move to trash","mailpoet"),onSuccess:Qs.onTrash}],en=[{name:"view",link:function(e){return(0,p.jsx)("a",{href:e.preview_url,target:"_blank",rel:"noopener noreferrer",children:(0,Oe.__)("Preview","mailpoet")})}},{name:"edit",className:"mailpoet-hide-on-mobile",label:(0,Oe.__)("Edit","mailpoet"),onClick:Ut.Q2},{name:"duplicate",className:"mailpoet-hide-on-mobile",label:(0,Oe.__)("Duplicate","mailpoet"),onClick:function(e,t){return c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"duplicate",data:{id:e.id}}).done((e=>{c.MailPoet.Notice.success((0,Oe.__)('Email "%1$s" has been duplicated.',"mailpoet").replace("%1$s",e.data.subject)),t()})).fail((e=>{e.errors.length>0&&c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0})}))}},{name:"trash",className:"mailpoet-hide-on-mobile"}];class tn extends o.Component{constructor(e){super(e),this.state={newslettersCount:void 0}}updateStatus=(e,t)=>{t.persist(),c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"setStatus",data:{id:Number(t.target.getAttribute("data-id")),status:e?"active":"draft"}}).done((e=>{"active"===e.data.status&&c.MailPoet.Notice.success((0,Oe.__)("Your post notification is now active!","mailpoet")),this.forceUpdate()})).fail((i=>{c.MailPoet.Notice.showApiErrorNotice(i),t.target.checked=!e}))};renderStatus=e=>(0,p.jsx)(Yi.Z,{className:"mailpoet-listing-status-toggle",onCheck:this.updateStatus,"data-id":e.id,dimension:"small",defaultChecked:"active"===e.status});renderSettings=e=>{let t;if(0===e.segments.length)return(0,p.jsx)(Me.Link,{className:"mailpoet-listing-error",to:`/send/${e.id}`,children:(0,Oe.__)("You need to select a list to send to.","mailpoet")});const i=_()((0,Oe.__)("Send to %1$s","mailpoet"),"%1$s",((t,i)=>(0,p.jsxs)(o.Fragment,{children:[(0,p.jsx)(Ns.Eg,{segments:e.segments},`segment-${i}`),(0,p.jsx)(Ns.$6,{newsletter:e},`filter-segment-${i}`)]},i)));switch(e.options.intervalType){case"daily":t=(0,Oe.__)("Daily at %1$s","mailpoet").replace("%1$s",_a[e.options.timeOfDay]);break;case"weekly":t=(0,Oe.__)("Weekly on %1$s at %2$s","mailpoet").replace("%1$s",ba[e.options.weekDay]).replace("%2$s",_a[e.options.timeOfDay]);break;case"monthly":t=(0,Oe.__)("Monthly on the %1$s at %2$s","mailpoet").replace("%1$s",xa[e.options.monthDay]).replace("%2$s",_a[e.options.timeOfDay]);break;case"nthWeekDay":t=(0,Oe.__)("Every %1$s %2$s of the month at %3$s","mailpoet").replace("%1$s",va[e.options.nthWeekDay]).replace("%2$s",ba[e.options.weekDay]).replace("%3$s",_a[e.options.timeOfDay]);break;case"immediately":t=(0,Oe.__)("Immediately","mailpoet");break;default:t="Invalid sending frequency"}return(0,p.jsxs)("span",{children:[i,(0,p.jsxs)("div",{className:"mailpoet-listing-schedule",children:[(0,p.jsx)("div",{className:"mailpoet-listing-schedule-icon",children:(0,p.jsx)(Bs.P,{})}),t]})]})};renderHistoryLink=e=>0===Number(e.children_count)?(0,p.jsx)("span",{className:"mailpoet-listing-status-unknown mailpoet-font-extra-small mailpoet-listing-notification-status",children:(0,Oe.__)("Not sent yet","mailpoet")}):(0,p.jsxs)(Me.Link,{className:"mailpoet-nowrap","data-automation-id":`history-${e.id}`,to:`/notification/history/${e.id}`,children:[(0,p.jsx)(Le.z,{className:"mailpoet-hide-on-mobile",dimension:"small",children:(0,Oe.__)("View history","mailpoet")}),(0,p.jsx)(Le.z,{className:"mailpoet-show-on-mobile mailpoet-listing-notification-status",dimension:"small",variant:"secondary",children:(0,Oe.__)("View history","mailpoet")})]});renderItem=(e,t)=>{const i=ee()("manage-column","column-primary","has-row-actions");return(0,p.jsxs)("div",{children:[(0,p.jsxs)("td",{className:i,children:[(0,p.jsx)("a",{className:"mailpoet-listing-title",href:`?page=mailpoet-newsletter-editor&id=${e.id}`,onClick:t=>{t.preventDefault(),(0,Ut.Q2)(e)},children:e.subject}),t]}),(0,p.jsx)("td",{className:"column mailpoet-hide-on-mobile","data-colname":(0,Oe.__)("Settings","mailpoet"),children:this.renderSettings(e)}),(0,p.jsx)("td",{className:"column","data-colname":(0,Oe.__)("History","mailpoet"),children:this.renderHistoryLink(e)}),(0,p.jsx)("td",{className:"column","data-colname":(0,Oe.__)("Status","mailpoet"),children:this.renderStatus(e)}),(0,p.jsxs)("td",{className:"column-date mailpoet-hide-on-mobile","data-colname":(0,Oe.__)("Last modified on","mailpoet"),children:[c.MailPoet.Date.short(e.updated_at),(0,p.jsx)("br",{}),c.MailPoet.Date.time(e.updated_at)]})]})};isItemInactive=e=>"draft"===e.status;render(){return(0,p.jsxs)(p.Fragment,{children:[0===this.state.newslettersCount&&(0,p.jsx)(ii,{filter:e=>"notification"===e.slug,hideScreenOptions:!1,hideClosingButton:!0}),0!==this.state.newslettersCount&&(0,p.jsx)(Ee.N,{limit:window.mailpoet_listing_per_page,location:this.props.location,params:this.props.match.params,endpoint:"newsletters",type:"notification",base_url:"notification",onRenderItem:this.renderItem,isItemInactive:this.isItemInactive,columns:Xs,bulk_actions:Js,item_actions:en,messages:Qs,auto_refresh:!0,sort_by:"updated_at",sort_order:"desc",afterGetItems:e=>{if(!e.loading){const t=e.groups.reduce(((e,t)=>e+t.count),0);this.setState({newslettersCount:t})}(0,Ut._X)(e),(0,Ut.bF)(e)}})]})}}tn.propTypes={location:Te().object.isRequired,match:Te().shape({params:Te().object}).isRequired},tn.displayName="NewsletterListNotification";const an=(0,Ne.EN)((0,r.withBoundary)(tn)),sn=c.MailPoet.trackingConfig.emailTrackingEnabled,nn={onNoItemsFound:(e,t)=>t?(0,Oe.__)("No emails found.","mailpoet"):(0,Oe.__)("Nothing here yet! But, don't fret - there's no reason to get upset. Pretty soon, you’ll be sending emails faster than a turbo-jet.","mailpoet"),onTrash:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email was moved to the trash.","mailpoet"):(0,Oe.__)("%1$d emails were moved to the trash.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onDelete:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email was permanently deleted.","mailpoet"):(0,Oe.__)("%1$d emails were permanently deleted.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onRestore:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email has been restored from the Trash.","mailpoet"):(0,Oe.__)("%1$d emails have been restored from the Trash.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)}},on=[{name:"subject",label:(0,Oe.__)("Subject","mailpoet"),sortable:!0},{name:"settings",label:(0,Oe.__)("Settings","mailpoet")},{name:"statistics",label:(0,Oe.__)("Clicked, Opened","mailpoet"),display:sn},{name:"status",label:(0,Oe.__)("Status","mailpoet"),width:145},{name:"updated_at",label:(0,Oe.__)("Last modified on","mailpoet"),sortable:!0}],rn=[{name:"trash",label:(0,Oe.__)("Move to trash","mailpoet"),onSuccess:nn.onTrash}];let ln=[{name:"view",link:function(e){return(0,p.jsx)("a",{href:e.preview_url,target:"_blank",rel:"noopener noreferrer",children:(0,Oe.__)("Preview","mailpoet")})}},{name:"duplicate",className:"mailpoet-hide-on-mobile",label:(0,Oe.__)("Duplicate","mailpoet"),onClick:(e,t)=>c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"duplicate",data:{id:e.id}}).done((e=>{c.MailPoet.Notice.success((0,Oe.__)('Email "%1$s" has been duplicated.',"mailpoet").replace("%1$s",e.data.subject)),t()})).fail((e=>{e.errors.length>0&&c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0})}))},{name:"edit",className:"mailpoet-hide-on-mobile",label:(0,Oe.__)("Edit","mailpoet"),onClick:Ut.Q2},{name:"trash",className:"mailpoet-hide-on-mobile"}];ln=(0,Ut.y8)(ln);class dn extends o.Component{constructor(e){super(e),this.state={newslettersCount:void 0}}updateStatus=(e,t)=>{t.persist(),c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"setStatus",data:{id:Number(t.target.getAttribute("data-id")),status:e?"active":"draft"}}).done((e=>{"active"===e.data.status&&c.MailPoet.Notice.success((0,Oe.__)("Your Re-engagement Email is now activated!","mailpoet")),this.forceUpdate()})).fail((i=>{c.MailPoet.Notice.showApiErrorNotice(i),t.target.checked=!e}))};renderStatus=e=>{const t=(0,Oe._x)("%1$d sent","number of welcome emails sent","mailpoet").replace("%1$d",e.total_sent.toLocaleString());return(0,p.jsxs)("div",{children:[(0,p.jsx)(Yi.Z,{className:"mailpoet-listing-status-toggle",onCheck:this.updateStatus,"data-id":e.id,dimension:"small",defaultChecked:"active"===e.status}),(0,p.jsx)("p",{className:"mailpoet-listing-stats-description",children:(0,p.jsx)(Me.Link,{to:`/sending-status/${e.id}`,"data-automation-id":`sending_status_${e.id}`,children:t})})]})};renderSettings=e=>{if(0===e.segments.length)return(0,p.jsx)(Me.Link,{className:"mailpoet-listing-error",to:`/send/${e.id}`,children:(0,Oe.__)("You need to select a list to send to.","mailpoet")});const t=_()((0,Oe.__)("Send to %1$s","mailpoet"),"%1$s",((t,i)=>(0,p.jsxs)(o.Fragment,{children:[(0,p.jsx)(Ns.Eg,{segments:e.segments},`segment-${i}`),(0,p.jsx)(Ns.$6,{newsletter:e},`filter-segment-${i}`)]},i)));let i=(0,Oe._x)("month",'month in the sentence "1 month after inactivity"',"mailpoet");e.options.afterTimeNumber>1&&"months"===e.options.afterTimeType?i=(0,Oe._x)("months",'months in the sentence "5 months after inactivity"',"mailpoet"):e.options.afterTimeNumber>1&&"weeks"===e.options.afterTimeType?i=(0,Oe._x)("weeks",'weeks in the sentence "5 weeks after inactivity"',"mailpoet"):1===e.options.afterTimeNumber&&"weeks"===e.options.afterTimeType&&(i=(0,Oe._x)("week",'week in the sentence "1 week after inactivity"',"mailpoet"));const a=(0,Oe._x)("{$count} {$frequency} after inactivity",'example: "5 months after inactivity"',"mailpoet").replace("{$count}",e.options.afterTimeNumber).replace("{$frequency}",i);return(0,p.jsxs)("span",{children:[t,(0,p.jsxs)("div",{className:"mailpoet-listing-schedule",children:[(0,p.jsx)("div",{className:"mailpoet-listing-schedule-icon",children:(0,p.jsx)(Bs.P,{})}),a]})]})};renderItem=(e,t)=>{const i=ee()("manage-column","column-primary","has-row-actions");return(0,p.jsxs)("div",{children:[(0,p.jsxs)("td",{className:i,children:[(0,p.jsx)("a",{className:"mailpoet-listing-title",href:`?page=mailpoet-newsletter-editor&id=${e.id}`,onClick:t=>{t.preventDefault(),(0,Ut.Q2)(e)},children:e.subject}),t]}),(0,p.jsx)("td",{className:"column mailpoet-hide-on-mobile","data-colname":(0,Oe.__)("Settings","mailpoet"),children:this.renderSettings(e)}),!0===sn?(0,p.jsx)("td",{className:"column mailpoet-listing-stats-column","data-colname":(0,Oe.__)("Clicked, Opened","mailpoet"),children:(0,p.jsx)(ri,{newsletter:e,isSent:e.total_sent>0&&!!e.statistics})}):null,(0,p.jsx)("td",{className:"column","data-colname":(0,Oe.__)("Status","mailpoet"),children:this.renderStatus(e)}),(0,p.jsxs)("td",{className:"column-date mailpoet-hide-on-mobile","data-colname":(0,Oe.__)("Last modified on","mailpoet"),children:[c.MailPoet.Date.short(e.updated_at),(0,p.jsx)("br",{}),c.MailPoet.Date.time(e.updated_at)]})]})};isItemInactive=e=>"draft"===e.status;render(){return(0,p.jsxs)(p.Fragment,{children:[0===this.state.newslettersCount&&(0,p.jsx)(ii,{filter:e=>"re_engagement"===e.slug,hideScreenOptions:!1,hideClosingButton:!0}),0!==this.state.newslettersCount&&(0,p.jsx)(Ee.N,{limit:window.mailpoet_listing_per_page,location:this.props.location,params:this.props.match.params,endpoint:"newsletters",type:"re_engagement",base_url:"re_engagement",onRenderItem:this.renderItem,isItemInactive:this.isItemInactive,columns:on,bulk_actions:rn,item_actions:ln,messages:nn,auto_refresh:!0,sort_by:"updated_at",sort_order:"desc",afterGetItems:e=>{if(!e.loading){const t=e.groups.reduce(((e,t)=>e+t.count),0);this.setState({newslettersCount:t})}(0,Ut._X)(e),(0,Ut.bF)(e)}})]})}}dn.propTypes={location:Te().object.isRequired,match:Te().shape({params:Te().object}).isRequired},dn.displayName="NewsletterListReEngagement";const cn=(0,Ne.EN)((0,r.withBoundary)(dn)),mn=c.MailPoet.trackingConfig.emailTrackingEnabled,un=[{name:"subject",label:(0,Oe.__)("Subject","mailpoet")},{name:"status",label:(0,Oe.__)("Status","mailpoet")},{name:"segments",label:(0,Oe.__)("Lists","mailpoet")},{name:"statistics",label:(0,Oe.__)("Clicked, Opened","mailpoet"),display:mn},{name:"sent_at",label:(0,Oe.__)("Sent on","mailpoet"),sortable:!0}],pn={onNoItemsFound:(e,t)=>t?(0,Oe.__)("No emails found.","mailpoet"):(0,Oe.__)("Nothing here yet! But, don't fret - there's no reason to get upset. Pretty soon, you’ll be sending emails faster than a turbo-jet.","mailpoet"),onTrash:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email was moved to the trash.","mailpoet"):(0,Oe.__)("%1$d emails were moved to the trash.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onDelete:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email was permanently deleted.","mailpoet"):(0,Oe.__)("%1$d emails were permanently deleted.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onRestore:e=>{const t=Number(e.meta.count);let i=null;i=1===t?(0,Oe.__)("1 email has been restored from the Trash.","mailpoet"):(0,Oe.__)("%1$d emails have been restored from the Trash.","mailpoet").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)}},hn=[{name:"trash",label:(0,Oe.__)("Move to trash","mailpoet"),onSuccess:pn.onTrash}],gn=(0,Ut.y8)([{name:"view",link:function(e){return(0,p.jsx)("a",{href:e.preview_url,target:"_blank",rel:"noopener noreferrer",children:(0,Oe.__)("Preview","mailpoet")})}},{name:"trash",className:"mailpoet-hide-on-mobile"}]),fn=(e,t,i)=>{const a=ee()("manage-column","column-primary","has-row-actions");return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("td",{className:a,children:[(0,p.jsx)("strong",{children:(0,p.jsx)("a",{href:e.preview_url,target:"_blank",rel:"noopener noreferrer",children:e.queue.newsletter_rendered_subject||e.subject})}),t]}),(0,p.jsx)("td",{className:"column mailpoet-listing-status-column","data-colname":(0,Oe.__)("Status","mailpoet"),children:(0,p.jsx)(Es,{newsletter:e,mailerLog:i.mta_log})}),(0,p.jsxs)("td",{className:"column mailpoet-hide-on-mobile","data-colname":(0,Oe.__)("Lists","mailpoet"),children:[(0,p.jsx)(Ns.Eg,{segments:e.segments,dimension:"large"}),(0,p.jsx)(Ns.$6,{newsletter:e,dimension:"large"})]}),!0===mn?(0,p.jsx)("td",{className:"column mailpoet-listing-stats-column","data-colname":(0,Oe.__)("Clicked, Opened","mailpoet"),children:(0,p.jsx)(ri,{newsletter:e,currentTime:i.current_time})}):null,(0,p.jsx)("td",{className:"column-date mailpoet-hide-on-mobile","data-colname":(0,Oe.__)("Sent on","mailpoet"),children:e.sent_at?(0,p.jsxs)(p.Fragment,{children:[c.MailPoet.Date.short(e.sent_at),(0,p.jsx)("br",{}),c.MailPoet.Date.time(e.sent_at)]}):null})]})};function _n(e){return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Me.Link,{className:"mailpoet-button button button-secondary button-small",to:"/notification",children:(0,Oe.__)("Back to Post notifications","mailpoet")}),(0,p.jsx)(Ee.N,{limit:window.mailpoet_listing_per_page,location:e.location,params:{...e.match.params,parentId:e.parentId},endpoint:"newsletters",type:"notification_history",base_url:"notification/history/:parentId",onRenderItem:fn,columns:un,messages:pn,item_actions:gn,bulk_actions:hn,auto_refresh:!0,sort_by:"sent_at",sort_order:"desc",afterGetItems:e=>{(0,Ut._X)(e),(0,Ut.bF)(e)}})]})}_n.propTypes={parentId:Te().string.isRequired,location:Te().shape({pathname:Te().string}).isRequired,match:Te().shape({params:Te().shape({id:Te().node}).isRequired}).isRequired},_n.displayName="NewsletterListNotificationHistory";const bn=(0,Ne.EN)((0,r.withBoundary)(_n)),xn=[{name:"subscriber_id",label:(0,Oe.__)("Subscriber","mailpoet"),sortable:!0},{name:"status",label:(0,Oe._x)("Sending status","an email sending status: unprocessed, sent or failed.","mailpoet")},{name:"failureReason",label:(0,Oe.__)("Failure reason (if applicable)","mailpoet")}],vn={onNoItemsFound:()=>(0,Oe.__)("No sending task found.","mailpoet")};function yn(e){const[t,i]=(0,o.useState)({id:e.match.params.id,subject:"",sent:!1});return(0,o.useEffect)((()=>{c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"get",data:{id:t.id}}).done((e=>i({id:t.id,subject:e.data.subject,sent:null!==e.data.sent_at}))).fail((e=>c.MailPoet.Notice.showApiErrorNotice(e)))}),[t.id]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("h1",{children:(0,Oe._x)("Sending status","Page title. This page displays a list of emails along with their sending status: unprocessed, sent or failed.","mailpoet")}),(0,p.jsx)(Pn,{newsletter:t}),(0,p.jsx)(Sn,{location:e.location,params:e.match.params})]})}yn.propTypes={location:Te().shape({pathname:Te().string}).isRequired,match:Te().shape({params:Te().shape({id:Te().string.isRequired}).isRequired}).isRequired},yn.displayName="SendingStatus";const jn=(e,t)=>e.location.pathname===t.location.pathname&&e.params.id===t.params.id,wn=e=>(0,p.jsx)("div",{children:(0,p.jsx)(Mn,{...e})}),Sn=(0,o.memo)((e=>{let{location:t,params:i}=e;return(0,p.jsx)(Ee.N,{limit:window.mailpoet_listing_per_page,location:t,params:i,endpoint:"sending_task_subscribers",base_url:"sending-status/:id",onRenderItem:wn,getListingItemKey:e=>`${e.taskId}-${e.subscriberId}`,columns:xn,messages:vn,auto_refresh:!0,sort_by:"failed",sort_order:"desc",afterGetItems:e=>{(0,Ut._X)(e),(0,Ut.bF)(e)}})}),jn);function Pn(e){let{newsletter:t}=e;return t.id&&t.subject&&t.sent?(0,p.jsx)("p",{children:(0,p.jsx)(Me.Link,{to:`/stats/${t.id}`,children:t.subject})}):null}function Mn(e){let{error:t,failed:i,taskId:a,processed:s,email:n,subscriberId:o,lastName:r,firstName:l}=e;const d=ee()("manage-column","column-primary","has-row-actions");let m=(0,Oe._x)("Unprocessed","status when the sending of a newsletter has not been processed","mailpoet");return s&&(m=i?(0,p.jsxs)("span",{children:[(0,Oe._x)("Failed","status when the sending of a newsletter has failed","mailpoet"),(0,p.jsx)("br",{}),(0,p.jsx)("a",{className:"button",href:"#",onClick:e=>{e.preventDefault(),c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"sending_task_subscribers",action:"resend",data:{taskId:a,subscriberId:o}}).done((()=>window.mailpoet_listing.forceUpdate())).fail((e=>c.MailPoet.Notice.showApiErrorNotice(e)))},children:(0,Oe.__)("Resend","mailpoet")})]}):(0,Oe._x)("Sent","status when a newsletter has been sent","mailpoet")),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("td",{"data-automation-id":`name_${a}_${o}`,className:d,children:[(0,p.jsx)("a",{className:"mailpoet-listing-title",href:`admin.php?page=mailpoet-subscribers#/edit/${o}`,children:n}),(0,p.jsx)("div",{className:"mailpoet-listing-subtitle",children:`${l} ${r}`})]}),(0,p.jsx)("td",{className:"column","data-automation-id":`status_${a}_${o}`,"data-colname":(0,Oe._x)("Sending status","an email sending status: unprocessed, sent or failed.","mailpoet"),children:m}),(0,p.jsx)("td",{className:"column","data-automation-id":`error_${a}_${o}`,"data-colname":(0,Oe.__)("Failure reason (if applicable)","mailpoet"),children:t})]})}Sn.propTypes={location:Te().shape({pathname:Te().string}).isRequired,params:Te().shape({id:Te().string.isRequired}).isRequired},Pn.propTypes={newsletter:Te().shape({id:Te().string,subject:Te().string,sent:Te().bool})},Pn.defaultProps={newsletter:{id:null,subject:null,sent:!1}},Mn.propTypes={error:Te().string,email:Te().string.isRequired,failed:Te().number.isRequired,taskId:Te().number.isRequired,lastName:Te().string.isRequired,firstName:Te().string.isRequired,processed:Te().number.isRequired,subscriberId:Te().number.isRequired},Mn.defaultProps={error:""},Mn.displayName="ListingItem",yn.displayName="SendingStatus";var Nn=i(23584),In=i(52249),kn=i(23064),Cn=i.n(kn);function Tn(e){const t=e.installedDaysAgo,i=t>30?c.MailPoet.I18n.t("reviewRequestUsingForMonths").replace("[months]",Math.round(t/30)):c.MailPoet.I18n.t("reviewRequestUsingForDays").replace("[days]",t);return(0,p.jsxs)("div",{className:"mailpoet_review_request",children:[(0,p.jsx)("img",{src:e.reviewRequestIllustrationUrl,height:"280",width:"280",alt:""}),(0,p.jsx)("h2",{children:c.MailPoet.I18n.t("reviewRequestHeading")}),(0,p.jsx)("p",{children:c.MailPoet.I18n.t("reviewRequestDidYouKnow").replace("[username]",e.username)}),(0,p.jsx)("p",{children:i}),(0,p.jsx)("p",{children:(0,p.jsx)("a",{href:"http://bit.ly/2Bi124o",target:"_blank",rel:"noopener noreferrer",className:"button button-primary",children:c.MailPoet.I18n.t("reviewRequestRateUsNow")})}),(0,p.jsx)("p",{children:(0,p.jsx)("a",{id:"mailpoet_review_request_not_now",children:c.MailPoet.I18n.t("reviewRequestNotNow")})})]})}Tn.propTypes={installedDaysAgo:Te().number.isRequired,reviewRequestIllustrationUrl:Te().string.isRequired,username:Te().string.isRequired};const En=()=>((0,o.useLayoutEffect)((()=>{window.mailpoet_display_nps_poll&&c.MailPoet.libs3rdPartyEnabled&&(Xa||(Xa=c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"analytics",action:"getTrackingData"})),Xa).then((e=>{let{data:t}=e;return(e=>{let t;t=window.mailpoet_display_nps_form?"EqOgKsgZd832Sz9w":window.mailpoet_is_new_user?"6L479eVPXk7pBn6S":"k0aJAsQAWI2ERyGv",Cn()({writeKey:t,userId:window.mailpoet_current_wp_user.ID+window.mailpoet_site_url,traits:{name:window.mailpoet_current_wp_user.user_nicename,email:window.mailpoet_current_wp_user.user_email,mailpoetVersion:window.mailpoet_version,mailpoetPremiumIsActive:window.mailpoet_premium_active,createdAt:e.installedAtIso,newslettersSent:e.newslettersSent,welcomeEmails:e.welcomeEmails,postnotificationEmails:e.postnotificationEmails,woocommerceEmails:e.woocommerceEmails,subscribers:e.subscribers,lists:e.lists,sendingMethod:e.sendingMethod,woocommerceIsInstalled:e.woocommerceIsInstalled},events:{submit:e=>{e.rating>=9&&e.completed&&c.MailPoet.Modal.popup({width:800,template:In.renderToString(Tn({username:window.mailpoet_current_wp_user_firstname||window.mailpoet_current_wp_user.user_login,reviewRequestIllustrationUrl:window.mailpoet_review_request_illustration_url,installedDaysAgo:window.mailpoet_installed_days_ago})),onInit:()=>{document.getElementById("mailpoet_review_request_not_now").addEventListener("click",(()=>c.MailPoet.Modal.close()))}})}}})})(t)}))}),[]),null),An=e=>function(t){return En(),(0,p.jsx)(e,{...t})};function Rn(){return(0,p.jsx)(d.Q,{children:(0,p.jsxs)(Me.Link,{id:"mailpoet-new-email",className:"mailpoet-button button-secondary",to:"/new",onClick:()=>c.MailPoet.trackEvent("Emails > Add New"),"data-automation-id":"new_email",children:[$e.R,(0,p.jsx)("span",{children:(0,Oe.__)("New email","mailpoet")})]})})}function On(e){let{children:t,location:i}=e;return null!==(0,_i.X)(i)||(e=>e.hash.match(/^#\/new/)||e.pathname.match(/^\/new/))(i)?null:t}On.propTypes={location:Te().string.isRequired,children:Te().node.isRequired};const Ln=(0,Ne.EN)(On);function Fn(){return(0,p.jsx)("style",{dangerouslySetInnerHTML:{__html:".wrap { margin: 0 !important; }"}})}var Dn=i(23535),qn=i(59355),$n=i(99983);const Bn=20,Wn=5,Vn=5,Un=5,Hn=100,zn=e=>{const t=e<.1?2:1;return c.MailPoet.Num.toLocaleFixed(e,t)},Zn=e=>+(+e).toFixed(1);function Yn(e){let{newsletter:t,isWoocommerceActive:i}=e;const a=t.total_sent||0;let s=0,n=0,o=0,r=0,l=0;a>0&&(s=100*t.statistics.clicked/a,n=100*t.statistics.opened/a,o=100*t.statistics.machineOpened/a,r=100*t.statistics.unsubscribed/a,l=100*t.statistics.bounced/a);const d=zn(s),c=zn(n),m=zn(o),u=zn(r),h=zn(l),g=a>=Bn&&t.statistics.opened>=Wn,f=t.statistics.unsubscribed>=Vn&&a>=Hn,b=t.statistics.bounced>=Un&&a>=Hn,x=(0,$n.y)("opened",n)||"",v=(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"mailpoet-statistics-value-small",children:[(0,p.jsxs)("span",{className:`mailpoet-statistics-value-number mailpoet-statistics-value-number-${x}`,children:[c,"% "]}),(0,Oe._x)("opened","Percentage of subscribers that opened a newsletter link","mailpoet")]}),g&&(0,p.jsx)($n.$,{isInverted:!1,stat:"opened",rate:n,tooltipId:`opened-${t.id||"0"}`,tooltipPlace:"right"})]}),y=(0,p.jsxs)("div",{className:"mailpoet-statistics-value-small",children:[(0,p.jsxs)("span",{className:"mailpoet-statistics-value-number",children:[m,"% "]}),(0,Oe._x)("machine-opened","Percentage of newsletters that were opened by a machine","mailpoet"),(0,p.jsx)(De.Tooltip,{tooltip:_()((0,Oe.__)("A machine-opened email is an email opened by a computer in the background without the user’s explicit request or knowledge. [link]Read more[/link]","mailpoet"),/\[link](.*?)\[\/link]/,(e=>(0,p.jsx)("span",{style:{pointerEvents:"all"},children:(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/368-what-are-machine-opens",target:"_blank",rel:"noopener noreferrer",children:e},"kb-link")},"machine-opened-tooltip")))})]}),j=Zn(r),w=f?(0,$n.y)("unsubscribed",j):"",S=(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"mailpoet-statistics-value-small",children:[(0,p.jsxs)("span",{className:`mailpoet-statistics-value-number mailpoet-statistics-value-number-${w}`,children:[u,"% "]}),(0,Oe._x)("unsubscribed","Percentage of subscribers that unsubscribed from a newsletter","mailpoet")]}),f&&(0,p.jsx)($n.$,{isInverted:!1,stat:"unsubscribed",rate:j,tooltipId:`unsubscribed-${t.id||"0"}`,tooltipPlace:"right"})]}),P=Zn(l),M=b?(0,$n.y)("bounced",P):"",N=(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"mailpoet-statistics-value-small",children:[(0,p.jsxs)("span",{className:`mailpoet-statistics-value-number mailpoet-statistics-value-number-${M}`,children:[h,"% "]}),(0,Oe._x)("bounced","Percentage of subscribers that bounced from a newsletter","mailpoet")]}),b&&(0,p.jsx)($n.$,{isInverted:!1,stat:"bounced",rate:P,tooltipId:`bounced-${t.id||"0"}`,tooltipPlace:"right"})]}),I=(0,$n.y)("clicked",s),k=(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"mailpoet-statistics-value",children:[(0,p.jsxs)("span",{className:`mailpoet-statistics-value-number mailpoet-statistics-value-number-${I}`,children:[d,"% "]}),(0,Oe._x)("clicked","Percentage of subscribers that clicked a newsletter link","mailpoet")]}),g&&(0,p.jsx)($n.$,{isInverted:!1,stat:"clicked",rate:s,tooltipId:`clicked-${t.id||"0"}`,tooltipPlace:"right"})]});return(0,p.jsxs)("div",{className:"mailpoet-stats-general",children:[(0,p.jsxs)(ki.Grid.ThreeColumns,{className:"mailpoet-stats-general-top-row",children:[(0,p.jsx)("div",{children:(0,p.jsxs)("div",{className:"mailpoet-statistics-value-small",children:[(0,Oe.__)("Sent to","mailpoet"),": ",(0,p.jsx)("span",{className:"mailpoet-statistics-value-number",children:a.toLocaleString()})]})}),(0,p.jsx)("div",{className:"mailpoet-statistics-with-left-separator",children:S}),(0,p.jsx)("div",{className:"mailpoet-statistics-with-left-separator",children:N})]}),(0,p.jsxs)(ki.Grid.ThreeColumns,{children:[(0,p.jsx)("div",{children:k}),(0,p.jsxs)("div",{className:"mailpoet-statistics-with-left-separator",children:[v,y]}),i&&(0,p.jsx)("div",{className:"mailpoet-statistics-with-left-separator",children:Ot.Hooks.applyFilters("mailpoet_newsletters_revenues_stats",null,t.statistics.revenue)}),!i&&(0,p.jsx)("div",{})]}),(0,p.jsx)("p",{className:"mailpoet-stats-general-read-more",children:(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/190-whats-a-good-email-open-rate",target:"_blank",rel:"noopener noreferrer",children:(0,Oe.__)("Read more on stats.","mailpoet")})})]})}function Gn(e){let{newsletter:t}=e;const i=t.queue.scheduled_at||t.queue.created_at;return(0,p.jsxs)(ki.Grid.ThreeColumns,{className:"mailpoet-stats-info",children:[(0,p.jsxs)("div",{className:"mailpoet-grid-span-two-columns",children:[(0,p.jsx)(bt.X,{level:1,children:t.subject}),(0,p.jsx)("div",{children:(0,p.jsxs)("b",{children:[c.MailPoet.Date.short(i)," • ",c.MailPoet.Date.time(i)]})}),Array.isArray(t.segments)&&t.segments.length&&(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{className:"mailpoet-stats-info-key",children:(0,Oe.__)("To","mailpoet")}),": ",(0,p.jsx)(r.SegmentTags,{dimension:"large",segments:t.segments}),(0,p.jsx)(r.FilterSegmentTag,{newsletter:t,dimension:"large"})]})]}),(0,p.jsxs)("div",{className:"mailpoet-stats-info-sender-preview",children:[(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{className:"mailpoet-stats-info-key-value",children:[(0,p.jsxs)("span",{className:"mailpoet-stats-info-key",children:[(0,Oe.__)("From","mailpoet"),": "]}),t.sender_address?t.sender_address:"-"]}),(0,p.jsxs)("div",{className:"mailpoet-stats-info-key-value",children:[(0,p.jsxs)("span",{className:"mailpoet-stats-info-key",children:[(0,Oe.__)("Reply-to","mailpoet"),": "]}),t.reply_to_address?t.reply_to_address:"-"]}),(0,p.jsxs)("div",{className:"mailpoet-stats-info-key-value",children:[(0,p.jsxs)("span",{className:"mailpoet-stats-info-key",children:[(0,Oe.__)("GA campaign","mailpoet"),": "]}),t.ga_campaign?t.ga_campaign:"-"]})]}),(0,p.jsx)("div",{children:(0,p.jsx)(r.Button,{href:t.preview_url,target:"_blank",rel:"noopener noreferrer",children:(0,Oe.__)("Preview","mailpoet")})})]})]})}Yn.displayName="NewsletterGeneralStats",Gn.displayName="NewsletterStatsInfo";var Kn=i(83393);const{subscribersLimitReached:Qn,subscribersLimit:Xn,subscribersCount:Jn,premiumActive:eo,hasValidApiKey:to,hasValidPremiumKey:io,isPremiumPluginInstalled:ao,pluginPartialKey:so}=c.MailPoet,no=to||io,oo=e=>(0,p.jsx)("p",{children:_()(e,/(\[subscribersCount]|\[subscribersLimit])/g,(e=>"[subscribersCount]"===e?Jn:Xn))}),ro=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"_blank";return(0,p.jsx)(Le.z,{href:t,target:i,rel:"noopener noreferrer",children:e})},lo=e=>(0,p.jsx)(Kn.yM,{buttonText:e});function co(e){let t,i,{message:a,actionButton:s}=e;if(!io||ao&&eo)if(Qn){t=oo((0,Oe.__)("Congratulations, you now have [subscribersCount] subscribers! Your plan is limited to [subscribersLimit] subscribers. You need to upgrade now to be able to continue using MailPoet.","mailpoet"));const e=no?c.MailPoet.MailPoetComUrlFactory.getUpgradeUrl(so):c.MailPoet.MailPoetComUrlFactory.getPurchasePlanUrl(+Jn+1,null,null,null);i=ro((0,Oe.__)("Upgrade your plan","mailpoet"),e)}else t=a,i=s;else t=oo((0,Oe.__)("Your current MailPoet plan includes advanced features, but they require the MailPoet Premium plugin to be installed and activated.","mailpoet")),i=lo(ao?(0,Oe.__)("Activate MailPoet Premium plugin","mailpoet"):(0,Oe.__)("Download MailPoet Premium plugin","mailpoet"));return(0,p.jsx)(Lt.K,{title:(0,Oe.__)("This is a Premium feature","mailpoet"),message:t,actionButton:i})}function mo(){const e=(0,p.jsx)(Le.z,{href:c.MailPoet.MailPoetComUrlFactory.getPurchasePlanUrl(c.MailPoet.subscribersCount,c.MailPoet.currentWpUserEmail,"starter",{utm_medium:"stats",utm_campaign:"signup"}),target:"_blank",rel:"noopener noreferrer",children:(0,Oe.__)("Upgrade","mailpoet")}),t=(0,p.jsxs)("p",{children:[(0,Oe.__)("Learn more about your subscribers and optimize your campaigns. See who opened your emails, which links they clicked, and then use the data to make your emails even better. And if you run a WooCommerce store, you’ll also see the revenue earned per email. All starting $10 per month.","mailpoet")," ",(0,p.jsx)("a",{href:"admin.php?page=mailpoet-upgrade",children:(0,Oe.__)("Learn more","mailpoet")}),"."]});return(0,p.jsx)("div",{className:"mailpoet-stats-premium-required",children:(0,p.jsx)(co,{message:t,actionButton:e})})}function uo(){if(!window.mailpoet_display_detailed_stats)return(0,p.jsx)(mo,{});if(window.mailpoet_subscribers_limit_reached){const e=window.mailpoet_has_valid_api_key,t=(0,Oe.__)("Upgrade required","mailpoet"),i=e?(0,Oe.__)("Congratulations, you now have [subscribersCount] subscribers! Your plan is limited to [subscribersLimit] subscribers. You need to upgrade now to be able to continue using MailPoet.","mailpoet"):(0,Oe.__)("Congratulations, you now have [subscribersCount] subscribers! Our free version is limited to [subscribersLimit] subscribers. You need to upgrade now to be able to continue using MailPoet.","mailpoet").replace("[subscribersLimit]",c.MailPoet.subscribersLimit.toString()).replace("[subscribersCount]",c.MailPoet.subscribersCount.toString()),a=e?c.MailPoet.MailPoetComUrlFactory.getUpgradeUrl(c.MailPoet.pluginPartialKey):c.MailPoet.MailPoetComUrlFactory.getPurchasePlanUrl(window.mailpoet_subscribers_count+1);return(0,p.jsx)("div",{className:"mailpoet-stats-premium-required",children:(0,p.jsx)(Lt.K,{title:t,message:(0,p.jsx)("p",{children:i}),actionButton:(0,p.jsx)(Le.z,{target:"_blank",rel:"noopener noreferrer",href:a,children:(0,Oe.__)("Upgrade Now","mailpoet")})})})}return null}uo.displayName="PremiumBanner";const po=(0,r.withBoundary)(uo);function ho(e){let{match:t,history:i,location:a}=e;const[s,n]=(0,o.useState)({item:void 0,loading:!0}),l=(0,o.useCallback)((e=>{n({loading:!0,item:s.item}),c.MailPoet.Modal.loading(!0),c.MailPoet.Ajax.post({api_version:c.MailPoet.apiVersion,endpoint:window.mailpoet_display_detailed_stats?"stats":"newsletters",action:window.mailpoet_display_detailed_stats?"get":"getWithStats",data:{id:e}}).always((()=>{c.MailPoet.Modal.loading(!1)})).done((e=>{n({loading:!1,item:e.data})})).fail((e=>{c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0}),n({loading:!1}),i.push("/")}))}),[i,s.item]);(0,o.useEffect)((()=>{window.scrollTo(0,0),s.item?.id!==t.params.id&&l(t.params.id)}),[t.params.id,l,s.item]);const{item:m,loading:u}=s,h=m;return u?null:h?.subject&&!h?.queue?(0,p.jsx)("div",{children:(0,p.jsx)(bt.X,{level:1,children:h.subject})}):h?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(St.B,{}),(0,p.jsx)(Fn,{}),(0,p.jsx)(d.Q,{}),(0,p.jsxs)("div",{className:"mailpoet-stats-page",children:[(0,p.jsx)(w,{}),(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(Gn,{newsletter:h})}),(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(Yn,{newsletter:h,isWoocommerceActive:c.MailPoet.isWoocommerceActive})}),(0,p.jsxs)(Dn.m,{activeKey:"clicked",children:[(0,p.jsx)(qn.O,{title:(0,Oe.__)("Clicked Links","mailpoet"),children:Ot.Hooks.applyFilters("mailpoet_newsletters_clicked_links_table",(0,p.jsx)(po,{}),h.clicked_links)},"clicked"),Ot.Hooks.applyFilters("mailpoet_newsletters_purchased_products",null,h),(0,p.jsx)(qn.O,{title:(0,Oe.__)("Subscriber Engagement","mailpoet"),automationId:"engagement-tab",children:Ot.Hooks.applyFilters("mailpoet_newsletters_subscriber_engagement",(0,p.jsx)(po,{}),a,t.params,h)},"engagement"),(0,p.jsx)(qn.O,{title:(0,Oe._x)("Bounces","A tab title for the list of bounces (w.wiki/45Qc)","mailpoet"),automationId:"bounces-tab",children:Ot.Hooks.applyFilters("mailpoet_newsletters_bounces",(0,p.jsx)(po,{}),a,t.params)},"bounces")]})]})]}):(0,p.jsxs)("h3",{children:[" ",(0,Oe.__)("This email does not exist.","mailpoet")," "]})}ho.displayName="CampaignStatsPage";const go=(0,Ne.EN)(ho);function fo(e){let{newsletters:t}=e;return(0,p.jsxs)(u.q,{type:"error",timeout:!1,closable:!1,renderInPlace:!0,children:[(0,p.jsx)("h3",{children:(0,Oe.__)("Paused emails","mailpoet")}),(0,p.jsx)("p",{children:(0,Oe.__)("There was problem sending the following email(s), please fix the issues described for each email and resume.","mailpoet")}),(0,p.jsx)("ul",{children:t.map((e=>{let{id:t,subject:i}=e;return(0,p.jsx)("li",{children:i},t)}))})]})}fo.displayName="CorruptEmailNotice";const _o=window.mailpoet_woocommerce_automatic_emails||[],bo=An((()=>{const{parentId:e}=(0,Ne.UO)();return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Ln,{children:(0,p.jsx)(Rn,{})}),c.MailPoet.corrupt_newsletters.length>0&&(0,p.jsx)(fo,{newsletters:c.MailPoet.corrupt_newsletters}),(0,p.jsxs)(Nn.t,{activeKey:"standard",routerType:"switch-only",onSwitch:e=>(e=>c.MailPoet.trackEvent(`Tab Emails > ${e} clicked`))(e),automationId:"newsletters_listing_tabs",children:[(0,p.jsx)(r.Tab,{route:"standard/(.*)?",title:(0,Oe.__)("Newsletters","mailpoet"),automationId:`tab-${(0,Oe.__)("Newsletters","mailpoet")}`,children:(0,p.jsx)($s,{})},"standard"),(0,p.jsx)(r.Tab,{route:"welcome/(.*)?",title:(0,Oe.__)("Welcome Emails","mailpoet"),automationId:`tab-${(0,Oe.__)("Welcome Emails","mailpoet")}`,children:(0,p.jsx)(Ks,{})},"welcome"),(0,p.jsx)(r.Tab,{route:"notification/(.*)?",title:(0,Oe.__)("Post Notifications","mailpoet"),automationId:`tab-${(0,Oe.__)("Post Notifications","mailpoet")}`,children:e?(0,p.jsx)(bn,{parentId:e}):(0,p.jsx)(an,{})},"notification"),(0,p.jsx)(r.Tab,{route:"re_engagement/(.*)?",title:(0,Oe.__)("Re-engagement Emails","mailpoet"),automationId:`tab-${(0,Oe.__)("Re-engagement Emails","mailpoet")}`,children:(0,p.jsx)(cn,{})},"re_engagement"),window.mailpoet_woocommerce_active&&!c.MailPoet.hideAutomations&&rt.default.map(_o,(e=>(0,p.jsx)(r.Tab,{route:`${e.slug}/(.*)?`,title:e.title,automationId:`tab-${e.title}`,children:(0,p.jsx)(gi,{})},e.slug)))]})]})}));function xo(e){let{history:t}=e;return(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(ii,{history:t,hideClosingButton:0===window.mailpoet_newsletters_count})})}bo.displayName="NewsletterTabs",xo.propTypes={history:Te().shape({push:Te().func.isRequired}).isRequired},xo.displayName="NewNewsletter";const vo=[...(()=>{const e=[];return rt.default.each(_o,(t=>{e.push({path:`/${t.slug}/(.*)?`,component:(0,r.withBoundary)(bo)});const{events:i}=t;rt.default.isObject(i)&&rt.default.each(i,(i=>{e.push({path:`/new/${t.slug}/${i.slug}/conditions`,render:e=>{const a={...e,email:t,name:i.slug};return(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(Ms,{...a})})}})})),e.push({path:`/new/${t.slug}`,render:e=>{const i={...e,email:t};return(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(Yt,{...i})})}})})),e})(),{path:"/notification/history/:parentId/(.*)?",render:(0,r.withBoundary)(bo)},{path:"/(standard|welcome|notification|re_engagement)/(.*)?",render:(0,r.withBoundary)(bo)},{path:"/new/standard",render:(0,r.withBoundary)(xs)},{path:"/new/notification",render:(0,r.withBoundary)(js)},{path:"/new/welcome",render:(0,r.withBoundary)(Ss)},{path:"/new/re-engagement",render:(0,r.withBoundary)(Ps)},{path:"/new",render:(0,r.withBoundary)(xo)},{name:"template",path:"/template/:id",render:(0,r.withBoundary)(Si)},{path:"/send/congratulate/:id",render:(0,r.withBoundary)(_s)},{path:"/send/:id",render:(0,r.withBoundary)(os)},{path:"/sending-status/:id/(.*)?",render:(0,r.withBoundary)(yn)},{path:"/stats/:id/(.*)?",render:(0,r.withBoundary)(go)}];function yo(){return(0,p.jsx)(l.k.Provider,{value:(0,l.S)(window),children:(0,p.jsxs)(Me.HashRouter,{children:[(0,p.jsx)(m.w,{}),(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(h,{mailpoetInstalledDaysAgo:c.MailPoet.installedDaysAgo,sendTransactionalEmails:c.MailPoet.transactionalEmailsEnabled,mtaMethod:c.MailPoet.mtaMethod,apiVersion:c.MailPoet.apiVersion,noticeDismissed:c.MailPoet.transactionalEmailsOptInNoticeDismissed})}),(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(w,{})}),(0,p.jsxs)(Ne.rs,{children:[(0,p.jsx)(Ne.AW,{exact:!0,path:"/",render:()=>(0,p.jsx)(Ne.l_,{to:0===window.mailpoet_newsletters_count?"/new":"/standard"})}),vo.map((e=>(0,p.jsx)(Ne.AW,{path:e.path,component:e.component,name:e.name||null,data:e.data||null,render:e.render},e.path)))]})]})})}const jo=document.getElementById("newsletters_container");jo&&((0,r.registerTranslations)(),window.mailpoet_listing=n.render((0,p.jsx)(yo,{}),jo));var wo=i(7969),So=i(36657);function Po(e){let{segmentType:t}=e;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(d.Q,{children:["static"===t&&(0,p.jsxs)(Me.Link,{className:"mailpoet-button button-secondary",to:"/new","data-automation-id":"new-list",children:[$e.R,(0,p.jsx)("span",{children:c.MailPoet.I18n.t("new")})]}),"dynamic"===t&&(0,p.jsxs)(Me.Link,{className:"mailpoet-button button-secondary",to:So.$W,"data-automation-id":"new-segment",children:[$e.R,(0,p.jsx)("span",{children:c.MailPoet.I18n.t("newSegment")})]})]}),(0,p.jsx)(qe,{subscribersInPlan:c.MailPoet.subscribersCount,subscribersInPlanLimit:c.MailPoet.subscribersLimit}),(0,p.jsx)(Fe,{cacheCalculation:window.mailpoet_subscribers_counts_cache_created_at}),(0,p.jsx)(w,{})]})}const Mo=e=>"wp_users"===e.type,No=e=>"woocommerce_users"===e.type,Io=e=>Mo(e)||No(e),ko=c.MailPoet.trackingConfig.emailTrackingEnabled,Co=[{name:"name",label:c.MailPoet.I18n.t("name"),sortable:!0},{name:"description",label:c.MailPoet.I18n.t("description")},{name:"average_subscriber_score",label:c.MailPoet.I18n.t("listScore"),display:ko},{name:"subscribed",label:c.MailPoet.I18n.t("subscribed"),className:"mailpoet-listing-column-narrow"},{name:"unconfirmed",label:c.MailPoet.I18n.t("unconfirmed"),className:"mailpoet-listing-column-narrow"},{name:"unsubscribed",label:c.MailPoet.I18n.t("unsubscribed"),className:"mailpoet-listing-column-narrow"},{name:"inactive",label:c.MailPoet.I18n.t("inactive"),className:"mailpoet-listing-column-narrow"},{name:"bounced",label:c.MailPoet.I18n.t("bounced"),className:"mailpoet-listing-column-narrow"},{name:"created_at",label:c.MailPoet.I18n.t("createdOn"),sortable:!0}],To={onTrash:e=>{const t=Number(e.meta.count);let i=null;i=1===t?c.MailPoet.I18n.t("oneSegmentTrashed"):c.MailPoet.I18n.t("multipleSegmentsTrashed").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onDelete:e=>{const t=Number(e.meta.count);let i=null;i=1===t?c.MailPoet.I18n.t("oneSegmentDeleted"):c.MailPoet.I18n.t("multipleSegmentsDeleted").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onRestore:e=>{const t=Number(e.meta.count);let i=null;i=1===t?c.MailPoet.I18n.t("oneSegmentRestored"):c.MailPoet.I18n.t("multipleSegmentsRestored").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)}},Eo=[{name:"trash",label:c.MailPoet.I18n.t("moveToTrash"),onSuccess:To.onTrash}],Ao=e=>!Io(e),Ro=[{name:"edit",className:"mailpoet-hide-on-mobile",link:function(e){return(0,p.jsx)(Me.Link,{to:`/edit/${e.id}`,children:c.MailPoet.I18n.t("edit")})},display:function(e){return!Io(e)}},{name:"duplicate_segment",className:"mailpoet-hide-on-mobile",label:c.MailPoet.I18n.t("duplicate"),onClick:(e,t)=>c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"segments",action:"duplicate",data:{id:e.id}}).done((e=>{c.MailPoet.Notice.success(c.MailPoet.I18n.t("listDuplicated").replace("%1$s",(0,wo.r)(e.data.name))),t()})).fail((e=>{c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0})})),display:function(e){return!Io(e)}},{name:"read_more",className:"mailpoet-hide-on-mobile",link:function(){return(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/133-the-wordpress-users-list",target:"_blank",rel:"noopener noreferrer",children:c.MailPoet.I18n.t("readMore")})},display:function(e){return Mo(e)}},{name:"synchronize_segment",label:c.MailPoet.I18n.t("forceSync"),onClick:async function(e,t){c.MailPoet.Modal.loading(!0),await c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"segments",action:"synchronize",data:{type:e.type}}).done((()=>{let i=c.MailPoet.I18n.t("listSynchronized").replace("%1$s",e.name);"woocommerce_users"===e.type&&(i=c.MailPoet.I18n.t("listSynchronizationWasScheduled").replace("%1$s",e.name)),c.MailPoet.Modal.loading(!1),c.MailPoet.Notice.success(i),t()})).fail((e=>{c.MailPoet.Modal.loading(!1),e.errors.length>0&&c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0})}))},display:function(e){return Mo(e)||No(e)}},{name:"view_subscribers",link:function(e){return(0,p.jsx)("a",{href:e.subscribers_url,"data-automation-id":`view_subscribers_${e.name}`,children:c.MailPoet.I18n.t("viewSubscribers")})}},{name:"trash",className:"mailpoet-hide-on-mobile",display:function(e){return!No(e)}}];class Oo extends o.Component{renderItem=(e,t)=>{const i=ee()("manage-column","column-primary","has-row-actions"),a=Number(e.subscribers_count.subscribed||0),s=Number(e.subscribers_count.unconfirmed||0),n=Number(e.subscribers_count.unsubscribed||0),o=Number(e.subscribers_count.inactive||0),r=Number(e.subscribers_count.bounced||0);let l;return l=Io(e)?(0,p.jsx)("span",{className:"mailpoet-listing-title",children:(0,wo.r)(e.name)}):(0,p.jsx)(Me.Link,{className:"mailpoet-listing-title",to:`/edit/${e.id}`,children:(0,wo.r)(e.name)}),(0,p.jsxs)("div",{children:[(0,p.jsxs)("td",{className:i,"data-automation-id":`segment_name_${(0,wo.kb)(e.name)}`,children:[l,t]}),(0,p.jsx)("td",{"data-colname":c.MailPoet.I18n.t("description"),children:(0,p.jsx)("abbr",{children:(0,wo.r)(e.description)})}),ko?(0,p.jsx)("td",{className:"column mailpoet-listing-stats-column","data-colname":c.MailPoet.I18n.t("averageScore"),children:(0,p.jsx)("div",{className:"mailpoet-listing-stats",children:(0,p.jsx)(fe,{id:e.id,engagementScore:e.average_engagement_score})})}):null,(0,p.jsx)("td",{className:"mailpoet-hide-on-mobile","data-colname":c.MailPoet.I18n.t("subscribed"),children:(0,p.jsx)("abbr",{children:a.toLocaleString()})}),(0,p.jsx)("td",{className:"mailpoet-hide-on-mobile","data-colname":c.MailPoet.I18n.t("unconfirmed"),children:(0,p.jsx)("abbr",{children:s.toLocaleString()})}),(0,p.jsx)("td",{className:"mailpoet-hide-on-mobile","data-colname":c.MailPoet.I18n.t("unsubscribed"),children:(0,p.jsx)("abbr",{children:n.toLocaleString()})}),(0,p.jsx)("td",{className:"mailpoet-hide-on-mobile","data-colname":c.MailPoet.I18n.t("inactive"),children:(0,p.jsx)("abbr",{children:o.toLocaleString()})}),(0,p.jsx)("td",{className:"mailpoet-hide-on-mobile","data-colname":c.MailPoet.I18n.t("bounced"),children:(0,p.jsx)("abbr",{children:r.toLocaleString()})}),(0,p.jsxs)("td",{className:"column-date mailpoet-hide-on-mobile","data-colname":c.MailPoet.I18n.t("createdOn"),children:[c.MailPoet.Date.short(e.created_at),(0,p.jsx)("br",{}),c.MailPoet.Date.time(e.created_at)]})]})};render(){return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Po,{segmentType:"static"}),(0,p.jsx)("div",{className:"mailpoet-segments-listing",children:(0,p.jsx)(Ee.N,{limit:window.mailpoet_listing_per_page,location:this.props.location,params:this.props.match.params,messages:To,search:!1,endpoint:"segments",base_url:"lists",onRenderItem:this.renderItem,columns:Co,bulk_actions:Eo,item_actions:Ro,sort_by:"name",sort_order:"asc",isItemDeletable:Ao,isItemToggleable:Mo})})]})}}const Lo=(0,Ne.EN)(Oo),Fo=[{name:"name",label:c.MailPoet.I18n.t("name"),type:"text"},{name:"description",label:c.MailPoet.I18n.t("description"),type:"textarea",tip:c.MailPoet.I18n.t("segmentDescriptionTip")},{name:"showInManageSubscriptionPage",label:c.MailPoet.I18n.t("showInManageSubscriptionPage"),type:"checkbox",values:{showInManageSubscriptionPage:c.MailPoet.I18n.t("showInManageSubscriptionPageTip")},isChecked:!0}],Do={onUpdate:function(){c.MailPoet.Notice.success(c.MailPoet.I18n.t("segmentUpdated"))},onCreate:function(){c.MailPoet.Notice.success(c.MailPoet.I18n.t("segmentAdded")),c.MailPoet.trackEvent("Lists > Add new")}};function qo(e){let{match:t}=e;return(0,p.jsxs)("div",{children:[(0,p.jsx)(et.A,{color:"#fff"}),(0,p.jsx)(St.B,{}),(0,p.jsxs)(bt.X,{level:1,className:"mailpoet-title",children:[(0,p.jsx)("span",{children:c.MailPoet.I18n.t("segment")}),(0,p.jsx)(Me.Link,{className:"mailpoet-button button button-secondary button-small",to:"/",children:c.MailPoet.I18n.t("backToList")})]}),(0,p.jsx)(b,{}),(0,p.jsx)(wt,{endpoint:"segments",fields:Fo,params:t.params,messages:Do})]})}qo.displayName="SegmentForm";const $o=document.getElementById("static_segments_container");function Bo(){return(0,p.jsx)(l.k.Provider,{value:(0,l.S)(window),children:(0,p.jsxs)(Me.HashRouter,{children:[(0,p.jsx)(m.w,{}),(0,p.jsxs)(Ne.rs,{children:[(0,p.jsx)(Ne.AW,{path:"/new",component:(0,r.withBoundary)(qo)}),(0,p.jsx)(Ne.AW,{path:"/edit/:id",component:(0,r.withBoundary)(qo)}),(0,p.jsx)(Ne.AW,{path:"*",component:(0,r.withBoundary)(Lo)})]})]})})}$o&&((0,r.registerTranslations)(),n.render((0,p.jsx)(Bo,{}),$o));var Wo=i(93743),Vo=i(91325),Uo=i(46166),Ho=i(82203),zo=i(67201),Zo=i(5019);function Yo(e){let{children:t,title:i,description:a}=e;return(0,p.jsxs)("div",{className:"mailpoet-admin-fields",children:[(0,p.jsxs)("div",{className:"mailpoet-admin-fields-title",children:[(0,p.jsx)(Zo.X,{level:4,children:i}),(0,p.jsx)("p",{children:a})]}),(0,p.jsx)(Ho.C,{children:(0,p.jsx)(zo.Z,{children:t})})]})}function Go(e){let{children:t,slug:i,title:a,description:s}=e;return(0,p.jsxs)("div",{className:"mailpoet-admin-field",children:[a&&(0,p.jsx)("p",{children:(0,p.jsx)("label",{htmlFor:`field_${i}`,children:a})}),(0,p.jsx)("div",{children:t}),s&&(0,p.jsx)("p",{className:"mailpoet-admin-field-description",children:s})]})}var Ko=i(33334),Qo=i(58678),Xo=i(92180),Jo=i(94460);function er(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),a=(0,P.Z)((e=>e(Xo.t).getAutomations()),[]),{updateSegmentFilter:s,updateSegmentFilterFromEvent:n}=(0,he.Z)(Xo.t);(0,o.useEffect)((()=>{i.operator!==Qo.f5.ANY&&i.operator!==Qo.f5.ALL&&i.operator!==Qo.f5.NONE&&s({operator:Qo.f5.ANY},t)}),[s,i,t]);const r=a.map((e=>({value:e.id,label:e.name})));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(lt.Select,{value:i.operator,onChange:e=>{n("operator",t,e)},isMinWidth:!0,children:[(0,p.jsx)("option",{value:Qo.f5.ANY,children:c.MailPoet.I18n.t("anyOf")}),(0,p.jsx)("option",{value:Qo.f5.ALL,children:c.MailPoet.I18n.t("allOf")}),(0,p.jsx)("option",{value:Qo.f5.NONE,children:c.MailPoet.I18n.t("noneOf")})]},"select"),(0,p.jsx)(Uo.ReactSelect,{dimension:"small",isMulti:!0,placeholder:c.MailPoet.I18n.t("searchAutomations"),options:r,value:r.filter((e=>{if(!i.automation_ids)return;const t=e.value;return-1!==i.automation_ids.indexOf(t)})),onChange:e=>{s({automation_ids:e.map((e=>e.value))},t)}})]})}const tr={[Jo.Z.ENTERED_AUTOMATION]:er,[Jo.Z.EXITED_AUTOMATION]:er};function ir(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a,updateSegmentFilterFromEvent:s}=(0,he.Z)(Xo.t),n=(0,P.Z)((e=>e(Xo.t).getNewslettersList()),[]),r=n?.map((e=>{const t=e.sent_at?c.MailPoet.Date.format(e.sent_at):c.MailPoet.I18n.t("notSentYet");return{label:e.subject,tag:t,value:Number(e.id)}}));return(0,o.useEffect)((()=>{i.operator!==Qo.f5.ANY&&i.operator!==Qo.f5.ALL&&i.operator!==Qo.f5.NONE&&a({operator:Qo.f5.ANY},t),i.action===Qo.zd.MACHINE_OPENED&&i.operator===Qo.f5.NONE&&a({operator:Qo.f5.ANY},t)}),[i.action,i.operator,t,a]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(lt.Select,{isMinWidth:!0,automationId:"segment-email-opens-condition",value:i.operator,onChange:e=>{s("operator",t,e)},children:[(0,p.jsx)("option",{value:Qo.f5.ANY,children:c.MailPoet.I18n.t("anyOf")}),(0,p.jsx)("option",{value:Qo.f5.ALL,children:c.MailPoet.I18n.t("allOf")}),i.action!==Qo.zd.MACHINE_OPENED?(0,p.jsx)("option",{value:Qo.f5.NONE,children:c.MailPoet.I18n.t("noneOf")}):null]},"select"),(0,p.jsx)(Uo.ReactSelect,{dimension:"small",isMulti:!0,placeholder:c.MailPoet.I18n.t("selectNewsletterPlaceholder"),options:r,automationId:"segment-email",value:(0,Za.filter)((e=>{if(!i.newsletters)return;const t=e.value;return-1!==i.newsletters.indexOf(t)}),r),onChange:e=>{a({newsletters:(0,Za.map)((0,Za.parseInt)(10),(0,Za.map)("value",e))},t)}})]})}const ar=e=>!!e;var sr=i(66265);function nr(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilterFromEvent:a,updateSegmentFilter:s}=(0,he.Z)(Xo.t);(0,o.useEffect)((()=>{(0,sr.J)(i.timeframe,Qo.u4)||s({timeframe:Qo.u4.IN_THE_LAST},t)}),[i,s,t]);const n=i.timeframe===Qo.u4.IN_THE_LAST;return(0,p.jsx)(p.Fragment,{children:(l=e=>n&&"{days}"===e?(0,p.jsx)(r.Input,{type:"number",value:i.days||"","data-automation-id":"segment-number-of-days",onChange:e=>{a("days",t,e)},min:1,step:1,placeholder:c.MailPoet.I18n.t("daysPlaceholder")},"input"):"{timeframe}"===e?(0,p.jsxs)(lt.Select,{value:i.timeframe,onChange:e=>{a("timeframe",t,e)},children:[(0,p.jsx)("option",{value:"inTheLast",children:c.MailPoet.I18n.t("inTheLast")}),(0,p.jsx)("option",{value:"allTime",children:c.MailPoet.I18n.t("overAllTime")})]},"timeframe-select"):n&&"string"==typeof e&&e.trim().length>1?(0,p.jsx)("div",{children:e},e):null,c.MailPoet.I18n.t("emailActionOpensDaysSentence").split(/({days})|({timeframe})/gim).map(l))});var l}function or(e){return e.timeframe===Qo.u4.ALL_TIME||!!e.days}function rr(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a,updateSegmentFilterFromEvent:s}=(0,he.Z)(Xo.t);return(0,o.useEffect)((()=>{void 0===i.operator&&a({operator:"more"},t)}),[a,i,t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ki.Grid.CenteredRow,{children:(n=e=>"{condition}"===e?(0,p.jsxs)(lt.Select,{value:i.operator,onChange:e=>{s("operator",t,e)},children:[(0,p.jsx)("option",{value:"more",children:c.MailPoet.I18n.t("moreThan")}),(0,p.jsx)("option",{value:"less",children:c.MailPoet.I18n.t("lessThan")}),(0,p.jsx)("option",{value:"equals",children:c.MailPoet.I18n.t("equals")}),(0,p.jsx)("option",{value:"not_equals",children:c.MailPoet.I18n.t("notEquals")})]},"select"):"{opens}"===e?(0,p.jsx)(at.I,{type:"number",value:i.opens||"","data-automation-id":"segment-number-of-opens",onChange:e=>{s("opens",t,e)},min:"0",placeholder:c.MailPoet.I18n.t("emailActionOpens")},"input"):"string"==typeof e&&e.trim().length>1?(0,p.jsx)("div",{children:e},"opens"):null,c.MailPoet.I18n.t("emailActionOpensSentence").split(/({condition})|({opens})|(\b[a-zA-Z]+\b)/gim).map(n))}),(0,p.jsx)(ki.Grid.CenteredRow,{children:(0,p.jsx)(nr,{filterIndex:t})})]});var n}const lr={[Qo.zd.OPENS_ABSOLUTE_COUNT]:rr,[Qo.zd.MACHINE_OPENS_ABSOLUTE_COUNT]:rr,[Qo.zd.CLICKED]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a,updateSegmentFilterFromEvent:s}=(0,he.Z)(Xo.t),n=(0,P.Z)((e=>e(Xo.t).getNewslettersList()),[]),[r,l]=(0,o.useState)([]),[d,m]=(0,o.useState)([]),[u,h]=(0,o.useState)(!1),g=n?.map((e=>{const t=e.sent_at?c.MailPoet.Date.format(e.sent_at):(0,Oe.__)("Not sent yet","mailpoet");return{label:e.subject,tag:t,value:Number(e.id)}})),f=(0,o.useCallback)((()=>{var e;ar(i.newsletter_id)&&(m([]),e=i.newsletter_id,l([]),h(!0),c.MailPoet.Ajax.post({api_version:c.MailPoet.apiVersion,endpoint:"newsletter_links",action:"get",data:{newsletterId:e}}).then((e=>{const{data:t}=e,i=t.map((e=>({value:e.id,label:e.url})));h(!1),m(i)})).fail((e=>{l(e.errors)})))}),[i.newsletter_id]);return(0,o.useEffect)((()=>{f()}),[f,i.newsletter_id]),(0,o.useEffect)((()=>{i.operator!==Qo.f5.ANY&&i.operator!==Qo.f5.ALL&&i.operator!==Qo.f5.NONE&&a({operator:Qo.f5.ANY},t)}),[i.operator,t,a]),(0,p.jsxs)(p.Fragment,{children:[r.length>0&&(0,p.jsx)(Jt,{errors:r}),(0,p.jsx)(Uo.ReactSelect,{placeholder:c.MailPoet.I18n.t("selectNewsletterPlaceholder"),options:g,value:(0,Za.find)(["value",i.newsletter_id],g),onChange:e=>{a({newsletter_id:e.value,link_ids:[]},t)},automationId:"segment-email"}),(0,p.jsxs)(lt.Select,{isMinWidth:!0,value:i.operator,onChange:e=>s("operator",t,e),automationId:"select-operator",children:[(0,p.jsx)("option",{value:Qo.f5.ANY,children:c.MailPoet.I18n.t("anyOf")}),(0,p.jsx)("option",{value:Qo.f5.ALL,children:c.MailPoet.I18n.t("allOf")}),(0,p.jsx)("option",{value:Qo.f5.NONE,children:c.MailPoet.I18n.t("noneOf")})]},"select-operator"),u&&(0,p.jsx)("span",{children:c.MailPoet.I18n.t("loadingDynamicSegmentItems")}),!u&&ar(i.newsletter_id)&&(0,p.jsx)(Uo.ReactSelect,{isMulti:!0,automationId:"segment-link-select",placeholder:c.MailPoet.I18n.t("allLinksPlaceholder"),options:d.length?d:[{value:0,label:c.MailPoet.I18n.t("noLinksHint"),isDisabled:!0}],value:(0,Za.filter)((e=>!!i.link_ids&&-1!==i.link_ids.indexOf(e.value)),d),onChange:e=>{a({link_ids:(e||[]).map((e=>e.value))},t)}})]})},[Qo.zd.OPENED]:ir,[Qo.zd.WAS_SENT]:ir,[Qo.zd.MACHINE_OPENED]:ir,[Qo.zd.CLICKED_ANY]:null};var dr=i(71622),cr=i(30673);let mr=function(e){return e.BEFORE="before",e.AFTER="after",e.ON="on",e.ON_OR_BEFORE="onOrBefore",e.ON_OR_AFTER="onOrAfter",e.NOT_ON="notOn",e.IN_THE_LAST="inTheLast",e.NOT_IN_THE_LAST="notInTheLast",e}({});const ur=[mr.BEFORE,mr.AFTER,mr.ON,mr.ON_OR_AFTER,mr.ON_OR_BEFORE,mr.NOT_ON,mr.IN_THE_LAST,mr.NOT_IN_THE_LAST],pr=e=>{if(null!==e){if(Array.isArray(e))throw new Error("convertDateToString can process only single date array given");return c.MailPoet.Date.format(e,{format:"Y-m-d"})}},hr=e=>{const t=(0,dr.default)(e);if((0,cr.default)(t))return t};function gr(e){let{filterIndex:t,defaultOperator:i}=e;const a=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:s,updateSegmentFilterFromEvent:n}=(0,he.Z)(Xo.t);return(0,o.useEffect)((()=>{ur.includes(a.operator)||s({operator:i},t),a.operator!==mr.BEFORE&&a.operator!==mr.AFTER&&a.operator!==mr.ON&&a.operator!==mr.ON_OR_AFTER&&a.operator!==mr.ON_OR_BEFORE&&a.operator!==mr.NOT_ON||void 0!==hr(a.value)&&/^\d+-\d+-\d+$/.test(a.value)||s({value:pr(new Date)},t),a.operator!==mr.IN_THE_LAST&&a.operator!==mr.NOT_IN_THE_LAST||"string"!=typeof a.value||/^\d*$/.exec(a.value)||s({value:""},t)}),[s,a,t,i]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(lt.Select,{value:a.operator,isMinWidth:!0,onChange:e=>{n("operator",t,e)},children:[(0,p.jsx)("option",{value:mr.BEFORE,children:c.MailPoet.I18n.t("before")}),(0,p.jsx)("option",{value:mr.ON_OR_BEFORE,children:c.MailPoet.I18n.t("onOrBefore")}),(0,p.jsx)("option",{value:mr.ON,children:c.MailPoet.I18n.t("on")}),(0,p.jsx)("option",{value:mr.NOT_ON,children:c.MailPoet.I18n.t("notOn")}),(0,p.jsx)("option",{value:mr.ON_OR_AFTER,children:c.MailPoet.I18n.t("onOrAfter")}),(0,p.jsx)("option",{value:mr.AFTER,children:c.MailPoet.I18n.t("after")}),(0,p.jsx)("option",{value:mr.IN_THE_LAST,children:c.MailPoet.I18n.t("inTheLast")}),(0,p.jsx)("option",{value:mr.NOT_IN_THE_LAST,children:c.MailPoet.I18n.t("notInTheLast")})]},"select"),(a.operator===mr.BEFORE||a.operator===mr.AFTER||a.operator===mr.ON||a.operator===mr.ON_OR_AFTER||a.operator===mr.ON_OR_BEFORE||a.operator===mr.NOT_ON)&&(0,p.jsx)(Ri.a,{className:"mailpoet-segments-datepicker-small",dateFormat:"MMM d, yyyy",onChange:e=>{s({value:pr(e)},t)},selected:a.value?hr(a.value):void 0}),(a.operator===mr.IN_THE_LAST||a.operator===mr.NOT_IN_THE_LAST)&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(at.I,{className:"mailpoet-segments-input-small",type:"number",value:a.value||"",onChange:e=>{n("value",t,e)},min:"1",placeholder:c.MailPoet.I18n.t("daysPlaceholder")},"input"),(0,p.jsx)("span",{children:c.MailPoet.I18n.t("daysPlaceholder")})]})]})}function fr(e){return!(!e.operator||!e.value)&&([mr.BEFORE,mr.AFTER,mr.ON,mr.NOT_ON,mr.ON_OR_BEFORE,mr.ON_OR_AFTER].includes(e.operator)?/^\d+-\d+-\d+$/.test(e.value):!![mr.IN_THE_LAST,mr.NOT_IN_THE_LAST].includes(e.operator)&&(/^\d+$/.test(e.value)&&Number(e.value)>0))}function _r(e){return function(t){return(0,p.jsx)(gr,{...t,defaultOperator:e})}}const br=_r(mr.BEFORE),xr=_r(mr.IN_THE_LAST);var vr=i(70468);const yr=["is","isNot","contains","notContains","startsWith","notStartsWith","endsWith","notEndsWith"];function jr(e){return!!yr.includes(e.operator)&&"string"==typeof e.value&&e.value.length>0}function wr(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilterFromEvent:a,updateSegmentFilter:s}=(0,he.Z)(Xo.t);return(0,o.useEffect)((()=>{yr.includes(i.operator)||s({operator:"is",value:""},t)}),[s,i,t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(lt.Select,{automationId:"subscriber-text-field-select",value:i.operator,isMinWidth:!0,onChange:e=>{a("operator",t,e)},children:[(0,p.jsx)("option",{value:"is",children:c.MailPoet.I18n.t("is")}),(0,p.jsx)("option",{value:"isNot",children:c.MailPoet.I18n.t("isNot")}),(0,p.jsx)("option",{value:"contains",children:c.MailPoet.I18n.t("contains")}),(0,p.jsx)("option",{value:"notContains",children:c.MailPoet.I18n.t("notContains")}),(0,p.jsx)("option",{value:"startsWith",children:c.MailPoet.I18n.t("startsWith")}),(0,p.jsx)("option",{value:"notStartsWith",children:c.MailPoet.I18n.t("notStartsWith")}),(0,p.jsx)("option",{value:"endsWith",children:c.MailPoet.I18n.t("endsWith")}),(0,p.jsx)("option",{value:"notEndsWith",children:c.MailPoet.I18n.t("notEndsWith")})]},"select"),(0,p.jsx)(at.I,{className:"mailpoet-segments-input-medium","data-automation-id":"text-custom-field-value",value:i.value||"",onChange:e=>{a("value",t,e)},placeholder:c.MailPoet.I18n.t("value")},"input")]})}const Sr={[vr.wq.CUSTOMER_IN_COUNTRY]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a}=(0,he.Z)(Xo.t),s=(0,P.Z)((e=>e(Xo.t).getWooCommerceCountries()),[]).map((e=>({value:e.code,label:e.name})));return(0,o.useEffect)((()=>{i.operator!==Qo.f5.ANY&&i.operator!==Qo.f5.NONE&&a({operator:Qo.f5.ANY},t)}),[a,i,t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(lt.Select,{value:i.operator,isMinWidth:!0,onChange:e=>{a({operator:e.target.value},t)},automationId:"select-operator-country",children:[(0,p.jsx)("option",{value:Qo.f5.ANY,children:c.MailPoet.I18n.t("anyOf")}),(0,p.jsx)("option",{value:Qo.f5.NONE,children:c.MailPoet.I18n.t("noneOf")})]},"select-operator-country"),(0,p.jsx)(Uo.ReactSelect,{dimension:"small",isMulti:!0,placeholder:c.MailPoet.I18n.t("selectWooCountry"),options:s,value:(0,Za.filter)((e=>{if(i.country_code)return-1!==i.country_code.indexOf(e.value)}),s),onChange:e=>{a({country_code:(e||[]).map((e=>e.value))},t)},automationId:"select-segment-country"},"select-segment-country")]})},[vr.wq.CUSTOMER_IN_CITY]:wr,[vr.wq.CUSTOMER_IN_POSTAL_CODE]:wr,[vr.wq.NUMBER_OF_ORDERS]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a,updateSegmentFilterFromEvent:s}=(0,he.Z)(Xo.t);return(0,o.useEffect)((()=>{void 0===i.number_of_orders_type&&a({number_of_orders_type:"="},t)}),[a,i,t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(ki.Grid.CenteredRow,{children:[(0,p.jsxs)(r.Select,{value:i.number_of_orders_type,onChange:e=>{s("number_of_orders_type",t,e)},automationId:"select-number-of-orders-type",children:[(0,p.jsx)("option",{value:"=",children:c.MailPoet.I18n.t("equals")}),(0,p.jsx)("option",{value:"!=",children:c.MailPoet.I18n.t("notEquals")}),(0,p.jsx)("option",{value:">",children:c.MailPoet.I18n.t("moreThan")}),(0,p.jsx)("option",{value:"<",children:c.MailPoet.I18n.t("lessThan")})]},"select"),(0,p.jsx)(r.Input,{"data-automation-id":"input-number-of-orders-count",type:"number",min:0,value:i.number_of_orders_count||"",placeholder:c.MailPoet.I18n.t("wooNumberOfOrdersCount"),onChange:e=>{s("number_of_orders_count",t,e)}}),(0,p.jsx)("div",{children:c.MailPoet.I18n.t("wooNumberOfOrdersOrders")})]}),(0,p.jsx)(ki.Grid.CenteredRow,{children:(0,p.jsx)(nr,{filterIndex:t})})]})},[vr.wq.NUMBER_OF_REVIEWS]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a,updateSegmentFilterFromEvent:s}=(0,he.Z)(Xo.t);return(0,o.useEffect)((()=>{(0,sr.J)(i.count_type,Qo.Si)||a({count_type:Qo.Si.EQUALS},t),(0,sr.J)(i.rating,Qo.Nj)||a({rating:Qo.Nj.ANY},t),(0,sr.J)(i.timeframe,Qo.u4)||a({timeframe:Qo.u4.IN_THE_LAST},t)}),[a,i,t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(r.Select,{value:i.rating,isMinWidth:!0,onChange:e=>{s("rating",t,e)},children:[(0,p.jsx)("option",{value:Qo.Nj.ANY,children:c.MailPoet.I18n.t("wooAnyStarRating")}),(0,p.jsx)("option",{value:Qo.Nj.ONE,children:c.MailPoet.I18n.t("wooOneStarRating")}),(0,p.jsx)("option",{value:Qo.Nj.TWO,children:c.MailPoet.I18n.t("wooTwoStarRating")}),(0,p.jsx)("option",{value:Qo.Nj.THREE,children:c.MailPoet.I18n.t("wooThreeStarRating")}),(0,p.jsx)("option",{value:Qo.Nj.FOUR,children:c.MailPoet.I18n.t("wooFourStarRating")}),(0,p.jsx)("option",{value:Qo.Nj.FIVE,children:c.MailPoet.I18n.t("wooFiveStarRating")})]},"rating-select"),(0,p.jsxs)(r.Select,{value:i.count_type,isMinWidth:!0,onChange:e=>{s("count_type",t,e)},automationId:"select-number-of-reviews-type",children:[(0,p.jsx)("option",{value:Qo.Si.EQUALS,children:c.MailPoet.I18n.t("equals")}),(0,p.jsx)("option",{value:Qo.Si.NOT_EQUALS,children:c.MailPoet.I18n.t("notEquals")}),(0,p.jsx)("option",{value:Qo.Si.MORE_THAN,children:c.MailPoet.I18n.t("moreThan")}),(0,p.jsx)("option",{value:Qo.Si.LESS_THAN,children:c.MailPoet.I18n.t("lessThan")})]},"select"),(0,p.jsx)(r.Input,{className:"mailpoet-segments-input-small","data-automation-id":"input-number-of-reviews-count",type:"number",min:0,value:i.count||"",placeholder:c.MailPoet.I18n.t("wooNumberOfOrdersCount"),onChange:e=>{s("count",t,e)}}),(0,p.jsx)("div",{children:c.MailPoet.I18n.t("wooNumberOfReviewsReviews")}),(0,p.jsx)(ki.Grid.CenteredRow,{children:(0,p.jsx)(nr,{filterIndex:t})})]})},[vr.wq.PURCHASE_DATE]:br,[vr.wq.PURCHASED_PRODUCT]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a}=(0,he.Z)(Xo.t),s=(0,P.Z)((e=>e(Xo.t).getProducts()),[]).map((e=>({value:e.id,label:e.name})));return(0,o.useEffect)((()=>{i.operator!==Qo.f5.ALL&&i.operator!==Qo.f5.ANY&&i.operator!==Qo.f5.NONE&&a({operator:Qo.f5.ANY},t)}),[a,i,t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(lt.Select,{value:i.operator,isMinWidth:!0,onChange:e=>{a({operator:e.target.value},t)},automationId:"select-operator",children:[(0,p.jsx)("option",{value:Qo.f5.ANY,children:c.MailPoet.I18n.t("anyOf")}),(0,p.jsx)("option",{value:Qo.f5.ALL,children:c.MailPoet.I18n.t("allOf")}),(0,p.jsx)("option",{value:Qo.f5.NONE,children:c.MailPoet.I18n.t("noneOf")})]},"select-operator"),(0,p.jsx)(Uo.ReactSelect,{isMulti:!0,dimension:"small",placeholder:c.MailPoet.I18n.t("selectWooPurchasedProduct"),options:s,value:(0,Za.filter)((e=>{if(void 0!==i.product_ids&&0!==i.product_ids.length)return-1!==i.product_ids.indexOf(e.value)}),s),onChange:e=>{a({product_ids:(e||[]).map((e=>e.value))},t)},automationId:"select-segment-products"},"select-segment-products")]})},[vr.wq.PURCHASED_CATEGORY]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a}=(0,he.Z)(Xo.t),s=(0,P.Z)((e=>e(Xo.t).getProductCategories()),[]).map((e=>({value:e.id,label:e.name})));return(0,o.useEffect)((()=>{i.operator!==Qo.f5.ALL&&i.operator!==Qo.f5.ANY&&i.operator!==Qo.f5.NONE&&a({operator:Qo.f5.ANY},t)}),[a,i,t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(lt.Select,{value:i.operator,isMinWidth:!0,onChange:e=>{a({operator:e.target.value},t)},automationId:"select-operator",children:[(0,p.jsx)("option",{value:Qo.f5.ANY,children:c.MailPoet.I18n.t("anyOf")}),(0,p.jsx)("option",{value:Qo.f5.ALL,children:c.MailPoet.I18n.t("allOf")}),(0,p.jsx)("option",{value:Qo.f5.NONE,children:c.MailPoet.I18n.t("noneOf")})]},"select-operator"),(0,p.jsx)(Uo.ReactSelect,{isMulti:!0,dimension:"small",placeholder:c.MailPoet.I18n.t("selectWooPurchasedCategory"),options:s,value:(0,Za.filter)((e=>{if(void 0!==i.category_ids&&0!==i.category_ids.length)return-1!==i.category_ids.indexOf(e.value)}),s),onChange:e=>{a({category_ids:(e||[]).map((e=>e.value))},t)},automationId:"select-segment-category"},"select-segment-category")]})},[vr.wq.SINGLE_ORDER_VALUE]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a,updateSegmentFilterFromEvent:s}=(0,he.Z)(Xo.t),n=(0,P.Z)((e=>e(Xo.t).getWooCommerceCurrencySymbol()),[]);return(0,o.useEffect)((()=>{void 0===i.single_order_value_type&&a({single_order_value_type:">"},t)}),[a,i,t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(ki.Grid.CenteredRow,{children:[(0,p.jsxs)(r.Select,{value:i.single_order_value_type,onChange:e=>{s("single_order_value_type",t,e)},automationId:"select-single-order-value-type",children:[(0,p.jsx)("option",{value:">",children:c.MailPoet.I18n.t("moreThan")}),(0,p.jsx)("option",{value:">=",children:c.MailPoet.I18n.t("moreThanOrEqual")}),(0,p.jsx)("option",{value:"=",children:c.MailPoet.I18n.t("equals")}),(0,p.jsx)("option",{value:"!=",children:c.MailPoet.I18n.t("notEquals")}),(0,p.jsx)("option",{value:"<=",children:c.MailPoet.I18n.t("lessThanOrEqual")}),(0,p.jsx)("option",{value:"<",children:c.MailPoet.I18n.t("lessThan")})]},"select"),(0,p.jsx)(r.Input,{"data-automation-id":"input-single-order-value-amount",type:"number",min:0,step:.01,value:i.single_order_value_amount||"",placeholder:c.MailPoet.I18n.t("wooSpentAmount"),onChange:e=>{s("single_order_value_amount",t,e)}}),(0,p.jsx)("div",{children:n})]}),(0,p.jsx)(ki.Grid.CenteredRow,{children:(0,p.jsx)(nr,{filterIndex:t})})]})},[vr.wq.TOTAL_SPENT]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a,updateSegmentFilterFromEvent:s}=(0,he.Z)(Xo.t),n=(0,P.Z)((e=>e(Xo.t).getWooCommerceCurrencySymbol()),[]);return(0,o.useEffect)((()=>{void 0===i.total_spent_type&&a({total_spent_type:">"},t)}),[a,i,t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(ki.Grid.CenteredRow,{children:[(0,p.jsxs)(r.Select,{value:i.total_spent_type,onChange:e=>{s("total_spent_type",t,e)},automationId:"select-total-spent-type",children:[(0,p.jsx)("option",{value:"=",children:c.MailPoet.I18n.t("equals")}),(0,p.jsx)("option",{value:"!=",children:c.MailPoet.I18n.t("notEquals")}),(0,p.jsx)("option",{value:">",children:c.MailPoet.I18n.t("moreThan")}),(0,p.jsx)("option",{value:"<",children:c.MailPoet.I18n.t("lessThan")})]},"select"),(0,p.jsx)(r.Input,{"data-automation-id":"input-total-spent-amount",type:"number",min:0,step:.01,value:i.total_spent_amount||"",placeholder:c.MailPoet.I18n.t("wooSpentAmount"),onChange:e=>{s("total_spent_amount",t,e)}}),(0,p.jsx)("div",{children:n})]}),(0,p.jsx)(ki.Grid.CenteredRow,{children:(0,p.jsx)(nr,{filterIndex:t})})]})},[vr.wq.AVERAGE_SPENT]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a,updateSegmentFilterFromEvent:s}=(0,he.Z)(Xo.t),n=(0,P.Z)((e=>e(Xo.t).getWooCommerceCurrencySymbol()),[]);return(0,o.useEffect)((()=>{[">",">=","=","!=","<=","<"].includes(i.average_spent_type)||a({average_spent_type:">"},t)}),[a,i,t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(r.Select,{value:i.average_spent_type,isMinWidth:!0,onChange:e=>{s("average_spent_type",t,e)},automationId:"select-average-spent-type",children:[(0,p.jsx)("option",{value:">",children:c.MailPoet.I18n.t("moreThan")}),(0,p.jsx)("option",{value:">=",children:c.MailPoet.I18n.t("moreThanOrEqual")}),(0,p.jsx)("option",{value:"=",children:c.MailPoet.I18n.t("equals")}),(0,p.jsx)("option",{value:"!=",children:c.MailPoet.I18n.t("notEquals")}),(0,p.jsx)("option",{value:"<=",children:c.MailPoet.I18n.t("lessThanOrEqual")}),(0,p.jsx)("option",{value:"<",children:c.MailPoet.I18n.t("lessThan")})]},"select"),(0,p.jsx)(r.Input,{className:"mailpoet-segments-input-small","data-automation-id":"input-average-spent-amount",type:"number",min:0,step:.01,value:i.average_spent_amount||"",placeholder:c.MailPoet.I18n.t("wooSpentAmount"),onChange:e=>{s("average_spent_amount",t,e)}}),(0,p.jsx)("div",{children:n}),(0,p.jsx)(ki.Grid.CenteredRow,{children:(0,p.jsx)(nr,{filterIndex:t})})]})},[vr.wq.USED_COUPON_CODE]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a}=(0,he.Z)(Xo.t),[s,n]=(0,o.useState)(!1),[l,d]=(0,o.useState)([]),[m,u]=(0,o.useState)(!1),[h,g]=(0,o.useState)(1),[f,_]=(0,o.useState)(!0),[b,x]=(0,o.useState)(""),[v,y]=(0,o.useState)([]),j=(0,o.useCallback)(((e,t,a,s)=>{s&&(e||u(!0),c.MailPoet.Ajax.post({api_version:c.MailPoet.apiVersion,endpoint:"coupons",action:"getCoupons",data:{page_number:t,page_size:1e3,include_coupon_ids:i.coupon_code_ids,search:a}}).then((i=>{const{data:a}=i,s=a.map((e=>({value:e.id.toString(),label:e.text}))),n=t+1;0===s.length?_(!1):(d((e=>(0,Za.uniqBy)((e=>e.value),[...e,...s]))),g(n)),e||u(!1)})).fail((e=>{y(e.errors)})))}),[i.coupon_code_ids]),w=(0,Za.debounce)(300,(e=>{const t=b;x(e),!m&&(f&&e||t&&!e)&&(g(1),j(!1,1,e,f))}));return(0,o.useEffect)((()=>{s||(j(!0,h,b,f),n(!0))}),[s,h,b,j,f]),(0,o.useEffect)((()=>{Array.isArray(i.coupon_code_ids)||a({coupon_code_ids:[]},t),(0,sr.J)(i.operator,Qo.f5)||a({operator:Qo.f5.ANY},t)}),[a,i,t]),(0,p.jsxs)(p.Fragment,{children:[v.length>0&&(0,p.jsx)(Jt,{errors:v}),s?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(ki.Grid.CenteredRow,{children:[(0,p.jsxs)(r.Select,{isMaxContentWidth:!0,value:i.operator,onChange:e=>{a({operator:e.target.value},t)},automationId:"select-operator-used-coupon-code",children:[(0,p.jsx)("option",{value:Qo.f5.ANY,children:c.MailPoet.I18n.t("anyOf")}),(0,p.jsx)("option",{value:Qo.f5.ALL,children:c.MailPoet.I18n.t("allOf")}),(0,p.jsx)("option",{value:Qo.f5.NONE,children:c.MailPoet.I18n.t("noneOf")})]},"select-operator-used-coupon-codes"),(0,p.jsx)(Uo.ReactSelect,{isFullWidth:!0,isMulti:!0,isLoadingMore:m,placeholder:c.MailPoet.I18n.t("selectWooCouponCodes"),options:l,value:(0,Za.filter)((e=>{if(i.coupon_code_ids)return-1!==i.coupon_code_ids.indexOf(e.value)}),l),onInputChange:e=>{w(e)},onChange:e=>{a({coupon_code_ids:(e||[]).map((e=>e.value))},t)},automationId:"select-shipping-methods",onMenuScrollToBottom:()=>{!m&&f&&j(!1,h,b,f)}},"select-coupon-codes")]}),(0,p.jsx)(ki.Grid.CenteredRow,{children:(0,p.jsx)(nr,{filterIndex:t})})]}):(0,p.jsx)(ki.Grid.CenteredRow,{children:(0,Oe.__)("Loading coupon codes...","mailpoet")})]})},[vr.wq.USED_PAYMENT_METHOD]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a}=(0,he.Z)(Xo.t),s=(0,P.Z)((e=>e(Xo.t).getPaymentMethods()),[]).map((e=>({value:e.id,label:e.name})));return(0,o.useEffect)((()=>{i.operator!==Qo.f5.ANY&&i.operator!==Qo.f5.ALL&&i.operator!==Qo.f5.NONE&&a({operator:Qo.f5.ANY},t)}),[a,i,t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(ki.Grid.CenteredRow,{children:[(0,p.jsxs)(r.Select,{isMaxContentWidth:!0,value:i.operator,onChange:e=>{a({operator:e.target.value},t)},automationId:"select-operator-used-payment-methods",children:[(0,p.jsx)("option",{value:Qo.f5.ANY,children:c.MailPoet.I18n.t("anyOf")}),(0,p.jsx)("option",{value:Qo.f5.ALL,children:c.MailPoet.I18n.t("allOf")}),(0,p.jsx)("option",{value:Qo.f5.NONE,children:c.MailPoet.I18n.t("noneOf")})]},"select-operator-used-payment-methods"),(0,p.jsx)(Uo.ReactSelect,{isFullWidth:!0,isMulti:!0,placeholder:c.MailPoet.I18n.t("selectWooPaymentMethods"),options:s,value:(0,Za.filter)((e=>{if(i.payment_methods)return-1!==i.payment_methods.indexOf(e.value)}),s),onChange:e=>{a({payment_methods:(e||[]).map((e=>e.value))},t)},automationId:"select-payment-methods"},"select-payment-methods")]}),(0,p.jsx)(ki.Grid.CenteredRow,{children:(0,p.jsx)(nr,{filterIndex:t})})]})},[vr.wq.USED_SHIPPING_METHOD]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a}=(0,he.Z)(Xo.t),s=(0,P.Z)((e=>e(Xo.t).getShippingMethods()),[]).map((e=>({value:e.instanceId,label:e.name})));return(0,o.useEffect)((()=>{i.operator!==Qo.f5.ANY&&i.operator!==Qo.f5.ALL&&i.operator!==Qo.f5.NONE&&a({operator:Qo.f5.ANY},t)}),[a,i,t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(ki.Grid.CenteredRow,{children:[(0,p.jsxs)(r.Select,{isMaxContentWidth:!0,value:i.operator,onChange:e=>{a({operator:e.target.value},t)},automationId:"select-operator-used-shipping-methods",children:[(0,p.jsx)("option",{value:Qo.f5.ANY,children:c.MailPoet.I18n.t("anyOf")}),(0,p.jsx)("option",{value:Qo.f5.ALL,children:c.MailPoet.I18n.t("allOf")}),(0,p.jsx)("option",{value:Qo.f5.NONE,children:c.MailPoet.I18n.t("noneOf")})]},"select-operator-used-shipping-methods"),(0,p.jsx)(Uo.ReactSelect,{isFullWidth:!0,isMulti:!0,placeholder:c.MailPoet.I18n.t("selectWooShippingMethods"),options:s,value:(0,Za.filter)((e=>{if(i.shipping_methods)return-1!==i.shipping_methods.indexOf(e.value)}),s),onChange:e=>{a({shipping_methods:(e||[]).map((e=>e.value))},t)},automationId:"select-shipping-methods"},"select-shipping-methods")]}),(0,p.jsx)(ki.Grid.CenteredRow,{children:(0,p.jsx)(nr,{filterIndex:t})})]})}};function Pr(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a,updateSegmentFilterFromEvent:s}=(0,he.Z)(Xo.t);(0,o.useEffect)((()=>{i.action===Qo.jx.WORDPRESS_ROLE&&i.operator!==Qo.f5.ANY&&i.operator!==Qo.f5.ALL&&i.operator!==Qo.f5.NONE&&a({operator:Qo.f5.ANY},t)}),[a,i,t]);const n=(0,P.Z)((e=>e(Xo.t).getWordpressRoles()),[]).map((e=>({value:e.role_id,label:e.role_name})));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ki.Grid.CenteredRow,{children:(0,p.jsxs)(lt.Select,{isFullWidth:!0,automationId:"segment-wordpress-role-condition",value:i.operator,onChange:e=>{s("operator",t,e)},children:[(0,p.jsx)("option",{value:Qo.f5.ANY,children:c.MailPoet.I18n.t("anyOf")}),(0,p.jsx)("option",{value:Qo.f5.ALL,children:c.MailPoet.I18n.t("allOf")}),(0,p.jsx)("option",{value:Qo.f5.NONE,children:c.MailPoet.I18n.t("noneOf")})]},"select")}),(0,p.jsx)(ki.Grid.CenteredRow,{children:(0,p.jsx)(Uo.ReactSelect,{dimension:"small",isMulti:!0,automationId:"segment-wordpress-role",placeholder:c.MailPoet.I18n.t("selectUserRolePlaceholder"),options:n,value:(0,Za.filter)((e=>{if(i.wordpressRole)return-1!==i.wordpressRole.indexOf(e.value)}),n),onChange:e=>{a({wordpressRole:(0,Za.map)("value",e)},t)}})})]})}let Mr=function(e){return e.HIGHER_THAN="higherThan",e.LOWER_THAN="lowerThan",e.EQUALS="equals",e.NOT_EQUALS="not_equals",e.UNKNOWN="unknown",e.NOT_UNKNOWN="not_unknown",e}({});const Nr=[Mr.HIGHER_THAN,Mr.LOWER_THAN,Mr.EQUALS,Mr.NOT_EQUALS,Mr.UNKNOWN,Mr.NOT_UNKNOWN];function Ir(e){return!!(0,Qo.F3)(e.operator)||"string"==typeof e.value&&e.value.length>0&&("equals"===e.operator||"contains"===e.operator||"not_contains"===e.operator||"not_equals"===e.operator||"more_than"===e.operator||"less_than"===e.operator)}function kr(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilterFromEvent:a,updateSegmentFilter:s}=(0,he.Z)(Xo.t);return(0,o.useEffect)((()=>{void 0===i.operator&&s({operator:"equals",value:""},t)}),[s,i,t]),(0,p.jsxs)(ki.Grid.CenteredRow,{children:[(0,p.jsxs)(lt.Select,{automationId:"text-custom-field-operator",value:i.operator,onChange:e=>{a("operator",t,e)},children:[(0,p.jsx)("option",{value:"equals",children:c.MailPoet.I18n.t("is")}),(0,p.jsx)("option",{value:"not_equals",children:c.MailPoet.I18n.t("isNot")}),(0,p.jsx)("option",{value:"contains",children:c.MailPoet.I18n.t("contains")}),(0,p.jsx)("option",{value:"not_contains",children:c.MailPoet.I18n.t("notContains")}),(0,p.jsx)("option",{value:"more_than",children:c.MailPoet.I18n.t("moreThan")}),(0,p.jsx)("option",{value:"less_than",children:c.MailPoet.I18n.t("lessThan")}),(0,p.jsx)("option",{value:"is_blank",children:c.MailPoet.I18n.t("isBlank")}),(0,p.jsx)("option",{value:"is_not_blank",children:c.MailPoet.I18n.t("isNotBlank")})]},"select"),!(0,Qo.F3)(i.operator)&&(0,p.jsx)(at.I,{"data-automation-id":"text-custom-field-value",value:i.value||"",onChange:e=>{a("value",t,e)},placeholder:c.MailPoet.I18n.t("value")},"input")]})}function Cr(e){return!!(0,Qo.F3)(e.operator)||"string"==typeof e.value&&e.value.length>0}function Tr(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a,updateSegmentFilterFromEvent:s}=(0,he.Z)(Xo.t),n=(0,P.Z)((e=>e(Xo.t).getCustomFieldsList()),[]),o=(0,Za.find)({id:Number(i.custom_field_id)},n);if(!o)return null;const r=o.params;if(!r||!Array.isArray(r.values))return null;const l=r.values.map((e=>({value:e.value,label:e.value}))),d=l.find((e=>e.value===i.value))?.label;return(0,p.jsxs)(ki.Grid.CenteredRow,{children:[(0,p.jsxs)(lt.Select,{automationId:"text-custom-field-operator",value:i.operator,onChange:e=>{s("operator",t,e)},children:[(0,p.jsx)("option",{value:"equals",children:c.MailPoet.I18n.t("is")}),(0,p.jsx)("option",{value:Qo.DB.BLANK,children:c.MailPoet.I18n.t("isBlank")}),(0,p.jsx)("option",{value:Qo.DB.NOT_BLANK,children:c.MailPoet.I18n.t("isNotBlank")})]},"select"),!(0,Qo.F3)(i.operator)&&(0,p.jsx)(Uo.ReactSelect,{dimension:"small",placeholder:c.MailPoet.I18n.t("selectValue"),options:l,value:i.value&&d?{value:i.value,label:d}:null,onChange:e=>{a({value:e.value},t)},automationId:"segment-wordpress-role"})]})}var Er=i(12892),Ar=i(15826);function Rr(e){return!!(0,Qo.F3)(e.operator)||("month"===e.date_type||!("string"!=typeof e.operator||e.operator.length<1))&&"string"==typeof e.value&&e.value.length>1}const Or=e=>{if(null!==e){if(Array.isArray(e))throw new Error("convertDateToString can process only single date array given");return(0,Ar.default)(e,"yyyy-MM-dd 00:00:00")}},Lr=e=>{const t=(0,dr.default)(e);if((0,cr.default)(t))return t},Fr={month:function(e){let{onChange:t,item:i,filterIndex:a}=e;return(0,o.useEffect)((()=>{Rr(i)||t((0,Za.assign)(i,{value:"2017-01-01 00:00:00"}),a),void 0===i.operator&&t((0,Za.assign)(i,{operator:"equals"}),a)}),[t,i,a]),(0,p.jsxs)(ki.Grid.CenteredRow,{children:[(0,p.jsxs)(lt.Select,{value:i.operator,onChange:e=>{t((0,Za.assign)(i,{operator:e.target.value}),a)},children:[(0,p.jsx)("option",{value:"equals",children:(0,Oe.__)("is","mailpoet")}),(0,p.jsx)("option",{value:Qo.DB.BLANK,children:(0,Oe.__)("is blank","mailpoet")}),(0,p.jsx)("option",{value:Qo.DB.NOT_BLANK,children:(0,Oe.__)("is not blank","mailpoet")})]},"select-operator"),!(0,Qo.F3)(i.operator)&&(0,p.jsxs)(lt.Select,{value:i.value,onChange:e=>{t((0,Za.assign)(i,{value:e.target.value}),a)},children:[(0,p.jsx)("option",{value:"2017-01-01 00:00:00",children:(0,Oe.__)("january","mailpoet")}),(0,p.jsx)("option",{value:"2017-02-01 00:00:00",children:(0,Oe.__)("february","mailpoet")}),(0,p.jsx)("option",{value:"2017-03-01 00:00:00",children:(0,Oe.__)("march","mailpoet")}),(0,p.jsx)("option",{value:"2017-04-01 00:00:00",children:(0,Oe.__)("april","mailpoet")}),(0,p.jsx)("option",{value:"2017-05-01 00:00:00",children:(0,Oe.__)("may","mailpoet")}),(0,p.jsx)("option",{value:"2017-06-01 00:00:00",children:(0,Oe.__)("june","mailpoet")}),(0,p.jsx)("option",{value:"2017-07-01 00:00:00",children:(0,Oe.__)("july","mailpoet")}),(0,p.jsx)("option",{value:"2017-08-01 00:00:00",children:(0,Oe.__)("august","mailpoet")}),(0,p.jsx)("option",{value:"2017-09-01 00:00:00",children:(0,Oe.__)("september","mailpoet")}),(0,p.jsx)("option",{value:"2017-10-01 00:00:00",children:(0,Oe.__)("october","mailpoet")}),(0,p.jsx)("option",{value:"2017-11-01 00:00:00",children:(0,Oe.__)("november","mailpoet")}),(0,p.jsx)("option",{value:"2017-12-01 00:00:00",children:(0,Oe.__)("december","mailpoet")})]},"select")]})},year:function(e){let{onChange:t,item:i,filterIndex:a}=e;const s=(0,Er.default)(new Date);return(0,o.useEffect)((()=>{Rr(i)||t((0,Za.assign)(i,{value:`${s}-01-01 00:00:00`,operator:"equals"}),a)}),[s,t,i,a]),(0,p.jsxs)(ki.Grid.CenteredRow,{children:[(0,p.jsxs)(lt.Select,{value:i.operator,onChange:e=>{t((0,Za.assign)(i,{operator:e.target.value}),a)},children:[(0,p.jsx)("option",{value:"equals",children:(0,Oe.__)("is","mailpoet")}),(0,p.jsx)("option",{value:"before",children:(0,Oe._x)("before",'Meaning: "Subscriber subscribed before April"',"mailpoet")}),(0,p.jsx)("option",{value:"after",children:(0,Oe._x)("after",'Meaning: "Subscriber subscribed after April',"mailpoet")}),(0,p.jsx)("option",{value:Qo.DB.BLANK,children:(0,Oe.__)("is blank","mailpoet")}),(0,p.jsx)("option",{value:Qo.DB.NOT_BLANK,children:(0,Oe.__)("is not blank","mailpoet")})]},"select-operator"),(0,p.jsx)(lt.Select,{value:i.value,onChange:e=>{t((0,Za.assign)(i,{value:e.target.value}),a)},children:(0,Za.range)(0,100).map((e=>(0,p.jsx)("option",{value:s-e+"-01-01 00:00:00",children:s-e},s-e)))},"select-year")]})},year_month:function(e){let{onChange:t,item:i,filterIndex:a}=e;return(0,o.useEffect)((()=>{void 0!==i.value&&""!==i.value||t((0,Za.assign)(i,{value:`${(0,Ar.default)(new Date,"yyyy-MM-dd")} 00:00:00`,operator:"equals"}),a)}),[t,i,a]),(0,p.jsxs)(ki.Grid.CenteredRow,{children:[(0,p.jsxs)(lt.Select,{value:i.operator,onChange:e=>{t((0,Za.assign)(i,{operator:e.target.value}),a)},children:[(0,p.jsx)("option",{value:"equals",children:(0,Oe.__)("is","mailpoet")}),(0,p.jsx)("option",{value:"before",children:(0,Oe._x)("before",'Meaning: "Subscriber subscribed before April"',"mailpoet")}),(0,p.jsx)("option",{value:"after",children:(0,Oe._x)("after",'Meaning: "Subscriber subscribed after April',"mailpoet")}),(0,p.jsx)("option",{value:Qo.DB.BLANK,children:(0,Oe.__)("is blank","mailpoet")}),(0,p.jsx)("option",{value:Qo.DB.NOT_BLANK,children:(0,Oe.__)("is not blank","mailpoet")})]},"select-operator"),!(0,Qo.F3)(i.operator)&&(0,p.jsx)(Ri.a,{onChange:e=>t((0,Za.assign)(i,{value:Or(e)}),a),selected:i.value?Lr(i.value):void 0,dateFormat:"MM/yyyy",showMonthYearPicker:!0})]})},year_month_day:function(e){let{onChange:t,item:i,filterIndex:a}=e;return(0,o.useEffect)((()=>{Rr(i)||t((0,Za.assign)(i,{value:`${(0,Ar.default)(new Date,"yyyy-MM-dd")} 00:00:00`,operator:"equals"}),a)}),[t,i,a]),(0,p.jsxs)(ki.Grid.CenteredRow,{children:[(0,p.jsxs)(lt.Select,{value:i.operator,onChange:e=>{t((0,Za.assign)(i,{operator:e.target.value}),a)},children:[(0,p.jsx)("option",{value:"equals",children:(0,Oe.__)("is","mailpoet")}),(0,p.jsx)("option",{value:"before",children:(0,Oe._x)("before",'Meaning: "Subscriber subscribed before April"',"mailpoet")}),(0,p.jsx)("option",{value:"after",children:(0,Oe._x)("after",'Meaning: "Subscriber subscribed after April',"mailpoet")}),(0,p.jsx)("option",{value:Qo.DB.BLANK,children:(0,Oe.__)("is blank","mailpoet")}),(0,p.jsx)("option",{value:Qo.DB.NOT_BLANK,children:(0,Oe.__)("is not blank","mailpoet")})]},"select-operator"),!(0,Qo.F3)(i.operator)&&(0,p.jsx)(Ri.a,{dateFormat:"MMM d, yyyy",onChange:e=>t((0,Za.assign)(i,{value:Or(e)}),a),selected:i.value?Lr(i.value):void 0})]})}};var Dr=function(e){return e.DATE="date",e.TEXT="text",e.TEXTAREA="textarea",e.RADIO="radio",e.CHECKBOX="checkbox",e.SELECT="select",e}(Dr||{});const qr={[Dr.TEXT]:Ir,[Dr.TEXTAREA]:Ir,[Dr.RADIO]:Cr,[Dr.SELECT]:Cr,[Dr.CHECKBOX]:function(e){return!!(0,Qo.F3)(e.operator)||["1","0"].includes(e.value)},[Dr.DATE]:Rr},$r={[Dr.TEXT]:kr,[Dr.TEXTAREA]:kr,[Dr.RADIO]:Tr,[Dr.SELECT]:Tr,[Dr.CHECKBOX]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilterFromEvent:a,updateSegmentFilter:s}=(0,he.Z)(Xo.t);return(0,o.useEffect)((()=>{void 0===i.operator?s({operator:"equals",value:"1"},t):"equals"!==i.operator||["1","0"].includes(i.value)||s({value:"1"},t)}),[s,i,t]),(0,p.jsxs)(ki.Grid.CenteredRow,{children:[(0,p.jsxs)(lt.Select,{value:i.operator,onChange:e=>{a("operator",t,e)},children:[(0,p.jsx)("option",{value:"equals",children:(0,Oe.__)("is","mailpoet")}),(0,p.jsx)("option",{value:Qo.DB.BLANK,children:(0,Oe.__)("is blank","mailpoet")}),(0,p.jsx)("option",{value:Qo.DB.NOT_BLANK,children:(0,Oe.__)("is not blank","mailpoet")})]},"select-operator"),!(0,Qo.F3)(i.operator)&&(0,p.jsxs)(lt.Select,{value:i.value,onChange:e=>a("value",t,e),children:[(0,p.jsx)("option",{value:"1",children:(0,Oe.__)("checked","mailpoet")}),(0,p.jsx)("option",{value:"0",children:(0,Oe.__)("unchecked","mailpoet")})]},"select")]})},[Dr.DATE]:function(e){let{customField:t,filterIndex:i}=e;const a=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(i)),[i]),{updateSegmentFilter:s}=(0,he.Z)(Xo.t);(0,o.useEffect)((()=>{a.date_type!==t.params.date_type&&s({date_type:t.params.date_type,value:""},i)}),[a.date_type,s,t.params.date_type,i]);const n=Fr[t.params.date_type];return n?(0,p.jsx)(n,{item:a,onChange:s,filterIndex:i}):null}};function Br(){return(0,p.jsx)(co,{message:(()=>{const e=c.MailPoet.I18n.t("premiumFeatureMultipleConditions");return(0,p.jsx)("p",{children:_()(e,/\[link](.*?)\[\/link]/g,(e=>(0,p.jsx)("a",{href:c.MailPoet.premiumLink,target:"_blank",rel:"noopener noreferrer",children:e},e)))})})(),actionButton:(0,p.jsx)(Le.z,{href:c.MailPoet.MailPoetComUrlFactory.getPurchasePlanUrl(c.MailPoet.subscribersCount,c.MailPoet.currentWpUserEmail,null,{utm_medium:"segments",utm_campaign:"signup"}),target:"_blank",rel:"noopener noreferrer",children:c.MailPoet.I18n.t("premiumBannerCtaFree")})})}const Wr={[Qo.jx.WORDPRESS_ROLE]:Pr,[Qo.jx.SUBSCRIBER_SCORE]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a,updateSegmentFilterFromEvent:s}=(0,he.Z)(Xo.t);return(0,o.useEffect)((()=>{Nr.includes(i.operator)||a({operator:Mr.HIGHER_THAN},t),i.operator!==Mr.HIGHER_THAN&&i.operator!==Mr.LOWER_THAN&&i.operator!==Mr.EQUALS&&i.operator!==Mr.NOT_EQUALS||void 0!==i.value||a({value:""},t),i.operator!==Mr.UNKNOWN&&i.operator!==Mr.NOT_UNKNOWN||a({value:null},t)}),[a,i,t]),(0,p.jsx)(ki.Grid.CenteredRow,{children:(n=e=>"{condition}"===e?(0,p.jsxs)(lt.Select,{value:i.operator,automationId:"segment-subscriber-score-operator",onChange:e=>{s("operator",t,e)},children:[(0,p.jsx)("option",{value:Mr.HIGHER_THAN,children:c.MailPoet.I18n.t("higherThan")}),(0,p.jsx)("option",{value:Mr.LOWER_THAN,children:c.MailPoet.I18n.t("lowerThan")}),(0,p.jsx)("option",{value:Mr.EQUALS,children:c.MailPoet.I18n.t("equals")}),(0,p.jsx)("option",{value:Mr.NOT_EQUALS,children:c.MailPoet.I18n.t("notEquals")}),(0,p.jsx)("option",{value:Mr.UNKNOWN,children:c.MailPoet.I18n.t("unknown")}),(0,p.jsx)("option",{value:Mr.NOT_UNKNOWN,children:c.MailPoet.I18n.t("notUnknown")})]},"select"):"{score}"===e?(i.operator===Mr.HIGHER_THAN||i.operator===Mr.LOWER_THAN||i.operator===Mr.EQUALS||i.operator===Mr.NOT_EQUALS)&&(0,p.jsx)(at.I,{type:"number",value:i.value||"","data-automation-id":"segment-subscriber-score-value",onChange:e=>{s("value",t,e)},min:"0",placeholder:c.MailPoet.I18n.t("subscriberScorePlaceholder")},"input"):"string"==typeof e&&e.trim().length>0?i.operator!==Mr.UNKNOWN&&i.operator!==Mr.NOT_UNKNOWN&&(0,p.jsx)("div",{children:e},"score"):null,c.MailPoet.I18n.t("subscriberScoreSentence").split(/({condition})|({score})|(\b%\b)/gim).map(n))});var n},[Qo.jx.SUBSCRIBED_DATE]:br,[Qo.jx.MAILPOET_CUSTOM_FIELD]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a}=(0,he.Z)(Xo.t),s=(0,P.Z)((e=>e(Xo.t).getCustomFieldsList()),[]),n=(0,Za.find)({id:Number(i.custom_field_id)},s),o=s.map((e=>({value:e.id.toString(),label:e.name}))),r=$r[i.custom_field_type];return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{children:(0,p.jsx)(Uo.ReactSelect,{dimension:"small",isFullWidth:!0,placeholder:c.MailPoet.I18n.t("selectCustomFieldPlaceholder"),options:o,automationId:"select-custom-field",value:(0,Za.find)((e=>{if(i.custom_field_id)return i.custom_field_id===e.value}),o),onChange:e=>{const i=(0,Za.find)({id:Number(e.value)},s);i&&a({custom_field_id:e.value,custom_field_type:i.type,operator:void 0,value:void 0},t)}})}),(0,p.jsx)("div",{children:r&&(0,p.jsx)(r,{customField:n,filterIndex:t})})]})},[Qo.jx.SUBSCRIBED_TO_LIST]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),a=(0,P.Z)((e=>e(Xo.t).getStaticSegmentsList()),[]),{updateSegmentFilter:s,updateSegmentFilterFromEvent:n}=(0,he.Z)(Xo.t);(0,o.useEffect)((()=>{i.operator!==Qo.f5.ANY&&i.operator!==Qo.f5.ALL&&i.operator!==Qo.f5.NONE&&s({operator:Qo.f5.ANY},t)}),[s,i,t]);const r=a.map((e=>({value:e.id,label:e.name})));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(lt.Select,{isMinWidth:!0,value:i.operator,onChange:e=>{n("operator",t,e)},children:[(0,p.jsx)("option",{value:Qo.f5.ANY,children:c.MailPoet.I18n.t("anyOf")}),(0,p.jsx)("option",{value:Qo.f5.ALL,children:c.MailPoet.I18n.t("allOf")}),(0,p.jsx)("option",{value:Qo.f5.NONE,children:c.MailPoet.I18n.t("noneOf")})]},"select"),(0,p.jsx)(Uo.ReactSelect,{dimension:"small",isMulti:!0,placeholder:c.MailPoet.I18n.t("searchLists"),options:r,value:(0,Za.filter)((e=>{if(!i.segments)return;const t=e.value;return-1!==i.segments.indexOf(t)}),r),onChange:e=>{s({segments:(0,Za.map)((0,Za.parseInt)(10),(0,Za.map)("value",e))},t)}})]})},[Qo.jx.SUBSCRIBER_TAG]:function(e){let{filterIndex:t}=e;return Ot.Hooks.applyFilters("mailpoet_dynamic_segments_filter_subscriber_tag",(0,p.jsx)(Br,{}),t)},[Qo.jx.SUBSCRIBER_FIRST_NAME]:wr,[Qo.jx.SUBSCRIBER_LAST_NAME]:wr,[Qo.jx.SUBSCRIBER_EMAIL]:wr,[Qo.jx.SUBSCRIBED_VIA_FORM]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),a=(0,P.Z)((e=>e(Xo.t).getSignupForms()),[]),{updateSegmentFilter:s,updateSegmentFilterFromEvent:n}=(0,he.Z)(Xo.t);(0,o.useEffect)((()=>{i.operator!==Qo.f5.ANY&&i.operator!==Qo.f5.NONE&&s({operator:Qo.f5.ANY},t)}),[s,i,t]);const r=a.map((e=>({value:e.id,label:e.name})));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(lt.Select,{isMinWidth:!0,value:i.operator,onChange:e=>{n("operator",t,e)},children:[(0,p.jsx)("option",{value:Qo.f5.ANY,children:c.MailPoet.I18n.t("anyOf")}),(0,p.jsx)("option",{value:Qo.f5.NONE,children:c.MailPoet.I18n.t("noneOf")})]},"select"),(0,p.jsx)(Uo.ReactSelect,{dimension:"small",isMulti:!0,placeholder:c.MailPoet.I18n.t("searchForms"),options:r,value:r.filter((e=>{if(!i.form_ids)return;const t=e.value;return-1!==i.form_ids.indexOf(t)})),onChange:e=>{s({form_ids:e.map((e=>e.value))},t)}})]})},[Qo.jx.SUBSCRIBER_LAST_ENGAGEMENT_DATE]:xr,[Qo.jx.SUBSCRIBER_LAST_PURCHASE_DATE]:xr,[Qo.jx.SUBSCRIBER_LAST_OPEN_DATE]:xr,[Qo.jx.SUBSCRIBER_LAST_CLICK_DATE]:xr,[Qo.jx.SUBSCRIBER_LAST_PAGE_VIEW_DATE]:xr,[Qo.jx.SUBSCRIBER_LAST_SENDING_DATE]:xr},Vr={[Qo.Bt.Automations]:function(e){return!!Object.values(Jo.Z).some((t=>t===e.action))&&(e.action!==Jo.Z.ENTERED_AUTOMATION||function(e){return(e.operator===Qo.f5.ANY||e.operator===Qo.f5.NONE||e.operator===Qo.f5.ALL)&&Array.isArray(e.automation_ids)&&e.automation_ids.length>0}(e))},[Qo.Bt.Email]:function(e){return!!Object.values(Qo.zd).some((t=>t===e.action))&&(e.action===Qo.zd.CLICKED_ANY||(e.action===Qo.zd.CLICKED?!!e.newsletter_id:e.action!==Qo.zd.OPENS_ABSOLUTE_COUNT&&e.action!==Qo.zd.MACHINE_OPENS_ABSOLUTE_COUNT?Array.isArray(e.newsletters)&&e.newsletters.length>0:or(e)&&!!e.opens&&!!e.operator))},[Qo.Bt.WooCommerce]:function(e){return!!Object.values(vr.wq).some((t=>t===e.action))&&(e.action===vr.wq.PURCHASED_CATEGORY?function(e){return!(void 0===e.category_ids||0===e.category_ids.length||!e.operator)}(e):e.action===vr.wq.PURCHASED_PRODUCT?function(e){return!(void 0===e.product_ids||0===e.product_ids.length||!e.operator)}(e):e.action===vr.wq.CUSTOMER_IN_COUNTRY?function(e){return!(void 0===e.country_code||0===e.country_code.length)}(e):e.action===vr.wq.NUMBER_OF_ORDERS?function(e){return!(!e.number_of_orders_count||!or(e)||!e.number_of_orders_type)}(e):e.action===vr.wq.TOTAL_SPENT?function(e){return!(!e.total_spent_amount||!or(e)||!e.total_spent_type)}(e):e.action===vr.wq.SINGLE_ORDER_VALUE?function(e){return!(!e.single_order_value_amount||!or(e)||!e.single_order_value_type)}(e):e.action===vr.wq.AVERAGE_SPENT?function(e){return!(!e.average_spent_amount||!e.average_spent_type||!or(e))}(e):e.action===vr.wq.USED_PAYMENT_METHOD?function(e){return!(!e.payment_methods||e.payment_methods.length<1||!e.operator||!or(e))}(e):e.action===vr.wq.USED_SHIPPING_METHOD?function(e){return!(!e.shipping_methods||e.shipping_methods.length<1||!e.operator||!or(e))}(e):e.action===vr.wq.PURCHASE_DATE?fr(e):e.action===vr.wq.NUMBER_OF_REVIEWS?function(e){return!!(e.count&&e.count_type&&e.rating&&or(e))}(e):e.action===vr.wq.USED_COUPON_CODE?function(e){return!(!e.coupon_code_ids||e.coupon_code_ids.length<1||!(0,sr.J)(e.operator,Qo.f5)||!or(e))}(e):![vr.wq.CUSTOMER_IN_POSTAL_CODE,vr.wq.CUSTOMER_IN_CITY].includes(e.action)||jr(e))},[Qo.Bt.WordPressRole]:function(e){return e.action&&e.action!==Qo.jx.WORDPRESS_ROLE?e.action===Qo.jx.MAILPOET_CUSTOM_FIELD?function(e){const t=qr[e.custom_field_type];return!!t&&t(e)}(e):e.action===Qo.jx.SUBSCRIBER_SCORE?function(e){if(e.operator===Mr.HIGHER_THAN||e.operator===Mr.LOWER_THAN||e.operator===Mr.EQUALS||e.operator===Mr.NOT_EQUALS){const t=Number(e.value),i=Number(parseFloat(e.value));return!Number.isNaN(t)&&!Number.isNaN(i)&&t>=0&&t<=100}return e.operator===Mr.UNKNOWN||e.operator===Mr.NOT_UNKNOWN}(e):e.action===Qo.jx.SUBSCRIBED_TO_LIST?function(e){return(e.operator===Qo.f5.ANY||e.operator===Qo.f5.ALL||e.operator===Qo.f5.NONE)&&Array.isArray(e.segments)&&e.segments.length>0}(e):e.action===Qo.jx.SUBSCRIBER_TAG?function(e){return Ot.Hooks.applyFilters("mailpoet_dynamic_segments_filter_subscriber_tag_validate",!1,e)}(e):[Qo.jx.SUBSCRIBER_FIRST_NAME,Qo.jx.SUBSCRIBER_LAST_NAME,Qo.jx.SUBSCRIBER_EMAIL].includes(e.action)?jr(e):[Qo.jx.SUBSCRIBER_LAST_ENGAGEMENT_DATE,Qo.jx.SUBSCRIBER_LAST_PURCHASE_DATE,Qo.jx.SUBSCRIBER_LAST_OPEN_DATE,Qo.jx.SUBSCRIBER_LAST_CLICK_DATE,Qo.jx.SUBSCRIBER_LAST_PAGE_VIEW_DATE,Qo.jx.SUBSCRIBER_LAST_SENDING_DATE].includes(e.action)?fr(e):e.action===Qo.jx.SUBSCRIBED_VIA_FORM?function(e){return(e.operator===Qo.f5.ANY||e.operator===Qo.f5.NONE)&&Array.isArray(e.form_ids)&&e.form_ids.length>0}(e):!(!e.operator||!e.value)&&!!Object.values(mr).includes(e.operator)&&fr(e):Array.isArray(e.wordpressRole)&&e.wordpressRole.length>0},[Qo.Bt.WooCommerceMembership]:function(e){const t=!e.plan_ids||!e.plan_ids.length||!e.operator;return e.action!==vr.hs.MEMBER_OF||!t},[Qo.Bt.WooCommerceSubscription]:function(e){const t=!e.product_ids||!e.product_ids.length||!e.operator;return e.action!==vr.ht.ACTIVE_SUBSCRIPTIONS||!t}};function Ur(e){return!(e.length<1)&&0===e.map((e=>void 0!==Vr[e.segmentType]&&Vr[e.segmentType](e))).filter((e=>!1===e)).length}let Hr,zr;function Zr(){const e=(0,P.Z)((e=>e(Xo.t).getSegment()),[]),t=(0,P.Z)((e=>e(Xo.t).getSubscriberCount()),[]),{updateSubscriberCount:i}=(0,he.Z)(Xo.t),a=JSON.stringify(e),s=(0,o.useRef)(1),n=(0,o.useRef)(null),r=(0,o.useRef)(!1),l=(0,o.useRef)((0,Pi.debounce)((function e(t){if(r.current)return void(n.current=t);n.current=null,s.current+=1;const a=s.current;r.current=!0,function(e){const t={filters:e.filters,filters_connect:e.filters_connect};return Mi().isEqual(t,Hr)?Promise.resolve(zr):(Hr={filters:[...e.filters],filters_connect:e.filters_connect},c.MailPoet.Ajax.post({api_version:c.MailPoet.apiVersion,endpoint:"dynamic_segments",action:"getCount",data:e,timeout:2e4}).then((e=>{const{data:t}=e;return zr={count:t.count,errors:void 0},zr})))}(t).then((t=>{if(r.current=!1,n.current)return void e(n.current);if(a!==s.current)return;const o={loading:!1};t&&(o.count=t.count,o.errors=t.errors),i(o)}),(e=>{r.current=!1;const t={},a=e.errors.map((e=>e.message));t.loading=!1,t.count=void 0,t.errors=a,i(t)}))}),2e3,{trailing:!0}));return(0,o.useEffect)((()=>{Ur(e.filters)?(i({loading:!0,count:void 0,errors:void 0}),(0,l.current)(e)):i({count:void 0,loading:!1})}),[e,a,i]),t.errors?(0,p.jsx)("div",{className:"mailpoet-form-field",children:(0,p.jsxs)("span",{className:"mailpoet-form-error-message",children:[c.MailPoet.I18n.t("dynamicSegmentSizeCalculatingTimeout")," ",(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/237-guide-to-subscriber-segmentation?utm_source=plugin&utm_medium=segments",target:"_blank",className:"mailpoet-form-error-message",rel:"noopener noreferrer",children:c.MailPoet.I18n.t("learnMore")})]})}):t.loading||void 0!==t.count?t.loading?(0,p.jsx)("div",{className:"mailpoet-form-field",children:(0,p.jsx)("span",{className:"mailpoet-form-notice-message",children:c.MailPoet.I18n.t("dynamicSegmentSizeIsCalculated")})}):(0,p.jsx)("div",{className:"mailpoet-form-field",children:(0,p.jsx)("span",{className:"mailpoet-form-notice-message",children:c.MailPoet.I18n.t("dynamicSegmentSize").replace("%1$d",t.count.toLocaleString())})}):(0,p.jsx)("span",{})}const Yr={[Qo.Bt.Automations]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),a=tr[i.action];return(0,p.jsx)(a,{filterIndex:t})},[Qo.Bt.Email]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),a=lr[i.action];return a?(0,p.jsx)(a,{filterIndex:t}):null},[Qo.Bt.WooCommerce]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),a=Sr[i.action];return(0,p.jsx)(a,{filterIndex:t})},[Qo.Bt.WordPressRole]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]);let a;return a=i.action?Wr[i.action]:Pr,a?(0,p.jsx)(a,{filterIndex:t}):null},[Qo.Bt.WooCommerceMembership]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a,updateSegmentFilterFromEvent:s}=(0,he.Z)(Xo.t),n=(0,P.Z)((e=>e(Xo.t).getMembershipPlans()),[]).map((e=>({value:e.id,label:e.name})));return(0,o.useEffect)((()=>{i.action===vr.hs.MEMBER_OF&&i.operator!==Qo.f5.ANY&&i.operator!==Qo.f5.ALL&&i.operator!==Qo.f5.NONE&&a({operator:Qo.f5.ANY},t)}),[a,i,t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ki.Grid.CenteredRow,{children:(0,p.jsxs)(lt.Select,{value:i.operator,onChange:e=>s("operator",t,e),automationId:"select-operator",children:[(0,p.jsx)("option",{value:Qo.f5.ANY,children:c.MailPoet.I18n.t("anyOf")}),(0,p.jsx)("option",{value:Qo.f5.ALL,children:c.MailPoet.I18n.t("allOf")}),(0,p.jsx)("option",{value:Qo.f5.NONE,children:c.MailPoet.I18n.t("noneOf")})]},"select-operator")}),(0,p.jsx)(ki.Grid.CenteredRow,{children:(0,p.jsx)(Uo.ReactSelect,{isMulti:!0,dimension:"small",isFullWidth:!0,placeholder:c.MailPoet.I18n.t("selectWooMembership"),options:n,value:(0,Za.filter)((e=>!!i.plan_ids&&-1!==i.plan_ids.indexOf(e.value)),n),onChange:e=>{a({plan_ids:(e||[]).map((e=>e.value))},t)},automationId:"select-segment-plans"},"select-segment-membership-plan")})]})},[Qo.Bt.WooCommerceSubscription]:function(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]),{updateSegmentFilter:a,updateSegmentFilterFromEvent:s}=(0,he.Z)(Xo.t),n=(0,P.Z)((e=>e(Xo.t).getSubscriptionProducts()),[]).map((e=>({value:e.id,label:e.name})));return(0,o.useEffect)((()=>{i.action===vr.ht.ACTIVE_SUBSCRIPTIONS&&i.operator!==Qo.f5.ANY&&i.operator!==Qo.f5.ALL&&i.operator!==Qo.f5.NONE&&a({operator:Qo.f5.ANY},t)}),[a,i,t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ki.Grid.CenteredRow,{children:(0,p.jsxs)(lt.Select,{value:i.operator,onChange:e=>s("operator",t,e),automationId:"select-operator",children:[(0,p.jsx)("option",{value:Qo.f5.ANY,children:c.MailPoet.I18n.t("anyOf")}),(0,p.jsx)("option",{value:Qo.f5.ALL,children:c.MailPoet.I18n.t("allOf")}),(0,p.jsx)("option",{value:Qo.f5.NONE,children:c.MailPoet.I18n.t("noneOf")})]},"select-operator")}),(0,p.jsx)(ki.Grid.CenteredRow,{children:(0,p.jsx)(Uo.ReactSelect,{isMulti:!0,dimension:"small",isFullWidth:!0,placeholder:c.MailPoet.I18n.t("selectWooSubscription"),options:n,value:(0,Za.filter)((e=>!!i.product_ids&&-1!==i.product_ids.indexOf(e.value)),n),onChange:e=>{a({product_ids:(e||[]).map((e=>e.value))},t)},automationId:"select-segment-products"},"select-segment-category")})]})}};function Gr(e){let{filterIndex:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegmentFilter(t)),[t]);if(void 0===i||void 0===Yr[i.segmentType])return null;const a=Yr[i.segmentType];return(0,p.jsx)(a,{filterIndex:t})}function Kr(){const e=(0,P.Z)((e=>e(Xo.t).getSegment()),[]),t=[Qo.zd.OPENED,Qo.zd.OPENS_ABSOLUTE_COUNT,Qo.zd.MACHINE_OPENED,Qo.zd.MACHINE_OPENS_ABSOLUTE_COUNT];let i=!1;return e.filters.forEach((e=>{t.includes(e.action)&&(i=!0)})),i?(0,p.jsx)("div",{className:"mailpoet-form-field",children:(0,p.jsx)("span",{className:"mailpoet-form-notice-message",children:c.MailPoet.I18n.t("privacyProtectionNotice")})}):(0,p.jsx)("span",{})}const Qr=Ot.Hooks.applyFilters("mailpoet_dynamic_segments_form_filters_before",(()=>null)),Xr=Ot.Hooks.applyFilters("mailpoet_dynamic_filters_filter_before",(()=>null)),Jr=Ot.Hooks.applyFilters("mailpoet_dynamic_filters_filter_after",(()=>(0,p.jsx)("div",{className:"mailpoet-gap"})));function el(e){let{isNewSegment:t}=e;const i=(0,P.Z)((e=>e(Xo.t).getSegment()),[]),a=(0,P.Z)((e=>e(Xo.t).getAvailableFilters()),[]),s=(0,P.Z)((e=>e(Xo.t).findFiltersValueForSegment(i)),[i]),n=(0,P.Z)((e=>e(Xo.t).getSubscriberCount()),[]),r=(0,P.Z)((e=>e(Xo.t).getErrors()),[]),{updateSegment:l,updateSegmentFilter:d,handleSave:m}=(0,he.Z)(Xo.t),[u,h]=(0,o.useState)(!1),g=Ot.Hooks.applyFilters("mailpoet_dynamic_segments_form_add_condition_action",(()=>{h(!0)}));return(0,p.jsx)("div",{className:"mailpoet-form-container",children:(0,p.jsxs)("form",{children:[r.length>0&&(0,p.jsx)(Jt,{errors:r.map((e=>({message:e})))}),(0,p.jsxs)(Yo,{title:(0,Oe.__)("Details","mailpoet"),description:(0,Oe.__)("What do you want to call this segment?","mailpoet"),children:[(0,p.jsx)(Go,{slug:"name",title:(0,Oe.__)("Name","mailpoet"),children:(0,p.jsx)(at.I,{isFullWidth:!0,type:"text",name:"name",id:"field_name",value:i.name||"","data-automation-id":"input-name",onChange:e=>{l({name:e.target.value})},placeholder:(0,Oe.__)("Enter name","mailpoet")})}),(0,p.jsx)(Go,{slug:"description",title:(0,Oe.__)("Description","mailpoet"),description:(0,Oe.__)("This text box is for your own use and is never shown to your subscribers.","mailpoet"),children:(0,p.jsx)(at.I,{isFullWidth:!0,name:"description",id:"field_description",value:i.description||"","data-automation-id":"input-description",onChange:e=>{l({description:e.target.value})},placeholder:(0,Oe.__)("Enter description","mailpoet")})})]}),(0,p.jsx)(Yo,{title:(0,Oe.__)("Conditions","mailpoet"),description:(0,Oe.__)("Set your segment constraints","mailpoet"),children:(0,p.jsx)(Go,{children:(0,p.jsxs)("div",{className:"mailpoet-segments-segments-section",children:[(0,p.jsx)(Qr,{}),Array.isArray(s)&&s.map(((e,t)=>(0,p.jsxs)(o.Fragment,{children:[(0,p.jsxs)("div",{className:"mailpoet-segments-grid","data-automation-id":`filter-row-${t}`,children:[(0,p.jsx)(Xr,{filterRows:s,index:t}),(0,p.jsx)("div",{className:"mailpoet-segments-filter-selector",children:(0,p.jsx)(Uo.ReactSelect,{dimension:"small",placeholder:(0,Oe.__)("Select action","mailpoet"),options:a,value:e.filterValue,onChange:e=>{d({segmentType:e.group,action:e.value},t)},automationId:"select-segment-action",isFullWidth:!0})}),void 0!==e.index&&(0,p.jsx)(Gr,{filterIndex:e.index})]}),(0,p.jsx)(Jr,{index:t})]},e.index))),(0,p.jsxs)("div",{className:"mailpoet-segments-conditions-bottom",children:[(0,p.jsx)(ue.ZP,{type:"button",variant:"secondary",onClick:e=>{e.preventDefault(),g(i,l)},children:(0,Oe.__)("Add a condition","mailpoet")}),(!c.MailPoet.premiumActive||!c.MailPoet.hasValidPremiumKey||c.MailPoet.subscribersLimitReached)&&(0,p.jsx)(Ko.x,{text:(0,Oe.__)("UPGRADE","mailpoet")}),u&&(0,p.jsx)(Ki.ZG,{onRequestClose:()=>{h(!1)},children:(0,Oe.__)("Multiple conditions per segment are not available in the free version of the MailPoet plugin.","mailpoet")})]})]})})}),(0,p.jsxs)("div",{className:"mailpoet-admin-fields-footer",children:[(0,p.jsxs)("div",{className:"mailpoet-segments-counter-section",children:[(0,p.jsx)(Zr,{}),(0,p.jsx)(Kr,{})]}),(0,p.jsx)("div",{className:"mailpoet-form-actions",children:(0,p.jsx)(ue.ZP,{variant:"primary",type:"submit",onClick:e=>{e.preventDefault(),m(t)},disabled:!Ur(i.filters)||void 0===n.count,children:(0,Oe.__)("Save","mailpoet")})})]})]})})}function tl(){const e=(0,Ne.$B)(),{pageLoaded:t,pageUnloaded:i}=(0,he.Z)(Xo.t),a=(0,P.Z)((e=>e(Xo.t).getPreviousPage()))||"/";(0,o.useEffect)((()=>(t(e.params.id),()=>{i()})),[e.params.id,t,i]);const s=void 0===e.params.id||Number.isNaN(Number(e.params.id));return(0,p.jsxs)("div",{className:"mailpoet-main-container",children:[(0,p.jsx)(d.Q,{}),(0,p.jsx)(St.B,{}),(0,p.jsx)(Wo.Z,{className:"mailpoet-heading",direction:["column","row"],gap:"16px",children:(0,p.jsx)(Vo.Z,{children:(0,p.jsxs)("h1",{className:"wp-heading-inline",children:[(0,p.jsx)(ue.ZP,{id:"mailpoet-segments-back-button",icon:xe.Z,href:`#${a}`,label:(0,Oe.__)("Return to previous page","mailpoet")}),e.params.id?(0,Oe.__)("Edit segment","mailpoet"):(0,Oe.__)("New segment","mailpoet")]})})}),(0,p.jsx)(el,{isNewSegment:s})]})}tl.displayName="SegmentEditor";const il=[{name:"name",label:c.MailPoet.I18n.t("nameColumn"),sortable:!0},{name:"description",label:c.MailPoet.I18n.t("description"),sortable:!1},{name:"count",label:c.MailPoet.I18n.t("subscribersCountColumn"),sortable:!1},{name:"subscribed",label:c.MailPoet.I18n.t("subscribed"),sortable:!1},{name:"updated_at",label:c.MailPoet.I18n.t("updatedAtColumn"),sortable:!0}],al={onLoadingItems:()=>c.MailPoet.I18n.t("loadingDynamicSegmentItems"),onNoItemsFound:()=>c.MailPoet.I18n.t("noDynamicSegmentItemsFound"),onTrash:e=>{const t=Number(e.meta.count);let i=null;i=1===t?c.MailPoet.I18n.t("oneDynamicSegmentTrashed"):c.MailPoet.I18n.t("multipleDynamicSegmentsTrashed").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onDelete:e=>{const t=Number(e.meta.count);let i=null;i=1===t?c.MailPoet.I18n.t("oneDynamicSegmentDeleted"):c.MailPoet.I18n.t("multipleDynamicSegmentsDeleted").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onRestore:e=>{const t=Number(e.meta.count);let i=null;i=1===t?c.MailPoet.I18n.t("oneDynamicSegmentRestored"):c.MailPoet.I18n.t("multipleDynamicSegmentsRestored").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)}},sl=[{name:"edit",className:"mailpoet-hide-on-mobile",link:e=>(0,p.jsx)(Me.Link,{to:`${So.jY}/${e.id}`,children:c.MailPoet.I18n.t("edit")}),display:e=>!e.is_plugin_missing},{name:"duplicate_segment",className:"mailpoet-hide-on-mobile",label:c.MailPoet.I18n.t("duplicate"),onClick:(e,t)=>c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"dynamic_segments",action:"duplicate",data:{id:e.id}}).done((e=>{c.MailPoet.Notice.success(c.MailPoet.I18n.t("segmentDuplicated").replace("%1$s",(0,wo.r)(e.data.name)),{scroll:!0}),t()})).fail((e=>{c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0})}))},{name:"edit_disabled",className:"mailpoet-hide-on-mobile mailpoet-disabled",link:e=>(0,p.jsx)(Me.Link,{to:`${So.jY}/${e.id}`,children:c.MailPoet.I18n.t("edit")}),display:e=>e.is_plugin_missing},{name:"view_subscribers",link:e=>(0,p.jsx)("a",{href:e.subscribers_url,children:c.MailPoet.I18n.t("viewSubscribers")})},{name:"trash",className:"mailpoet-hide-on-mobile"}],nl=[{name:"trash",label:c.MailPoet.I18n.t("moveToTrash"),onSuccess:al.onTrash}];function ol(e,t){return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("td",{className:"column-primary","data-colname":c.MailPoet.I18n.t("nameColumn"),children:[(0,p.jsx)("span",{className:"mailpoet-listing-title",children:e.name}),t]}),(0,p.jsx)("td",{"data-colname":c.MailPoet.I18n.t("description"),children:(0,p.jsx)("abbr",{children:e.description})}),e.is_plugin_missing?(0,p.jsx)("td",{colSpan:2,className:"column mailpoet-hide-on-mobile","data-colname":c.MailPoet.I18n.t("missingPluginMessageColumn"),children:e.missing_plugin_message&&e.missing_plugin_message.message&&e.missing_plugin_message.link?_()(e.missing_plugin_message.message,/\[link](.*?)\[\/link]/g,(t=>(0,p.jsx)("a",{className:"mailpoet-listing-link-important",href:e.missing_plugin_message.link,target:"_blank",rel:"noopener noreferrer",children:t},"missingPluginMessageLink"))):e.missing_plugin_message.message}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("td",{className:"column mailpoet-hide-on-mobile","data-colname":c.MailPoet.I18n.t("subscribersCountColumn"),children:parseInt(e.count_all,10).toLocaleString()}),(0,p.jsx)("td",{className:"column mailpoet-hide-on-mobile","data-colname":c.MailPoet.I18n.t("subscribed"),children:parseInt(e.count_subscribed,10).toLocaleString()})]}),(0,p.jsxs)("td",{className:"column-date mailpoet-hide-on-mobile","data-colname":c.MailPoet.I18n.t("updatedAtColumn"),children:[c.MailPoet.Date.short(e.created_at),(0,p.jsx)("br",{}),c.MailPoet.Date.time(e.created_at)]})]})}const rl=(0,Ne.EN)((function(e){return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Po,{segmentType:"dynamic"}),(0,p.jsx)(Ee.N,{limit:window.mailpoet_listing_per_page,location:e.location,params:e.match.params,search:!0,onRenderItem:ol,endpoint:"dynamic_segments",base_url:"segments",columns:il,messages:al,sort_by:"created_at",sort_order:"desc",item_actions:sl,bulk_actions:nl}),(0,p.jsxs)("p",{className:"mailpoet_sending_methods_help help",children:[(0,p.jsxs)("b",{children:[c.MailPoet.I18n.t("segmentsTip"),":"]})," ",c.MailPoet.I18n.t("segmentsTipText")," ",(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/237-guide-to-subscriber-segmentation?utm_source=plugin&utm_medium=segments&utm_campaign=helpdocs",target:"_blank",rel:"noopener noreferrer",children:c.MailPoet.I18n.t("segmentsTipLink")})]})]})}));var ll=i(77110),dl=i(18925),cl=i(35100);const ml=({count:e,className:t="",...i})=>(0,o.createElement)("span",{className:`woocommerce-badge ${t}`,...i},e);var ul=i(26430),pl=i(58663),hl=i(6422),gl=i(80373);const fl=[{name:(0,Oe.__)("Recently Subscribed","mailpoet"),slug:"recently-subscribed",category:Qo.r9.ENGAGEMENT,description:(0,Oe.__)("Contacts who have subscribed to your emails within the last 30 days.","mailpoet"),isEssential:!0,filters:[{segmentType:"userRole",action:"subscribedDate",operator:"inTheLast",value:"30"}]},{name:(0,Oe.__)("Engaged Subscribers (30 days)","mailpoet"),slug:"engaged-subscribers-30-days",category:Qo.r9.ENGAGEMENT,description:(0,Oe.__)("Contacts who have interacted with your emails or made at least one purchase, and received emails from you in the last 30 days.","mailpoet"),isEssential:!0,filters:[{segmentType:"userRole",action:"lastClickDate",operator:"inTheLast",value:"30"},{segmentType:"userRole",action:"lastOpenDate",operator:"inTheLast",value:"30"},{segmentType:"userRole",action:"lastPurchaseDate",operator:"inTheLast",value:"30"},{segmentType:"userRole",action:"lastSendingDate",operator:"inTheLast",value:"30"}],filtersConnect:Qo.cK.OR},{name:(0,Oe.__)("Engaged Subscribers (3 months)","mailpoet"),slug:"engaged-subscribers-3-months",category:Qo.r9.ENGAGEMENT,description:(0,Oe.__)("Contacts who have interacted with your emails or made at least one purchase, and received emails from you in the last 3 months.","mailpoet"),isEssential:!0,filters:[{segmentType:"userRole",action:"lastClickDate",operator:"inTheLast",value:"90"},{segmentType:"userRole",action:"lastOpenDate",operator:"inTheLast",value:"90"},{segmentType:"userRole",action:"lastPurchaseDate",operator:"inTheLast",value:"90"},{segmentType:"userRole",action:"lastSendingDate",operator:"inTheLast",value:"90"}],filtersConnect:Qo.cK.OR},{name:(0,Oe.__)("Engaged Subscribers (6 months)","mailpoet"),slug:"engaged-subscribers-6-months",category:Qo.r9.ENGAGEMENT,description:(0,Oe.__)("Contacts who have interacted with your emails or made at least one purchase, and received emails from you in the last 6 months.","mailpoet"),isEssential:!0,filters:[{segmentType:"userRole",action:"lastClickDate",operator:"inTheLast",value:"180"},{segmentType:"userRole",action:"lastOpenDate",operator:"inTheLast",value:"180"},{segmentType:"userRole",action:"lastPurchaseDate",operator:"inTheLast",value:"180"},{segmentType:"userRole",action:"lastSendingDate",operator:"inTheLast",value:"180"}],filtersConnect:Qo.cK.OR},{name:(0,Oe.__)("Recent Buyers","mailpoet"),slug:"recent-buyers",category:Qo.r9.PURCHASE_HISTORY,description:(0,Oe.__)("Customers who have made a purchase within the last 30 days. ","mailpoet"),isEssential:!0,filters:[{segmentType:"woocommerce",action:"numberOfOrders",timeframe:Qo.u4.IN_THE_LAST,number_of_orders_type:">",number_of_orders_count:0,days:"30"}]},{name:(0,Oe.__)("Repeat Buyers","mailpoet"),slug:"repeat-buyers",category:Qo.r9.PURCHASE_HISTORY,description:(0,Oe.__)("Customers who have made at least two purchases in the last 6 months.","mailpoet"),isEssential:!0,filters:[{segmentType:"woocommerce",action:"numberOfOrders",timeframe:Qo.u4.IN_THE_LAST,number_of_orders_type:">",number_of_orders_count:1,days:"180"}]},{name:(0,Oe.__)("Loyal Buyers","mailpoet"),slug:"loyal-buyers",category:Qo.r9.PURCHASE_HISTORY,description:(0,Oe.__)("Customers who have made at least five purchases in the last 12 months.","mailpoet"),isEssential:!0,filters:[{segmentType:"woocommerce",action:"numberOfOrders",timeframe:Qo.u4.IN_THE_LAST,number_of_orders_type:">",number_of_orders_count:4,days:"365"}]},{name:(0,Oe.__)("Win-Back","mailpoet"),slug:"win-back",category:Qo.r9.PURCHASE_HISTORY,description:(0,Oe.__)("Customers who have previously purchased, but haven’t made a purchase in the last 6 months.","mailpoet"),isEssential:!0,filters:[{segmentType:"userRole",action:"lastPurchaseDate",operator:"notInTheLast",value:"180"}]},{name:(0,Oe.__)("Lapsed Customers","mailpoet"),slug:"lapsed-customers",category:Qo.r9.PURCHASE_HISTORY,description:(0,Oe.__)("Customers who haven’t made a purchase in the last 9 months.","mailpoet"),isEssential:!1,filters:[{segmentType:"userRole",action:"lastPurchaseDate",operator:"notInTheLast",value:"270"}]},{name:(0,Oe.__)("Recent Openers","mailpoet"),slug:"recent-openers",category:Qo.r9.ENGAGEMENT,description:(0,Oe.__)("Contacts who have opened an email in the last 7 days.","mailpoet"),isEssential:!1,filters:[{segmentType:"email",action:"opensAbsoluteCount",operator:"more",timeframe:Qo.u4.IN_THE_LAST,opens:"0",days:"7"}]},{name:(0,Oe.__)("Big Spenders","mailpoet"),slug:"big-spenders",category:Qo.r9.SHOPPING_BEHAVIOR,description:(0,Oe.__)("Customers who have completed $100 or more worth of orders in the last 12 months.","mailpoet"),isEssential:!1,filters:[{segmentType:"woocommerce",action:"totalSpent",timeframe:Qo.u4.IN_THE_LAST,total_spent_type:">",total_spent_amount:100,days:"365"}]}],_l=[{slug:Qo.r9.ENGAGEMENT,name:(0,Oe.__)("Engagement","mailpoet")},{slug:Qo.r9.PURCHASE_HISTORY,name:(0,Oe.__)("Purchase History","mailpoet")},{slug:Qo.r9.SHOPPING_BEHAVIOR,name:(0,Oe.__)("Shopping Behavior","mailpoet")}];function bl(e){const t=_l.find((t=>t.slug===e));return t?t.name:null}function xl(e){let{template:t}=e;const{createFromTemplate:i}=(0,he.Z)(Xo.t);return(0,p.jsxs)(Ho.C,{className:"mailpoet-templates-card",onClick:e=>{(e=>{e.preventDefault(),i(t)})(e)},children:[(0,p.jsxs)(ul.Z,{className:"mailpoet-templates-card-header",children:[t.isEssential&&(0,p.jsx)(pl.Z,{text:(0,Oe.__)("Essential segment","mailpoet"),children:(0,p.jsx)("div",{className:"mailpoet-templates-badge-essential",children:(0,p.jsx)(Q.Z,{icon:hl.Z,size:18})})}),(0,p.jsx)(ue.ZP,{variant:"link",children:t.name})]}),(0,p.jsxs)(zo.Z,{className:"mailpoet-templates-card-body",children:[(0,p.jsx)("p",{children:t.description}),(0,p.jsx)(gl.Z,{label:bl(t.category)})]})]})}const vl=[{name:"all",title:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("span",{children:(0,Oe.__)("All","mailpoet")}),(0,p.jsx)(ml,{count:fl.length})]})}];function yl(){const e=(0,P.Z)((e=>e(Xo.t).getErrors()),[]),t=()=>{c.MailPoet.trackEvent("Segments > New empty segment")};return(0,p.jsxs)("div",{className:"mailpoet-main-container",children:[(0,p.jsx)(St.B,{}),(0,p.jsx)(d.Q,{}),(0,p.jsxs)(Wo.Z,{className:"mailpoet-heading",direction:["column","row"],gap:"16px",children:[(0,p.jsx)(Vo.Z,{children:(0,p.jsxs)("h1",{className:"wp-heading-inline",children:[(0,p.jsx)(ue.ZP,{icon:xe.Z,"aria-label":(0,Oe.__)("Navigate to the segments list page","mailpoet"),href:"#/",label:(0,Oe.__)("Segments list","mailpoet")}),(0,Oe.__)("Start with a pre-built segment","mailpoet")]})}),(0,p.jsx)(ll.Z,{children:(0,p.jsx)(dl.Z,{label:(0,Oe.__)("Search segment templates","mailpoet")})}),(0,p.jsx)(ll.Z,{children:(0,p.jsx)(ue.ZP,{variant:"secondary",href:`#${So.yK}`,"data-automation-id":"new-custom-segment",onClick:()=>{t()},children:(0,Oe.__)("Create custom segment","mailpoet")})})]}),e.length>0&&(0,p.jsx)(Jt,{errors:e.map((e=>({message:e})))}),(0,p.jsx)(cl.Z,{tabs:vl,children:e=>(0,p.jsx)("div",{className:"mailpoet-templates-card-grid",children:fl.filter((t=>"all"===e.name||t.category===e.name)).map((e=>(0,p.jsx)(xl,{template:e},e.name)))})}),(0,p.jsxs)("div",{className:"mailpoet-templates-footer",children:[(0,p.jsx)("p",{children:(0,Oe.__)("Want to set your own conditions?","mailpoet")}),(0,p.jsx)(ue.ZP,{variant:"link",href:`#${So.yK}`,onClick:()=>{t()},children:(0,Oe.__)("Create custom segment","mailpoet")})]})]})}_l.forEach((e=>{const t=fl.filter((t=>t.category===e.slug)).length;vl.push({name:e.slug,title:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("span",{children:e.name}),(0,p.jsx)(ml,{count:t})]})})}));const jl=document.getElementById("dynamic_segments_container");function wl(){const{setPreviousPage:e}=(0,he.Z)(Xo.t),t=(0,Ne.k6)(),i=(0,o.useRef)(t.location.pathname);return(0,o.useEffect)((()=>t.listen((t=>{e(i.current),i.current=t.pathname}))),[t,e]),null}function Sl(){return(0,p.jsx)(l.k.Provider,{value:(0,l.S)(window),children:(0,p.jsxs)(Me.HashRouter,{children:[(0,p.jsx)(wl,{}),(0,p.jsx)(m.w,{}),(0,p.jsxs)(Ne.rs,{children:[(0,p.jsx)(Ne.AW,{path:So.yK,component:(0,r.withBoundary)(tl)}),(0,p.jsx)(Ne.AW,{path:`${So.jY}/:id`,component:(0,r.withBoundary)(tl)}),(0,p.jsx)(Ne.AW,{path:So.$W,component:(0,r.withBoundary)(yl)}),(0,p.jsx)(Ne.AW,{path:"*",component:(0,r.withBoundary)(rl)})]})]})})}jl&&((0,r.registerTranslations)(),(0,Xo.M)(),n.render((0,p.jsx)(Sl,{}),jl));const Pl=()=>{c.MailPoet.trackEvent("Forms > Add New"),setTimeout((()=>{window.location=window.mailpoet_form_template_selection_url}),200)};function Ml(){const[e,t]=(0,o.useState)(!1);return(0,p.jsx)(d.Q,{children:(0,p.jsx)(Le.z,{onClick:()=>{t(!0),Pl()},withSpinner:e,automationId:"create_new_form",variant:"secondary",iconStart:$e.R,children:c.MailPoet.I18n.t("new")})})}Ml.displayName="FormsHeading";const Nl=[{name:"name",label:c.MailPoet.I18n.t("formName"),sortable:!0},{name:"segments",label:c.MailPoet.I18n.t("segments")},{name:"type",label:c.MailPoet.I18n.t("type")},{name:"status",label:c.MailPoet.I18n.t("status")},{name:"updated_at",label:c.MailPoet.I18n.t("updatedAt"),sortable:!0}],Il={onTrash:e=>{const t=Number(e.meta.count);let i=null;i=1===t?c.MailPoet.I18n.t("oneFormTrashed"):c.MailPoet.I18n.t("multipleFormsTrashed").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onDelete:e=>{const t=Number(e.meta.count);let i=null;i=1===t?c.MailPoet.I18n.t("oneFormDeleted"):c.MailPoet.I18n.t("multipleFormsDeleted").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onRestore:e=>{const t=Number(e.meta.count);let i=null;i=1===t?c.MailPoet.I18n.t("oneFormRestored"):c.MailPoet.I18n.t("multipleFormsRestored").replace("%1$d",t.toLocaleString()),c.MailPoet.Notice.success(i)},onNoItemsFound:()=>(0,p.jsxs)("div",{className:"mailpoet-forms-add-new-row",children:[(0,p.jsx)("p",{children:c.MailPoet.I18n.t("noItemsFound")}),(0,p.jsx)(r.Button,{onClick:Pl,automationId:"add_new_form",iconStart:$e.R,children:c.MailPoet.I18n.t("new")})]})},kl=[{name:"trash",label:c.MailPoet.I18n.t("moveToTrash"),onSuccess:Il.onTrash}],Cl=[{name:"edit",className:"mailpoet-hide-on-mobile",label:c.MailPoet.I18n.t("edit"),link:function(e){return(0,p.jsx)("a",{href:`admin.php?page=mailpoet-form-editor&id=${e.id}`,children:c.MailPoet.I18n.t("edit")})}},{name:"duplicate",className:"mailpoet-hide-on-mobile",label:c.MailPoet.I18n.t("duplicate"),onClick:function(e,t){return c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"forms",action:"duplicate",data:{id:e.id}}).done((e=>{const i=e.data.name?e.data.name:c.MailPoet.I18n.t("noName");c.MailPoet.Notice.success(c.MailPoet.I18n.t("formDuplicated").replace("%1$s",(0,wo.r)(i))),t()})).fail((e=>{e.errors.length>0&&c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0})}))}},{name:"trash",className:"mailpoet-hide-on-mobile"}];class Tl extends o.Component{updateStatus=(e,t)=>{t.persist(),c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"forms",action:"setStatus",data:{id:Number(t.target.getAttribute("data-id")),status:e?"enabled":"disabled"}}).done((e=>{"enabled"===e.data.status&&c.MailPoet.Notice.success(c.MailPoet.I18n.t("formActivated"))})).fail((i=>{c.MailPoet.Notice.showApiErrorNotice(i),t.target.checked=!e}))};isItemInactive=e=>"disabled"===e.status;renderStatus(e){return(0,p.jsxs)("div",{children:[(0,p.jsx)(Yi.Z,{onCheck:this.updateStatus,"data-id":e.id,dimension:"small",defaultChecked:"enabled"===e.status}),(0,p.jsxs)("p",{children:[c.MailPoet.I18n.t("signups"),": ",e.signups.toLocaleString()]})]})}renderItem=(e,t)=>{null===e.settings&&c.MailPoet.Notice.error(c.MailPoet.I18n.t("formSettingsCorrupted").replace("%1$s",(0,wo.r)(e.name)).replace("[link]",`<a class="mailpoet-link" href="admin.php?page=mailpoet-form-editor&id=${parseInt(e.id,10)}">`).replace("[/link]","</a>"));const i=ee()("manage-column","column-primary","has-row-actions"),a=window.mailpoet_segments.filter((t=>-1!==ke().inArray(t.id,e.segments))),s=function(e){const t=[];return"1"===e?.form_placement?.fixed_bar?.enabled&&t.push(c.MailPoet.I18n.t("placeFixedBarFormOnPages")),"1"===e?.form_placement?.below_posts?.enabled&&t.push(c.MailPoet.I18n.t("placeFormBellowPages")),"1"===e?.form_placement?.popup?.enabled&&t.push(c.MailPoet.I18n.t("placePopupFormOnPages")),"1"===e?.form_placement?.slide_in?.enabled&&t.push(c.MailPoet.I18n.t("placeSlideInFormOnPages")),t.length>0?t.join(", "):c.MailPoet.I18n.t("placeFormOthers")}(e.settings);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("td",{className:i,children:[(0,p.jsx)("a",{className:"mailpoet-listing-title",href:`admin.php?page=mailpoet-form-editor&id=${e.id}`,children:e.name?e.name:`(${c.MailPoet.I18n.t("noName")})`}),t]}),(0,p.jsx)("td",{className:"column","data-colname":c.MailPoet.I18n.t("segments"),children:(0,p.jsx)(Ns.Eg,{segments:a,dimension:"large",children:"user"===e.settings?.segments_selected_by&&(0,p.jsx)("span",{className:"mailpoet-tags-prefix",children:c.MailPoet.I18n.t("userChoice")})})}),(0,p.jsx)("td",{className:"column","data-colname":c.MailPoet.I18n.t("type"),children:s}),(0,p.jsx)("td",{className:"column","data-colname":c.MailPoet.I18n.t("status"),children:this.renderStatus(e)}),(0,p.jsxs)("td",{className:"column-date mailpoet-hide-on-mobile","data-colname":c.MailPoet.I18n.t("updatedAt"),children:[c.MailPoet.Date.short(e.updated_at),(0,p.jsx)("br",{}),c.MailPoet.Date.time(e.updated_at)]})]})};render(){return(0,p.jsxs)("div",{className:"mailpoet-listing-no-actions-on-mobile",children:[(0,p.jsx)(Ml,{}),(0,p.jsx)(Ee.N,{limit:window.mailpoet_listing_per_page,className:"mailpoet-forms-listing",location:this.props.location,params:this.props.match.params,messages:Il,search:!1,endpoint:"forms",onRenderItem:this.renderItem,isItemInactive:this.isItemInactive,columns:Nl,bulk_actions:kl,item_actions:Cl})]})}}Tl.propTypes={location:Te().object.isRequired,match:Te().shape({params:Te().object}).isRequired},Tl.displayName="FormList";const El=An(Tl);function Al(){return(0,p.jsx)(l.k.Provider,{value:(0,l.S)(window),children:(0,p.jsxs)(Me.HashRouter,{children:[(0,p.jsx)(m.w,{}),(0,p.jsx)(Ne.AW,{path:"*",render:(0,r.withBoundary)(El)})]})})}const Rl=document.getElementById("forms_container");Rl&&((0,r.registerTranslations)(),n.render((0,p.jsx)(Al,{}),Rl));var Ol=i(85143);function Ll(){return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Ol.R,{}),(0,p.jsx)("p",{children:c.MailPoet.I18n.t("knowledgeBaseIntro")}),(0,p.jsxs)("ul",{className:"mailpoet-text-links",children:[(0,p.jsx)("li",{children:(0,p.jsx)("a",{target:"_blank",rel:"noreferrer noopener",href:"https://kb.mailpoet.com/category/116-common-problems",children:"Common Problems"})}),(0,p.jsx)("li",{children:(0,p.jsx)("a",{target:"_blank",rel:"noreferrer noopener",href:"https://kb.mailpoet.com/category/165-newsletters",children:"Newsletters"})}),(0,p.jsx)("li",{children:(0,p.jsx)("a",{target:"_blank",rel:"noreferrer noopener",href:"https://kb.mailpoet.com/category/156-migration-questions",children:"Migration Questions"})}),(0,p.jsx)("li",{children:(0,p.jsx)("a",{target:"_blank",rel:"noreferrer noopener",href:"https://kb.mailpoet.com/category/149-sending-methods",children:"Sending Methods"})}),(0,p.jsx)("li",{children:(0,p.jsx)("a",{target:"_blank",rel:"noreferrer noopener",href:"https://kb.mailpoet.com/category/139-subscription-forms",children:"Subscription Forms"})}),(0,p.jsx)("li",{children:(0,p.jsx)("a",{target:"_blank",rel:"noreferrer noopener",href:"https://kb.mailpoet.com/category/114-getting-started",children:"Getting Started"})}),(0,p.jsx)("li",{children:(0,p.jsx)("a",{target:"_blank",rel:"noreferrer noopener",href:"https://kb.mailpoet.com/category/123-newsletter-designer",children:"Newsletter Designer"})}),(0,p.jsx)("li",{children:(0,p.jsx)("a",{target:"_blank",rel:"noreferrer noopener",href:"https://kb.mailpoet.com/category/121-subscribers-and-lists",children:"Subscribers and Lists"})})]}),(0,p.jsx)(Le.z,{target:"_blank",rel:"noreferrer noopener",href:"https://kb.mailpoet.com/",children:c.MailPoet.I18n.t("knowledgeBaseButton")})]})}var Fl=i(39425);function Dl(e){e.target.select()}function ql(e,t){if(rt.default.isObject(e)){const i=Object.keys(e).map((t=>`${t}: ${e[t]}`));return(0,p.jsx)("textarea",{readOnly:!0,id:t,onFocus:Dl,value:i.join("\n"),style:{width:"100%",height:"400px"}})}return(0,p.jsx)("p",{children:c.MailPoet.I18n.t("systemInfoDataError")})}function $l(){const e="mailpoet-system-info",t=window.systemInfoData;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"mailpoet_notice notice inline",children:(0,p.jsx)("p",{children:c.MailPoet.I18n.t("systemInfoIntro")})}),ql(t,e),(0,p.jsx)(Fl.m,{variant:"secondary",targetId:e})]})}function Bl(e){return(0,p.jsx)("table",{className:"widefat fixed",style:{maxWidth:e.max_width},children:(0,p.jsx)("tbody",{children:e.rows.map((e=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{className:"row-title",children:e.key}),(0,p.jsx)("td",{children:e.value})]},`row_${e.key}`)))})})}function Wl(e){return(0,p.jsx)("span",{children:!0===e.children&&e.truthy||!1===e.children&&e.falsy||e.unknown})}function Vl(e){const t=e.status_data,i={active:c.MailPoet.I18n.t("running"),inactive:c.MailPoet.I18n.t("cronWaiting")},a=Array.isArray(t.last_error)?(0,p.jsx)(p.Fragment,{children:t.last_error.map((e=>(0,p.jsxs)("div",{children:[e.worker,": ",(0,p.jsx)("i",{children:e.message})]},e.worker)))}):t.last_error;return(0,p.jsxs)("div",{children:[(0,p.jsx)("h4",{children:c.MailPoet.I18n.t("systemStatusCronStatusTitle")}),(0,p.jsx)(Bl,{max_width:"400px",rows:[{key:c.MailPoet.I18n.t("accessible"),value:(0,p.jsx)(Wl,{children:t.accessible})},{key:c.MailPoet.I18n.t("status"),value:i[t.status]?i[t.status]:c.MailPoet.I18n.t("unknown")},{key:c.MailPoet.I18n.t("lastUpdated"),value:t.updated_at?c.MailPoet.Date.full(1e3*t.updated_at):c.MailPoet.I18n.t("unknown")},{key:c.MailPoet.I18n.t("lastRunStarted"),value:t.run_accessed_at?c.MailPoet.Date.full(1e3*t.run_started_at):c.MailPoet.I18n.t("unknown")},{key:c.MailPoet.I18n.t("lastRunCompleted"),value:t.run_completed_at?c.MailPoet.Date.full(1e3*t.run_completed_at):c.MailPoet.I18n.t("unknown")},{key:c.MailPoet.I18n.t("lastSeenError"),value:a||c.MailPoet.I18n.t("none")},{key:c.MailPoet.I18n.t("lastSeenErrorDate"),value:t.last_error_date?c.MailPoet.Date.full(1e3*t.last_error_date):c.MailPoet.I18n.t("unknown")}]})]})}function Ul(e){let t=e.task.scheduled_at;t&&(t=(0,Is.default)(t,"yyyy-MM-dd HH:mm:ss",new Date));const i=(0,Is.default)(e.task.updated_at,"yyyy-MM-dd HH:mm:ss",new Date);return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{className:"column column-primary",children:e.task.id}),(0,p.jsx)("td",{className:"column",children:e.task.type}),(0,p.jsx)("td",{className:"column",children:e.task.newsletter?(0,p.jsx)("a",{href:e.task.newsletter.preview_url,"data-newsletter-id":e.task.newsletter.newsletter_id,"data-queue-id":e.task.newsletter.queue_id,target:"_blank",rel:"noopener noreferrer",children:e.task.newsletter.subject||c.MailPoet.I18n.t("preview")}):c.MailPoet.I18n.t("none")}),(0,p.jsx)("td",{className:"column",children:e.task.priority}),e.show_scheduled_at?(0,p.jsx)("td",{className:"column-date",children:(0,p.jsx)("abbr",{children:`${c.MailPoet.Date.short(t)} ${c.MailPoet.Date.time(t)}`})}):null,(0,p.jsx)("td",{className:"column-date",children:(0,p.jsx)("abbr",{children:`${c.MailPoet.Date.short(i)} ${c.MailPoet.Date.time(i)}`})})]})}function Hl(e){return(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{className:"row-title",children:"Id"}),(0,p.jsx)("th",{className:"row-title",children:c.MailPoet.I18n.t("type")}),(0,p.jsx)("th",{className:"row-title",children:c.MailPoet.I18n.t("email")}),(0,p.jsx)("th",{className:"row-title",children:c.MailPoet.I18n.t("priority")}),e.show_scheduled_at?(0,p.jsx)("th",{className:"row-title",children:c.MailPoet.I18n.t("scheduledAt")}):null,(0,p.jsx)("th",{className:"row-title",children:c.MailPoet.I18n.t("updatedAt")})]})}function zl(e){const t=e.show_scheduled_at?6:5;return(0,p.jsxs)("table",{className:"widefat fixed striped",children:[(0,p.jsx)("thead",{children:(0,p.jsx)(Hl,{show_scheduled_at:e.show_scheduled_at})}),(0,p.jsx)("tbody",{children:e.tasks.length?e.tasks.map((t=>(0,p.jsx)(Ul,{task:t,show_scheduled_at:e.show_scheduled_at},t.id))):(0,p.jsx)("tr",{className:"mailpoet-listing-no-items",children:(0,p.jsx)("td",{colSpan:t,children:c.MailPoet.I18n.t("nothingToShow")})})}),(0,p.jsx)("tfoot",{children:(0,p.jsx)(Hl,{show_scheduled_at:e.show_scheduled_at})})]})}function Zl(e){const t=e.status_data;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("h4",{children:c.MailPoet.I18n.t("systemStatusQueueTitle")}),(0,p.jsx)(Bl,{max_width:"400px",rows:[{key:c.MailPoet.I18n.t("status"),value:"paused"===t.status?c.MailPoet.I18n.t("paused"):c.MailPoet.I18n.t("running")},{key:c.MailPoet.I18n.t("startedAt"),value:t.started?c.MailPoet.Date.full(1e3*t.started):c.MailPoet.I18n.t("unknown")},{key:c.MailPoet.I18n.t("sentEmails"),value:t.sent||0},{key:c.MailPoet.I18n.t("retryAttempt"),value:t.retry_attempt||c.MailPoet.I18n.t("none")},{key:c.MailPoet.I18n.t("retryAt"),value:t.retry_at?c.MailPoet.Date.full(1e3*t.retry_at):c.MailPoet.I18n.t("none")},{key:c.MailPoet.I18n.t("error"),value:t.error?t.error.error_message:c.MailPoet.I18n.t("none")},{key:c.MailPoet.I18n.t("totalCompletedTasks"),value:t.tasksStatusCounts.completed},{key:c.MailPoet.I18n.t("totalRunningTasks"),value:t.tasksStatusCounts.running},{key:c.MailPoet.I18n.t("totalPausedTasks"),value:t.tasksStatusCounts.paused},{key:c.MailPoet.I18n.t("totalScheduledTasks"),value:t.tasksStatusCounts.scheduled}]}),(0,p.jsx)("h5",{children:c.MailPoet.I18n.t("scheduledTasks")}),(0,p.jsx)(zl,{show_scheduled_at:!0,tasks:t.latestTasks.filter((e=>"scheduled"===e.status))}),(0,p.jsx)("h5",{children:c.MailPoet.I18n.t("runningTasks")}),(0,p.jsx)(zl,{tasks:t.latestTasks.filter((e=>null===e.status))}),(0,p.jsx)("h5",{children:c.MailPoet.I18n.t("completedTasks")}),(0,p.jsx)(zl,{tasks:t.latestTasks.filter((e=>"completed"===e.status))})]})}function Yl(e){let{version:t,storage:i,latestTrigger:a,latestCompletedTrigger:s,latestCompletedRun:n}=e;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("h4",{children:c.MailPoet.I18n.t("actionSchedulerStatus")}),(0,p.jsx)(Bl,{max_width:"400px",rows:[{key:c.MailPoet.I18n.t("version"),value:t},{key:c.MailPoet.I18n.t("storage"),value:i},{key:c.MailPoet.I18n.t("latestActionSchedulerTrigger"),value:c.MailPoet.Date.full(Je().utc(a).local())},{key:c.MailPoet.I18n.t("latestActionSchedulerCompletedTrigger"),value:c.MailPoet.Date.full(Je().utc(s).local())},{key:c.MailPoet.I18n.t("latestActionSchedulerCompletedRun"),value:c.MailPoet.Date.full(Je().utc(n).local())}]})]})}function Gl(e,t,i,a,s){const n=e?"success":"error";let o=e?t:i;return a&&(o=_()(o,/\[link\](.*?)\[\/link\]/g,(e=>(0,p.jsx)("a",{className:"mailpoet-text-link",href:a,children:e},"kb-link")))),(0,p.jsxs)("div",{className:`mailpoet_notice notice inline notice-${n}`,children:[(0,p.jsx)("p",{children:o}),s?(0,p.jsx)("p",{children:(0,p.jsx)("i",{children:s})}):null]})}function Kl(e){const t=e.cron.isReachable,i=e.cron.url,a=`${c.MailPoet.I18n.t("systemStatusConnectionUnsuccessful")} ${c.MailPoet.I18n.t("systemStatusCronConnectionUnsuccessfulInfo")}`,s=c.MailPoet.I18n.t("systemStatusConnectionSuccessful"),n=t?null:e.cron.pingResponse;return(0,p.jsxs)("div",{children:[(0,p.jsx)("h4",{children:c.MailPoet.I18n.t("systemStatusCronTitle")}),(0,p.jsx)("p",{children:(0,p.jsx)("a",{className:"mailpoet-text-link",href:i,target:"_blank",rel:"noopener noreferrer",children:i})}),Gl(t,s,a,"https://kb.mailpoet.com/article/231-sending-does-not-work",n)]})}function Ql(e){const t=e.mss.enabled?`${c.MailPoet.I18n.t("systemStatusConnectionUnsuccessful")} ${c.MailPoet.I18n.t("systemStatusMSSConnectionUnsuccessfulInfo")}`:c.MailPoet.I18n.t("systemStatusMSSConnectionCanNotConnect"),i=e.mss.enabled?c.MailPoet.I18n.t("systemStatusConnectionSuccessful"):c.MailPoet.I18n.t("systemStatusMSSConnectionCanConnect");return(0,p.jsxs)("div",{children:[(0,p.jsx)("h4",{children:c.MailPoet.I18n.t("systemStatusMSSTitle")}),Gl(e.mss.isReachable,i,t,"https://kb.mailpoet.com/article/319-known-errors-when-validating-a-mailpoet-key",null)]})}function Xl(){const e=window.systemStatusData,t=window.actionSchedulerData;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"mailpoet_notice notice inline",children:(0,p.jsx)("p",{children:e.mss.enabled?c.MailPoet.I18n.t("systemStatusIntroCronMSS"):c.MailPoet.I18n.t("systemStatusIntroCron")})}),Kl(e),Ql(e),(0,p.jsx)(Vl,{status_data:e.cronStatus}),(0,p.jsx)(Yl,{...t}),t?(0,p.jsx)(Zl,{status_data:e.queueStatus}):null]})}function Jl(){return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("p",{children:c.MailPoet.I18n.t("yourPrivacyContent1")}),(0,p.jsx)("p",{children:c.MailPoet.I18n.t("yourPrivacyContent2")}),(0,p.jsx)("p",{children:c.MailPoet.I18n.t("yourPrivacyContent3")}),(0,p.jsx)(Le.z,{target:"_blank",rel:"noreferrer noopener",href:"https://www.mailpoet.com/privacy-notice/",children:c.MailPoet.I18n.t("yourPrivacyButton")})]})}function ed(){return(0,p.jsxs)(l.k.Provider,{value:(0,l.S)(window),children:[(0,p.jsx)(d.D,{}),(0,p.jsx)(m.w,{}),(0,p.jsxs)(Nn.t,{activeKey:"knowledgeBase",children:[(0,p.jsx)(r.Tab,{title:c.MailPoet.I18n.t("tabKnowledgeBaseTitle"),children:(0,p.jsx)(Ll,{})},"knowledgeBase"),(0,p.jsx)(r.Tab,{title:c.MailPoet.I18n.t("tabSystemStatusTitle"),children:(0,p.jsx)(Xl,{})},"systemStatus"),(0,p.jsx)(r.Tab,{title:c.MailPoet.I18n.t("tabSystemInfoTitle"),children:(0,p.jsx)($l,{})},"systemInfo"),(0,p.jsx)(r.Tab,{title:c.MailPoet.I18n.t("tabYourPrivacyTitle"),children:(0,p.jsx)(Jl,{})},"yourPrivacy")]})]})}Bl.propTypes={max_width:Te().string,rows:Te().arrayOf(Te().shape({key:Te().string.isRequired,value:Te().oneOfType([Te().string,Te().number,Te().element]).isRequired})).isRequired},Bl.defaultProps={max_width:"auto"},Wl.propTypes={truthy:Te().string,falsy:Te().string,unknown:Te().string,children:Te().bool},Wl.defaultProps={truthy:(0,Oe.__)("Yes","mailpoet"),falsy:(0,Oe.__)("No","mailpoet"),unknown:(0,Oe.__)("Unknown","mailpoet"),children:null},Vl.propTypes={status_data:Te().shape({accessible:Te().bool,last_error_date:Te().string,status:Te().string,updated_at:Te().number,run_accessed_at:Te().number,run_completed_at:Te().number,run_started_at:Te().number,last_error:Te().oneOfType([Te().string,Te().array])}).isRequired},Ul.propTypes={show_scheduled_at:Te().bool,task:Te().shape({id:Te().number.isRequired,type:Te().string.isRequired,priority:Te().number.isRequired,updated_at:Te().string.isRequired,scheduled_at:Te().string,status:Te().string,newsletter:Te().shape({newsletter_id:Te().number.isRequired,queue_id:Te().number.isRequired,preview_url:Te().string.isRequired,subject:Te().string})}).isRequired},Ul.defaultProps={show_scheduled_at:!1},Hl.propTypes={show_scheduled_at:Te().bool},Hl.defaultProps={show_scheduled_at:!1},zl.propTypes={show_scheduled_at:Te().bool,tasks:Te().arrayOf(Ul.propTypes.task).isRequired},zl.defaultProps={show_scheduled_at:!1},Zl.propTypes={status_data:Te().shape({status:Te().string,started:Te().number,sent:Te().number,retry_attempt:Te().number,retry_at:Te().number,error:Te().shape({operation:Te().string,error_message:Te().string}),tasksStatusCounts:Te().shape({completed:Te().number.isRequired,running:Te().number.isRequired,paused:Te().number.isRequired,scheduled:Te().number.isRequired}).isRequired,latestTasks:Te().arrayOf(Ul.propTypes.task).isRequired}).isRequired};const td=document.getElementById("help_container");td&&((0,r.registerTranslations)(),n.render((0,p.jsx)(ed,{}),td));var id=i(13269);function ad(e){let{children:t,location:{pathname:i}}=e;return(0,o.useEffect)((()=>{window.scrollTo(0,0)}),[i]),t||null}ad.propTypes={location:Te().shape({pathname:Te().string.isRequired}).isRequired,children:Te().node.isRequired},ad.displayName="ScrollToTopComponent";const sd=(0,Ne.EN)((0,id.lV)(ad));function nd(e){let{activeMethod:t,onMethodChange:i}=e;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"mailpoet-settings-label",children:[(0,p.jsx)("span",{className:"mailpoet_import_heading",children:c.MailPoet.I18n.t("methodSelectionHead")}),(0,p.jsx)("div",{className:"mailpoet-settings-inputs-row",children:(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/242-video-guide-importing-subscribers-using-a-csv-file",target:"_blank",rel:"noopener noreferrer",children:(0,p.jsx)(Et.V,{dimension:"large",variant:"excellent",isInverted:!0,children:c.MailPoet.I18n.t("seeVideo")})})})]}),(0,p.jsxs)("div",{className:"mailpoet-settings-inputs",children:[(0,p.jsxs)("div",{className:"mailpoet-settings-inputs-row",children:[(0,p.jsx)(ct.Y,{name:"select_method",automationId:"import-paste-method",id:"import-paste-method",checked:"paste-method"===t,value:"paste-method",onCheck:i}),(0,p.jsx)("label",{htmlFor:"import-paste-method",children:c.MailPoet.I18n.t("methodPaste")})]}),(0,p.jsxs)("div",{className:"mailpoet-settings-inputs-row",children:[(0,p.jsx)(ct.Y,{name:"select_method",automationId:"import-csv-method",id:"import-csv-method",checked:"file-method"===t,value:"file-method",onCheck:i}),(0,p.jsx)("label",{htmlFor:"import-csv-method",children:c.MailPoet.I18n.t("methodUpload")})]}),(0,p.jsxs)("div",{className:"mailpoet-settings-inputs-row",children:[(0,p.jsx)(ct.Y,{name:"select_method",automationId:"import-mailchimp-method",id:"import-mailchimp-method",checked:"mailchimp-method"===t,value:"mailchimp-method",onCheck:i}),(0,p.jsx)("label",{htmlFor:"import-mailchimp-method",children:c.MailPoet.I18n.t("methodMailChimp")})]})]})]})}function od(e){let{hidePrevious:t,isLastStep:i,canGoNext:a,onPreviousAction:s,onNextAction:n}=e;return(0,p.jsxs)("div",{className:"mailpoet-settings-save",children:[!t&&(0,p.jsx)(Le.z,{type:"button",variant:"secondary",onClick:s,children:c.MailPoet.I18n.t("previousStep")}),(0,p.jsx)(Le.z,{type:"button",automationId:"import-next-step",isDisabled:!a,onClick:()=>{a&&n()},children:c.MailPoet.I18n.t(i?"import":"nextStep")})]})}nd.propTypes={activeMethod:Te().string,onMethodChange:Te().func.isRequired},nd.defaultProps={activeMethod:void 0},nd.displayName="SelectImportMethod",od.propTypes={canGoNext:Te().bool,hidePrevious:Te().bool,isLastStep:Te().bool,onPreviousAction:Te().func,onNextAction:Te().func},od.defaultProps={hidePrevious:!1,isLastStep:!1,canGoNext:!0,onPreviousAction:()=>{},onNextAction:()=>{}},od.displayName="PreviousNextStepButtons";const rd="https://kb.mailpoet.com/article/126-importing-subscribers-with-csv-files",ld="Email, First Name, Last Name\njohn@doe.com, John, Doe\nmary@smith.com, Mary, Smith\njohnny@walker.com, Johnny, Walker";function dd(e){let{onValueChange:t,canFinish:i,onFinish:a,data:s,onPrevious:n}=e;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"mailpoet-settings-label",children:[(0,p.jsx)("label",{htmlFor:"paste_input",children:c.MailPoet.I18n.t("pasteLabel")}),(0,p.jsx)("p",{className:"description",children:_()(c.MailPoet.I18n.t("pasteDescription"),/\[link\](.*?)\[\/link\]/,(e=>(0,p.jsx)("a",{className:"mailpoet-link",href:`${rd}`,target:"_blank",rel:"noopener noreferrer",children:e},"kb-link")))})]}),(0,p.jsx)("div",{className:"mailpoet-settings-inputs",children:(0,p.jsx)(nt.g,{id:"paste_input",rows:"15",placeholder:ld,isCode:!0,onChange:e=>{t(e.target.value)},defaultValue:s})}),(0,p.jsx)(od,{canGoNext:i,onPreviousAction:n,onNextAction:a})]})}dd.propTypes={onFinish:Te().func,onPrevious:Te().func,canFinish:Te().bool.isRequired,onValueChange:Te().func.isRequired,data:Te().string},dd.defaultProps={onFinish:()=>{},onPrevious:()=>{},data:""},dd.displayName="MethodPaste";const cd="https://kb.mailpoet.com/article/126-importing-subscribers-with-csv-files";function md(e){let{onValueChange:t,canFinish:i,onFinish:a,onPrevious:s}=e;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"mailpoet-settings-label",children:[(0,p.jsx)("label",{htmlFor:"file_local",children:c.MailPoet.I18n.t("methodUpload")}),(0,p.jsx)("p",{className:"description",children:_()(c.MailPoet.I18n.t("pasteDescription"),/\[link\](.*?)\[\/link\]/,(e=>(0,p.jsx)("a",{className:"mailpoet-link",href:`${cd}`,target:"_blank",rel:"noopener noreferrer",children:e},"kb-link")))})]}),(0,p.jsx)("div",{className:"mailpoet-settings-inputs",children:(0,p.jsx)(at.I,{type:"file",id:"file_local",accept:".csv","data-automation-id":"import-file-upload-input",onChange:e=>{const i=e.target.value.match(/[^.]+$/);c.MailPoet.Notice.hide(),null===i||"csv"!==i[0].toLowerCase()?(c.MailPoet.Notice.error(c.MailPoet.I18n.t("wrongFileFormat")),t("")):t(e.target.files[0])}})}),(0,p.jsx)(od,{canGoNext:i,onPreviousAction:s,onNextAction:a})]})}function ud(e){let{onFinish:t,onPrevious:i}=e;const[a,s]=(0,o.useState)(""),[n,r]=(0,o.useState)(void 0),[l,d]=(0,o.useState)([]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"mailpoet-settings-label",children:(0,p.jsxs)("label",{htmlFor:"mailpoet_mailchimp_key_input",children:[(0,p.jsx)("span",{className:"mailpoet_import_heading",children:c.MailPoet.I18n.t("methodMailChimpLabel")}),(0,p.jsx)("p",{className:"description",children:_()(c.MailPoet.I18n.t("methodMailChimpDescription"),/\[link\](.*?)\[\/link\]/,(e=>(0,p.jsx)("a",{className:"mailpoet-link",href:"https://kb.mailpoet.com/article/255-migrating-from-mailchimp-to-mailpoet#api",target:"_blank",rel:"noopener noreferrer",children:e},"kb-link")))})]})}),(0,p.jsx)("div",{className:"mailpoet-settings-inputs",children:(0,p.jsxs)("div",{className:"mailpoet-settings-inputs-row mailpoet-settings-inputs-row-centered",children:[(0,p.jsx)(at.I,{dimension:"small",id:"mailpoet_mailchimp_key_input",type:"text",onChange:e=>{s(e.target.value),""===e.target.value.trim()&&r(void 0)}}),(0,p.jsx)("span",{className:"mailpoet-gap"}),(0,p.jsx)(Le.z,{type:"button",dimension:"small",onClick:()=>{c.MailPoet.Modal.loading(!0),c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"importExport",action:"getMailChimpLists",data:{api_key:a}}).always((()=>{c.MailPoet.Modal.loading(!1)})).done((e=>r(e.data))).fail((e=>{e.errors.length>0&&c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0})}))},children:c.MailPoet.I18n.t("methodMailChimpVerify")}),(0,p.jsx)("span",{className:"mailpoet-gap"}),(0,p.jsx)("span",{children:Array.isArray(n)&&0===n.length?c.MailPoet.I18n.t("noMailChimpLists"):null})]})}),n?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"mailpoet-settings-label",children:c.MailPoet.I18n.t("methodMailChimpSelectList")}),(0,p.jsx)("div",{className:"mailpoet-settings-inputs",children:(0,p.jsx)(Re.Y,{field:{id:"segments",name:"list-selection",multiple:!0,placeholder:c.MailPoet.I18n.t("methodMailChimpSelectPlaceholder"),forceSelect2:!0,values:n},onValueChange:e=>d(e.target.value)})})]}):null,(0,p.jsx)(od,{canGoNext:Array.isArray(l)&&l.length>0,onPreviousAction:i,onNextAction:()=>{c.MailPoet.Modal.loading(!0),c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"importExport",action:"getMailChimpSubscribers",data:{api_key:a,lists:l}}).always((()=>{c.MailPoet.Modal.loading(!1)})).done((e=>t(e.data))).fail((e=>{e.errors.length>0&&c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0})}))}})]})}md.propTypes={canFinish:Te().bool.isRequired,onFinish:Te().func,onPrevious:Te().func,onValueChange:Te().func.isRequired},md.defaultProps={onFinish:()=>{},onPrevious:()=>{}},md.displayName="MethodUpload",ud.propTypes={onFinish:Te().func,onPrevious:Te().func},ud.defaultProps={onFinish:()=>{},onPrevious:()=>{}},ud.displayName="MethodMailChimp";var pd=i(80824),hd=i.n(pd);const gd=e=>window.roleBasedEmails.findIndex((t=>e.startsWith(`${t}@`)))>=0,fd=e=>{let t,i=rt.default.unescape(e);return i=i.toLowerCase().replace(/^["';.,\s]+|[^\x20-\x7E]+$|["';.,_\s]+$/g,"").replace(/\s+|%\d+|,+/g,""),t=/<(.*?)>/.exec(i),t&&(i=t[1].trim()),t=/mailto:(?:\s+)?(.*)/.exec(i),t&&(i=t[1].trim()),!!window.mailpoet_email_regex.test(i)&&!gd(i)&&i};function _d(e){let{history:t,setStepMethodSelectionData:i,subscribersLimitForValidation:a}=e;const[s,n]=(0,o.useState)(void 0),[l,d]=(0,o.useState)(""),[m,u]=(0,o.useState)(void 0),h=e=>{i(e),t.push(((e,t,i)=>void 0===e||void 0===e.subscribersCount||e.subscribersCount<t||"mailchimp-method"===i?"step_data_manipulation":"step_input_validation")(e,a,s))},g=()=>{t.push("/step_clean_list")},f=()=>{((e,t)=>{const i=encodeURI(e).split(/%..|./).length-1;c.MailPoet.Notice.hide(),i>window.maxPostSizeBytes?c.MailPoet.Notice.error(c.MailPoet.I18n.t("maxPostSizeNotice")):(c.MailPoet.Modal.loading(!0),hd().parse(e,function(e){return{skipEmptyLines:!0,error(){c.MailPoet.Notice.hide(),c.MailPoet.Notice.error(c.MailPoet.I18n.t("dataProcessingError"))},complete(t){const i=function(e){let t=[];const i=[],a=[],s=[],n=[];let o,r,l,d,c=null,m=null,u=!1;return Object.keys(e).forEach((p=>{l=e[p].map((e=>e.trim())),d=l.length,null===m&&(m=d),d===m&&(null===c?(Object.keys(l).forEach((e=>{r=fd(l[e]),null===c&&window.mailpoet_email_regex.test(r)&&(c=e,i[r]=!0,l[e]=r,t[r]=l)})),null===c&&0===parseInt(p,10)&&(u=!0,t[0]=l)):""!==l[c]&&(o=fd(l[c]),rt.default.has(i,o)?a.push(o):gd(l[c])?n.push(l[c]):window.mailpoet_email_regex.test(o)?(i[o]=!0,l[c]=o,t[o]=l):s.push(l[c])))})),t=rt.default.values(t),t&&(u&&t.length>=2||!u&&t.length>=1)?{header:window.mailpoet_email_regex.test(t[0][c])?null:t.shift(),subscribers:t,subscribersCount:t.length,duplicate:rt.default.uniq(a),invalid:rt.default.uniq(s),role:rt.default.uniq(n)}:null}(t.data);if(i)e(i);else{let e=c.MailPoet.I18n.t("noValidRecords");e=e.replace("[link]",'<a href="https://kb.mailpoet.com/article/126-importing-subscribers-with-csv-files">'),e=e.replace("[/link]","</a>"),c.MailPoet.Notice.error(e)}c.MailPoet.Modal.loading(!1)}}}((e=>{c.MailPoet.trackEvent("Subscribers import started",{source:"file-method"===s?"file upload":"pasted data"}),h(e)}))))})("paste-method"===s?l:m)};return(0,p.jsxs)("div",{className:"mailpoet-settings-grid",children:[(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(nd,{activeMethod:s,onMethodChange:n})}),"paste-method"===s&&(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(dd,{onPrevious:g,onValueChange:d,onFinish:f,canFinish:!!l.trim(),data:l})}),"file-method"===s&&(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(md,{onPrevious:g,onValueChange:u,onFinish:f,canFinish:!!m,data:m})}),"mailchimp-method"===s&&(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(ud,{onPrevious:g,onFinish:e=>{c.MailPoet.trackEvent("Subscribers import started",{source:"MailChimp"}),h(e)}})}),void 0===s&&(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(od,{canGoNext:!1,onPreviousAction:g})})]})}_d.propTypes={history:Te().shape({push:Te().func.isRequired}).isRequired,setStepMethodSelectionData:Te().func.isRequired,subscribersLimitForValidation:Te().number.isRequired},_d.diplayName="StepMethodSelection";const bd=(0,Ne.EN)(_d);function xd(e){let{onProceed:t}=e;return(0,p.jsxs)("div",{className:"mailpoet-clean-list-step-container",children:[(0,p.jsx)("p",{children:c.MailPoet.I18n.t("cleanListText1")}),(0,p.jsx)("p",{children:c.MailPoet.I18n.t("cleanListText2")}),(0,p.jsxs)("p",{children:[t&&(0,p.jsx)(Le.z,{onClick:t,variant:"tertiary",children:c.MailPoet.I18n.t("listCleaningGotIt")}),(0,p.jsx)(Le.z,{target:"_blank",href:"https://kb.mailpoet.com/article/287-list-cleaning-services",children:c.MailPoet.I18n.t("tryListCleaning")})]})]})}function vd(e){let{onSubmit:t,history:i}=e;const[a,s]=(0,o.useState)(void 0);return(0,p.jsxs)("div",{className:"mailpoet-settings-grid",children:[(0,p.jsx)("div",{className:"mailpoet-settings-label",children:c.MailPoet.I18n.t("validationStepHeading")}),(0,p.jsxs)("div",{className:"mailpoet-settings-inputs",children:[(0,p.jsxs)("div",{className:"mailpoet-settings-inputs-row",children:[(0,p.jsx)(ct.Y,{automationId:"mailpoet_import_validation_step_option1",id:"existing-list",checked:"existing-list"===a,value:"existing-list",onCheck:s}),(0,p.jsx)("label",{htmlFor:"existing-list",children:c.MailPoet.I18n.t("validationStepRadio1")})]}),(0,p.jsxs)("div",{className:"mailpoet-settings-inputs-row",children:[(0,p.jsx)(ct.Y,{automationId:"mailpoet_import_validation_step_option2",id:"address-book",checked:"address-book"===a,value:"address-book",onCheck:s}),(0,p.jsx)("label",{htmlFor:"address-book",children:c.MailPoet.I18n.t("validationStepRadio2")})]})]}),(0,p.jsx)(od,{canGoNext:void 0!==a,onPreviousAction:()=>i.push("step_method_selection"),onNextAction:()=>t(a)})]})}function yd(){return(0,p.jsxs)("div",{className:"mailpoet-clean-list-step-container","data-automation-id":"import_wrong_source_block",children:[(0,p.jsx)("p",{children:c.MailPoet.I18n.t("validationStepBlock1")}),(0,p.jsx)("p",{children:c.MailPoet.I18n.t("validationStepBlock2")}),(0,p.jsx)("p",{children:(0,p.jsx)(Le.z,{href:"https://kb.mailpoet.com/article/269-reconfirm-subscribers-to-your-list",target:"_blank",rel:"noopener noreferrer",children:c.MailPoet.I18n.t("validationStepBlockButton")})})]})}function jd(e){let{onSubmit:t}=e;const[i,a]=(0,o.useState)("over2years"),s=(0,o.useCallback)((e=>{a(e.target.value)}),[a]),n=(0,o.useCallback)((()=>{t("over2years"===i||"1to2years"===i?"notRecently":"recently")}),[t,i]);return(0,p.jsxs)("div",{className:"mailpoet-settings-grid",children:[(0,p.jsx)("div",{className:"mailpoet-settings-label",children:c.MailPoet.I18n.t("validationStepLastSentHeading")}),(0,p.jsx)("div",{className:"mailpoet-settings-inputs",children:(0,p.jsxs)(lt.Select,{defaultValue:i,onChange:s,automationId:"last_sent_to_list",children:[(0,p.jsx)("option",{value:"over2years",children:c.MailPoet.I18n.t("validationStepLastSentOption1")}),(0,p.jsx)("option",{value:"1to2years",children:c.MailPoet.I18n.t("validationStepLastSentOption2")}),(0,p.jsx)("option",{value:"less1year",children:c.MailPoet.I18n.t("validationStepLastSentOption3")}),(0,p.jsx)("option",{value:"less3months",children:c.MailPoet.I18n.t("validationStepLastSentOption4")})]})}),(0,p.jsx)("div",{className:"mailpoet-settings-save",children:(0,p.jsx)(Le.z,{type:"button",automationId:"last_sent_to_list_next",onClick:n,children:c.MailPoet.I18n.t("validationStepLastSentNext")})})]})}function wd(e){let{stepMethodSelectionData:t,history:i}=e;const[a,s]=(0,o.useState)(void 0),[n,l]=(0,o.useState)(void 0);(0,o.useEffect)((()=>{void 0===t&&i.replace("step_method_selection")}),[t,i]);const d=(0,o.useCallback)((e=>{l(e),"recently"===e&&i.push("step_data_manipulation")}),[i,l]);return(0,p.jsxs)(p.Fragment,{children:[void 0===a&&(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(vd,{onSubmit:s,history:i})}),"address-book"===a&&(0,p.jsx)(yd,{}),"existing-list"===a&&void 0===n&&(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(jd,{onSubmit:d})}),"existing-list"===a&&"notRecently"===n&&(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(xd,{})})]})}xd.displayName="CleanList",vd.propTypes={history:Te().shape({push:Te().func.isRequired}).isRequired,onSubmit:Te().func.isRequired},vd.displayName="InitialQuestion",jd.propTypes={onSubmit:Te().func.isRequired},jd.displayName="LastSentQuestion",wd.propTypes={history:Te().shape({push:Te().func.isRequired,replace:Te().func.isRequired}).isRequired,stepMethodSelectionData:Te().shape({duplicate:Te().arrayOf(Te().string),header:Te().arrayOf(Te().string),invalid:Te().arrayOf(Te().string),role:Te().arrayOf(Te().string),subscribersCount:Te().number,subscribers:Te().arrayOf(Te().arrayOf(Te().string))})},wd.defaultProps={stepMethodSelectionData:void 0};const Sd=(0,Ne.EN)(wd);function Pd(e){let{translation:t,subscribers:i}=e,a="";return i.length&&(a=_()(t.replace("%2$s",i.join(", ")),"%1$s",(()=>(0,p.jsx)("strong",{children:i.length.toLocaleString()},t))),a=(0,p.jsx)("p",{children:a})),a}function Md(e){let{stepMethodSelectionData:t}=e;const{invalid:i,duplicate:a,role:s}=t,[n,r]=(0,o.useState)(!1),l=ee()("mailpoet_subscribers_data_parse_results_details",{mailpoet_hidden:!n}),d=(0,p.jsx)(Pd,{translation:c.MailPoet.I18n.t("importNoticeInvalid"),subscribers:i}),m=(0,p.jsx)(Pd,{translation:c.MailPoet.I18n.t("importNoticeDuplicate"),subscribers:a});let u="";if(s.length&&(u=_()(c.MailPoet.I18n.t("importNoticeRoleBased"),/(%1\$s|\[link\].*\[\/link\]|%2\$s)/,(e=>"%1$s"===e?(0,p.jsx)("strong",{children:s.length.toLocaleString()},"role-length"):"%2$s"===e?s.join(", "):(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/270-role-based-email-addresses-are-not-allowed",target:"_blank",rel:"noopener noreferrer",children:e.replace("[link]","").replace("[/link]","")},e))),u=(0,p.jsx)("p",{children:u})),i.length||a.length||s.length){const e=i.length+a.length+s.length;return(0,p.jsxs)("div",{className:"error",children:[(0,p.jsxs)("p",{children:[_()(c.MailPoet.I18n.t("importNoticeSkipped"),"%1$s",(()=>(0,p.jsx)("strong",{children:e.toLocaleString()},"lengths")))," ",(0,p.jsx)("a",{className:"mailpoet_subscribers_data_parse_results_details_show","data-automation-id":"show-more-details",onClick:()=>r(!n),role:"button",tabIndex:0,onKeyDown:e=>{["keydown","keypress"].includes(e.type)&&["Enter"," "].includes(e.key)&&(e.preventDefault(),r(!n))},children:c.MailPoet.I18n.t("showMoreDetails")})]}),(0,p.jsxs)("div",{className:l,children:[(0,p.jsx)("hr",{}),d,m,u]})]})}return null}Pd.propTypes={translation:Te().string.isRequired,subscribers:Te().arrayOf(Te().string).isRequired},Md.propTypes={stepMethodSelectionData:Te().shape({duplicate:Te().arrayOf(Te().string),invalid:Te().arrayOf(Te().string),role:Te().arrayOf(Te().string)})},Md.defaultProps={stepMethodSelectionData:{invalid:[],duplicate:[],role:[]}};const Nd=()=>{const e={data:window.mailpoetColumnsSelect2,width:"15em"};ke()("select.mailpoet_subscribers_column_data_match").select2(e).on("select2:selecting",(t=>{const i=t.currentTarget,a=t.params.args.data.id;"create"===a?(t.preventDefault(),ke()(i).select2("close"),c.MailPoet.Modal.popup({title:c.MailPoet.I18n.t("addNewField"),template:ke()("#form_template_field_form").html()}),ke()("#form_field_new").parsley().on("form:submit",(()=>{const t=ke()("#form_field_new").mailpoetSerializeObject();return c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"customFields",action:"save",data:t}).done((t=>{const a={id:t.data.id,name:t.data.name,text:t.data.name,type:t.data.type,params:t.data.params,custom:!0};2===window.mailpoetColumnsSelect2.length&&window.mailpoetColumnsSelect2.push({name:c.MailPoet.I18n.t("userColumns"),children:[]}),window.mailpoetColumnsSelect2[2].children.push(a),window.mailpoetColumns.push(a),ke()("select.mailpoet_subscribers_column_data_match").each((()=>{ke()(i).html("").select2("destroy").select2(e)})),ke()(i).data("column-id",a.id),c.MailPoet.Modal.close()})).fail((e=>{e.errors.length>0&&c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{positionAfter:"#field_name"})})),!1}))):ke()("select.mailpoet_subscribers_column_data_match").each((()=>{const e=i,s=ke()(e).val();s===a&&"ignore"!==s&&(confirm(`${c.MailPoet.I18n.t("selectedValueAlreadyMatched")} ${c.MailPoet.I18n.t("confirmCorrespondingColumn")}`)?ke()(e).data("column-id","ignore"):(t.preventDefault(),ke()(i).select2("close")))}))})).on("select2:select",(e=>{const t=e.currentTarget,i=e.params.data.id;ke()(t).data("column-id",i)})).on("select2:open",(()=>{const e=document.querySelectorAll(".select2-search__field[aria-controls]");0!==e.length&&e[e.length-1].focus()})),ke().map(ke()(".mailpoet_subscribers_column_data_match"),(e=>{const t=ke()(e).data("column-id");ke()(e).val(t).trigger("change")}))},Id=(e,t)=>{const i=[],a=[];let s,n,o,r;return Object.keys(e[0]).forEach((l=>{s=e[0][l],n="ignore",s%1!=0&&window.mailpoet_email_regex.test(s)?n="email":t&&(o=t[l],r=window.mailpoetColumns.map((e=>e.name)).indexOf(o),-1!==r?n=window.mailpoetColumns[r].id:o&&(/first|first name|given name/i.test(o)?n="first_name":/last|last name/i.test(o)&&(n="last_name"))),n="ignore"!==n&&-1===a.indexOf(n)?n:"ignore",i[l]={column_id:n},a.push(n)})),i},kd=10;function Cd(e){let{header:t,subscribers:i}=e;const a=Id(i,t);return(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:c.MailPoet.I18n.t("matchData")}),a.map(((e,t)=>(0,p.jsx)("th",{children:(0,p.jsx)("select",{className:"mailpoet_subscribers_column_data_match","data-column-id":e.column_id,"data-column-index":t,id:`column_${t}`})},e.column_id+t)))]})}function Td(e){let{header:t}=e;return(0,p.jsxs)("tr",{className:"mailpoet_header",children:[(0,p.jsx)("td",{}),t.map((e=>(0,p.jsx)("td",{children:e},e)))]})}function Ed(e){let{subscriber:t,index:i}=e;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("td",{children:i}),t.map(((e,t)=>(0,p.jsx)("td",{children:e},`${e}-${i}-${t}`)))]})}function Ad(e){let{subscribers:t,subscribersCount:i}=e;const a=". . .",s=Array(t[0].length).fill(a);return(0,p.jsxs)(p.Fragment,{children:[t.slice(0,kd).map(((e,t)=>(0,p.jsx)("tr",{children:(0,p.jsx)(Ed,{subscriber:e,index:t+1})},`${e[0]}-${t}`))),i>kd+1?(0,p.jsx)("tr",{children:(0,p.jsx)(Ed,{subscriber:s,index:a})},"filler"):null,i>kd?(0,p.jsx)("tr",{children:(0,p.jsx)(Ed,{subscriber:t[i-1],index:i})},t[i-1][0]):null]})}function Rd(e){let{subscribersCount:t,subscribers:i,header:a}=e;return(0,o.useLayoutEffect)((()=>{Nd()})),(0,p.jsx)("div",{className:"subscribers_data",children:(0,p.jsxs)("table",{className:"mailpoet_subscribers widefat fixed",children:[(0,p.jsx)("thead",{children:(0,p.jsx)(Cd,{header:a,subscribers:i})}),(0,p.jsxs)("tbody",{children:[a?(0,p.jsx)(Td,{header:a}):null,(0,p.jsx)(Ad,{subscribers:i,subscribersCount:t})]})]})})}Cd.propTypes={subscribers:Te().arrayOf(Te().arrayOf(Te().oneOfType([Te().string,Te().number]))).isRequired,header:Te().arrayOf(Te().string)},Cd.defaultProps={header:[]},Td.propTypes={header:Te().arrayOf(Te().string).isRequired},Ed.propTypes={subscriber:Te().arrayOf(Te().oneOfType([Te().string,Te().number])).isRequired,index:Te().node.isRequired},Ad.propTypes={subscribersCount:Te().number.isRequired,subscribers:Te().arrayOf(Te().arrayOf(Te().oneOfType([Te().string,Te().number]))).isRequired},Rd.propTypes={subscribersCount:Te().number,subscribers:Te().arrayOf(Te().arrayOf(Te().oneOfType([Te().string,Te().number]))),header:Te().arrayOf(Te().string)},Rd.defaultProps={subscribersCount:0,subscribers:[],header:[]};const Od=e=>{c.MailPoet.Modal.popup({title:c.MailPoet.I18n.t("addNewList"),template:ke()("#new_segment_template").html()}),ke()("#new_segment_name").on("keypress",(e=>{13===e.which&&ke()("#new_segment_process").trigger("click")})),ke()("#new_segment_process").on("click",(()=>{const t=ke()("#new_segment_name").val().trim(),i=ke()("#new_segment_description").val().trim();c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"ImportExport",action:"addSegment",data:{name:t,description:i}}).done((t=>{e({id:t.data.id,name:t.data.name,text:t.data.name,subscriberCount:0}),c.MailPoet.Modal.close()})).fail((e=>{e.errors.length>0&&(c.MailPoet.Notice.hide(),c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{positionAfter:"#new_segment_name"}))}))})),ke()("#new_segment_cancel").on("click",(()=>{c.MailPoet.Modal.close()}))};function Ld(e){let{setSelectedSegments:t}=e;const{segments:i}=(0,o.useContext)(l.k),{all:a,updateAll:s}=i,[n,r]=(0,o.useState)(a);(0,o.useLayoutEffect)((()=>{!function(e,i){const a=ke()("select#mailpoet_segments_select");if(a.data("select2"))return;const s=e=>{let t=`<span class="mailpoet-form-select2-text"><span>${e.name}</span></span>`;return e.count&&(t+=`<span class="mailpoet-form-select2-count">${e.count}</span>`),t};a.html(""),a.select2({data:e.map((e=>({...e,text:e.name}))),dropdownCssClass:"mailpoet-form-select2-dropdown",escapeMarkup:e=>e,templateResult:s,templateSelection:s}).on("change",(e=>{const i=ke()('[data-id="notice_segmentSelection"]');e.currentTarget.value?ke()('[data-id="notice_segmentSelection"]').remove():i.length||c.MailPoet.Notice.error(c.MailPoet.I18n.t("segmentSelectionRequired"),{static:!0,scroll:!0,id:"notice_segmentSelection",hideClose:!0});(e=>{t(e)})(rt.default.pluck(a.select2("data"),"id"))}))}(n)}),[n,t]);const d=e=>{!function(){const e=ke()("select#mailpoet_segments_select");e.data("select2")&&(e.select2("destroy"),e.find("option").remove(),e.off("select2:unselecting").off("change").off("select2:opening"))}(),t([]),r([...n,e]),s([...n,e])};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"mailpoet-settings-label",children:(0,p.jsxs)("label",{htmlFor:"mailpoet_segments_select",children:[c.MailPoet.I18n.t("pickLists"),(0,p.jsx)("p",{className:"description",children:c.MailPoet.I18n.t("pickListsDescription")})]})}),(0,p.jsx)("div",{className:"mailpoet-settings-inputs",children:(0,p.jsxs)("div",{className:"mailpoet-settings-inputs-row mailpoet-settings-inputs-row-centered",children:[(0,p.jsx)("div",{className:"mailpoet-form-select mailpoet-form-input",children:(0,p.jsx)("select",{id:"mailpoet_segments_select","data-placeholder":c.MailPoet.I18n.t("select"),multiple:"multiple",children:(0,p.jsx)("option",{})})}),(0,p.jsx)(Le.z,{variant:"tertiary",onClick:()=>Od(d),children:c.MailPoet.I18n.t("createANewList")})]})})]})}function Fd(){return(0,p.jsx)("p",{className:"description",children:_()(c.MailPoet.I18n.t("consentSubscribed"),/\[link](.*?)\[\/link]/,(e=>(0,p.jsx)("a",{className:"mailpoet-link",href:"https://kb.mailpoet.com/article/357-why-express-consent-is-important",target:"_blank",rel:"noopener noreferrer",children:e},"kb-link")))})}function Dd(e){let{newSubscribersStatus:t,setNewSubscribersStatus:i}=e;const a=(0,o.useCallback)((e=>{i(e.target.value)}),[i]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"mailpoet-settings-label",children:[(0,p.jsx)("label",{htmlFor:"new_subscribers_status",children:c.MailPoet.I18n.t("newSubscribersStatus")}),(0,p.jsx)(Fd,{})]}),(0,p.jsx)("div",{className:"mailpoet-settings-inputs",children:(0,p.jsxs)(lt.Select,{id:"new_subscribers_status",placeholder:c.MailPoet.I18n.t("select"),name:"new_subscribers_status",onChange:a,defaultValue:t,children:[(0,p.jsx)("option",{value:"subscribed",children:c.MailPoet.I18n.t("subscribed")}),(0,p.jsx)("option",{value:"inactive",children:c.MailPoet.I18n.t("inactive")}),(0,p.jsx)("option",{value:"unsubscribed",children:c.MailPoet.I18n.t("unsubscribed")})]})})]})}function qd(e){let{existingSubscribersStatus:t,setExistingSubscribersStatus:i}=e;const a=(0,o.useCallback)((e=>{i(e.target.value)}),[i]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"mailpoet-settings-label",children:[(0,p.jsx)("label",{htmlFor:"existing_subscribers_status",children:c.MailPoet.I18n.t("existingSubscribersStatus")}),(0,p.jsx)(Fd,{})]}),(0,p.jsx)("div",{className:"mailpoet-settings-inputs",children:(0,p.jsxs)(lt.Select,{id:"existing_subscribers_status",placeholder:c.MailPoet.I18n.t("select"),name:"existing_subscribers_status",onChange:a,defaultValue:t,children:[(0,p.jsx)("option",{value:"dont_update",children:c.MailPoet.I18n.t("dontUpdate")}),(0,p.jsx)("option",{value:"subscribed",children:c.MailPoet.I18n.t("subscribed")}),(0,p.jsx)("option",{value:"inactive",children:c.MailPoet.I18n.t("inactive")}),(0,p.jsx)("option",{value:"unsubscribed",children:c.MailPoet.I18n.t("unsubscribed")})]})})]})}function $d(e){let{updateExistingSubscribers:t,setUpdateExistingSubscribers:i}=e;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"mailpoet-settings-label",children:c.MailPoet.I18n.t("updateExistingSubscribers")}),(0,p.jsxs)("div",{className:"mailpoet-settings-inputs",children:[(0,p.jsx)(ct.Y,{id:"update_existing_subscribers",name:"update_existing_subscribers",value:"1",checked:t,onCheck:()=>i(!0)}),(0,p.jsx)("label",{htmlFor:"update_existing_subscribers",children:c.MailPoet.I18n.t("updateExistingSubscribersYes")}),(0,p.jsx)("span",{className:"mailpoet-gap"}),(0,p.jsx)(ct.Y,{id:"dont_update_existing_subscribers",name:"update_existing_subscribers",value:"",checked:!t,onCheck:()=>i(!1)}),(0,p.jsx)("label",{htmlFor:"dont_update_existing_subscribers",children:c.MailPoet.I18n.t("updateExistingSubscribersNo")})]})]})}Ld.propTypes={setSelectedSegments:Te().func.isRequired},$d.propTypes={setUpdateExistingSubscribers:Te().func.isRequired,updateExistingSubscribers:Te().bool.isRequired},i(49868);function Bd(e){let{selectedTags:t,setSelectedTags:i}=e;const a=(0,o.useCallback)((e=>{let{value:t}=e;i(t)}),[i]),s=c.MailPoet.tags.map((e=>e.name));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"mailpoet-settings-label",children:[c.MailPoet.I18n.t("assignTagsLabel"),(0,p.jsx)("p",{className:"description",children:c.MailPoet.I18n.t("assignTagsDescription")})]}),(0,p.jsx)("div",{className:"mailpoet-settings-inputs mailpoet-import-tags",children:(0,p.jsx)(xt.T,{name:"tags",onChange:a,suggestedValues:s,selectedValues:t,placeholder:c.MailPoet.I18n.t("addNewTag")})})]})}function Wd(e){let{history:t,stepMethodSelectionData:i,subscribersLimitForValidation:a,setStepDataManipulationData:s}=e;const[n,r]=(0,o.useState)([]),[l,d]=(0,o.useState)(!0),[m,u]=(0,o.useState)("subscribed"),[h,g]=(0,o.useState)("dontUpdate"),[f,_]=(0,o.useState)([]);return(0,o.useEffect)((()=>{void 0===i&&t.replace("step_method_selection")}),[i,t]),void 0===i?null:(0,p.jsxs)("div",{"data-automation-id":"import_data_manipulation_step",children:[(0,p.jsx)(Md,{stepMethodSelectionData:i}),(0,p.jsx)(Rd,{subscribersCount:i.subscribersCount,subscribers:i.subscribers,header:i.header}),(0,p.jsxs)("div",{className:"mailpoet-settings-grid",children:[(0,p.jsx)(Ld,{setSelectedSegments:r}),(0,p.jsx)(Dd,{newSubscribersStatus:m,setNewSubscribersStatus:u}),(0,p.jsx)(qd,{existingSubscribersStatus:h,setExistingSubscribersStatus:g}),(0,p.jsx)($d,{setUpdateExistingSubscribers:d,updateExistingSubscribers:l}),(0,p.jsx)(Bd,{selectedTags:f,setSelectedTags:_}),(0,p.jsx)(od,{canGoNext:n.length>0,onPreviousAction:()=>t.push(function(e,t){return void 0===e||void 0===e.subscribersCount||e.subscribersCount<t?"step_method_selection":"step_input_validation"}(i,a)),onNextAction:()=>{((e,t,i,a,s,n,o)=>{const r={},l=new(ke().AsyncQueue);let d=0;const m=Date.now()/1e3,u={created:0,updated:0,errors:[],segments:[],tags:[]};c.MailPoet.Modal.progress(!0);const p=e.reduce(((e,t,i)=>(i%2e3==0&&e.push([]),e[e.length-1].push(t),e)),[]);rt.default.each(ke()("select.mailpoet_subscribers_column_data_match"),((e,t)=>{const i=ke()(e).data("column-id");"ignore"!==i&&(r[i]={index:t})})),rt.default.each(p,(()=>{l.add((o=>{o.pause(),c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"ImportExport",action:"processImport",data:JSON.stringify({columns:r,subscribers:p[d],timestamp:m,segments:t,newSubscribersStatus:i,existingSubscribersStatus:a,updateSubscribers:s,tags:n})}).done((t=>{const i=t.data.added_to_segment_with_welcome_notification;var a,s;u.created+=t.data.created,u.updated+=t.data.updated,u.segments=t.data.segments,u.added_to_segment_with_welcome_notification=i,c.MailPoet.Modal.setProgress((a=u,s=e,Math.floor((a.created+a.updated)/s.length*100))),o.run()})).fail((e=>{c.MailPoet.Modal.progress(!1),e.errors.length>0&&c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0})})),d+=1}))})),l.run(),l.onComplete((()=>{c.MailPoet.Modal.progress(!1),u.errors.length>0&&!u.updated&&!u.created?c.MailPoet.Notice.error(rt.default.flatten(u.errors)):(u.segments=rt.default.map(rt.default.filter(u.segments,(e=>t.includes(e.id))),(e=>e.name)),o(u))}))})(i.subscribers,n,m,h,l,f,(e=>{s(e),t.push("step_results")}))},isLastStep:!0})]})]})}Wd.propTypes={history:Te().shape({push:Te().func.isRequired,replace:Te().func.isRequired}).isRequired,stepMethodSelectionData:Te().shape({duplicate:Te().arrayOf(Te().string),header:Te().arrayOf(Te().string),invalid:Te().arrayOf(Te().string),role:Te().arrayOf(Te().string),subscribersCount:Te().number,subscribers:Te().arrayOf(Te().arrayOf(Te().oneOfType([Te().string,Te().number])))}),subscribersLimitForValidation:Te().number.isRequired,setStepDataManipulationData:Te().func.isRequired},Wd.defaultProps={stepMethodSelectionData:void 0};const Vd=(0,Ne.EN)(Wd);function Ud(e){let{subscribersCount:t,segments:i,initialMessage:a}=e;if(t){let e=_()(a,"%1$s",(()=>(0,p.jsx)("strong",{children:t.toLocaleString()},"%1$s")));return e=_()(e,"%2$s",(()=>`"${i.join('", "')}"`)),(0,p.jsx)("p",{children:e})}return null}function Hd(e){let{createdSubscribers:t,updatedSubscribers:i}=e;return t||i?null:(0,p.jsx)("p",{children:c.MailPoet.I18n.t("importNoAction")})}function zd(e){let{createdSubscribers:t,updatedSubscribers:i}=e;return t||i?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("p",{children:(0,p.jsx)("b",{children:c.MailPoet.I18n.t("congratulationResult")})}),(0,p.jsx)("p",{children:_()(c.MailPoet.I18n.t("suppressionListReminder"),/\[link](.*?)\[\/link]/,(e=>(0,p.jsx)("a",{className:"mailpoet-link",href:"https://kb.mailpoet.com/article/359-how-to-import-a-suppression-list",target:"_blank",rel:"noopener noreferrer",children:e},"kb-link")))})]}):null}function Zd(e){let{addedToSegmentWithWelcomeNotification:t}=e;return t?(0,p.jsx)("p",{children:c.MailPoet.I18n.t("importNoWelcomeEmail")}):null}function Yd(e){let{errors:t,createdSubscribers:i,updatedSubscribers:a,segments:s,addedToSegmentWithWelcomeNotification:n,history:l}=e;return(0,o.useEffect)((()=>{void 0===s&&0===t.length&&void 0===i&&void 0===a&&l.replace("step_method_selection")}),[s,i,t.length,l,a]),t.length&&c.MailPoet.Notice.error(rt.default.flatten(t)),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsxs)("div",{className:"updated",children:[(0,p.jsx)(Ud,{subscribersCount:i,segments:s,initialMessage:c.MailPoet.I18n.t("subscribersCreated")}),(0,p.jsx)(Ud,{subscribersCount:a,segments:s,initialMessage:c.MailPoet.I18n.t("subscribersUpdated")}),(0,p.jsx)(Hd,{createdSubscribers:i,updatedSubscribers:a}),(0,p.jsx)(Zd,{addedToSegmentWithWelcomeNotification:n})]})}),(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(zd,{createdSubscribers:i,updatedSubscribers:a})}),(0,p.jsx)("div",{className:"mailpoet-settings-grid",children:(0,p.jsxs)("div",{className:"mailpoet-settings-save",children:[(0,p.jsx)(Le.z,{variant:"secondary",type:"button",onClick:()=>l.push("step_method_selection"),children:c.MailPoet.I18n.t("importAgain")}),(0,p.jsx)(Le.z,{type:"button",onClick:()=>{window.location.href="admin.php?page=mailpoet-subscribers"},children:c.MailPoet.I18n.t("viewSubscribers")})]})})]})}Ud.propTypes={segments:Te().arrayOf(Te().string.isRequired),subscribersCount:Te().number,initialMessage:Te().string},Ud.defaultProps={segments:[],subscribersCount:0,initialMessage:""},Ud.displayName="ResultMessage",Hd.propTypes={createdSubscribers:Te().number,updatedSubscribers:Te().number},Hd.defaultProps={createdSubscribers:0,updatedSubscribers:0},Hd.displayName="NoAction",zd.propTypes={createdSubscribers:Te().number,updatedSubscribers:Te().number},zd.defaultProps={createdSubscribers:0,updatedSubscribers:0},zd.displayName="SuppressionListReminder",Zd.propTypes={addedToSegmentWithWelcomeNotification:Te().bool},Zd.defaultProps={addedToSegmentWithWelcomeNotification:!1},Zd.diplayName="NoWelcomeEmail",Yd.propTypes={history:Te().shape({push:Te().func.isRequired,replace:Te().func.isRequired}).isRequired,errors:Te().arrayOf(Te().string.isRequired),segments:Te().arrayOf(Te().string.isRequired),createdSubscribers:Te().number,updatedSubscribers:Te().number,addedToSegmentWithWelcomeNotification:Te().bool},Yd.defaultProps={errors:[],segments:void 0,createdSubscribers:void 0,updatedSubscribers:void 0,addedToSegmentWithWelcomeNotification:void 0},Yd.displayName="StepResultsComponent";const Gd=(0,Ne.EN)(Yd);function Kd(e){let{history:t}=e;return(0,p.jsx)(xd,{onProceed:()=>t.push("step_method_selection")})}Kd.displayName="StepCleanList";const Qd=document.getElementById("import_container");function Xd(){const[e,t]=(0,o.useState)(void 0),[i,a]=(0,o.useState)({}),s=(0,l.S)(window);return(0,p.jsx)(l.k.Provider,{value:s,children:(0,p.jsxs)(Me.HashRouter,{children:[(0,p.jsx)(m.w,{}),(0,p.jsx)(sd,{children:(0,p.jsxs)(Ne.rs,{children:[(0,p.jsx)(Ne.AW,{path:"/step_clean_list",render:(0,r.withBoundary)(Kd)}),(0,p.jsx)(Ne.AW,{path:"/step_method_selection",render:e=>(0,p.jsx)(bd,{...e,setStepMethodSelectionData:t,subscribersLimitForValidation:100})}),(0,p.jsx)(Ne.AW,{path:"/step_input_validation",render:t=>(0,p.jsx)(Sd,{...t,stepMethodSelectionData:e})}),(0,p.jsx)(Ne.AW,{path:"/step_data_manipulation",render:t=>(0,p.jsx)(Vd,{...t,stepMethodSelectionData:e,subscribersLimitForValidation:100,setStepDataManipulationData:a})}),(0,p.jsx)(Ne.AW,{path:"/step_results",render:e=>(0,p.jsx)(Gd,{...e,errors:i.errors,createdSubscribers:i.created,updatedSubscribers:i.updated,segments:i.segments,addedToSegmentWithWelcomeNotification:i.added_to_segment_with_welcome_notification})}),(0,p.jsx)(Ne.AW,{path:"*",render:()=>(0,p.jsx)(Ne.l_,{to:"/step_clean_list"})})]})})]})})}Qd&&((0,r.registerTranslations)(),n.render((0,p.jsx)(Xd,{}),Qd));var Jd=i(76721),ec=i.n(Jd);ke()(document).ready((()=>{let e;if(!ke()("#mailpoet_subscribers_export").length)return;if(!window.exportData.segments)return;const t=ec().compile(ke()("#mailpoet_subscribers_export_template").html());function i(t){const i="mailpoet-disabled";"on"===t?e.removeClass(i):e.addClass(i)}ke()("#mailpoet-export").html(t(window.exportData));const a=ke()("#export_lists"),s=ke()("#export_columns");function n(e){let t=`<span class="mailpoet-form-select2-text"><span>${e.name}</span></span>`;return void 0!==e.count&&(t+=`<span class="mailpoet-form-select2-count">${e.count}</span>`),t}function o(e,t){e.data("select2")&&e.html("").select2("destroy"),e.select2({data:t,width:"20em",dropdownCssClass:"mailpoet-form-select2-dropdown",escapeMarkup:e=>e,templateResult:n,templateSelection:n}).on("select2:selecting",(t=>{const i=t.params.args.data.id,a=["select","deselect"];let s;rt.default.contains(a,i)&&(t.preventDefault(),"deselect"===i?ke()(t.target).val("").trigger("change"):(s=[],rt.default.each(e.find("option"),(e=>{const t=e.value;rt.default.contains(a,t)||s.push(t)})),ke()(t.target).val(s).trigger("change")),ke()(t.target).select2("close"))})).on("change",(()=>{window.exportData.segments&&a.select2("data").length&&s.select2("data").length||!window.exportData.segments&&s.select2("data").length?i("on"):i("off")}))}e=ke()("#mailpoet-export-button"),window.segments.forEach((e=>{a.append(ke()("<option></option>").attr("value",e.id).text(e.name))})),window.subscriberFieldsSelect2.forEach((e=>{e.text=e.name,e.children.forEach((e=>{e.name=(0,wo.r)(e.name),e.text=(0,wo.r)(e.name)}))})),o(a,window.segments),o(s,window.subscriberFieldsSelect2),s.val(["email","first_name","last_name","list_status","global_status","subscribed_ip","created_at","confirmed_at","confirmed_ip"]).trigger("change"),e.on("click",(e=>{if(ke()(e.target).hasClass("mailpoet-disabled"))return;c.MailPoet.Modal.loading(!0);const t=ke()(':radio[name="option_format"]:checked').val();c.MailPoet.Ajax.post({api_version:c.MailPoet.apiVersion,endpoint:"ImportExport",action:"processExport",data:JSON.stringify({export_format_option:t,segments:!!window.exportData.segments&&a.val(),subscriber_fields:s.val()})}).always((()=>{c.MailPoet.Modal.loading(!1)})).done((e=>{const i=c.MailPoet.I18n.t("exportMessage").replace("%1$s",`<strong>${parseInt(e.data.totalExported,10).toLocaleString()}</strong>`).replace("[link]",`<a href="${e.data.exportFileURL}" target="_blank" >`).replace("[/link]","</a>");ke()("#export_result_notice").html(`<p>${i}</p>`).show(),window.location.href=e.data.exportFileURL,c.MailPoet.trackEvent("Subscribers export completed",{"Total exported":e.data.totalExported,"File Format":t})})).fail((e=>{e.errors.length>0&&c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0})}))}))}));var tc=i(37441),ic=i(19613);function ac(e){let{children:t}=e;return(0,p.jsx)("div",{className:"mailpoet-steps-content",children:t})}const sc=(0,p.jsx)("svg",{width:"13",height:"11",viewBox:"0 0 13 11",children:(0,p.jsx)("path",{fill:"currentColor",d:"M9.967.638c.483-.698 1.405-.846 2.06-.33.654.515.793 1.499.31 2.197l-5.44 7.857c-.55.794-1.64.857-2.267.132l-3.4-3.928c-.552-.638-.515-1.632.083-2.22.598-.59 1.53-.55 2.082.088l2.19 2.532L9.968.638z"})}),nc=(0,p.jsx)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",children:(0,p.jsx)("path",{fill:"currentColor",d:"M12.407 3.31c.576.576.576 1.509 0 2.084L9.914 7.888l2.411 2.412c.586.585.586 1.535 0 2.121-.585.586-1.535.586-2.12 0l-2.413-2.412L5.3 12.503c-.576.575-1.509.575-2.084 0-.575-.575-.575-1.508 0-2.083l2.493-2.495-2.41-2.41c-.587-.587-.587-1.536 0-2.122.585-.586 1.535-.586 2.12 0L7.83 5.804l2.494-2.493c.575-.576 1.508-.576 2.083 0z"})});function oc(e){let{onCheck:t,showError:i,checked:a,automationId:s,...n}=e;return(0,p.jsxs)("div",{className:ee()({"mailpoet-form-yesno":!0,"mailpoet-form-yesno-error":i,"mailpoet-disabled":n.disabled}),"data-automation-id":s,children:[(0,p.jsxs)("label",{children:[(0,p.jsx)("input",{type:"radio",checked:!0===a,onChange:()=>t(!0),...n}),(0,p.jsx)("span",{className:"mailpoet-form-yesno-control mailpoet-form-yesno-yes",children:sc})]}),(0,p.jsxs)("label",{children:[(0,p.jsx)("input",{type:"radio",checked:!1===a,onChange:()=>t(!1),...n}),(0,p.jsx)("span",{className:"mailpoet-form-yesno-control mailpoet-form-yesno-no",children:nc})]})]})}function rc(e){let{submitForm:t,loading:i,showCustomersImportSetting:a,isWizardStep:s=!1}=e;const[n,l]=(0,o.useState)(null),[d,c]=(0,o.useState)(!1===a?"unsubscribed":null),[m,u]=(0,o.useState)(!1),h=s?(0,Oe._x)("Continue","A label on a button","mailpoet"):(0,Oe._x)("Start using WooCommerce features","Submit button caption on the standalone WooCommerce setup page","mailpoet");let g;return"subscribed"===d&&(g=!0),"unsubscribed"===d&&(g=!1),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(r.TypographyHeading,{level:1,children:(0,Oe._x)("Power up your WooCommerce store","Title on the WooCommerce setup page","mailpoet")}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)("p",{children:(0,Oe.__)("MailPoet comes with powerful features for WooCommerce. Select features that you would like to use with your store.","mailpoet")}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsxs)("form",{onSubmit:e=>(e.preventDefault(),u(!0),null===d||null===n||t(d,n),!1),children:[(0,p.jsxs)("div",{children:[a?(0,p.jsxs)("div",{className:"mailpoet-wizard-woocommerce-option",children:[(0,p.jsx)("div",{className:"mailpoet-wizard-woocommerce-toggle",children:(0,p.jsx)(oc,{showError:m&&null===d,checked:g,onCheck:e=>c(e?"subscribed":"unsubscribed"),name:"mailpoet_woocommerce_import_type",automationId:"woocommerce_import_type"})}),(0,p.jsxs)("div",{children:[(0,p.jsx)("p",{children:_()((0,Oe.__)("Do you want to import your WooCommerce customers as subscribed? [link]Learn more[/link].","mailpoet"),/\[link\](.*?)\[\/link\]/,(e=>(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/284-import-old-customers-to-the-woocommerce-customers-list",rel:"noopener noreferrer",target:"_blank",children:e},e)))}),(0,p.jsxs)("div",{className:"mailpoet-wizard-note",children:[(0,p.jsx)("span",{children:"GDPR"}),(0,Oe._x)("To be compliant with privacy regulations, your customers must have explicitly accepted to receive your marketing emails.","GDPR compliance information","mailpoet")]})]})]}):null,(0,p.jsxs)("div",{className:"mailpoet-wizard-woocommerce-option",children:[(0,p.jsx)("div",{className:"mailpoet-wizard-woocommerce-toggle",children:(0,p.jsx)(oc,{showError:m&&null===n,checked:n,onCheck:e=>l(e),name:"mailpoet_woocommerce_tracking",automationId:"woocommerce_tracking"})}),(0,p.jsxs)("div",{children:[(0,p.jsx)("p",{children:_()((0,Oe.__)("Collect more precise email and site engagement, and e-commerce metrics by enabling cookie tracking. [link]Learn more[/link].","mailpoet"),/\[link\](.*?)\[\/link\]/,(e=>(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/280-woocommerce-cookie-tracking",rel:"noopener noreferrer",target:"_blank",children:e},e)))}),(0,p.jsxs)("div",{className:"mailpoet-wizard-note",children:[(0,p.jsx)("span",{children:"GDPR"}),(0,Oe._x)("To be compliant, you should display a cookie tracking banner on your website.","GDPR compliance information","mailpoet")]})]})]})]}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)(r.Button,{className:"mailpoet-wizard-continue-button",isFullWidth:!0,type:"submit",withSpinner:i,disabled:i,automationId:"submit_woocommerce_setup",children:h})]})]})}function lc(e){return(0,p.jsx)(ls,{illustrationUrl:e.illustrationUrl,children:e.children})}function dc(e){let{isWizardStep:t=!1,redirectToNextStep:i=null}=e;const[a,s]=(0,o.useState)(!1),[n,l]=(0,ic.yu)("woocommerce"),d=(0,ic.yu)("tracking")[1],m=(0,ic.yu)("woocommerce_import_screen_displayed")[1],u=(0,ic.yu)("mailpoet_subscribe_old_woocommerce_customers")[1],h=e=>{s(!1),c.MailPoet.Notice.showApiErrorNotice(e,{scroll:!0})},g=e=>c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"settings",action:"set",data:e}).fail(h),f=(0,p.jsx)(lc,{illustrationUrl:window.wizard_woocommerce_illustration_url,children:(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(rc,{loading:a,submitForm:async(e,a)=>{s(!0);const o="basic"===c.MailPoet.trackingConfig.level?"basic":"partial",r={level:a?"full":o},p={enabled:"subscribed"===e?"1":""},f={woocommerce_import_screen_displayed:1,"mailpoet_subscribe_old_woocommerce_customers.enabled":p.enabled,"tracking.level":r.level,"woocommerce.accept_cookie_revenue_tracking.set":"1"};await g(f),d(r),u(p),l({...n,accept_cookie_revenue_tracking:{...n.accept_cookie_revenue_tracking||{},set:"1"}}),m("1"),await c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"importExport",action:"setupWooCommerceInitialImport"}).fail(h),t?i():await(async()=>{t?await g({version:window.mailpoet_version}).then((()=>{window.location.href=window.finish_wizard_url})):window.location.href=window.finish_wizard_url})()},isWizardStep:t,showCustomersImportSetting:window.mailpoet_show_customers_import})})});return t?f:(0,p.jsx)(ac,{children:f})}function cc(e){let{skipStep:t,loading:i,update_sender:a,submit_sender:s,sender:n=null}=e;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(bt.X,{level:1,children:(0,Oe.__)("Start by configuring your sender information","mailpoet")}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsxs)("p",{children:[(0,p.jsx)("b",{children:(0,Oe.__)("Default sender","mailpoet")}),(0,p.jsx)("br",{}),(0,Oe.__)("Enter details of the person or brand your subscribers expect to receive emails from","mailpoet")]}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsxs)("form",{id:"mailpoet_sender_form",onSubmit:e=>{e.preventDefault(),ke()("#mailpoet_sender_form").parsley().validate()&&s()},children:[(0,p.jsxs)(ki.Grid.TwoColumns,{children:[(0,p.jsxs)("label",{htmlFor:"senderName",children:[(0,p.jsx)("span",{className:"mailpoet-wizard-label",children:(0,Oe._x)("From Name","A form field label","mailpoet")}),(0,p.jsx)(r.Input,{isFullWidth:!0,name:"senderName",type:"text",placeholder:"John Doe",value:n?n.name:"","data-parsley-required":!0,onChange:e=>a({name:e.target.value})})]}),(0,p.jsxs)("label",{htmlFor:"senderAddress",children:[(0,p.jsx)("span",{className:"mailpoet-wizard-label",children:(0,Oe._x)("From Address","A form field label","mailpoet")}),(0,p.jsx)(r.Input,{isFullWidth:!0,name:"senderAddress",type:"text",placeholder:"john@doe.com",value:n?n.address:"","data-parsley-required":!0,"data-parsley-type":"email",onChange:e=>a({address:e.target.value})})]})]}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)(r.Button,{className:"mailpoet-wizard-continue-button",isFullWidth:!0,type:"submit",withSpinner:i,children:(0,Oe._x)("Continue","A label on a button","mailpoet")}),(0,p.jsx)(r.Button,{href:"#skipStep",isDisabled:i,isFullWidth:!0,onClick:t,variant:"tertiary",children:(0,Oe._x)("Skip this step","A label on a skip button","mailpoet")})]})]})}lc.propTypes={illustrationUrl:Te().string.isRequired,children:Te().oneOfType([Te().arrayOf(Te().node),Te().node]).isRequired},dc.displayName="WooCommerceController",cc.displayName="WelcomeWizardSenderStep";const mc=e=>null==e;function uc(e){let{loading:t,submitForm:i}=e;const[a,s]=(0,o.useState)({tracking:void 0,libs3rdParty:void 0}),[n,r]=(0,o.useState)(!1);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(bt.X,{level:1,children:(0,Oe.__)("Confirm privacy and data settings","mailpoet")}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsxs)("form",{onSubmit:function(e){return e.preventDefault(),r(!0),mc(a.libs3rdParty)||mc(a.tracking)||i(a.tracking,a.libs3rdParty),!1},children:[(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{id:"mailpoet-wizard-3rd-party-libs",className:"mailpoet-wizard-woocommerce-option",children:[(0,p.jsx)("div",{className:"mailpoet-wizard-woocommerce-toggle",children:(0,p.jsx)(oc,{showError:n&&mc(a.libs3rdParty),onCheck:e=>{const t={libs3rdParty:e};s((e=>({...e,...t})))},checked:a.libs3rdParty,name:"mailpoet_libs_3rdParty"})}),(0,p.jsxs)("div",{children:[(0,p.jsx)("p",{children:(0,Oe.__)("Enable modern text fonts in emails and show contextual help articles in MailPoet","mailpoet")}),(0,p.jsx)("div",{className:"mailpoet-wizard-note",children:_()((0,Oe.__)("MailPoet may load Google Fonts, DocsBot and other [link]3rd party libraries[/link].","mailpoet"),/\[link\](.*?)\[\/link\]/g,((e,t)=>(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/338-what-3rd-party-libraries-we-use",target:"_blank",rel:"noopener noreferrer",children:e},t)))})]})]}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsxs)("div",{id:"mailpoet-wizard-tracking",className:"mailpoet-wizard-woocommerce-option",children:[(0,p.jsx)("div",{className:"mailpoet-wizard-woocommerce-toggle",children:(0,p.jsx)(oc,{showError:n&&mc(a.tracking),onCheck:e=>{const t={tracking:e};s((e=>({...e,...t})))},checked:a.tracking,name:"mailpoet_tracking"})}),(0,p.jsxs)("div",{children:[(0,p.jsx)("p",{children:(0,Oe.__)("Help improve MailPoet","mailpoet")}),(0,p.jsx)("div",{className:"mailpoet-wizard-note",children:_()((0,Oe.__)("Get improved features and fixes faster by sharing with us [link]non-sensitive data about how you use MailPoet[/link]. No personal data is tracked or stored.","mailpoet"),/\[link\](.*?)\[\/link\]/g,((e,t)=>(0,p.jsx)("a",{href:"https://kb.mailpoet.com/article/130-sharing-your-data-with-us",target:"_blank",rel:"noopener noreferrer",children:e},t)))})]})]})]}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)(Le.z,{className:"mailpoet-wizard-continue-button",isFullWidth:!0,type:"submit",withSpinner:t,disabled:t,children:(0,Oe._x)("Continue","A label on a button","mailpoet")})]})]})}uc.propTypes={loading:Te().bool.isRequired,submitForm:Te().func.isRequired},uc.displayName="WelcomeWizardUsageTrackingStep";var pc=i(6198);async function hc(e){await c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"settings",action:"set",data:e}).fail((e=>{e.errors.length>0&&c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0})}))}async function gc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;await hc({version:window.mailpoet_version}),window.location.href=e||window.finish_wizard_url}function fc(){const[e,t]=(0,o.useState)(!1),i=e=>{e.preventDefault(),t(!0)},a=()=>t(!1);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("p",{children:_()(c.MailPoet.I18n.t("welcomeWizardMSSAdvancedUsers"),/\[link](.*?)\[\/link]/g,((e,t)=>(0,p.jsx)("a",{onClick:i,href:"#",children:e},t)))}),e&&(0,p.jsxs)(Qt.Z,{className:"mailpoet-welcome-wizard-confirmation-modal",title:c.MailPoet.I18n.t("welcomeWizardMSSConfirmationModalTitle"),onRequestClose:a,children:[(0,p.jsx)("p",{children:c.MailPoet.mailFunctionEnabled?c.MailPoet.I18n.t("welcomeWizardMSSConfirmationModalFirstParagraph"):c.MailPoet.I18n.t("welcomeWizardMSSConfirmationModalFirstParagraphWithoutMailFunction")}),(0,p.jsx)("p",{children:c.MailPoet.I18n.t("welcomeWizardMSSConfirmationModalSecondParagraph")}),(0,p.jsxs)("div",{className:"mailpoet-welcome-wizard-confirmation-modal-buttons",children:[(0,p.jsx)(r.Button,{variant:"secondary",onClick:a,children:c.MailPoet.I18n.t("welcomeWizardMSSConfirmationModalGoBackButton")}),(0,p.jsx)(r.Button,{onClick:async e=>{e.preventDefault(),await gc("admin.php?page=mailpoet-settings#/mta/other")},children:c.MailPoet.I18n.t("welcomeWizardMSSConfirmationModalOkButton")})]})]})]})}const _c="https://account.mailpoet.com/?ref=plugin-wizard&utm_source=plugin&utm_medium=onboarding&utm_campaign=purchase";function bc(){const e=(0,Ne.k6)(),{step:t}=(0,Ne.UO)(),i=(0,ic.v9)("getKeyActivationState")();return(0,o.useEffect)((()=>{!0===i.isKeyValid&&e.replace(`/steps/${t}/part/3`)}),[i.isKeyValid,e,t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(bt.X,{level:1,children:c.MailPoet.I18n.t("welcomeWizardMSSFirstPartTitle")}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)("p",{children:c.MailPoet.I18n.t("welcomeWizardMSSFirstPartSubtitle")}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)("div",{className:"mailpoet-welcome-wizard-mss-list",children:(0,p.jsxs)(r.List,{children:[(0,p.jsx)("li",{children:c.MailPoet.I18n.t("welcomeWizardMSSList1")}),(0,p.jsx)("li",{children:c.MailPoet.I18n.t("welcomeWizardMSSList2")}),c.MailPoet.subscribersCount<1e3?(0,p.jsx)("li",{children:c.MailPoet.I18n.t("welcomeWizardMSSList3Free")}):(0,p.jsx)("li",{children:c.MailPoet.I18n.t("welcomeWizardMSSList3Paid")})]})}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)(r.Button,{className:"mailpoet-wizard-continue-button",isFullWidth:!0,href:_c,target:"_blank",rel:"noopener noreferrer",onClick:i=>function(e,t,i){e.preventDefault(),window.open(_c),t.push(`/steps/${i}/part/2`)}(i,e,t),iconEnd:(0,p.jsx)(Xi.Z,{icon:pc.Z}),children:c.MailPoet.I18n.t("welcomeWizardMSSFirstPartButton")}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)(fc,{})]})}var xc=i(86873),vc=i(77135);function yc(){const e=(0,Ne.k6)(),{step:t}=(0,Ne.UO)(),i=(0,ic.v9)("getKeyActivationState")();return(0,o.useEffect)((()=>{!0===i.isKeyValid&&e.push(`/steps/${t}/part/3`)}),[i.isKeyValid,e,t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(r.Heading,{level:1,children:c.MailPoet.I18n.t("welcomeWizardMSSSecondPartTitle")}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)("p",{children:c.MailPoet.I18n.t("welcomeWizardMSSSecondPartEnterKey")}),(0,p.jsx)("p",{children:_()(c.MailPoet.I18n.t("welcomeWizardMSSSecondPartNoAccount"),/\[link](.*?)\[\/link]/g,((e,t)=>(0,p.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://account.mailpoet.com/?ref=plugin-wizard&utm_source=plugin&utm_medium=onboarding&utm_campaign=purchase",children:e},t)))}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsxs)("label",{htmlFor:"mailpoet_premium_key",children:[(0,p.jsx)("span",{className:"mailpoet-wizard-label",children:c.MailPoet.I18n.t("welcomeWizardMSSSecondPartInputLabel")}),(0,p.jsx)(vc.c,{placeholder:c.MailPoet.I18n.t("welcomeWizardMSSSecondPartInputPlaceholder"),isFullWidth:!0})]}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)(xc.X,{label:c.MailPoet.I18n.t("welcomeWizardMSSSecondPartButton"),isFullWidth:!0}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)(fc,{})]})}function jc(){return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(bt.X,{level:1,children:c.MailPoet.I18n.t("welcomeWizardMSSThirdPartTitle")}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)("p",{children:c.MailPoet.I18n.t("welcomeWizardMSSThirdPartFirstParagraph")}),(0,p.jsx)("p",{children:c.MailPoet.I18n.t("welcomeWizardMSSThirdPartSecondParagraph")}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)(r.Button,{className:"mailpoet-wizard-continue-button",type:"button",onClick:()=>gc(),isFullWidth:!0,children:c.MailPoet.I18n.t("welcomeWizardMSSThirdPartButton")})]})}function wc(){const{path:e}=(0,Ne.$B)(),{step:t}=(0,Ne.UO)();return(0,p.jsxs)(Ne.rs,{children:[(0,p.jsx)(Ne.AW,{exact:!0,path:`${e}`,children:(0,p.jsx)(Ne.l_,{to:`/steps/${t}/part/1`})}),(0,p.jsx)(Ne.AW,{path:`${e}/part/1`,children:(0,p.jsx)(bc,{})}),(0,p.jsx)(Ne.AW,{path:`${e}/part/2`,children:(0,p.jsx)(yc,{})}),(0,p.jsx)(Ne.AW,{path:`${e}/part/3`,children:(0,p.jsx)(jc,{})})]})}const Sc=e=>{let{name:t,address:i}=e;const a=i.split("@").pop().toLowerCase();return window.mailpoet_free_domains.indexOf(a)>-1?(e=>{let{name:t,address:i}=e;const a=`wordpress@${window.location.hostname.replace("www.","")}`;return{sender:{name:t,address:a},reply_to:{name:t,address:i},"signup_confirmation.from.address":a,"signup_confirmation.from.name":t,"signup_confirmation.reply_to.address":i,"signup_confirmation.reply_to.name":t}})({name:t,address:i}):(e=>{let{name:t,address:i}=e;return{sender:{name:t,address:i},reply_to:{name:t,address:i},"signup_confirmation.from.address":i,"signup_confirmation.from.name":t,"signup_confirmation.reply_to.address":i,"signup_confirmation.reply_to.name":t}})({name:t,address:i})},Pc=()=>{let e=3;return window.mailpoet_woocommerce_active&&(e+=1),e},Mc=(e,t,i)=>{i<Pc()?e.push(`/steps/${i+1}`):t()},Nc=e=>1===e?"WelcomeWizardSenderStep":2===e?"WelcomeWizardUsageTrackingStep":window.mailpoet_woocommerce_active&&3===e?"WizardWooCommerceStep":"WelcomeWizardPitchMSSStep";var Ic=i(93006);function kc(e){let{match:t,history:i}=e;const a=Pc(),s=parseInt(t.params.step,10),[n,l]=(0,o.useState)(!1),[c,m]=(0,ic.yu)("sender"),u=(0,ic.yu)("analytics")[1],h=(0,ic.yu)("3rd_party_libs")[1];(0,o.useEffect)((()=>{(s>a||s<1)&&i.push("/steps/1")}),[s,a,i]);const g=(0,rt.partial)(Mc,i,gc),f=(0,o.useCallback)((async(e,t)=>{l(!0);const i={enabled:e?"1":""},a={enabled:t?"1":""},n={analytics:i,"3rd_party_libs":a};await hc(n),u(i),h(a),g(s),l(!1)}),[g,s,u,h]),_=(0,o.useCallback)((e=>{m({...c,...e})}),[c,m]),b=(0,o.useCallback)((async()=>{l(!0),await hc(Sc(c)).then((()=>g(s))),l(!1)}),[g,c,s]),x=(0,o.useCallback)((async e=>{e.preventDefault(),l(!0);const t={address:window.admin_email,name:""};await hc(Sc(t)).then((()=>{m(t),g(s)})),l(!1)}),[g,s,m]),v=Nc(s);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(St.B,{}),(0,p.jsx)(d.D,{logoWithLink:!1,children:(0,p.jsx)(Ic.R,{count:a,current:s})}),(0,p.jsxs)(ac,{children:["WelcomeWizardSenderStep"===v?(0,p.jsx)(lc,{illustrationUrl:window.wizard_sender_illustration_url,children:(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(cc,{update_sender:_,submit_sender:b,skipStep:x,loading:n,sender:c})})}):null,"WelcomeWizardUsageTrackingStep"===v?(0,p.jsx)(lc,{illustrationUrl:window.wizard_tracking_illustration_url,children:(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(uc,{loading:n,submitForm:f})})}):null,"WelcomeWizardPitchMSSStep"===v?(0,p.jsx)(lc,{illustrationUrl:window.wizard_MSS_pitch_illustration_url,children:(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(wc,{})})}):null,"WizardWooCommerceStep"===v?(0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(dc,{isWizardStep:!0,redirectToNextStep:()=>g(s)})}):null]})]})}function Cc(){let e="/steps/1";window.location.search.includes("woocommerce-setup")&&(e="/woocommerce");const t=(0,l.S)(window);return(0,p.jsx)(l.k.Provider,{value:t,children:(0,p.jsxs)(Me.HashRouter,{children:[(0,p.jsx)(m.w,{}),(0,p.jsxs)(Ne.rs,{children:[(0,p.jsx)(Ne.AW,{path:"/steps/:step",component:(0,r.withBoundary)(kc)}),(0,p.jsx)(Ne.AW,{path:"/woocommerce",component:(0,r.withBoundary)(dc)}),(0,p.jsx)(Ne.AW,{render:()=>(0,p.jsx)(Ne.l_,{to:e})})]})]})})}kc.displayName="WelcomeWizardStepsController";const Tc=document.getElementById("mailpoet-wizard-container");function Ec(){const[e,t]=(0,o.useState)(null),i=(0,l.S)(window),a=i.notices.error;function s(s){const n=s.target.name,o=s.target.checked;c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"featureFlags",action:"set",data:{[n]:o?1:0}}).done((()=>{const a=e[n];a.value=o,t({...e,[n]:a});const s=`Feature '${n}' was ${o?"enabled":"disabled"}.`;i.notices.success((0,p.jsx)("p",{children:s}))})).fail((e=>{e.errors.length>0&&a(e.errors.map((e=>(0,p.jsx)("p",{children:e.message},e.message))),{scroll:!0})}))}return(0,o.useEffect)((()=>{c.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"featureFlags",action:"getAll"}).done((e=>{const i=e.data.reduce(((e,t)=>({...e,[t.name]:t})),{});t(i)})).fail((e=>{e.errors.length>0&&a((0,p.jsx)(p.Fragment,{children:e.errors.map((e=>(0,p.jsx)("p",{children:e.message})))}),{scroll:!0})}))}),[a]),null===e?(0,p.jsx)("p",{children:"Loading experimental features..."}):0===Object.values(e).length?(0,p.jsx)("p",{children:"There are no experimental features at the moment."}):(0,p.jsx)(l.k.Provider,{value:i,children:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(m.w,{}),Object.values(e).map((e=>{const t=`experimental-feature-${e.name}`;return(0,p.jsx)("div",{children:(0,p.jsxs)("label",{htmlFor:t,children:[(0,p.jsx)("input",{id:t,type:"checkbox",name:e.name,defaultChecked:e.value,onChange:s})," ",e.name]})},e.name)}))]})})}Tc&&((0,r.registerTranslations)(),(0,tc.N)(),n.render((0,p.jsx)(Cc,{}),Tc));const Ac=document.getElementById("experimental_features_container");Ec.displayName="ExperimentalFeatures",Ac&&((0,r.registerTranslations)(),n.render((0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(Ec,{})}),Ac));var Rc=i(26227);function Oc(e){let{message:t,editing:i}=e;return i?(0,p.jsx)("textarea",{value:t,className:"mailpoet-logs-full-message",readOnly:!0}):(0,p.jsx)(p.Fragment,{children:`${t.substr(0,150)}…`})}function Lc(e){let{log:t}=e;const[i,a]=(0,o.useState)(!1);return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{role:"gridcell",children:t.name}),(0,p.jsx)("td",{onClick:function(e){(function(e){return(e.ctrlKey||e.metaKey)&&!e.altKey})(e)&&(i||a(!0))},role:"gridcell",children:(0,p.jsx)(Oc,{message:t.message,editing:i})}),(0,p.jsx)("td",{role:"gridcell",children:c.MailPoet.Date.full(t.created_at)})]},`log-row-${t.id}`)}function Fc(e){let{logs:t,onFilter:i,originalFrom:a,originalTo:s,originalSearch:n,originalOffset:l,originalLimit:d}=e;const[m,u]=(0,o.useState)(a??void 0),[h,g]=(0,o.useState)(s??void 0),[f,_]=(0,o.useState)(l??""),[b,x]=(0,o.useState)(d??""),[v,y]=(0,o.useState)(n||""),j=(0,Pi.curry)(((e,t)=>{e(null!==t?c.MailPoet.Date.format(t,{format:"Y-m-d"}):void 0)})),w=(0,o.useCallback)((()=>{const e={};m&&(e.from=m),h&&(e.to=h),f&&""!==f.trim()&&(e.offset=f),b&&""!==b.trim()&&(e.limit=b),v&&""!==v.trim()&&(e.search=v.trim()),i(e)}),[m,b,f,v,h,i]);return(0,p.jsxs)("div",{className:"mailpoet-listing mailpoet-logs",children:[(0,p.jsxs)("div",{className:"mailpoet-listing-header",children:[(0,p.jsxs)("div",{className:"mailpoet-listing-search",children:[(0,p.jsx)("label",{htmlFor:"search_input",className:"screen-reader-text",children:c.MailPoet.I18n.t("searchLabel")}),(0,p.jsx)(r.Input,{dimension:"small",iconStart:Rc.J,type:"search",id:"search_input",name:"s",onChange:e=>y(e.target.value),value:v,placeholder:c.MailPoet.I18n.t("searchLabel")})]}),(0,p.jsxs)("div",{className:"mailpoet-listing-filters",children:[`${c.MailPoet.I18n.t("from")}:`,(0,p.jsxs)(r.ErrorBoundary,{children:[(0,p.jsx)(Ri.a,{dateFormat:"MMMM d, yyyy",onChange:j(u),maxDate:new Date,selected:m?(0,dr.default)(m):void 0,dimension:"small"}),`${c.MailPoet.I18n.t("to")}:`,(0,p.jsx)(Ri.a,{dateFormat:"MMMM d, yyyy",onChange:j(g),maxDate:new Date,selected:h?(0,dr.default)(h):void 0,dimension:"small"})]})]}),(0,p.jsxs)("div",{className:"mailpoet-logs-limit",children:[(0,p.jsx)("label",{htmlFor:"offset_input",className:"screen-reader-text",children:c.MailPoet.I18n.t("offsetLabel")}),(0,p.jsx)(r.Input,{dimension:"small",id:"offset_input",name:"o",type:"number",onChange:e=>_(e.target.value),value:f,placeholder:c.MailPoet.I18n.t("offsetLabel")})]}),(0,p.jsxs)("div",{className:"mailpoet-logs-limit",children:[(0,p.jsx)("label",{htmlFor:"limit_input",className:"screen-reader-text",children:c.MailPoet.I18n.t("limitLabel")}),(0,p.jsx)(r.Input,{dimension:"small",id:"limit_input",name:"l",type:"number",onChange:e=>x(e.target.value),value:b,placeholder:c.MailPoet.I18n.t("limitLabel")})]}),(0,p.jsx)(r.Button,{dimension:"small",onClick:w,children:c.MailPoet.I18n.t("filter")})]}),(0,p.jsxs)("table",{className:"mailpoet-listing-table widefat striped",role:"grid",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:c.MailPoet.I18n.t("tableHeaderName")}),(0,p.jsx)("th",{children:c.MailPoet.I18n.t("tableHeaderMessage")}),(0,p.jsx)("th",{children:c.MailPoet.I18n.t("tableHeaderCreatedOn")})]})}),(0,p.jsx)("tbody",{children:(0,p.jsx)(r.ErrorBoundary,{children:t.map((e=>(0,p.jsx)(Lc,{log:e},`log-${e.id}`)))})})]})]})}Lc.displayName="Log",Fc.displayName="LogsList";const Dc=document.getElementById("mailpoet_logs_container");if(Dc){const e=new URL(window.location.href);n.render((0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(Fc,{logs:window.mailpoet_logs,originalFrom:e.searchParams.get("from"),originalTo:e.searchParams.get("to"),originalSearch:e.searchParams.get("search"),originalOffset:e.searchParams.get("offset"),originalLimit:e.searchParams.get("limit"),onFilter:t=>{e.searchParams.delete("from"),e.searchParams.delete("to"),e.searchParams.delete("search"),e.searchParams.delete("offset"),e.searchParams.delete("limit"),Object.entries(t).forEach((t=>{let[i,a]=t;e.searchParams.append(i,a)})),window.location.href=e.href}})}),Dc)}var qc=i(634);function $c(e){let{onRequestClose:t}=e;const[i,a]=(0,o.useState)(!1);return ke()((e=>{e(document).on("click",".notice .mailpoet-js-button-fix-this",(()=>{a(!0)}))})),(0,p.jsxs)(l.k.Provider,{value:(0,l.S)(window),children:[(0,p.jsx)(m.w,{}),i&&(0,p.jsx)(qc.d,{onRequestClose:()=>{a(!1),t()}})]})}$c.defaultProps={onRequestClose:Pi.noop};const Bc=document.getElementById("mailpoet_set_from_address_modal");Bc&&n.render((0,p.jsx)($c,{onRequestClose:()=>{window.location.href.includes("?page=mailpoet-settings")&&window.location.reload()}}),Bc);const Wc=e=>(async e=>{if("MailPoet"!==c.MailPoet.mtaMethod)return!0;const t=await(async()=>"MailPoet"!==c.MailPoet.mtaMethod?[]:(await c.MailPoet.Ajax.post({api_version:c.MailPoet.apiVersion,endpoint:"mailer",action:"getVerifiedSenderDomains"})).data||[])(),i=(0,Wi.DA)(e);return-1!==t.indexOf(i)||-1!==(await(async()=>"MailPoet"!==c.MailPoet.mtaMethod?[]:(await c.MailPoet.Ajax.post({api_version:c.MailPoet.apiVersion,endpoint:"mailer",action:"getAuthorizedEmailAddresses"})).data||[])()).indexOf(e)})(e).then((e=>{if(!e)return c.MailPoet.Notice.error(c.MailPoet.I18n.t("mailerSendingNotResumedUnauthorized"),{scroll:!0}),c.MailPoet.trackEvent("Unauthorized email used",{"Unauthorized email source":"send"}),!1;c.MailPoet.Ajax.post({api_version:c.MailPoet.apiVersion,endpoint:"mailer",action:"resumeSending"}).done((()=>{c.MailPoet.Notice.success(c.MailPoet.I18n.t("mailerSendingResumedNotice"))})).fail((e=>{e.errors.length>0&&c.MailPoet.Notice.error(e.errors.map((e=>e.message)),{scroll:!0})}))}));ke()((e=>{e(document).on("click",".notice .mailpoet-js-button-resume-sending",(e=>{Wc(e.target.value)}))}));var Vc=i(79142);const Uc=e=>{const t=window.location.href.includes("?page=mailpoet-settings"),i=window.location.href.includes("?page=mailpoet-newsletters#/send");(e=>{const t=`${(0,Wi.HD)()||"some other"} page`;e&&e.type&&"email"===e.type?c.MailPoet.trackEvent("MSS in plugin authorize email",{"authorized email source":"modal","original page":t,wasSuccessful:"yes"}):e&&e.type&&"domain"===e.type&&c.MailPoet.trackEvent("MSS in plugin verify sender domain",{"verify sender domain source":"modal","original page":t,wasSuccessful:"yes"})})(e),(t||i)&&window.location.reload()};function Hc(){const[e,t]=(0,o.useState)(""),[i,a]=(0,o.useState)("email");return(0,o.useEffect)((()=>{const e=e=>{e.preventDefault();const i=String(e?.target?.dataset?.email||""),s=String(e?.target?.dataset?.type||"");a(s||"email"),t(i)};ke()((t=>{t(document).on("click",".mailpoet-js-button-authorize-email-and-sender-domain",e)}))}),[]),(0,p.jsx)(p.Fragment,{children:e&&(0,p.jsx)(Vc.h,{senderEmail:e,onRequestClose:()=>{t("")},onSuccessAction:Uc,showSenderEmailTab:"email"===i,showSenderDomainTab:"domain"===i,initialTab:"domain"===i?"sender_domain":"sender_email"})})}const zc=document.getElementById("mailpoet_authorize_sender_email_modal");zc&&n.render((0,p.jsx)(Hc,{}),zc);var Zc=i(83653),Yc=i(73030);const Gc=()=>{window.location.href=window.mailpoet_welcome_wizard_url},Kc="landing_page_cta_display",Qc="landing_page_cta_display_variant_begin_setup",Xc="landing_page_cta_display_variant_get_started_for_free";function Jc(){return(0,p.jsxs)(Zc.Experiment,{name:Kc,children:[(0,p.jsx)(Zc.Variant,{name:Qc,children:(0,p.jsx)(r.Button,{onClick:()=>{Zc.emitter.emitWin(Kc)},children:(0,Oe.__)("Begin setup","mailpoet")})}),(0,p.jsx)(Zc.Variant,{name:Xc,children:(0,p.jsx)(r.Button,{onClick:()=>{Zc.emitter.emitWin(Kc)},children:(0,Oe.__)("Get started for free","mailpoet")})})]})}function em(){return(0,p.jsx)("section",{className:"landing-header",children:(0,p.jsxs)("div",{className:"mailpoet-content-center",children:[(0,p.jsx)(bt.X,{level:0,children:(0,Oe.__)("Better email — without leaving WordPress","mailpoet")}),(0,p.jsx)("p",{children:(0,Oe.__)("Whether you’re just starting out or have already established your business, we’ve got what you need to reach customers where they are.","mailpoet")}),(0,p.jsx)(Jc,{})]})})}function tm(){return(0,p.jsx)("section",{className:"landing-footer",children:(0,p.jsxs)("div",{className:"landing-footer-content mailpoet-content-center",children:[(0,p.jsxs)(bt.X,{level:4,children:[" ",(0,Oe.__)("Ready to start using MailPoet?","mailpoet")," "]}),(0,p.jsx)(Jc,{})]})})}function im(){const e=[{slug:"item-1",title:(0,Oe.__)("What types of campaigns can I create with MailPoet?","mailpoet"),text:(0,Oe.__)("MailPoet allows you to create five different types of emails: Newsletter, Welcome Email, Latest Post Notifications, Re-engagement Emails and WooCommerce.","mailpoet"),readMoreText:(0,Oe.__)("Read More","mailpoet"),readMoreLink:"https://kb.mailpoet.com/article/141-create-an-email-types-of-campaigns"},{slug:"item-2",title:(0,Oe.__)("How do I send a newsletter?","mailpoet"),text:(0,Oe.__)("You can manually create a standard newsletter to be sent immediately or scheduled to be sent at a later time. Simply go to MailPoet > Emails and click on the “+ New Email” button to select “Newsletter”.","mailpoet"),readMoreText:(0,Oe.__)("Read More","mailpoet"),readMoreLink:"https://kb.mailpoet.com/article/344-create-a-standard-newsletter"},{slug:"item-3",title:(0,Oe.__)("Do I need a paid plan?","mailpoet"),text:(0,Oe.__)("When you install the MailPoet plugin, you can use it for free up to 1,000 subscribers. If you have more than 1,000 subscribers, you'll need one of our paid plans: Creator, Business, or Agency. The best choice of plan type will depend on whether you want to send with our MailPoet Sending Service or your own sending method, as well as the number of sites you will be using MailPoet on.","mailpoet"),readMoreText:(0,Oe.__)("Read More","mailpoet"),readMoreLink:"https://kb.mailpoet.com/article/349-choosing-your-mailpoet-plan"},{slug:"item-4",title:(0,Oe.__)("How do I import my customers from WooCommerce?","mailpoet"),text:(0,Oe.__)('The WooCommerce Customers list is a list automatically created by MailPoet with all of your WooCommerce customers. It also includes “Guest" customers. If WooCommerce is active, users that installed or updated the plugin should have chosen if they wanted to add the customers as “Subscribed” or “Unsubscribed” to the WooCommerce Customers list.',"mailpoet"),readMoreText:(0,Oe.__)("Read More","mailpoet"),readMoreLink:"https://kb.mailpoet.com/article/284-import-old-customers-to-the-woocommerce-customers-list"},{slug:"item-5",title:(0,Oe.__)("How do I customize emails for my store?","mailpoet"),text:(0,Oe.__)("You can create and send the following 4 WooCommerce Automatic emails with MailPoet: Abandoned Shopping Cart, First Purchase, Purchased In This Category, Purchased This Product. You can read more about each in our article.","mailpoet"),readMoreText:(0,Oe.__)("Read More","mailpoet"),readMoreLink:"https://kb.mailpoet.com/article/277-woocommerce-automatic-emails"}];return(0,p.jsxs)("section",{className:"landing-faq",children:[(0,p.jsxs)("div",{className:"mailpoet-content-center landing-faq-header",children:[(0,p.jsxs)(bt.X,{level:2,children:[" ",(0,Oe.__)("Frequently asked questions","mailpoet")," "]}),(0,p.jsx)("p",{children:_()((0,Oe.__)("Here are some common questions on getting started. Can't find what you're looking for? [link]View all resources[/link]","mailpoet"),/\[link\](.*?)\[\/link\]/,(e=>(0,p.jsx)("a",{href:"https://kb.mailpoet.com/",rel:"noopener noreferrer",target:"_blank",children:e},e)))})]}),(0,p.jsx)("div",{className:"mailpoet-content-center landing-faq-mobile",children:(0,p.jsx)(bt.X,{level:2,children:(0,Oe.__)("FAQ","mailpoet")})}),(0,p.jsx)("div",{className:"mailpoet-faq-accordion",children:e.map((e=>(0,p.jsxs)("details",{children:[(0,p.jsxs)("summary",{children:[" ",(0,p.jsxs)("strong",{children:[" ",e.title," "]})," "]}),(0,p.jsxs)("div",{className:"content",children:[(0,p.jsx)("p",{children:e.text}),(0,p.jsx)("p",{children:(0,p.jsx)("a",{href:e.readMoreLink,rel:"noopener noreferrer",target:"_blank",children:e.readMoreText})})]})]},e.slug)))}),(0,p.jsxs)("div",{className:"mailpoet-content-center landing-faq-mobile",children:[(0,p.jsx)("p",{children:(0,Oe.__)("Can’t find what you’re looking for?","mailpoet")}),(0,p.jsx)("p",{children:_()((0,Oe.__)("[link]View all resources[/link]","mailpoet"),/\[link\](.*?)\[\/link\]/,(e=>(0,p.jsx)("a",{href:"https://kb.mailpoet.com/",rel:"noopener noreferrer",target:"_blank",children:e},e)))})]})]})}Zc.emitter.addPlayListener(((e,t)=>{(0,Yc.KN)("Experiment Display",{experiment:e,variant:t},Yc.BY)})),Zc.emitter.addWinListener(((e,t)=>{(0,Yc.KN)("Experiment Win",{experiment:e,variant:t},Yc.BY,Gc)})),Zc.emitter.defineVariants(Kc,[Qc,Xc],[50,50]),Zc.experimentDebugger.setDebuggerAvailable(c.MailPoet.FeaturesController.isSupported("landingpage_ab_test_debugger")),Zc.experimentDebugger.enable(),Jc.displayName="Landingpage Ab Test",em.displayName="Landingpage Header",tm.displayName="Landingpage Footer",im.displayName="Landingpage FAQ";const am={heroImage:`${c.MailPoet.cdnUrl}landingpage/landingpage-hero-image.png`,featureImages:{icon_1:`${c.MailPoet.cdnUrl}landingpage/feature_icon_1.png`,icon_2:`${c.MailPoet.cdnUrl}landingpage/feature_icon_2.png`,icon_3:`${c.MailPoet.cdnUrl}landingpage/feature_icon_3.png`},wooCommerceFeatureImages:{feature_1:`${c.MailPoet.cdnUrl}landingpage/woo_feature_automate_your_marketing.png`,feature_2:`${c.MailPoet.cdnUrl}landingpage/woo_feature_measure_revenue_per_email.png`,feature_3:`${c.MailPoet.cdnUrl}landingpage/woo_feature_let_your_brand_shine.png`}};function sm(){return(0,p.jsxs)("section",{className:"landing-content",children:[(0,p.jsxs)("div",{className:"hero-section mailpoet-content-center",children:[(0,p.jsx)("img",{src:am.heroImage,alt:"",className:"hero-image landingpage-images"}),(0,p.jsx)("br",{}),(0,p.jsx)("br",{}),(0,p.jsx)(bt.X,{level:4,children:(0,Oe.sprintf)((0,Oe.__)("Powering email marketing for %s websites","mailpoet"),"700,000+")}),(0,p.jsx)("br",{}),(0,p.jsxs)(ki.Grid.ThreeColumns,{className:"landingpage-general-features",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("img",{src:am.featureImages.icon_1,alt:"",className:"landingpage-feature-icon"}),(0,p.jsx)("strong",{children:(0,Oe.__)("Deliver beautiful emails","mailpoet")}),(0,p.jsx)("p",{children:(0,Oe.__)("Choose from our pre-built templates or create your own with our drag-and-drop email builder.","mailpoet")})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("img",{src:am.featureImages.icon_2,alt:"",className:"landingpage-feature-icon"}),(0,p.jsx)("strong",{children:(0,Oe.__)("Grow your mailing list","mailpoet")}),(0,p.jsx)("p",{children:(0,Oe.__)("Use our custom sign-up forms to reach more subscribers while you deliver engaging content.","mailpoet")})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("img",{src:am.featureImages.icon_3,alt:"",className:"landingpage-feature-icon"}),(0,p.jsx)("strong",{children:(0,Oe.__)("Reach the right people","mailpoet")}),(0,p.jsx)("p",{children:(0,Oe.__)("From the first hello to repeated purchases, send emails to the right people at the right time.","mailpoet")})]})]})]}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsxs)("div",{className:"landingpage-wooCommerce-features",children:[(0,p.jsxs)("div",{className:"mailpoet-content-center",children:[(0,p.jsx)(bt.X,{level:2,children:(0,Oe.__)("MailPoet + WooCommerce","mailpoet")}),(0,p.jsx)("p",{children:(0,Oe.__)("Hyper-relevant content for every stage of the customer’s journey","mailpoet")})]}),(0,p.jsx)("br",{}),(0,p.jsxs)(ki.Grid.TwoColumns,{className:"landingpage-wooCommerce-feature-item",children:[(0,p.jsx)("div",{children:(0,p.jsx)("img",{src:am.wooCommerceFeatureImages.feature_1,alt:(0,Oe.__)("Automate your marketing feature Image","mailpoet"),className:"landingpage-images"})}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:(0,Oe.__)("Automate your marketing","mailpoet")}),(0,p.jsx)("p",{children:(0,Oe.__)("Drive sales and build loyalty through automated marketing messages that respond to your customer’s purchase data.","mailpoet")})]})]}),(0,p.jsxs)(ki.Grid.TwoColumns,{className:"landingpage-wooCommerce-feature-item",children:[(0,p.jsx)("div",{children:(0,p.jsx)("img",{src:am.wooCommerceFeatureImages.feature_2,alt:(0,Oe.__)("Measure revenue per email feature Image","mailpoet"),className:"landingpage-images"})}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:(0,Oe.__)("Measure revenue per email","mailpoet")}),(0,p.jsx)("p",{children:(0,Oe.__)("See how much revenue your campaign is bringing and make improvements based on auto-generated email statistics.","mailpoet")})]})]}),(0,p.jsxs)(ki.Grid.TwoColumns,{className:"landingpage-wooCommerce-feature-item",children:[(0,p.jsx)("div",{children:(0,p.jsx)("img",{src:am.wooCommerceFeatureImages.feature_3,alt:(0,Oe.__)("Let your brand shine feature Image","mailpoet"),className:"landingpage-images"})}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:(0,Oe.__)("Let your brand shine","mailpoet")}),(0,p.jsx)("p",{children:(0,Oe.__)("Use our inbuilt WooCommerce email customizer to design your store's transactional emails and build customer confidence.","mailpoet")})]})]})]})]})}function nm(){return(0,p.jsx)(l.k.Provider,{value:(0,l.S)(window),children:(0,p.jsxs)("main",{children:[(0,p.jsx)(St.B,{}),(0,p.jsx)(d.Q,{}),(0,p.jsx)(et.A,{color:"#fff"}),(0,p.jsx)(em,{}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)(sm,{}),(0,p.jsx)("div",{className:"mailpoet-gap"}),(0,p.jsx)(im,{}),(0,p.jsx)(tm,{})]})})}sm.displayName="Landingpage Content",nm.displayName="Landingpage";const om=document.getElementById("mailpoet_landingpage_container");om&&((0,r.registerTranslations)(),n.render((0,p.jsx)(r.ErrorBoundary,{children:(0,p.jsx)(nm,{})}),om)),i(86555)},86555:function(){document.addEventListener("DOMContentLoaded",(function(){window.mailpoet_track_wizard_loaded_via_woocommerce&&(window.MailPoet.trackEvent("User opened the MailPoet setup task in WooCommerce > Home",{"WooCommerce version":window.mailpoet_woocommerce_version}),window.MailPoet.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"settings",action:"delete",data:"send_event_that_wizard_was_loaded_via_woocommerce"}))}))},28270:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(t,i){var a;if("formatting"===(null!=i&&i.context?String(i.context):"standalone")&&e.formattingValues){var s=e.defaultFormattingWidth||e.defaultWidth,n=null!=i&&i.width?String(i.width):s;a=e.formattingValues[n]||e.formattingValues[s]}else{var o=e.defaultWidth,r=null!=i&&i.width?String(i.width):e.defaultWidth;a=e.values[r]||e.values[o]}return a[e.argumentCallback?e.argumentCallback(t):t]}},e.exports=t.default},71248:function(e,t,i){var a={EventEmitter:i(71793),EmitterSubscription:i(10777)};e.exports=a},71793:function(e,t,i){"use strict";var a=i(10777),s=i(31073),n=i(53101),o=i(73928),r=function(){function e(){this._subscriber=new s,this._currentSubscription=null}var t=e.prototype;return t.addListener=function(e,t,i){return this._subscriber.addSubscription(e,new a(this._subscriber,t,i))},t.once=function(e,t,i){var a=this;return this.addListener(e,(function(){a.removeCurrentListener(),t.apply(i,arguments)}))},t.removeAllListeners=function(e){this._subscriber.removeAllSubscriptions(e)},t.removeCurrentListener=function(){this._currentSubscription||n(!1),this._subscriber.removeSubscription(this._currentSubscription)},t.listeners=function(e){var t=this._subscriber.getSubscriptionsForType(e);return t?t.filter(o.thatReturnsTrue).map((function(e){return e.listener})):[]},t.emit=function(e){var t=this._subscriber.getSubscriptionsForType(e);if(t){for(var i=Object.keys(t),a=0;a<i.length;a++){var s=t[i[a]];s&&(this._currentSubscription=s,this.__emitToSubscription.apply(this,[s].concat(Array.prototype.slice.call(arguments))))}this._currentSubscription=null}},t.__emitToSubscription=function(e,t){var i=Array.prototype.slice.call(arguments,2);e.listener.apply(e.context,i)},e}();e.exports=r},10777:function(e,t,i){"use strict";var a=function(e){var t,i;function a(t,i,a){var s;return(s=e.call(this,t)||this).listener=i,s.context=a,s}return i=e,(t=a).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,a}(i(56447));e.exports=a},56447:function(e){"use strict";var t=function(){function e(e){this.subscriber=e}return e.prototype.remove=function(){this.subscriber&&(this.subscriber.removeSubscription(this),this.subscriber=null)},e}();e.exports=t},31073:function(e,t,i){"use strict";var a=i(53101),s=function(){function e(){this._subscriptionsForType={},this._currentSubscription=null}var t=e.prototype;return t.addSubscription=function(e,t){t.subscriber!==this&&a(!1),this._subscriptionsForType[e]||(this._subscriptionsForType[e]=[]);var i=this._subscriptionsForType[e].length;return this._subscriptionsForType[e].push(t),t.eventType=e,t.key=i,t},t.removeAllSubscriptions=function(e){void 0===e?this._subscriptionsForType={}:delete this._subscriptionsForType[e]},t.removeSubscription=function(e){var t=e.eventType,i=e.key,a=this._subscriptionsForType[t];a&&delete a[i]},t.getSubscriptionsForType=function(e){return this._subscriptionsForType[e]},e}();e.exports=s},35245:function(e){"use strict";var t=!("undefined"==typeof window||!window.document||!window.document.createElement),i={canUseDOM:t,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:t&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:t&&!!window.screen,isInWorker:!t};e.exports=i},13003:function(e,t,i){"use strict";var a=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];void 0!==i.g.Int32Array&&(a=new Int32Array(a)),e.exports=function(e){for(var t=-1,i=0,s=e.length;i<s;i++)t=t>>>8^a[255&(t^e.charCodeAt(i))];return~t}},73928:function(e){"use strict";function t(e){return function(){return e}}var i=function(){};i.thatReturns=t,i.thatReturnsFalse=t(!1),i.thatReturnsTrue=t(!0),i.thatReturnsNull=t(null),i.thatReturnsThis=function(){return this},i.thatReturnsArgument=function(e){return e},e.exports=i},53101:function(e){"use strict";e.exports=function(e,t){for(var i=arguments.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s];if(!e){var n;if(void 0===t)n=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;(n=new Error(t.replace(/%s/g,(function(){return String(a[o++])})))).name="Invariant Violation"}throw n.framesToPop=1,n}}},80824:function(e,t){var i,a;i=function e(){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},i=!t.document&&!!t.postMessage,a=t.IS_PAPA_WORKER||!1,s={},n=0,o={parse:function(i,a){var r=(a=a||{}).dynamicTyping||!1;if(y(r)&&(a.dynamicTypingFunction=r,r={}),a.dynamicTyping=r,a.transform=!!y(a.transform)&&a.transform,a.worker&&o.WORKERS_SUPPORTED){var l=function(){if(!o.WORKERS_SUPPORTED)return!1;var i,a,r=(i=t.URL||t.webkitURL||null,a=e.toString(),o.BLOB_URL||(o.BLOB_URL=i.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",a,")();"],{type:"text/javascript"})))),l=new t.Worker(r);return l.onmessage=f,l.id=n++,s[l.id]=l}();return l.userStep=a.step,l.userChunk=a.chunk,l.userComplete=a.complete,l.userError=a.error,a.step=y(a.step),a.chunk=y(a.chunk),a.complete=y(a.complete),a.error=y(a.error),delete a.worker,void l.postMessage({input:i,config:a,workerId:l.id})}var p=null;return o.NODE_STREAM_INPUT,"string"==typeof i?(i=function(e){return 65279===e.charCodeAt(0)?e.slice(1):e}(i),p=a.download?new d(a):new m(a)):!0===i.readable&&y(i.read)&&y(i.on)?p=new u(a):(t.File&&i instanceof File||i instanceof Object)&&(p=new c(a)),p.stream(i)},unparse:function(e,t){var i=!1,a=!0,s=",",n="\r\n",r='"',l=r+r,d=!1,c=null,m=!1;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||o.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(s=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(i=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(d=t.skipEmptyLines),"string"==typeof t.newline&&(n=t.newline),"string"==typeof t.quoteChar&&(r=t.quoteChar),"boolean"==typeof t.header&&(a=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");c=t.columns}void 0!==t.escapeChar&&(l=t.escapeChar+r),("boolean"==typeof t.escapeFormulae||t.escapeFormulae instanceof RegExp)&&(m=t.escapeFormulae instanceof RegExp?t.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var u=new RegExp(h(r),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return p(null,e,d);if("object"==typeof e[0])return p(c||Object.keys(e[0]),e,d)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||c),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),p(e.fields||[],e.data||[],d);throw new Error("Unable to serialize unrecognized input");function p(e,t,i){var o="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var r=Array.isArray(e)&&0<e.length,l=!Array.isArray(t[0]);if(r&&a){for(var d=0;d<e.length;d++)0<d&&(o+=s),o+=g(e[d],d);0<t.length&&(o+=n)}for(var c=0;c<t.length;c++){var m=r?e.length:t[c].length,u=!1,p=r?0===Object.keys(t[c]).length:0===t[c].length;if(i&&!r&&(u="greedy"===i?""===t[c].join("").trim():1===t[c].length&&0===t[c][0].length),"greedy"===i&&r){for(var h=[],f=0;f<m;f++){var _=l?e[f]:f;h.push(t[c][_])}u=""===h.join("").trim()}if(!u){for(var b=0;b<m;b++){0<b&&!p&&(o+=s);var x=r&&l?e[b]:b;o+=g(t[c][x],b)}c<t.length-1&&(!i||0<m&&!p)&&(o+=n)}}return o}function g(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var a=!1;m&&"string"==typeof e&&m.test(e)&&(e="'"+e,a=!0);var n=e.toString().replace(u,l);return(a=a||!0===i||"function"==typeof i&&i(e,t)||Array.isArray(i)&&i[t]||function(e,t){for(var i=0;i<t.length;i++)if(-1<e.indexOf(t[i]))return!0;return!1}(n,o.BAD_DELIMITERS)||-1<n.indexOf(s)||" "===n.charAt(0)||" "===n.charAt(n.length-1))?r+n+r:n}}};if(o.RECORD_SEP=String.fromCharCode(30),o.UNIT_SEP=String.fromCharCode(31),o.BYTE_ORDER_MARK="\ufeff",o.BAD_DELIMITERS=["\r","\n",'"',o.BYTE_ORDER_MARK],o.WORKERS_SUPPORTED=!i&&!!t.Worker,o.NODE_STREAM_INPUT=1,o.LocalChunkSize=10485760,o.RemoteChunkSize=5242880,o.DefaultDelimiter=",",o.Parser=g,o.ParserHandle=p,o.NetworkStreamer=d,o.FileStreamer=c,o.StringStreamer=m,o.ReadableStreamStreamer=u,t.jQuery){var r=t.jQuery;r.fn.parse=function(e){var i=e.config||{},a=[];return this.each((function(e){if("INPUT"!==r(this).prop("tagName").toUpperCase()||"file"!==r(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var s=0;s<this.files.length;s++)a.push({file:this.files[s],inputElem:this,instanceConfig:r.extend({},i)})})),s(),this;function s(){if(0!==a.length){var t,i,s,l=a[0];if(y(e.before)){var d=e.before(l.file,l.inputElem);if("object"==typeof d){if("abort"===d.action)return"AbortError",t=l.file,i=l.inputElem,s=d.reason,void(y(e.error)&&e.error({name:"AbortError"},t,i,s));if("skip"===d.action)return void n();"object"==typeof d.config&&(l.instanceConfig=r.extend(l.instanceConfig,d.config))}else if("skip"===d)return void n()}var c=l.instanceConfig.complete;l.instanceConfig.complete=function(e){y(c)&&c(e,l.file,l.inputElem),n()},o.parse(l.file,l.instanceConfig)}else y(e.complete)&&e.complete()}function n(){a.splice(0,1),s()}}}function l(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=x(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new p(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,i){if(this.isFirstChunk&&y(this._config.beforeFirstChunk)){var s=this._config.beforeFirstChunk(e);void 0!==s&&(e=s)}this.isFirstChunk=!1,this._halted=!1;var n=this._partialLine+e;this._partialLine="";var r=this._handle.parse(n,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var l=r.meta.cursor;this._finished||(this._partialLine=n.substring(l-this._baseIndex),this._baseIndex=l),r&&r.data&&(this._rowCount+=r.data.length);var d=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(a)t.postMessage({results:r,workerId:o.WORKER_ID,finished:d});else if(y(this._config.chunk)&&!i){if(this._config.chunk(r,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);r=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(r.data),this._completeResults.errors=this._completeResults.errors.concat(r.errors),this._completeResults.meta=r.meta),this._completed||!d||!y(this._config.complete)||r&&r.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),d||r&&r.meta.paused||this._nextChunk(),r}this._halted=!0},this._sendError=function(e){y(this._config.error)?this._config.error(e):a&&this._config.error&&t.postMessage({workerId:o.WORKER_ID,error:e,finished:!1})}}function d(e){var t;(e=e||{}).chunkSize||(e.chunkSize=o.RemoteChunkSize),l.call(this,e),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),i||(t.onload=v(this._chunkLoaded,this),t.onerror=v(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var a in e)t.setRequestHeader(a,e[a])}if(this._config.chunkSize){var s=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+s)}try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}i&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");return null===t?-1:parseInt(t.substring(t.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){var i=t.statusText||e;this._sendError(new Error(i))}}function c(e){var t,i;(e=e||{}).chunkSize||(e.chunkSize=o.LocalChunkSize),l.call(this,e);var a="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,i=e.slice||e.webkitSlice||e.mozSlice,a?((t=new FileReader).onload=v(this._chunkLoaded,this),t.onerror=v(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var s=Math.min(this._start+this._config.chunkSize,this._input.size);e=i.call(e,this._start,s)}var n=t.readAsText(e,this._config.encoding);a||this._chunkLoaded({target:{result:n}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function m(e){var t;l.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,i=this._config.chunkSize;return i?(e=t.substring(0,i),t=t.substring(i)):(e=t,t=""),this._finished=!t,this.parseChunk(e)}}}function u(e){l.call(this,e=e||{});var t=[],i=!0,a=!1;this.pause=function(){l.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){l.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){a&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):i=!0},this._streamData=v((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),i&&(i=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=v((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=v((function(){this._streamCleanUp(),a=!0,this._streamData("")}),this),this._streamCleanUp=v((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function p(e){var t,i,a,s=Math.pow(2,53),n=-s,r=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,l=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,d=this,c=0,m=0,u=!1,p=!1,f=[],_={data:[],errors:[],meta:{}};if(y(e.step)){var b=e.step;e.step=function(t){if(_=t,w())j();else{if(j(),0===_.data.length)return;c+=t.data.length,e.preview&&c>e.preview?i.abort():(_.data=_.data[0],b(_,d))}}}function v(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function j(){return _&&a&&(P("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+o.DefaultDelimiter+"'"),a=!1),e.skipEmptyLines&&(_.data=_.data.filter((function(e){return!v(e)}))),w()&&function(){if(_)if(Array.isArray(_.data[0])){for(var t=0;w()&&t<_.data.length;t++)_.data[t].forEach(i);_.data.splice(0,1)}else _.data.forEach(i);function i(t,i){y(e.transformHeader)&&(t=e.transformHeader(t,i)),f.push(t)}}(),function(){if(!_||!e.header&&!e.dynamicTyping&&!e.transform)return _;function t(t,i){var a,s=e.header?{}:[];for(a=0;a<t.length;a++){var n=a,o=t[a];e.header&&(n=a>=f.length?"__parsed_extra":f[a]),e.transform&&(o=e.transform(o,n)),o=S(n,o),"__parsed_extra"===n?(s[n]=s[n]||[],s[n].push(o)):s[n]=o}return e.header&&(a>f.length?P("FieldMismatch","TooManyFields","Too many fields: expected "+f.length+" fields but parsed "+a,m+i):a<f.length&&P("FieldMismatch","TooFewFields","Too few fields: expected "+f.length+" fields but parsed "+a,m+i)),s}var i=1;return!_.data.length||Array.isArray(_.data[0])?(_.data=_.data.map(t),i=_.data.length):_.data=t(_.data,0),e.header&&_.meta&&(_.meta.fields=f),m+=i,_}()}function w(){return e.header&&0===f.length}function S(t,i){return a=t,e.dynamicTypingFunction&&void 0===e.dynamicTyping[a]&&(e.dynamicTyping[a]=e.dynamicTypingFunction(a)),!0===(e.dynamicTyping[a]||e.dynamicTyping)?"true"===i||"TRUE"===i||"false"!==i&&"FALSE"!==i&&(function(e){if(r.test(e)){var t=parseFloat(e);if(n<t&&t<s)return!0}return!1}(i)?parseFloat(i):l.test(i)?new Date(i):""===i?null:i):i;var a}function P(e,t,i,a){var s={type:e,code:t,message:i};void 0!==a&&(s.row=a),_.errors.push(s)}this.parse=function(s,n,r){var l=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substring(0,1048576);var i=new RegExp(h(t)+"([^]*?)"+h(t),"gm"),a=(e=e.replace(i,"")).split("\r"),s=e.split("\n"),n=1<s.length&&s[0].length<a[0].length;if(1===a.length||n)return"\n";for(var o=0,r=0;r<a.length;r++)"\n"===a[r][0]&&o++;return o>=a.length/2?"\r\n":"\r"}(s,l)),a=!1,e.delimiter)y(e.delimiter)&&(e.delimiter=e.delimiter(s),_.meta.delimiter=e.delimiter);else{var d=function(t,i,a,s,n){var r,l,d,c;n=n||[",","\t","|",";",o.RECORD_SEP,o.UNIT_SEP];for(var m=0;m<n.length;m++){var u=n[m],p=0,h=0,f=0;d=void 0;for(var _=new g({comments:s,delimiter:u,newline:i,preview:10}).parse(t),b=0;b<_.data.length;b++)if(a&&v(_.data[b]))f++;else{var x=_.data[b].length;h+=x,void 0!==d?0<x&&(p+=Math.abs(x-d),d=x):d=x}0<_.data.length&&(h/=_.data.length-f),(void 0===l||p<=l)&&(void 0===c||c<h)&&1.99<h&&(l=p,r=u,c=h)}return{successful:!!(e.delimiter=r),bestDelimiter:r}}(s,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);d.successful?e.delimiter=d.bestDelimiter:(a=!0,e.delimiter=o.DefaultDelimiter),_.meta.delimiter=e.delimiter}var c=x(e);return e.preview&&e.header&&c.preview++,t=s,i=new g(c),_=i.parse(t,n,r),j(),u?{meta:{paused:!0}}:_||{meta:{paused:!1}}},this.paused=function(){return u},this.pause=function(){u=!0,i.abort(),t=y(e.chunk)?"":t.substring(i.getCharIndex())},this.resume=function(){d.streamer._halted?(u=!1,d.streamer.parseChunk(t,!0)):setTimeout(d.resume,3)},this.aborted=function(){return p},this.abort=function(){p=!0,i.abort(),_.meta.aborted=!0,y(e.complete)&&e.complete(_),t=""}}function h(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(e){var t,i=(e=e||{}).delimiter,a=e.newline,s=e.comments,n=e.step,r=e.preview,l=e.fastMode,d=t=void 0===e.quoteChar||null===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(d=e.escapeChar),("string"!=typeof i||-1<o.BAD_DELIMITERS.indexOf(i))&&(i=","),s===i)throw new Error("Comment character same as delimiter");!0===s?s="#":("string"!=typeof s||-1<o.BAD_DELIMITERS.indexOf(s))&&(s=!1),"\n"!==a&&"\r"!==a&&"\r\n"!==a&&(a="\n");var c=0,m=!1;this.parse=function(o,u,p){if("string"!=typeof o)throw new Error("Input must be a string");var g=o.length,f=i.length,_=a.length,b=s.length,x=y(n),v=[],j=[],w=[],S=c=0;if(!o)return z();if(e.header&&!u){var P=o.split(a)[0].split(i),M=[],N={},I=!1;for(var k in P){var C=P[k];y(e.transformHeader)&&(C=e.transformHeader(C,k));var T=C,E=N[C]||0;for(0<E&&(I=!0,T=C+"_"+E),N[C]=E+1;M.includes(T);)T=T+"_"+E;M.push(T)}if(I){var A=o.split(a);A[0]=M.join(i),o=A.join(a)}}if(l||!1!==l&&-1===o.indexOf(t)){for(var R=o.split(a),O=0;O<R.length;O++){if(w=R[O],c+=w.length,O!==R.length-1)c+=a.length;else if(p)return z();if(!s||w.substring(0,b)!==s){if(x){if(v=[],W(w.split(i)),Z(),m)return z()}else W(w.split(i));if(r&&r<=O)return v=v.slice(0,r),z(!0)}}return z()}for(var L=o.indexOf(i,c),F=o.indexOf(a,c),D=new RegExp(h(d)+h(t),"g"),q=o.indexOf(t,c);;)if(o[c]!==t)if(s&&0===w.length&&o.substring(c,c+b)===s){if(-1===F)return z();c=F+_,F=o.indexOf(a,c),L=o.indexOf(i,c)}else if(-1!==L&&(L<F||-1===F))w.push(o.substring(c,L)),c=L+f,L=o.indexOf(i,c);else{if(-1===F)break;if(w.push(o.substring(c,F)),H(F+_),x&&(Z(),m))return z();if(r&&v.length>=r)return z(!0)}else for(q=c,c++;;){if(-1===(q=o.indexOf(t,q+1)))return p||j.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:v.length,index:c}),U();if(q===g-1)return U(o.substring(c,q).replace(D,t));if(t!==d||o[q+1]!==d){if(t===d||0===q||o[q-1]!==d){-1!==L&&L<q+1&&(L=o.indexOf(i,q+1)),-1!==F&&F<q+1&&(F=o.indexOf(a,q+1));var $=V(-1===F?L:Math.min(L,F));if(o.substr(q+1+$,f)===i){w.push(o.substring(c,q).replace(D,t)),o[c=q+1+$+f]!==t&&(q=o.indexOf(t,c)),L=o.indexOf(i,c),F=o.indexOf(a,c);break}var B=V(F);if(o.substring(q+1+B,q+1+B+_)===a){if(w.push(o.substring(c,q).replace(D,t)),H(q+1+B+_),L=o.indexOf(i,c),q=o.indexOf(t,c),x&&(Z(),m))return z();if(r&&v.length>=r)return z(!0);break}j.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:v.length,index:c}),q++}}else q++}return U();function W(e){v.push(e),S=c}function V(e){var t=0;if(-1!==e){var i=o.substring(q+1,e);i&&""===i.trim()&&(t=i.length)}return t}function U(e){return p||(void 0===e&&(e=o.substring(c)),w.push(e),c=g,W(w),x&&Z()),z()}function H(e){c=e,W(w),w=[],F=o.indexOf(a,c)}function z(e){return{data:v,errors:j,meta:{delimiter:i,linebreak:a,aborted:m,truncated:!!e,cursor:S+(u||0)}}}function Z(){n(z()),v=[],j=[]}},this.abort=function(){m=!0},this.getCharIndex=function(){return c}}function f(e){var t=e.data,i=s[t.workerId],a=!1;if(t.error)i.userError(t.error,t.file);else if(t.results&&t.results.data){var n={abort:function(){a=!0,_(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:b,resume:b};if(y(i.userStep)){for(var o=0;o<t.results.data.length&&(i.userStep({data:t.results.data[o],errors:t.results.errors,meta:t.results.meta},n),!a);o++);delete t.results}else y(i.userChunk)&&(i.userChunk(t.results,n,t.file),delete t.results)}t.finished&&!a&&_(t.workerId,t.results)}function _(e,t){var i=s[e];y(i.userComplete)&&i.userComplete(t),i.terminate(),delete s[e]}function b(){throw new Error("Not implemented.")}function x(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var i in e)t[i]=x(e[i]);return t}function v(e,t){return function(){e.apply(t,arguments)}}function y(e){return"function"==typeof e}return a&&(t.onmessage=function(e){var i=e.data;if(void 0===o.WORKER_ID&&i&&(o.WORKER_ID=i.workerId),"string"==typeof i.input)t.postMessage({workerId:o.WORKER_ID,results:o.parse(i.input,i.config),finished:!0});else if(t.File&&i.input instanceof File||i.input instanceof Object){var a=o.parse(i.input,i.config);a&&t.postMessage({workerId:o.WORKER_ID,results:a,finished:!0})}}),(d.prototype=Object.create(l.prototype)).constructor=d,(c.prototype=Object.create(l.prototype)).constructor=c,(m.prototype=Object.create(m.prototype)).constructor=m,(u.prototype=Object.create(l.prototype)).constructor=u,o},void 0===(a=i.apply(t,[]))||(e.exports=a)},23064:function(e){e.exports=function(e){if(!window.satismeter){window.satismeter=function(){var e=[];function t(){e.push(arguments)}return t.q=e,t}();var t=document.createElement("script"),i=document.getElementsByTagName("script")[0].parentNode;t.async=1,t.src="https://app.satismeter.com/satismeter.js",i.appendChild(t)}return window.satismeter(e)}},65311:function(e){"use strict";e.exports=jQuery}},function(e){e.O(0,[351],(function(){return 81950,e(e.s=81950)})),e.O()}]);