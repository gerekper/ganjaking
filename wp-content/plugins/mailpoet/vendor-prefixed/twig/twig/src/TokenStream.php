<?php
 namespace MailPoetVendor\Twig; if (!defined('ABSPATH')) exit; use MailPoetVendor\Twig\Error\SyntaxError; final class TokenStream { private $tokens; private $current = 0; private $source; public function __construct(array $tokens, \MailPoetVendor\Twig\Source $source = null) { $this->tokens = $tokens; $this->source = $source ?: new \MailPoetVendor\Twig\Source('', ''); } public function __toString() { return \implode("\n", $this->tokens); } public function injectTokens(array $tokens) { $this->tokens = \array_merge(\array_slice($this->tokens, 0, $this->current), $tokens, \array_slice($this->tokens, $this->current)); } public function next() : \MailPoetVendor\Twig\Token { if (!isset($this->tokens[++$this->current])) { throw new \MailPoetVendor\Twig\Error\SyntaxError('Unexpected end of template.', $this->tokens[$this->current - 1]->getLine(), $this->source); } return $this->tokens[$this->current - 1]; } public function nextIf($primary, $secondary = null) { if ($this->tokens[$this->current]->test($primary, $secondary)) { return $this->next(); } } public function expect($type, $value = null, string $message = null) : \MailPoetVendor\Twig\Token { $token = $this->tokens[$this->current]; if (!$token->test($type, $value)) { $line = $token->getLine(); throw new \MailPoetVendor\Twig\Error\SyntaxError(\sprintf('%sUnexpected token "%s"%s ("%s" expected%s).', $message ? $message . '. ' : '', \MailPoetVendor\Twig\Token::typeToEnglish($token->getType()), $token->getValue() ? \sprintf(' of value "%s"', $token->getValue()) : '', \MailPoetVendor\Twig\Token::typeToEnglish($type), $value ? \sprintf(' with value "%s"', $value) : ''), $line, $this->source); } $this->next(); return $token; } public function look(int $number = 1) : \MailPoetVendor\Twig\Token { if (!isset($this->tokens[$this->current + $number])) { throw new \MailPoetVendor\Twig\Error\SyntaxError('Unexpected end of template.', $this->tokens[$this->current + $number - 1]->getLine(), $this->source); } return $this->tokens[$this->current + $number]; } public function test($primary, $secondary = null) : bool { return $this->tokens[$this->current]->test($primary, $secondary); } public function isEOF() : bool { return -1 === $this->tokens[$this->current]->getType(); } public function getCurrent() : \MailPoetVendor\Twig\Token { return $this->tokens[$this->current]; } public function getSourceContext() : \MailPoetVendor\Twig\Source { return $this->source; } } \class_alias('MailPoetVendor\\Twig\\TokenStream', 'MailPoetVendor\\Twig_TokenStream'); 