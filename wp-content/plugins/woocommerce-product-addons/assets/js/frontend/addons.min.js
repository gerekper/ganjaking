!function(m,_){function a(t){return this instanceof a?!!t.length&&(this.$el=t,this.$addons=this.$el.find(".wc-pao-addon-field"),this.$addons.length?(this.is_rtl="rtl"===document.documentElement.dir,this.validation=new o(this),this.totals=new i(this),this.show_incomplete_subtotals=this.totals.showIncompleteSubtotals(),this.setupEvents(),this.validation.validate(),this.updateTotals(),m(".wc-pao-addon-image-swatch").tipTip({delay:200}),void WC_PAO.initialized_forms.push(this)):this.$addons=!1):new a(t)}function i(t){return this instanceof i?!m.isEmptyObject(t)&&(this.$form=t.$el,this.$addons=t.$addons,this.$variation_input=!!this.$form.hasClass("variations_form")&&this.$form.find('input[name="variation_id"], input.variation_id'),this.is_variable=this.$variation_input&&0<this.$variation_input.length,this.$totals=this.$form.find("#product-addons-total"),this.product_id=this.is_variable?this.$variation_input.val():this.$totals.data("product-id"),!!this.product_id&&(this.base_price=this.$totals.data("price"),this.raw_price=this.$totals.data("raw-price"),this.product_type=this.$totals.data("type"),this.qty=parseFloat(this.$form.find("input.qty").val()),this.addons_price_data=[],this.$subscription_plans=this.$form.find(".wcsatt-options-product"),this.has_subscription_plans=0<this.$subscription_plans.length,this.is_rtl=t.is_rtl,this.total=0,this.total_raw=0,void(this.show_subtotal_panel=!0))):new i(t)}function o(t){return this instanceof o?!!t.$addons.length&&(this.$form=t.$el,this.$addons=t.$addons,void(this.validationState=this.getInitialState())):new o(t)}(WC_PAO=_.WC_PAO||{}).initialized_forms=[],WC_PAO.Helper={escapeHtml:function(t){return document.createElement("div").appendChild(document.createTextNode(t)).parentNode.innerHTML},isGroupedSubsSelected:function(){var t=m(".product-type-grouped"),a=!1;return t.length&&t.find(".group_table tr.product").each(function(){if(0<m(this).find(".input-text.qty").val()&&m(this).find(".entry-summary .subscription-details").length)return!(a=!0)}),a},isGroupedMixedProductType:function(){var t=m(".product-type-grouped"),a=0,i=0;return!!(t.length&&(t.find(".group_table tr.product").each(function(){0<m(this).find(".input-text.qty").val()&&(m(this).find(".entry-summary .subscription-details").length?a++:i++)}),0<a&&0<i))},delay:function(t,a){clearTimeout(0),setTimeout(t,a)}},WC_PAO.Form=(a.prototype.setupEvents=function(){var e=this;e.$el.find('button[type="submit"]').on("click",function(){var t;return!!e.validation.validate(!0)||(0<(t=e.$el.find(".wc-pao-validation-notice")).length&&(0<(t=e.$el.find(t[0].closest(".wc-pao-addon-container"))).length&&!e.is_in_viewport(t)&&t[0].scrollIntoView()),!1)}),e.$el.on("blur change",".wc-pao-addon input, .wc-pao-addon textarea, .wc-pao-addon select, .wc-pao-addon-custom-text",function(){e.validation.validateAddon(m(this),!0),e.updateTotals()}),e.$el.on("keyup",".wc-pao-addon input, .wc-pao-addon textarea, .wc-pao-addon-custom-text",function(){var t=m(this);WC_PAO.Helper.delay(function(){e.validation.validateAddon(t,!0),e.updateTotals()},300)}),e.$el.on("change","input.qty",function(){e.updateTotals()}),e.$el.on("click touchend",".wc-pao-addon-image-swatch",function(t){t.preventDefault();var t=m(this).data("value"),a=m(this).parents(".wc-pao-addon-wrap"),i=m.parseHTML(m(this).data("price")),o=a.find(".wc-pao-addon-image-swatch-selected-swatch");o.html(""),a.find(".wc-pao-addon-image-swatch").removeClass("selected"),m(this).addClass("selected"),a.find(".wc-pao-addon-image-swatch-select").val(t),o.html(i),e.validation.validateAddon(a.find("select.wc-pao-addon-field"),!0),e.updateTotals()}),e.$el.on("click",".reset_variations",function(){e.totals.reset()}),e.$el.on("wc_variation_form",function(){e.validation.validate(),e.updateTotals()}),e.$el.on("found_variation",function(t,a){e.totals.updateVariation(a),e.validation.validate(),e.updateTotals()}),e.$el.on("hide_variation",function(t){e.updateTotals()}),e.$el.on("woocommerce-product-addons-update",function(){e.validation.validate(),e.updateTotals()}),m("#credit_called").on("keyup",function(){e.validation.validate(),e.updateTotals()})},a.prototype.updateTotals=function(){this.totals.calculate(),this.show_incomplete_subtotals||this.isValid()?this.totals.render():this.totals.reset()},a.prototype.isValid=function(){var t=!0;return this.$el.find("button.single_add_to_cart_button").is(".disabled")?t=!1:(m.each(this.validation.getValidationState(),function(){if(!this.validity)return t=!1}),t)},a.prototype.is_in_viewport=function(t,a,i,o){var e,s,n,d,r,c,l,p=m(_);if(!(t.length<1))return n=(t=1<t.length?t.eq(0):t).get(0),r=p.width(),l=p.height(),i=!0!==i||n.offsetWidth*n.offsetHeight,o=o||"vertical","function"==typeof n.getBoundingClientRect?(c=0<=(n=n.getBoundingClientRect()).top&&n.top<l,e=0<n.bottom&&n.bottom<=l,d=n.top<0&&n.bottom>l,s=0<=n.left&&n.left<r,n=0<n.right&&n.right<=r,d=a?c||e||d:c&&e,c=a?s||n:s&&n,"both"===o?i&&d&&c:"vertical"===o?i&&d:"horizontal"===o?i&&c:void 0):(s=(e=p.scrollTop())+l,d=(n=p.scrollLeft())+r,p=(l=(c=t.offset()).top)+t.height(),c=(r=c.left)+t.width(),t=!0===a?p:l,l=!0===a?l:p,p=!0===a?c:r,a=!0===a?r:c,"both"===o?!!i&&l<=s&&e<=t&&a<=d&&n<=p:"vertical"===o?!!i&&l<=s&&e<=t:"horizontal"===o?!!i&&a<=d&&n<=p:void 0)},i.prototype.showIncompleteSubtotals=function(){return 1===this.$totals.data("show-incomplete-sub-total")},i.prototype.updateVariation=function(t){this.$variation_input=!!this.$form.hasClass("variations_form")&&this.$form.find('input[name="variation_id"], input.variation_id'),this.product_id=t.variation_id,this.$totals.data("product-id",this.product_id),void 0!==t.display_price?this.base_price=t.display_price:m(t.price_html).find(".amount").last().length&&(this.base_price=m(t.price_html).find(".amount").last().text(),this.base_price=this.base_price.replace(woocommerce_addons_params.currency_format_symbol,""),this.base_price=this.base_price.replace(woocommerce_addons_params.currency_format_thousand_sep,""),this.base_price=this.base_price.replace(woocommerce_addons_params.currency_format_decimal_sep,"."),this.base_price=this.base_price.replace(/[^0-9\.]/g,""),this.base_price=parseFloat(this.base_price)),this.$totals.data("price",this.base_price)},i.prototype.calculate=function(){var u=this;u.qty=parseFloat(u.$form.find("input.qty").val()),u.addons_price_data=[],u.total=0,u.total_raw=0,u.base_price=u.$totals.data("price"),u.raw_price=u.$totals.data("raw-price"),u.product_id=u.is_variable?u.$variation_input.val():u.$totals.data("product-id"),""===u.base_price&&"undefined"!=typeof custom_gift_card_amount&&custom_gift_card_amount.length&&0<custom_gift_card_amount.val()&&(u.base_price=custom_gift_card_amount.val()),woocommerce_addons_params.is_bookings&&m(".wc-bookings-booking-cost").length&&(u.base_price=parseFloat(m(".wc-bookings-booking-cost").attr("data-raw-price"))),this.$addons.each(function(){if(m(this).val()){var t,a,i,o=m(this),e=o.parents(".wc-pao-addon"),s=e.find(".wc-pao-addon-name").length?e.find(".wc-pao-addon-name").data("addon-name"):"",n="",d=0,r=0,c=o.data("price-type"),l=!1,p={},_=!!e.find(".wc-pao-addon-name").length&&e.find(".wc-pao-addon-name").data("has-per-person-pricing"),e=!!e.find(".wc-pao-addon-name").length&&e.find(".wc-pao-addon-name").data("has-per-block-pricing");if(o.is(".wc-pao-addon-custom-price"))l=!0,d=o.val(),r=o.val(),c="quantity_based";else if(o.is(".wc-pao-addon-input-multiplier"))""!==o.val()&&(o.val(Math.ceil(o.val())),d=o.data("price")*o.val(),r=o.data("raw-price")*o.val());else if(o.is(".wc-pao-addon-checkbox, .wc-pao-addon-radio")){if(!o.is(":checked"))return;n=o.data("label"),d=o.data("price"),r=o.data("raw-price")}else if(o.is(".wc-pao-addon-image-swatch-select, .wc-pao-addon-select")){if(!o.find("option:selected")||""===o.find("option:selected").val())return;c=o.find("option:selected").data("price-type"),n=o.find("option:selected").data("label"),d=o.find("option:selected").data("price"),r=o.find("option:selected").data("raw-price")}else{if(!o.val())return;d=o.data("price"),r=o.data("raw-price")}switch(d=d||0,r=r||0,"booking"!==u.product_type&&"accommodation-booking"!==u.product_type||!woocommerce_addons_params.is_bookings||(void(t=u.qty=0)!==m("#wc_bookings_field_duration")&&0<m("#wc_bookings_field_duration").val()&&(t=m("#wc_bookings_field_duration").val()),void 0!==m("#wc-bookings-form-end-time")&&0<m("#wc-bookings-form-end-time").val()&&(t=m("#wc-bookings-form-end-time").val()),i=m("#wc_bookings_field_persons"),a=0,1===i.length?a=parseInt(a,10)+parseInt(i.val(),10):m(".wc-bookings-booking-form").find("input").each(function(){var t=this.id.match(/wc_bookings_field_persons_(\d+)/);null!=t&&m("#"+t[0]).length&&(a=parseInt(a,10)+parseInt(m("#"+t[0]).val(),10))}),0===u.qty&&m(".wc-bookings-booking-cost").length&&(u.qty=1),_&&a&&(u.qty*=a),e&&t&&(u.qty*=t)),c){case"flat_fee":p.cost=parseFloat(d),p.cost_raw=parseFloat(r);break;case"quantity_based":p.cost_pu=parseFloat(d),p.cost_raw_pu=parseFloat(r),p.cost=p.cost_pu*u.qty,p.cost_raw=p.cost_raw_pu*u.qty;break;case"percentage_based":p.cost_pct=parseFloat(d)/100,p.cost_raw_pct=parseFloat(r)/100,p.cost=parseFloat(u.base_price)*p.cost_pct*u.qty,p.cost_raw=parseFloat(u.raw_price)*p.cost_raw_pct*u.qty}u.total+=p.cost||0,u.total_raw+=p.cost_raw||0,void 0!==n&&("number"==typeof n||n.length?p.name=s+(n?" - "+n:""):(i=o.val(),(_=parseInt(woocommerce_addons_params.trim_user_input_characters,10))<(i=o.is(".wc-pao-addon-file-upload")?i.replace(/^.*[\\\/]/,""):i).length&&(i=i.slice(0,_)+"..."),p.name=s+" - "+WC_PAO.Helper.escapeHtml(i)),p.is_custom_price=l,p.price_type=c,u.addons_price_data.push(p))}}),u.$totals.data("price_data",u.addons_price_data),u.$form.trigger("updated_addons")},i.prototype.render=function(){var t,i,e,a,o,s,n,d,r,c=this;c.$totals.data("show-sub-total")&&c.qty&&(c.formatMoney(c.total),e=!1,void 0!==c.base_price&&c.product_id&&(t=m(".wc-bookings-booking-form").length?isNaN(c.base_price)?0:parseFloat(c.base_price):parseFloat(c.base_price*c.qty),i=c.formatMoney(t+c.total)),c.has_subscription_plans?(a=c.$form.data("satt_script"))&&a.schemes_model.get_active_scheme_key()&&((a=c.$subscription_plans.find("input:checked")).val()&&(o=a.parent().find(".subscription-details"))):c.$form.parent().find(".subscription-details").length&&!c.$form.hasClass("bundle_data")&&(o=c.$form.parent().find(".subscription-details"),c.$variation_input&&0<c.$variation_input.length&&(o=c.$form.parent().find(".woocommerce-variation .subscription-details"))),o&&0<o.length&&(s=" "+o.clone().wrap("<p>").parent().html()),"grouped"===c.product_type?s&&!WC_PAO.Helper.isGroupedMixedProductType()&&WC_PAO.Helper.isGroupedSubsSelected()&&(i&&(i+=s)):s&&i&&(i+=s),i)?(a=c.$form.find(".wc-pao-addon-container").data("product-name"),o=c.formatMoney(t),s=c.$form.find(".wc-pao-addon-container").data("product-tax-status"),n=m(".wc-bookings-booking-form").length?'<div class="product-addon-totals"><ul><li><div class="wc-pao-col1"><strong>'+a+'</strong></div><div class="wc-pao-col2"><strong><span class="amount">'+o+"</span></strong></div></li>":'<div class="product-addon-totals"><ul><li><div class="wc-pao-col1"><strong><span>'+(c.is_rtl?woocommerce_addons_params.quantity_symbol+c.qty:c.qty+woocommerce_addons_params.quantity_symbol)+"</span> "+a+'</strong></div><div class="wc-pao-col2"><strong><span class="amount">'+o+"</span></strong></div></li>",c.addons_price_data.length&&m.each(c.addons_price_data,function(t,a){var i,o;n="quantity_based"===a.price_type?(o=0===(i=a.cost)?"-":c.formatMoney(i),n+'<li class="wc-pao-row-quantity-based"><div class="wc-pao-col1">'+a.name+'</div><div class="wc-pao-col2"><span class="amount">'+o+"</span></div></li>"):(o=0===(i=a.cost)?"-":'<span class="amount">'+c.formatMoney(i)+"</span>",n+'<li><div class="wc-pao-col1"><strong>'+a.name+'</strong></div><div class="wc-pao-col2">'+o+"</div></li>"),woocommerce_addons_params.tax_enabled&&a.is_custom_price&&(e=!0)}),d="",r=void 0===c.$totals.data("i18n_sub_total")?woocommerce_addons_params.i18n_sub_total:c.$totals.data("i18n_sub_total"),e||woocommerce_addons_params.price_display_suffix&&woocommerce_addons_params.tax_enabled?"taxable"!==s||e||!1!=-1<woocommerce_addons_params.price_display_suffix.indexOf("{price_including_tax}")||!1!=-1<woocommerce_addons_params.price_display_suffix.indexOf("{price_excluding_tax}")?m.ajax({type:"POST",url:woocommerce_addons_params.ajax_url,data:{action:"wc_product_addons_calculate_tax",product_id:c.product_id,add_on_total:c.total,add_on_total_raw:c.total_raw,qty:c.qty},success:function(t){var a;n="SUCCESS"==t.result?(d='<small class="woocommerce-price-suffix">'+woocommerce_addons_params.price_display_suffix+"</small>",a=c.formatMoney(t.price_including_tax),t=c.formatMoney(t.price_excluding_tax),d=(d=d.replace("{price_including_tax}",'<span class="amount">'+a+"</span>")).replace("{price_excluding_tax}",'<span class="amount">'+t+"</span>"),a=woocommerce_addons_params.display_include_tax?a:t,n+'<li class="wc-pao-subtotal-line"><p class="price">'+r+' <span class="amount">'+a+"</span> "+d+" </p></li></ul></div>"):n+'<li class="wc-pao-subtotal-line"><p class="price">'+r+' <span class="amount">'+i+"</span></p></li></ul></div>",c.show_subtotal_panel?c.$totals.html(n):c.$totals.html(""),c.$form.trigger("updated_addons")},error:function(){n=n+'<li class="wc-pao-subtotal-line"><p class="price">'+r+' <span class="amount">'+i+"</span></p></li></ul></div>",c.show_subtotal_panel?c.$totals.html(n):c.$totals.html(""),c.$form.trigger("updated_addons")}}):(n=n+'<li class="wc-pao-subtotal-line"><strong>'+r+' <span class="amount">'+i+"</span> "+woocommerce_addons_params.price_display_suffix+"</strong></li></ul></div>",c.show_subtotal_panel?c.$totals.html(n):c.$totals.html(""),c.$form.trigger("updated_addons")):(n=n+'<li class="wc-pao-subtotal-line"><p class="price">'+r+' <span class="amount">'+i+"</span></p></li></ul></div>",c.show_subtotal_panel?c.$totals.html(n):c.$totals.html(""),c.$form.trigger("updated_addons"))):(c.$totals.empty(),c.$form.trigger("updated_addons"))},i.prototype.reset=function(){this.$totals.empty(),this.$totals.html(""),this.$form.trigger("updated_addons")},i.prototype.formatMoney=function(t){let a=woocommerce_addons_params.currency_format_num_decimals;var i;return woocommerce_addons_params.trim_trailing_zeros&&(i=parseFloat(t)%1==0,t=parseFloat(t),a=i?0:t.toString().split(".")[1].length),accounting.formatMoney(t,{symbol:woocommerce_addons_params.currency_format_symbol,decimal:woocommerce_addons_params.currency_format_decimal_sep,thousand:woocommerce_addons_params.currency_format_thousand_sep,precision:a,format:woocommerce_addons_params.currency_format})},o.prototype.getInitialState=function(){var t={};return m.each(this.$addons,function(){t[m(this).attr("id")]={validity:!0,message:""}}),t},o.prototype.getValidationState=function(){return this.validationState},o.prototype.validateAddon=function(t,a=!1){var i=t.data("restrictions"),o=t.attr("id"),e=!0;return m.isEmptyObject(i)||((e="required"in i&&"yes"===i.required?this.validateRequired(t):e)&&"content"in i&&("only_letters"===i.content?e=this.validateLetters(t):"only_numbers"===i.content?e=this.validateNumbers(t):"only_letters_numbers"===i.content?e=this.validateLettersNumbers(t):"email"===i.content&&(e=this.validateEmail(t))),(e=e&&"min"in i?this.validateMin(t,i.min):e)&&"max"in i&&(e=this.validateMax(t,i.max))),a&&this.printMessage(t),this.validationState[o].validity},o.prototype.validate=function(t=!1){var a=!0,i=this;return m.each(i.$addons,function(){i.validateAddon(m(this),t)||(a=!1)}),a},o.prototype.printMessage=function(t){var a,t=t.attr("id"),i=this.$form.find("#"+t),o=t+"-validation-notice",e=this.validationState[t].message;i.is(":radio")||i.is(":checkbox")?((a=i.closest(".wc-pao-addon-container .wc-pao-addon-wrap")).find(".wc-pao-validation-notice").remove(),this.validationState[t].validity||a.append('<small id="'+o+'" class="wc-pao-validation-notice">'+e+"</small>")):(i.closest(".wc-pao-addon-container").find(".wc-pao-validation-notice").remove(),this.validationState[t].validity||i.after('<small id="'+o+'" class="wc-pao-validation-notice">'+e.replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</small>"))},o.prototype.validateRequired=function(t){var a=!0,i="",o="",e=t.attr("id");if(t.is(":checkbox")||t.is(":radio")){var s,n=(s=t.closest(".wc-pao-addon-container")).find(".wc-pao-addon-field"),d=this,a=!1;if(m.each(n,function(){m(this).is(":checked")&&(a=!0)}),a)return void m.each(n,function(){var t=m(this).attr("id");d.validationState[t]={validity:a,message:i,reason:o}});i=woocommerce_addons_params.i18n_validation_required_select}else t.hasClass("wc-pao-addon-image-swatch-select")?(s=t.closest(".wc-pao-addon-container"),a=!1,m.each(s.find(".wc-pao-addon-image-swatch"),function(){m(this).hasClass("selected")&&(a=!0)}),a||(i=woocommerce_addons_params.i18n_validation_required_select)):t.val()||(a=!1,"file"===t.attr("type")?i=woocommerce_addons_params.i18n_validation_required_file:"number"===t.attr("type")?i=woocommerce_addons_params.i18n_validation_required_number:t.is("input")||t.is("textarea")?i=woocommerce_addons_params.i18n_validation_required_input:t.is("select")&&(i=woocommerce_addons_params.i18n_validation_required_select));return a||(o="required"),this.validationState[e]={validity:a,message:i,reason:o},this.validationState[e].validity},o.prototype.validateLetters=function(t){var a=!/[`!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~\d]/g.test(t.val()),i="",o="",e=t.attr("id");return(a=t.val()?a:!0)||(i=woocommerce_addons_params.i18n_validation_letters_only,o="letters"),this.validationState[e]={validity:a,message:i,reason:o},this.validationState[e].validity},o.prototype.validateNumbers=function(t){var a=/^[0-9]*$/g.test(t.val()),i="",o="",e=t.attr("id");return(a=t.val()?a:!0)||(i=woocommerce_addons_params.i18n_validation_numbers_only,o="numbers"),this.validationState[e]={validity:a,message:i,reason:o},this.validationState[e].validity},o.prototype.validateLettersNumbers=function(t){var a=!/[`!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~]/g.test(t.val()),i="",o="",e=t.attr("id");return(a=t.val()?a:!0)||(i=woocommerce_addons_params.i18n_validation_letters_and_numbers_only,o="letters_numbers"),this.validationState[e]={validity:a,message:i,reason:o},this.validationState[e].validity},o.prototype.validateEmail=function(t){var a=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(t.val()),i="",o="",e=t.attr("id");return(a=t.val()?a:!0)||(i=woocommerce_addons_params.i18n_validation_email_only,o="email"),this.validationState[e]={validity:a,message:i,reason:o},this.validationState[e].validity},o.prototype.validateMin=function(t,a){var i,o=!0,e="",s="",n=t.attr("id");return t.val()?"number"===t.attr("type")?(i=((i=t.val()).includes(".")||i.includes(",")?parseFloat:parseInt)(i))<a&&(o=!1,e=woocommerce_addons_params.i18n_validation_min_number.replace("%c",a)):("text"===t.attr("type")||t.is("textarea"))&&t.val().length<a&&(o=!1,e=woocommerce_addons_params.i18n_validation_min_characters.replace("%c",a)):o=!0,this.validationState[n]={validity:o,message:e,reason:s=o?s:"min"},this.validationState[n].validity},o.prototype.validateMax=function(t,a){var i,o,e=!0,s="",n=t.attr("id");return t.val()?"number"===t.attr("type")?a<(o=((o=t.val()).includes(".")||o.includes(",")?parseFloat:parseInt)(o))&&(e=!1,s=woocommerce_addons_params.i18n_validation_max_number.replace("%c",a)):("text"===t.attr("type")||t.is("textarea"))&&t.val().length>a&&(e=!1,s=woocommerce_addons_params.i18n_validation_max_characters.replace("%c",a)):e=!0,this.validationState[n]={validity:e,message:s,reason:i=e?i:"max"},this.validationState[n].validity},a),m(function(){m("body").on("quick-view-displayed",function(){m(this).find(".cart:not(.cart_group)").each(function(){new WC_PAO.Form(m(this))})}),m("body").find(".cart:not(.cart_group)").each(function(){new WC_PAO.Form(m(this))})})}(jQuery,window);