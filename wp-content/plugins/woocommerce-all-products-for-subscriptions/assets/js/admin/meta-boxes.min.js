jQuery(function(c){var n,e=c("#wcsatt_data"),t=e.find(".general_scheme_options"),i=t.find("input#_wcsatt_allow_one_off"),s=t.find("select#_wcsatt_default_status"),a=t.find(".wcsatt_image_select__container"),o=t.find("textarea#_wcsatt_subscription_prompt"),_=e.find(".subscription_schemes"),r=_.find(".subscription_scheme"),p=r.length,d={message:null,overlayCSS:{background:""!==wcsatt_admin_params.post_id?"#fff":"#f1f1f1",opacity:.6}};function l(){0<r.length?(i.prop("disabled",!1),s.prop("disabled",!1),o.prop("disabled",!1)):(i.prop("checked",!0).trigger("change"),i.prop("disabled",!0),s.prop("disabled",!0),o.prop("disabled",!0)),m()}function u(){0<r.length?e.removeClass("planless"):e.addClass("planless"),1<r.length?e.addClass("more_than_one_plan"):e.removeClass("more_than_one_plan"),i.is(":checked")?e.addClass("onetime_enabled"):e.removeClass("onetime_enabled")}function h(){var t=c("select#product-type").val(),n=r.length;"subscription"!==t&&"variable-subscription"!==t&&(0<n?c(".subscription_one_time_shipping").show():c(".subscription_one_time_shipping").hide())}function m(){a.removeClass("disabled"),(1===r.length&&!i.is(":checked")||0===r.length&&i.is(":checked"))&&a.addClass("disabled")}function f(){r.each(function(t,n){c(".position",n).val(parseInt(c(n).index(".subscription_schemes .subscription_scheme"),10)),c(n).attr("rel",t)})}c.fn.wcsatt_init_help_tips=function(){c(this).find(".help_tip, .tips, .woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})},c.fn.wcsatt_init_type_dependent_inputs=function(){var t=c("select#product-type").val(),n="variable"===t?wcsatt_admin_params.i18n_override_option_variable:wcsatt_admin_params.i18n_override_option,e="variable"===t?wcsatt_admin_params.i18n_inherit_option_variable:wcsatt_admin_params.i18n_inherit_option,t="variable"===t?wcsatt_admin_params.i18n_discount_description_variable:wcsatt_admin_params.i18n_discount_description;c(this).find('.subscription_pricing_method_input [value="inherit"]').text(e),c(this).find('.subscription_pricing_method_input [value="override"]').text(n),c(this).find(".subscription_price_discount .woocommerce-help-tip").attr("data-tip",t).wcsatt_init_help_tips()},c.fn.wcsatt_refresh_days_in_month=function(){var t=c(this),n=t.find(".satt_subscription_payment_sync_date_day"),e=t.find(".subscription_sync_annual"),t=parseInt(t.find(".wc_input_subscription_payment_sync_date_month").val(),10);t?(t=t,t=new Date(Date.UTC(2001,t,0)).getUTCDate(),n.val()>t&&n.val(t),n.attr({step:"1",min:"1",max:t}),e.addClass("subscription_sync_annual--synced")):e.removeClass("subscription_sync_annual--synced")},c.fn.wcsatt_refresh_scheme_lengths=function(){var t=c(this),e=t.find(".wc_input_subscription_length"),n=t.find(".wc_input_subscription_period"),t=t.find(".wc_input_subscription_period_interval"),i=e.val(),s=parseInt(t.val(),10),a=!1;e.empty(),c.each(wcsatt_admin_params.subscription_lengths[n.val()],function(t,n){0!=parseInt(t,10)&&0!=parseInt(t,10)%s||e.append(c("<option></option>").attr("value",t).text(n))}),e.children("option").each(function(){if(this.value==i)return!(a=!0)}),a?e.val(i):e.val(0)},""===wcsatt_admin_params.post_id&&(e.on("click","h3",function(){var t=c(this).closest(".wc-metabox"),n=t.find(".wc-metabox-content");t.hasClass("closed")?n.show():n.hide(),t.toggleClass("closed")}),e.find(".wc-metabox").each(function(){var t=c(this),n=t.find(".wc-metabox-content");t.hasClass("closed")&&n.hide()})),c.fn.wcsatt_refresh_sync_options=function(){var t=c(this),n=t.find(".wc_input_subscription_period"),e=t.find(".subscription_sync"),i=e.find(".subscription_sync_annual"),s=e.find(".subscription_sync_week_month"),a=s.find("select"),t=i.find("select"),n=n.val();"day"===n?(e.hide(),a.val(0),t.val(0).trigger("change")):(e.show(),"year"===n?(s.hide(),a.val(0),i.show()):(i.hide(),t.val(0).trigger("change"),a.empty(),c.each(WCSubscriptions.syncOptions[n],function(t,n){t||(n=wcsatt_admin_params.i18n_do_no_sync),a.append(c("<option></option>").attr("value",t).text(n))}),s.show()))},(n=a.find("li")).on("click",function(){if(a.hasClass("disabled"))return!1;var t=c(this);t.find("input").prop("checked",!0),n.removeClass("selected"),t.addClass("selected")}),i.on("change",function(){m()}),"yes"===wcsatt_admin_params.is_onboarding&&setTimeout(function(){c(".satt_options a").trigger("click")},500),c("select#product-type").on("change",function(){0<r.length&&r.wcsatt_init_type_dependent_inputs(),u(),l(),h()}).trigger("change"),c("input#_virtual").on("change",function(){h()}).trigger("change"),e.on("woocommerce_subscription_schemes_changed",function(){r=_.find(".subscription_scheme"),f(),u(),l(),h()}).one("woocommerce_subscription_scheme_added",function(){e.removeClass("onboarding")}),_.on("change","select.subscription_pricing_method_input",function(){var t=c(this),n=t.closest(".subscription_scheme_product_data"),t=t.val();n.find(".subscription_pricing_method").hide(),n.find(".subscription_pricing_method_"+t).show()}).on("change",".wc_input_subscription_period",function(){var t=c(this).closest(".subscription_scheme");t.wcsatt_refresh_scheme_lengths(),t.wcsatt_refresh_sync_options()}).on("change",".wc_input_subscription_payment_sync_date_month",function(){c(this).closest(".subscription_scheme").wcsatt_refresh_days_in_month()}),e.on("click","span.scheme-remove",function(){var t=c(this).closest(".subscription_scheme");return t.find("*").off(),t.remove(),e.trigger("woocommerce_subscription_schemes_changed"),!1}).on("click",".remove_all",function(){return e.hasClass("no_plans")||(r.each(function(t,n){n=c(n);n.find("*").off(),n.remove()}),e.trigger("woocommerce_subscription_schemes_changed")),!1}).on("click","button.add_subscription_scheme",function(){e.block(d),p++;var t={action:"wcsatt_add_subscription_scheme",post_id:wcsatt_admin_params.post_id,index:p,security:wcsatt_admin_params.add_subscription_scheme_nonce};return c.post(wcsatt_admin_params.wc_ajax_url,t,function(t){_.append(t.markup);var n=_.find(".subscription_scheme").last();n.wcsatt_init_type_dependent_inputs(),n.wcsatt_init_help_tips(),n.find("select.subscription_pricing_method_input").trigger("change"),e.unblock(),e.trigger("woocommerce_subscription_scheme_added",t),e.trigger("woocommerce_subscription_schemes_changed")},"json"),!1}),i.on("change",function(){c(this).is(":checked")?e.find(".wcsatt_default_status").show():e.find(".wcsatt_default_status").hide(),u()}).trigger("change"),c("#_nyp").on("change",function(){c(this).is(":checked")?_.addClass("is_nyp"):_.removeClass("is_nyp")}).trigger("change"),function(){_.find("select.subscription_pricing_method_input").trigger("change"),_.find('select.wc_input_subscription_payment_sync_date_month[value!="0"]').trigger("change");var t=r.get();t.sort(function(t,n){t=parseInt(c(t).attr("rel"),10),n=parseInt(c(n).attr("rel"),10);return t<n?-1:n<t?1:0}),c(t).each(function(t,n){_.append(n)}),_.sortable({items:".subscription_scheme",cursor:"move",axis:"y",handle:"span.scheme-handle",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(t,n){n.item.css("background-color","#f6f6f6")},stop:function(t,n){n.item.removeAttr("style"),f()}})}()});