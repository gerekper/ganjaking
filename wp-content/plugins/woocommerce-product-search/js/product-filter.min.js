/*!
 * product-filter.js
 *
 * Copyright (c) "kento" Karim Rahimpur www.itthinx.com
 *
 * This code is provided subject to the license granted.
 * Unauthorized use and distribution is prohibited.
 * See COPYRIGHT.txt and LICENSE.txt
 *
 * This code is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 *
 * This header and all notices must be kept intact.
 *
 * @author itthinx
 * @package woocommerce-product-search
 * @since 2.0.0
 */
;var ixwpsf={blinkerTimeouts:[],blinkerTimeout:5000,productsBlinker:false,taxonomy:[],ts:0,autoToggleFilterWidgets:true,embed:true,expandTime:200,retractTime:320,xhr:null};var ix_dropdown_thumbnails=[],ix_dropdown_order=[];(function(a){ixwpsf.productFilter=function(d,j,b){var u=decodeURI(window.location.href),w=false,h=a(j.products).filter(function(){return a(this).closest('.related.products,[class^="wp-block-woocommerce"]').length<1}),n=h.css("width"),k=h.css("height"),t=ixwpsf.blinkerTimeout,y=true,g=true,A=typeof b.origin_id!=="undefined"?b.origin_id:null;if(typeof b.href!=="undefined"){if(u!==b.href){u=b.href;w=true}}if(typeof b.unpage_url==="undefined"||b.unpage_url!==false){var x=new RegExp("\\/page\\/[0-9]+","gi");var e=u.replace(x,"");e=ixwpsf.updateQueryArg("paged","",e);e=ixwpsf.updateQueryArg("product-page","",e);u=e}var q=null;if(typeof b.reset!=="undefined"&&b.reset&&typeof b.reset_url!=="undefined"){q=decodeURI(b.reset_url);if(typeof b.unpage_url==="undefined"||b.unpage_url!==false){var x=new RegExp("\\/page\\/[0-9]+","gi");q=q.replace(x,"");q=ixwpsf.updateQueryArg("paged","",q);q=ixwpsf.updateQueryArg("product-page","",q)}}if(typeof b.term!=="undefined"){var c=new RegExp("ixwpst\\["+b.taxonomy+"\\]\\[[0-9]+\\]","g");u=u.replace(c,"ixwpst["+b.taxonomy+"][]");if(!a.isArray(b.term)){switch(b.action){case"add":u=ixwpsf.addQueryArg("ixwpst["+b.taxonomy+"][]",b.term,u);break;case"remove":u=ixwpsf.removeQueryArg("ixwpst["+b.taxonomy+"][]",b.term,u);break;default:u=ixwpsf.updateQueryArg("ixwpst["+b.taxonomy+"][]",b.term,u)}}else{u=ixwpsf.updateQueryArg("ixwpst["+b.taxonomy+"][]","",u);for(var s=0;s<b.term.length;s++){u=ixwpsf.addQueryArg("ixwpst["+b.taxonomy+"][]",b.term[s],u)}}}var v="";if(typeof b.min_price!=="undefined"){u=ixwpsf.updateQueryArg("min_price",b.min_price,u);v+=b.min_price}else{var r=ixwpsf.getQueryArg(u,"min_price");if(r!==null&&r.length>0){v+=r}}if(typeof b.max_price!=="undefined"){u=ixwpsf.updateQueryArg("max_price",b.max_price,u);v+=b.max_price}else{var m=ixwpsf.getQueryArg(u,"max_price");if(m!==null&&m.length>0){v+=m}}var f=v.length>0?"1":"";u=ixwpsf.updateQueryArg("ixwpsp",f,u);if(f!==""){b.ixwpsp=f}if(typeof b.blinkerTimeout!=="undefined"){t=b.blinkerTimeout}if(typeof b.updateAddressBar!=="undefined"){y=b.updateAddressBar}if(typeof b.updateDocumentTitle!=="undefined"){g=b.updateDocumentTitle}d=a.trim(d);u=ixwpsf.updateQueryArg("ixwpss",encodeURIComponent(d),u);if(typeof b.title!=="undefined"){u=ixwpsf.updateQueryArg("title",b.title,u)}if(typeof b.excerpt!=="undefined"){u=ixwpsf.updateQueryArg("excerpt",b.excerpt,u)}if(typeof b.content!=="undefined"){u=ixwpsf.updateQueryArg("content",b.content,u)}if(typeof b.categories!=="undefined"){u=ixwpsf.updateQueryArg("categories",b.categories,u)}if(typeof b.attributes!=="undefined"){u=ixwpsf.updateQueryArg("attributes",b.attributes,u)}if(typeof b.tags!=="undefined"){u=ixwpsf.updateQueryArg("tags",b.tags,u)}if(typeof b.sku!=="undefined"){u=ixwpsf.updateQueryArg("sku",b.sku,u)}if(typeof b.order_by!=="undefined"){u=ixwpsf.updateQueryArg("order_by",b.order_by,u)}if(typeof b.order!=="undefined"){u=ixwpsf.updateQueryArg("order",b.order,u)}if(typeof b.wpml!=="undefined"){u=ixwpsf.updateQueryArg("wpml",b.wpml,u)}if(typeof b.terms!=="undefined"){u=ixwpsf.updateQueryArg("terms",b.terms,u)}if(ixwpsf.taxonomy.length>0){var o=null,l=null;if(A!==null){for(var s=0;s<ixwpsf.taxonomy.length;s++){if(typeof ixwpsf.taxonomy[s].origin_id!=="undefined"){if(ixwpsf.taxonomy[s].origin_id===A){o=ixwpsf.taxonomy[s].taxonomy;l=s;break}}}}for(var s=0;s<ixwpsf.taxonomy.length;s++){if(o!==null&&ixwpsf.taxonomy[s].taxonomy===o&&s!==l){continue}if(typeof ixwpsf.taxonomy[s].show!=="undefined"){u=ixwpsf.updateQueryArg("ixwpsf[taxonomy]["+ixwpsf.taxonomy[s].taxonomy+"][show]",ixwpsf.taxonomy[s].show,u)}if(typeof ixwpsf.taxonomy[s].multiple!=="undefined"){u=ixwpsf.updateQueryArg("ixwpsf[taxonomy]["+ixwpsf.taxonomy[s].taxonomy+"][multiple]",ixwpsf.taxonomy[s].multiple?1:0,u)}if(typeof ixwpsf.taxonomy[s].filter!=="undefined"){u=ixwpsf.updateQueryArg("ixwpsf[taxonomy]["+ixwpsf.taxonomy[s].taxonomy+"][filter]",ixwpsf.taxonomy[s].filter?1:0,u)}}}if(typeof b.ixwpse!=="undefined"){u=ixwpsf.updateQueryArg("ixwpse",b.ixwpse,u)}if(typeof b.on_sale!=="undefined"){u=ixwpsf.updateQueryArg("on_sale",b.on_sale,u)}if(typeof b.rating!=="undefined"){u=ixwpsf.updateQueryArg("rating",b.rating,u)}a(j.field).addClass("blinker");if(ixwpsf.productsBlinker){h.addClass("product-search-filter-blinker").html("").show()}h.css("minWidth",n);h.css("minHeight",k);a(j.pagination).hide();a(j.count).hide();if(t>0){ixwpsf.blinkerTimeouts[j.field]=setTimeout(function(){a(j.field).removeClass("blinker")},t);ixwpsf.blinkerTimeouts[j.products]=setTimeout(function(){h.removeClass("product-search-filter-blinker")},t)}var z=(typeof Date.now==="function")?Date.now():0;if(q!==null){u=q}var p=ixwpsf.updateQueryArg("ixmbd",ixwpsf.embed?"1":"",u);a("body").addClass("product-search-filter-loading");if(ixwpsf.xhr!==null){ixwpsf.xhr.abort()}ixwpsf.xhr=a.ajax({url:p,error:function(C,D,B){if(typeof D==="undefined"||D!=="abort"){a("body").removeClass("product-search-filter-loading");a(".loading-term-filter").removeClass("loading-term-filter");a(j.field).removeClass("blinker");a(j.pagination).show();a(j.count).show()}},success:function(D,C,K){a("body").removeClass("product-search-filter-loading");ixwpsf.xhr=null;if(z>=ixwpsf.ts){ixwpsf.ts=z}else{return}var F=a(D).find(j.breadcrumb);if(F.length>0){a(j.breadcrumb).replaceWith(F);a(j.breadcrumb).show()}else{a(j.breadcrumb).html("");a(j.breadcrumb).hide()}var E=a(D).find(j.header);if(E.length>0){a(j.header).replaceWith(E);a(j.header).show()}else{a(j.header).html("");a(j.header).hide()}a(j.field).removeClass("blinker");if(ixwpsf.productsBlinker){h.removeClass("product-search-filter-blinker")}else{h.html("").show()}if(t>0){clearTimeout(ixwpsf.blinkerTimeouts[j.field]);clearTimeout(ixwpsf.blinkerTimeouts[j.products])}var J=a(D).find(j.products).filter(function(){return a(this).closest('.related.products,[class^="wp-block-woocommerce"]').length<1});var L=false,B=false;if(J.length===0){L=true}if(a(J).find(j.product).length>0){if(h.length>0){h.show().replaceWith(J)}else{a(j.header).parent().replaceWith(a(D).find(j.header).parent());L=false}a(j.info).remove();a(j.ordering).show()}else{if(h.length>0){a(j.info).remove();h.html("").hide().after(a(D).find(j.info));a(j.ordering).hide();L=false}if(a(D).find(j.info).length===0){B=true}}if(L){console.log("Could not find the general Products Container, expected the selector "+j.products)}if(!L&&B){console.log("Could not find the individual Product Container, expected the selector "+j.product)}var M=a(D).find(j.pagination);a.each(a(j.pagination),function(N,O){if(M.eq(N).length>0){a(j.pagination).eq(N).replaceWith(M.eq(N))}else{a(j.pagination).eq(N).html("")}});var I=a(D).find(j.count);a.each(a(j.count),function(N,O){if(I.eq(N).length>0){a(j.count).eq(N).replaceWith(I.eq(N))}else{a(j.count).eq(N).html("")}});a(j.pagination).show();a(j.count).show();if(!w){if(y){window.history.pushState({query:d,href:u},"",u)}if(g){var H=a(D).filter("title").text();document.title=H}}ixwpsf.updateOrderingForm(d,j,b,u);if(q!==null){a(".product-filter-field").val("");a(".product-filter-field").parent().find(".product-search-filter-search-clear").hide()}if(typeof a().slider!=="undefined"){var G=a(D).find(".product-search-filter-price-slider");a.each(a(".product-search-filter-price-slider"),function(U,X){if(G.eq(U).length>0){var V=G.eq(U).data("min_price"),R=G.eq(U).data("max_price"),S=G.eq(U).data("precision"),O=isNaN(parseFloat(V))?V:parseFloat(V).toFixed(S),P=isNaN(parseFloat(R))?R:parseFloat(R).toFixed(S);a(X).slider("option","min",V);a(X).slider("option","max",R);a(X).find("span.slider-limit-min").text(O);a(X).find("span.slider-limit-max").text(P);a(X).data("min_price",V);a(X).data("max_price",R);var T=G.eq(U).find(".slider-min").text(),Y=G.eq(U).find(".slider-max").text();new_slider_min_display=isNaN(parseFloat(T))?T:parseFloat(T).toFixed(S),new_slider_max_display=isNaN(parseFloat(Y))?Y:parseFloat(Y).toFixed(S);a(X).parent().find(".slider-min").text(new_slider_min_display);a(X).parent().find(".slider-max").text(new_slider_max_display);if(q===null){var Z=V;if(T!==""){Z=wps_price_slider.easeOut(T,V,R)}var W=R;if(Y!==""){W=wps_price_slider.easeOut(Y,V,R)}a(X).slider("disable");a(X).slider("values",[Z,W]);a(X).slider("values",[Z,W]);a(X).slider("enable");a(X).parent().find("input.product-search-filter-min-price").val(new_slider_min_display);a(X).parent().find("input.product-search-filter-max-price").val(new_slider_max_display)}else{a(X).slider("disable");a(X).slider("values",[V,R]);a(X).slider("values",[V,R]);a(X).slider("enable");a(X).parent().find("input.product-search-filter-min-price").val("").trigger("clear");a(X).parent().find("input.product-search-filter-max-price").val("").trigger("clear");var N=a(X).parent().find(".slider-min"),Q=a(X).parent().find(".slider-max");N.text("");Q.text("");a(X).parent().parent().find(".product-search-filter-price-clear").hide()}}});if(typeof wps_price_slider!=="undefined"){wps_price_slider.updateForm(d,".product-search-filter-price-slider",b,u)}}if(q!==null){a.each(a(".product-search-filter-price"),function(N,O){var P=a(O).find(".product-search-filter-price-slider").length>0;if(!P){a(O).find("input.product-search-filter-min-price").val("").trigger("clear");a(O).find("input.product-search-filter-max-price").val("").trigger("clear");a(O).find(".product-search-filter-price-clear").hide()}})}a(D).find(".product-search-filter-items option").each(function(O,P){var Q=a(P).val(),N=a(P).data();ix_dropdown_thumbnails[Q]=N});a(".product-search-filter-terms").each(function(P,R){var S=a(D).find("#"+this.id);if(S.length>0){var Q=a(this).find("select.selectized");if(Q.length===0){a("#"+this.id).replaceWith(S)}else{var O=S.find("#"+Q.first()[0].id);if(O.length>0){O=O.first();var N=[];a(O).find("option").each(function(T,U){a(U).data("data",{$order:T});N[a(U).val()]=T});ix_dropdown_order[O.id]=N;a("#"+this.id).replaceWith(S);O.trigger("apply-selectize")}}a(S).find(".product-search-product_cat-filter-item a").on("click",ixwpsf.categoryFilterItemOnClick);a(S).find("select.product-search-filter-product_cat").on("change",ixwpsf.categoryFilterSelectOnChange);a(S).find("select.product-search-filter-attribute").on("change",ixwpsf.attributeFilterSelectOnChange);a(S).find(".product-search-product_tag-filter-item").on("click",ixwpsf.tagFilterItemOnClick);a(S).find(".product-search-attribute-filter-item a").on("click",ixwpsf.attributeFilterItemOnClick)}});a(".product-search-filter-extras").each(function(N,O){var P=a(D).find("#"+this.id);if(P.length>0){a("#"+this.id).replaceWith(P)}});ixwpsf.toggleWidgets();a(".product-search-filter-reset .product-search-filter-reset-clear").removeClass("loading-reset-filter");a(".product-search-filter-reset").trigger("ixProductFilterRequestDone");a(document).triggerHandler("ixProductFilterRequestProcessed")}})};ixwpsf.updateOrderingForm=function(f,o,e,u){var j=a(o.ordering).closest("form");if(j.length>0){if(f.length>0){var g=a(j).find('input[name="ixwpss"]');if(g.length>0){g.val(f)}else{a(j).append('<input type="hidden" name="ixwpss" value="'+f+'"/>')}}if(typeof e.title!=="undefined"){var x=a(j).find('input[name="title"]');if(x.length>0){x.val(e.title)}else{a(j).append('<input type="hidden" name="title" value="'+e.title+'"/>')}}else{a(j).find('input[name="title"]').remove()}if(typeof e.excerpt!=="undefined"){var c=a(j).find('input[name="excerpt"]');if(c.length>0){c.val(e.excerpt)}else{a(j).append('<input type="hidden" name="excerpt" value="'+e.excerpt+'"/>')}}else{a(j).find('input[name="excerpt"]').remove()}if(typeof e.content!=="undefined"){var s=a(j).find('input[name="content"]');if(s.length>0){s.val(e.content)}else{a(j).append('<input type="hidden" name="content" value="'+e.content+'"/>')}}else{a(j).find('input[name="content"]').remove()}if(typeof e.categories!=="undefined"){var q=a(j).find('input[name="categories"]');if(q.length>0){q.val(e.categories)}else{a(j).append('<input type="hidden" name="categories" value="'+e.categories+'"/>')}}else{a(j).find('input[name="categories"]').remove()}if(typeof e.attributes!=="undefined"){var k=a(j).find('input[name="attributes"]');if(k.length>0){k.val(e.attributes)}else{a(j).append('<input type="hidden" name="attributes" value="'+e.attributes+'"/>')}}else{a(j).find('input[name="attributes"]').remove()}if(typeof e.tags!=="undefined"){var m=a(j).find('input[name="tags"]');if(m.length>0){m.val(e.tags)}else{a(j).append('<input type="hidden" name="tags" value="'+e.tags+'"/>')}}else{a(j).find('input[name="tags"]').remove()}if(typeof e.sku!=="undefined"){var n=a(j).find('input[name="sku"]');if(n.length>0){n.val(e.sku)}else{a(j).append('<input type="hidden" name="sku" value="'+e.sku+'"/>')}}else{a(j).find('input[name="sku"]').remove()}if(typeof e.wpml!=="undefined"){var l=a(j).find('input[name="wpml"]');if(l.length>0){l.val(e.wpml)}else{a(j).append('<input type="hidden" name="wpml" value="'+e.wpml+'"/>')}}else{a(j).find('input[name="wpml"]').remove()}a(j).find('input[name="min_price"]').remove();a(j).find('input[name="max_price"]').remove();a(j).find('input[name^="ixwpst"]').remove();a(j).find('input[name^="ixwpsf"]').remove();a(j).find('input[name="ixwpse"]').remove();a(j).find('input[name="on_sale"]').remove();a(j).find('input[name="rating"]').remove();var v=u.substring(u.indexOf("?")+1);var d=v.indexOf("#");if(d>=0){v=v.substring(0,d)}v=v.split("&");if(v.length>0){for(var t=0;t<v.length;t++){var p=v[t].split("="),w="",r="";w=unescape(p[0]);if(p.length>1){r=unescape(p[1])}if(w!==""&&w!=="orderby"&&w!=="ixwpss"&&w!=="title"&&w!=="excerpt"&&w!=="content"&&w!=="categories"&&w!=="attributes"&&w!=="tags"&&w!=="sku"&&w!=="wpml"&&(w==="min_price"||w==="max_price"||w.indexOf("ixwpst")===0||w.indexOf("ixwpsf")===0||w==="ixwpse"||w==="on_sale"||w==="rating")){var b=a(j).find('input[name="'+w+'"]');if(b.length>0&&!w.endsWith("[]")){b.val(r)}else{a(j).append(a('<input type="hidden" name="'+w+'" />').attr({value:r}))}}}}if(typeof e.ixwpsp!=="undefined"){var h=a(j).find('input[name="ixwpsp"]');if(h.length>0){h.val(e.ixwpsp)}else{a(j).append('<input type="hidden" name="ixwpsp" value="'+e.ixwpsp+'"/>')}}else{a(j).find('input[name="ixwpsp"]').remove()}}};ixwpsf.updateQueryArg=function(j,h,b){b=ixwpsf.decodeURI(b);var c=j.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),g=new RegExp("([?&])"+c+"=.*?(&|#|$)","g"),k=null;if(typeof b==="undefined"){b=window.location.href}if(h===""){g=new RegExp("([?&])"+c+"=([^&#$]*)","g");k=b.replace(g,"$1");k=k.replace("?&","?").replace(/&&+/g,"&").replace(/&$/,"")}else{var e;if(e=b.match(g)){rmregex=new RegExp("([?&])"+c+"=([^&#$]*)","g");k=b.replace(rmregex,"$1");k=k.replace("?&","?").replace(/&&+/g,"&").replace(/&$/,"");k=ixwpsf.addQueryArg(j,h,k)}else{var d="",f=b.indexOf("?")!==-1?"&":"?";if(b.indexOf("#")!==-1){d=b.replace(/.*#/,"#");b=b.replace(/#.*/,"")}k=b+f+j+"="+h+d}}return k};ixwpsf.getQueryArgs=function(b){b=ixwpsf.decodeURI(b);var d=/[^=&?]+\s*=\s*[^&#]*/g;var f=b.match(d);var e=[];if(f!==null){for(var c=0;c<f.length;c++){var g=f[c].split("=");e.push(g)}}return e};ixwpsf.getQueryArg=function(c,e){c=ixwpsf.decodeURI(c);var f=new RegExp("[&?]"+e+"s*=s*[^&#]*","g");var g=c.match(f);var b=null;if(g!==null){for(var d=0;d<g.length;d++){var h=g[d].split("=");b=h[1];break}}return b};ixwpsf.addQueryArg=function(d,f,b){b=ixwpsf.decodeURI(b);var j=true;if(typeof b==="undefined"){b=window.location.href}var e=ixwpsf.getQueryArgs(b);for(var c=0;c<e.length;c++){if(e[c][0]==d&&e[c][1]==f){j=false;break}}if(j){var h="",g=b.indexOf("?")!==-1?"&":"?";if(b.indexOf("#")!==-1){h=b.replace(/.*#/,"#");b=b.replace(/#.*/,"")}b=b+g+d+"="+f+h}return b};ixwpsf.removeQueryArg=function(e,g,d){d=ixwpsf.decodeURI(d);var c=e.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),f=new RegExp("([?&])"+c+"="+g+"(&|#|$)","i"),b=d.replace(f,"$1$2").replace("?&","?").replace(/&&+/g,"&").replace(/&$/,"");return b};ixwpsf.categoryFilterItemOnClick=function(h){var d=a(this).closest(".product-search-filter-terms"),f=a(d).attr("id"),c=a(d).data("multiple"),b=a(this).parent().data("term")==="";if(c&&!b){var g="add"}else{var g="replace"}if(typeof h.preventDefault==="function"){h.preventDefault()}if(typeof h.stopImmediatePropagation==="function"){h.stopImmediatePropagation()}if(typeof h.stopPropagation==="function"){h.stopPropagation()}if(a(this).parent().hasClass("current-cat")){a(this).addClass("loading-term-filter");if(c){a(this).parent().removeClass("current-cat");a(".product-filter-field").first().trigger("ixTermFilter",[a(this).parent().data("term"),"product_cat","remove",f])}else{a(".product-search-product_cat-filter-item").removeClass("current-cat");a(".product-filter-field").first().trigger("ixTermFilter",["","product_cat",null,f])}}else{if(!c){a(".product-search-product_cat-filter-item").removeClass("current-cat")}a(this).parent().addClass("current-cat");a(this).addClass("loading-term-filter");a(".product-filter-field").first().trigger("ixTermFilter",[a(this).parent().data("term"),"product_cat",g,f])}return false};ixwpsf.categoryFilterSelectOnChange=function(j){var d=a(this).closest(".product-search-filter-terms"),g=a(d).attr("id"),c=a(d).data("multiple"),b=false;var f=a(this).val();if(f===null||f===""||(typeof f==="object")&&f.length===0){f="";b=true}if(c&&!b){var h="add"}else{var h="replace"}if(typeof j.preventDefault==="function"){j.preventDefault()}if(typeof j.stopImmediatePropagation==="function"){j.stopImmediatePropagation()}if(typeof j.stopPropagation==="function"){j.stopPropagation()}a(".product-filter-field").first().trigger("ixTermFilter",[f,"product_cat",h,g]);return false};ixwpsf.attributeFilterSelectOnChange=function(k){var f=a(this).closest(".product-search-filter-terms"),h=a(f).attr("id"),c=a(f).data("multiple"),b=false,d=a(this).data("taxonomy");var g=a(this).val();if(g===null||g===""||(typeof g==="object")&&g.length===0){g="";b=true}if(c&&!b){var j="add"}else{var j="replace"}if(typeof k.preventDefault==="function"){k.preventDefault()}if(typeof k.stopImmediatePropagation==="function"){k.stopImmediatePropagation()}if(typeof k.stopPropagation==="function"){k.stopPropagation()}a(".product-filter-field").first().trigger("ixTermFilter",[g,d,j,h]);return false};ixwpsf.tagFilterItemOnClick=function(h){var d=a(this).closest(".product-search-filter-terms"),f=a(d).attr("id"),c=a(d).data("multiple"),b=a(this).data("term")==="";if(c&&!b){var g="add"}else{var g="replace"}if(typeof h.preventDefault==="function"){h.preventDefault()}if(typeof h.stopImmediatePropagation==="function"){h.stopImmediatePropagation()}if(typeof h.stopPropagation==="function"){h.stopPropagation()}if(a(this).hasClass("current-tag")){a(this).addClass("loading-term-filter");if(c){a(this).removeClass("current-tag");a(".product-filter-field").first().trigger("ixTermFilter",[a(this).data("term"),"product_tag","remove",f])}else{a(".product-search-product_tag-filter-item").removeClass("current-tag");a(".product-filter-field").first().trigger("ixTermFilter",["","product_tag",null,f])}}else{if(!c){a(".product-search-product_tag-filter-item").removeClass("current-tag")}a(this).addClass("current-tag");a(this).addClass("loading-term-filter");a(".product-filter-field").first().trigger("ixTermFilter",[a(this).data("term"),"product_tag",g,f])}return false};ixwpsf.attributeFilterItemOnClick=function(h){var d=a(this).closest(".product-search-filter-terms"),f=a(d).attr("id"),c=a(d).data("multiple"),b=a(this).parent().data("term")==="";if(c&&!b){var g="add"}else{var g="replace"}if(typeof h.preventDefault==="function"){h.preventDefault()}if(typeof h.stopImmediatePropagation==="function"){h.stopImmediatePropagation()}if(typeof h.stopPropagation==="function"){h.stopPropagation()}if(a(this).parent().hasClass("current-attribute")){a(".product-search-"+a(this).parent().data("taxonomy")+"-filter-item").removeClass("current-attribute");a(this).addClass("loading-term-filter");if(c){a(".product-filter-field").first().trigger("ixTermFilter",[a(this).parent().data("term"),a(this).parent().data("taxonomy"),"remove",f])}else{a(".product-filter-field").first().trigger("ixTermFilter",["",a(this).parent().data("taxonomy"),null,f])}}else{a(this).parent().addClass("current-attribute");a(this).addClass("loading-term-filter");if(a(this).parent().data("term")==="undefined"||a(this).parent().data("term")===""){a(".product-filter-field").first().trigger("ixTermFilter",["",a(this).parent().data("taxonomy"),null,f])}else{a(".product-filter-field").first().trigger("ixTermFilter",[a(this).parent().data("term"),a(this).parent().data("taxonomy"),g,f])}}return false};ixwpsf.decodeURI=function(b){try{b=decodeURI(b)}catch(c){b=b.replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/%20/g," ")}return b};ixwpsf.toggleWidgets=function(){if(ixwpsf.autoToggleFilterWidgets){a(".product-search-filter-items").each(function(){if(!a(this).is("select")){if(!a(this).is(".selectize-control,.selectize-dropdown")){var b=a(this).children().length>0;if(b||a(this).hasClass("product-search-filter-toggle-widget")){a(this).closest(".widget").toggle(b)}if(b||a(this).hasClass("product-search-filter-toggle")){a(this).toggle(b)}}}else{if(!a(this).is("select.selectized")){var c=a(this).children(),b=true;if(c.length===0){b=false}else{if(c.length===1){var e=c.first().val();if(typeof e==="undefined"||e===""){b=false}}}}else{var b=true;if(typeof this.selectize!=="undefined"&&typeof this.selectize.options!=="undefined"){var d=Object.keys(this.selectize.options).length;if(d===0){b=false}else{if(d===1){for(i in this.selectize.options){if(typeof this.selectize.options[i].value==="undefined"||this.selectize.options[i].value===""){b=false;break}}}}}}if(b||a(this).hasClass("product-search-filter-toggle-widget")){a(this).closest(".widget").toggle(b)}if(b||a(this).hasClass("product-search-filter-toggle")){a(this).closest(".product-search-filter-terms").find(".selectize-control").toggle(b);a(this).filter("select:not(.apply-selectize)").toggle(b)}}})}};a(document).ready(function(){a(document).on("mouseenter",".expandable.auto-expand",function(d){if(typeof d.preventDefault==="function"){d.preventDefault()}if(typeof d.stopImmediatePropagation==="function"){d.stopImmediatePropagation()}if(typeof d.stopPropagation==="function"){d.stopPropagation()}var e=a(this).find(".term-expander").first();var b=false;if(typeof e.data("locked")!=="undefined"){b=e.data("locked")}if(b){return}a(this).addClass("expanded");var c=a(this).find("> ul");c.stop(true,true).show(ixwpsf.expandTime);if(a(this).hasClass("auto-retract")){a(this).closest(".product-search-filter-items").on("mouseleave.ixwpsf",function(f){c.parent().removeClass("expanded");c.stop(true,true).hide(ixwpsf.retractTime);a(this).off("mouseleave.ixwpsf")})}});a(document).on("click touchstart",".term-expander",function(g){if(typeof g.preventDefault==="function"){g.preventDefault()}if(typeof g.stopImmediatePropagation==="function"){g.stopImmediatePropagation()}if(typeof g.stopPropagation==="function"){g.stopPropagation()}var h=a(this).closest(".term-expander");var e=false;var c=false;if(typeof h.data("locked")!=="undefined"){c=h.data("locked")}switch(c){case true:e=true;break;default:h.data("locked",true);var b=setTimeout(function(){h.data("locked",false);h.data("lockedTimeout",null)},500);h.data("lockedTimeout",b)}if(e){return}var f=a(this).closest(".expandable");var d=f.find("> ul");if(!f.hasClass("expanded")){f.addClass("expanded");d.show(ixwpsf.expandTime)}else{f.removeClass("expanded");d.hide(ixwpsf.retractTime)}});a(".product-search-form input.product-filter-field").prop("disabled",false);a(".product-search-filter-price-form input.product-search-filter-price-field").prop("disabled",false);a(".product-search-filter-price.hide-fields .min-max-fields").hide();a("select.product-search-filter-product_cat").prop("disabled",false);a("select.product-search-filter-attribute").prop("disabled",false);a(".product-search-product_cat-filter-item a").on("click",ixwpsf.categoryFilterItemOnClick);a("select.product-search-filter-product_cat").on("change",ixwpsf.categoryFilterSelectOnChange);a("select.product-search-filter-attribute").on("change",ixwpsf.attributeFilterSelectOnChange);a(".product-search-product_tag-filter-item").on("click",ixwpsf.tagFilterItemOnClick);a(".product-search-attribute-filter-item a").on("click",ixwpsf.attributeFilterItemOnClick);a(document).on("change input textInput",".product-search-filter-search input.product-filter-field",function(){var b=a(this).val().trim();if(b.length>0){a(this).parent().find(".product-search-filter-search-clear").show()}else{a(this).parent().find(".product-search-filter-search-clear").hide()}});a(document).on("click",".product-search-filter-search .product-search-filter-search-clear",function(){a(this).parent().find("input.product-filter-field").val("").trigger("input")});a(document).on("change input textInput",".product-search-filter-price input.product-search-filter-min-price, .product-search-filter-price input.product-search-filter-max-price",function(){var c=a(this).parent().find("input.product-search-filter-min-price").val().trim(),b=a(this).parent().find("input.product-search-filter-max-price").val().trim();if(c.length>0||b.length>0){a(this).parent().parent().find(".product-search-filter-price-clear").show()}else{a(this).parent().parent().find(".product-search-filter-price-clear").hide()}});a(document).on("click",".product-search-filter-price .product-search-filter-price-clear",function(){var h=a(this).parent().find("input.product-search-filter-min-price"),e=a(this).parent().find("input.product-search-filter-max-price"),d=false,b=false;if(h.length>0){if(h.val()!==""){h.val("");d=true}}if(e.length>0){if(e.val()!==""){e.val("");b=true}}if(d){h.trigger("input")}else{if(b){e.trigger("input")}}if(typeof a().slider!=="undefined"){var g=a(this).parent().find(".product-search-filter-price-slider");if(g.length>0){var d=g.slider("option","min"),b=g.slider("option","max");g.slider("option","values",[d,b]);var f=g.parent().find(".slider-min"),c=g.parent().find(".slider-max");f.text(d);c.text(b)}}});a(document).on("click",".product-search-filter-extra:not(.filter-dead)",function(h){if(typeof h.preventDefault==="function"){h.preventDefault()}if(typeof h.stopImmediatePropagation==="function"){h.stopImmediatePropagation()}if(typeof h.stopPropagation==="function"){h.stopPropagation()}a(this).parent().find("a.product-search-filter-extra").addClass("loading-extra-filter");var d=null;if(a(this).is("a")){var b=a(this).parent().find('input[type="checkbox"]').first();b.prop("checked",!b.prop("checked"));if(a(this).is("a.rating-filter-option")){d=a(this).data("rating")}else{if(!a(this).is("a.rating-filter-clear")){var g=a(".product-search-filter-rating a.rating-selected");if(g.length>0){d=g.first().data("rating")}}}}var c={ixwpse:1};var f=a(this).parent().find('input[type="checkbox"]');f.each(function(){c[a(this).attr("name")]=this.checked?1:0});if(d!==null){c.rating=d}else{c.rating=""}a(".product-search-form input.product-filter-field").first().trigger("ixExtraFilter",c)});a(document).on("click",".product-search-filter-reset .product-search-filter-reset-clear",function(b){if(typeof b.preventDefault==="function"){b.preventDefault()}if(typeof b.stopImmediatePropagation==="function"){b.stopImmediatePropagation()}if(typeof b.stopPropagation==="function"){b.stopPropagation()}a(this).addClass("loading-reset-filter");a(".product-search-form input.product-filter-field").first().trigger("ixFilterReset")});a(".product-search-filter-reset").on("ixProductFilterRequestDone",function(c){var b=false;a(".product-filter-field").each(function(d){if(a(this).val().length>0){b=true;return false}});if(!b){b=a('.product-search-filter-terms .current-cat, .product-search-filter-terms .current-tag, .product-search-filter-terms .current-attribute, .product-search-filter-terms select.selectized option[selected]:not([value=""])').length>0}if(!b){a(".product-search-filter-min-price, .product-search-filter-max-price").each(function(d){if(a(this).val().length>0){b=true;return false}})}if(!b){a("input.product-search-filter-on-sale").each(function(d){if(this.checked){b=true;return false}})}if(!b){b=a(".product-search-filter-rating .rating-filter-option.rating-selected").length>0}if(b){a(this).show()}else{a(this).hide()}});a(".product-search-filter-reset").trigger("ixProductFilterRequestDone");a(".product-search-filter-items option").each(function(c,d){var e=a(d).val(),b=a(d).data();ix_dropdown_thumbnails[e]=b});a("select.apply-selectize").each(function(c,d){var b=[];a(d).find("option").each(function(e,f){a(f).data("data",{$order:e});b[a(f).val()]=e});ix_dropdown_order[d.id]=b});if(typeof a().selectize!=="undefined"){a("select.apply-selectize").trigger("apply-selectize")}ixwpsf.toggleWidgets()})})(jQuery);