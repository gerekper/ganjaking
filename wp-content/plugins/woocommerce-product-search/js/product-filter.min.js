/*!
 * product-filter.js
 *
 * Copyright (c) "kento" Karim Rahimpur www.itthinx.com
 *
 * This code is provided subject to the license granted.
 * Unauthorized use and distribution is prohibited.
 * See COPYRIGHT.txt and LICENSE.txt
 *
 * This code is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 *
 * This header and all notices must be kept intact.
 *
 * @author itthinx
 * @package woocommerce-product-search
 * @since 2.0.0
 */
;var ixwpsf={blinkerTimeouts:[],blinkerTimeout:5000,productsBlinker:false,taxonomy:[],ts:0,autoToggleFilterWidgets:true,embed:true,expandTime:200,retractTime:320,xhr:null};var ix_dropdown_thumbnails=[],ix_dropdown_order=[];(function(a){ixwpsf.productFilter=function(d,h,b){var t=decodeURI(window.location.href),v=false,g=a(h.products).filter(function(){return a(this).closest('.related.products,[class^="wp-block-woocommerce"]').length<1}),m=g.css("width"),j=g.css("height"),s=ixwpsf.blinkerTimeout,w=true,f=true,y=typeof b.origin_id!=="undefined"?b.origin_id:null;if(typeof b.href!=="undefined"){if(t!==b.href){t=b.href;v=true}}var p=null;if(typeof b.reset!=="undefined"&&b.reset&&typeof b.reset_url!=="undefined"){p=decodeURI(b.reset_url)}if(typeof b.term!=="undefined"){var c=new RegExp("ixwpst\\["+b.taxonomy+"\\]\\[[0-9]+\\]","g");t=t.replace(c,"ixwpst["+b.taxonomy+"][]");if(!a.isArray(b.term)){switch(b.action){case"add":t=ixwpsf.addQueryArg("ixwpst["+b.taxonomy+"][]",b.term,t);break;case"remove":t=ixwpsf.removeQueryArg("ixwpst["+b.taxonomy+"][]",b.term,t);break;default:t=ixwpsf.updateQueryArg("ixwpst["+b.taxonomy+"][]",b.term,t)}}else{t=ixwpsf.updateQueryArg("ixwpst["+b.taxonomy+"][]","",t);for(var r=0;r<b.term.length;r++){t=ixwpsf.addQueryArg("ixwpst["+b.taxonomy+"][]",b.term[r],t)}}}var u="";if(typeof b.min_price!=="undefined"){t=ixwpsf.updateQueryArg("min_price",b.min_price,t);u+=b.min_price}else{var q=ixwpsf.getQueryArg(t,"min_price");if(q!==null&&q.length>0){u+=q}}if(typeof b.max_price!=="undefined"){t=ixwpsf.updateQueryArg("max_price",b.max_price,t);u+=b.max_price}else{var l=ixwpsf.getQueryArg(t,"max_price");if(l!==null&&l.length>0){u+=l}}var e=u.length>0?"1":"";t=ixwpsf.updateQueryArg("ixwpsp",e,t);if(e!==""){b.ixwpsp=e}if(typeof b.blinkerTimeout!=="undefined"){s=b.blinkerTimeout}if(typeof b.updateAddressBar!=="undefined"){w=b.updateAddressBar}if(typeof b.updateDocumentTitle!=="undefined"){f=b.updateDocumentTitle}d=a.trim(d);t=ixwpsf.updateQueryArg("ixwpss",encodeURIComponent(d),t);if(typeof b.title!=="undefined"){t=ixwpsf.updateQueryArg("title",b.title,t)}if(typeof b.excerpt!=="undefined"){t=ixwpsf.updateQueryArg("excerpt",b.excerpt,t)}if(typeof b.content!=="undefined"){t=ixwpsf.updateQueryArg("content",b.content,t)}if(typeof b.categories!=="undefined"){t=ixwpsf.updateQueryArg("categories",b.categories,t)}if(typeof b.attributes!=="undefined"){t=ixwpsf.updateQueryArg("attributes",b.attributes,t)}if(typeof b.tags!=="undefined"){t=ixwpsf.updateQueryArg("tags",b.tags,t)}if(typeof b.sku!=="undefined"){t=ixwpsf.updateQueryArg("sku",b.sku,t)}if(typeof b.order_by!=="undefined"){t=ixwpsf.updateQueryArg("order_by",b.order_by,t)}if(typeof b.order!=="undefined"){t=ixwpsf.updateQueryArg("order",b.order,t)}if(typeof b.wpml!=="undefined"){t=ixwpsf.updateQueryArg("wpml",b.wpml,t)}if(typeof b.terms!=="undefined"){t=ixwpsf.updateQueryArg("terms",b.terms,t)}if(ixwpsf.taxonomy.length>0){var n=null,k=null;if(y!==null){for(var r=0;r<ixwpsf.taxonomy.length;r++){if(typeof ixwpsf.taxonomy[r].origin_id!=="undefined"){if(ixwpsf.taxonomy[r].origin_id===y){n=ixwpsf.taxonomy[r].taxonomy;k=r;break}}}}for(var r=0;r<ixwpsf.taxonomy.length;r++){if(n!==null&&ixwpsf.taxonomy[r].taxonomy===n&&r!==k){continue}if(typeof ixwpsf.taxonomy[r].show!=="undefined"){t=ixwpsf.updateQueryArg("ixwpsf[taxonomy]["+ixwpsf.taxonomy[r].taxonomy+"][show]",ixwpsf.taxonomy[r].show,t)}if(typeof ixwpsf.taxonomy[r].multiple!=="undefined"){t=ixwpsf.updateQueryArg("ixwpsf[taxonomy]["+ixwpsf.taxonomy[r].taxonomy+"][multiple]",ixwpsf.taxonomy[r].multiple?1:0,t)}if(typeof ixwpsf.taxonomy[r].filter!=="undefined"){t=ixwpsf.updateQueryArg("ixwpsf[taxonomy]["+ixwpsf.taxonomy[r].taxonomy+"][filter]",ixwpsf.taxonomy[r].filter?1:0,t)}}}if(typeof b.ixwpse!=="undefined"){t=ixwpsf.updateQueryArg("ixwpse",b.ixwpse,t)}if(typeof b.on_sale!=="undefined"){t=ixwpsf.updateQueryArg("on_sale",b.on_sale,t)}if(typeof b.rating!=="undefined"){t=ixwpsf.updateQueryArg("rating",b.rating,t)}a(h.field).addClass("blinker");if(ixwpsf.productsBlinker){g.addClass("product-search-filter-blinker").html("").show()}g.css("minWidth",m);g.css("minHeight",j);a(h.pagination).hide();a(h.count).hide();if(s>0){ixwpsf.blinkerTimeouts[h.field]=setTimeout(function(){a(h.field).removeClass("blinker")},s);ixwpsf.blinkerTimeouts[h.products]=setTimeout(function(){g.removeClass("product-search-filter-blinker")},s)}var x=(typeof Date.now==="function")?Date.now():0;if(p!==null){t=p}var o=ixwpsf.updateQueryArg("ixmbd",ixwpsf.embed?"1":"",t);a("body").addClass("product-search-filter-loading");if(ixwpsf.xhr!==null){ixwpsf.xhr.abort()}ixwpsf.xhr=a.ajax({url:o,error:function(A,B,z){if(typeof B==="undefined"||B!=="abort"){a("body").removeClass("product-search-filter-loading");a(".loading-term-filter").removeClass("loading-term-filter");a(h.field).removeClass("blinker");a(h.pagination).show();a(h.count).show()}},success:function(B,A,I){a("body").removeClass("product-search-filter-loading");ixwpsf.xhr=null;if(x>=ixwpsf.ts){ixwpsf.ts=x}else{return}var D=a(B).find(h.breadcrumb);if(D.length>0){a(h.breadcrumb).replaceWith(D);a(h.breadcrumb).show()}else{a(h.breadcrumb).html("");a(h.breadcrumb).hide()}var C=a(B).find(h.header);if(C.length>0){a(h.header).replaceWith(C);a(h.header).show()}else{a(h.header).html("");a(h.header).hide()}a(h.field).removeClass("blinker");if(ixwpsf.productsBlinker){g.removeClass("product-search-filter-blinker")}else{g.html("").show()}if(s>0){clearTimeout(ixwpsf.blinkerTimeouts[h.field]);clearTimeout(ixwpsf.blinkerTimeouts[h.products])}var H=a(B).find(h.products).filter(function(){return a(this).closest('.related.products,[class^="wp-block-woocommerce"]').length<1});var J=false,z=false;if(H.length===0){J=true}if(a(H).find(h.product).length>0){if(g.length>0){g.show().replaceWith(H)}else{a(h.header).parent().replaceWith(a(B).find(h.header).parent());J=false}a(h.info).remove();a(h.ordering).show()}else{if(g.length>0){a(h.info).remove();g.html("").hide().after(a(B).find(h.info));a(h.ordering).hide();J=false}if(a(B).find(h.info).length===0){z=true}}if(J){console.log("Could not find the general Products Container, expected the selector "+h.products)}if(!J&&z){console.log("Could not find the individual Product Container, expected the selector "+h.product)}var K=a(B).find(h.pagination);a.each(a(h.pagination),function(L,M){if(K.eq(L).length>0){a(h.pagination).eq(L).replaceWith(K.eq(L))}else{a(h.pagination).eq(L).html("")}});var G=a(B).find(h.count);a.each(a(h.count),function(L,M){if(G.eq(L).length>0){a(h.count).eq(L).replaceWith(G.eq(L))}else{a(h.count).eq(L).html("")}});a(h.pagination).show();a(h.count).show();if(!v){if(w){window.history.pushState({query:d,href:t},"",t)}if(f){var F=a(B).filter("title").text();document.title=F}}ixwpsf.updateOrderingForm(d,h,b,t);if(p!==null){a(".product-filter-field").val("");a(".product-filter-field").parent().find(".product-search-filter-search-clear").hide()}if(typeof a().slider!=="undefined"){var E=a(B).find(".product-search-filter-price-slider");a.each(a(".product-search-filter-price-slider"),function(S,V){if(E.eq(S).length>0){var T=E.eq(S).data("min_price"),P=E.eq(S).data("max_price"),Q=E.eq(S).data("precision"),M=isNaN(parseFloat(T))?T:parseFloat(T).toFixed(Q),N=isNaN(parseFloat(P))?P:parseFloat(P).toFixed(Q);a(V).slider("option","min",T);a(V).slider("option","max",P);a(V).find("span.slider-limit-min").text(M);a(V).find("span.slider-limit-max").text(N);a(V).data("min_price",T);a(V).data("max_price",P);var R=E.eq(S).find(".slider-min").text(),W=E.eq(S).find(".slider-max").text();new_slider_min_display=isNaN(parseFloat(R))?R:parseFloat(R).toFixed(Q),new_slider_max_display=isNaN(parseFloat(W))?W:parseFloat(W).toFixed(Q);a(V).parent().find(".slider-min").text(new_slider_min_display);a(V).parent().find(".slider-max").text(new_slider_max_display);if(p===null){var X=T;if(R!==""){X=wps_price_slider.easeOut(R,T,P)}var U=P;if(W!==""){U=wps_price_slider.easeOut(W,T,P)}a(V).slider("disable");a(V).slider("values",[X,U]);a(V).slider("values",[X,U]);a(V).slider("enable");a(V).parent().find("input.product-search-filter-min-price").val(new_slider_min_display);a(V).parent().find("input.product-search-filter-max-price").val(new_slider_max_display)}else{a(V).slider("disable");a(V).slider("values",[T,P]);a(V).slider("values",[T,P]);a(V).slider("enable");a(V).parent().find("input.product-search-filter-min-price").val("").trigger("clear");a(V).parent().find("input.product-search-filter-max-price").val("").trigger("clear");var L=a(V).parent().find(".slider-min"),O=a(V).parent().find(".slider-max");L.text("");O.text("");a(V).parent().parent().find(".product-search-filter-price-clear").hide()}}});if(typeof wps_price_slider!=="undefined"){wps_price_slider.updateForm(d,".product-search-filter-price-slider",b,t)}}if(p!==null){a.each(a(".product-search-filter-price"),function(L,M){var N=a(M).find(".product-search-filter-price-slider").length>0;if(!N){a(M).find("input.product-search-filter-min-price").val("").trigger("clear");a(M).find("input.product-search-filter-max-price").val("").trigger("clear");a(M).find(".product-search-filter-price-clear").hide()}})}a(B).find(".product-search-filter-items option").each(function(M,N){var O=a(N).val(),L=a(N).data();ix_dropdown_thumbnails[O]=L});a(".product-search-filter-terms").each(function(N,P){var Q=a(B).find("#"+this.id);if(Q.length>0){var O=a(this).find("select.selectized");if(O.length===0){a("#"+this.id).replaceWith(Q)}else{var M=Q.find("#"+O.first()[0].id);if(M.length>0){M=M.first();var L=[];a(M).find("option").each(function(R,S){a(S).data("data",{$order:R});L[a(S).val()]=R});ix_dropdown_order[M.id]=L;a("#"+this.id).replaceWith(Q);M.trigger("apply-selectize")}}a(Q).find(".product-search-product_cat-filter-item a").on("click",ixwpsf.categoryFilterItemOnClick);a(Q).find("select.product-search-filter-product_cat").on("change",ixwpsf.categoryFilterSelectOnChange);a(Q).find("select.product-search-filter-attribute").on("change",ixwpsf.attributeFilterSelectOnChange);a(Q).find(".product-search-product_tag-filter-item").on("click",ixwpsf.tagFilterItemOnClick);a(Q).find(".product-search-attribute-filter-item a").on("click",ixwpsf.attributeFilterItemOnClick)}});a(".product-search-filter-extras").each(function(L,M){var N=a(B).find("#"+this.id);if(N.length>0){a("#"+this.id).replaceWith(N)}});ixwpsf.toggleWidgets();a(".product-search-filter-reset .product-search-filter-reset-clear").removeClass("loading-reset-filter");a(".product-search-filter-reset").trigger("ixProductFilterRequestDone");a(document).triggerHandler("ixProductFilterRequestProcessed")}})};ixwpsf.updateOrderingForm=function(f,o,e,u){var j=a(o.ordering).closest("form");if(j.length>0){if(f.length>0){var g=a(j).find('input[name="ixwpss"]');if(g.length>0){g.val(f)}else{a(j).append('<input type="hidden" name="ixwpss" value="'+f+'"/>')}}if(typeof e.title!=="undefined"){var x=a(j).find('input[name="title"]');if(x.length>0){x.val(e.title)}else{a(j).append('<input type="hidden" name="title" value="'+e.title+'"/>')}}else{a(j).find('input[name="title"]').remove()}if(typeof e.excerpt!=="undefined"){var c=a(j).find('input[name="excerpt"]');if(c.length>0){c.val(e.excerpt)}else{a(j).append('<input type="hidden" name="excerpt" value="'+e.excerpt+'"/>')}}else{a(j).find('input[name="excerpt"]').remove()}if(typeof e.content!=="undefined"){var s=a(j).find('input[name="content"]');if(s.length>0){s.val(e.content)}else{a(j).append('<input type="hidden" name="content" value="'+e.content+'"/>')}}else{a(j).find('input[name="content"]').remove()}if(typeof e.categories!=="undefined"){var q=a(j).find('input[name="categories"]');if(q.length>0){q.val(e.categories)}else{a(j).append('<input type="hidden" name="categories" value="'+e.categories+'"/>')}}else{a(j).find('input[name="categories"]').remove()}if(typeof e.attributes!=="undefined"){var k=a(j).find('input[name="attributes"]');if(k.length>0){k.val(e.attributes)}else{a(j).append('<input type="hidden" name="attributes" value="'+e.attributes+'"/>')}}else{a(j).find('input[name="attributes"]').remove()}if(typeof e.tags!=="undefined"){var m=a(j).find('input[name="tags"]');if(m.length>0){m.val(e.tags)}else{a(j).append('<input type="hidden" name="tags" value="'+e.tags+'"/>')}}else{a(j).find('input[name="tags"]').remove()}if(typeof e.sku!=="undefined"){var n=a(j).find('input[name="sku"]');if(n.length>0){n.val(e.sku)}else{a(j).append('<input type="hidden" name="sku" value="'+e.sku+'"/>')}}else{a(j).find('input[name="sku"]').remove()}if(typeof e.wpml!=="undefined"){var l=a(j).find('input[name="wpml"]');if(l.length>0){l.val(e.wpml)}else{a(j).append('<input type="hidden" name="wpml" value="'+e.wpml+'"/>')}}else{a(j).find('input[name="wpml"]').remove()}a(j).find('input[name="min_price"]').remove();a(j).find('input[name="max_price"]').remove();a(j).find('input[name^="ixwpst"]').remove();a(j).find('input[name^="ixwpsf"]').remove();a(j).find('input[name="ixwpse"]').remove();a(j).find('input[name="on_sale"]').remove();a(j).find('input[name="rating"]').remove();var v=u.substring(u.indexOf("?")+1);var d=v.indexOf("#");if(d>=0){v=v.substring(0,d)}v=v.split("&");if(v.length>0){for(var t=0;t<v.length;t++){var p=v[t].split("="),w="",r="";w=unescape(p[0]);if(p.length>1){r=unescape(p[1])}if(w!==""&&w!=="orderby"&&w!=="ixwpss"&&w!=="title"&&w!=="excerpt"&&w!=="content"&&w!=="categories"&&w!=="attributes"&&w!=="tags"&&w!=="sku"&&w!=="wpml"&&(w==="min_price"||w==="max_price"||w.indexOf("ixwpst")===0||w.indexOf("ixwpsf")===0||w==="ixwpse"||w==="on_sale"||w==="rating")){var b=a(j).find('input[name="'+w+'"]');if(b.length>0&&!w.endsWith("[]")){b.val(r)}else{a(j).append(a('<input type="hidden" name="'+w+'" />').attr({value:r}))}}}}if(typeof e.ixwpsp!=="undefined"){var h=a(j).find('input[name="ixwpsp"]');if(h.length>0){h.val(e.ixwpsp)}else{a(j).append('<input type="hidden" name="ixwpsp" value="'+e.ixwpsp+'"/>')}}else{a(j).find('input[name="ixwpsp"]').remove()}}};ixwpsf.updateQueryArg=function(j,h,b){b=ixwpsf.decodeURI(b);var c=j.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),g=new RegExp("([?&])"+c+"=.*?(&|#|$)","g"),k=null;if(typeof b==="undefined"){b=window.location.href}if(h===""){g=new RegExp("([?&])"+c+"=([^&#$]*)","g");k=b.replace(g,"$1");k=k.replace("?&","?").replace(/&&+/g,"&").replace(/&$/,"")}else{var e;if(e=b.match(g)){rmregex=new RegExp("([?&])"+c+"=([^&#$]*)","g");k=b.replace(rmregex,"$1");k=k.replace("?&","?").replace(/&&+/g,"&").replace(/&$/,"");k=ixwpsf.addQueryArg(j,h,k)}else{var d="",f=b.indexOf("?")!==-1?"&":"?";if(b.indexOf("#")!==-1){d=b.replace(/.*#/,"#");b=b.replace(/#.*/,"")}k=b+f+j+"="+h+d}}return k};ixwpsf.getQueryArgs=function(b){b=ixwpsf.decodeURI(b);var d=/[^=&?]+\s*=\s*[^&#]*/g;var f=b.match(d);var e=[];if(f!==null){for(var c=0;c<f.length;c++){var g=f[c].split("=");e.push(g)}}return e};ixwpsf.getQueryArg=function(c,e){c=ixwpsf.decodeURI(c);var f=new RegExp("[&?]"+e+"s*=s*[^&#]*","g");var g=c.match(f);var b=null;if(g!==null){for(var d=0;d<g.length;d++){var h=g[d].split("=");b=h[1];break}}return b};ixwpsf.addQueryArg=function(d,f,b){b=ixwpsf.decodeURI(b);var j=true;if(typeof b==="undefined"){b=window.location.href}var e=ixwpsf.getQueryArgs(b);for(var c=0;c<e.length;c++){if(e[c][0]==d&&e[c][1]==f){j=false;break}}if(j){var h="",g=b.indexOf("?")!==-1?"&":"?";if(b.indexOf("#")!==-1){h=b.replace(/.*#/,"#");b=b.replace(/#.*/,"")}b=b+g+d+"="+f+h}return b};ixwpsf.removeQueryArg=function(e,g,d){d=ixwpsf.decodeURI(d);var c=e.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),f=new RegExp("([?&])"+c+"="+g+"(&|#|$)","i"),b=d.replace(f,"$1$2").replace("?&","?").replace(/&&+/g,"&").replace(/&$/,"");return b};ixwpsf.categoryFilterItemOnClick=function(h){var d=a(this).closest(".product-search-filter-terms"),f=a(d).attr("id"),c=a(d).data("multiple"),b=a(this).parent().data("term")==="";if(c&&!b){var g="add"}else{var g="replace"}if(typeof h.preventDefault==="function"){h.preventDefault()}if(typeof h.stopImmediatePropagation==="function"){h.stopImmediatePropagation()}if(typeof h.stopPropagation==="function"){h.stopPropagation()}if(a(this).parent().hasClass("current-cat")){a(this).addClass("loading-term-filter");if(c){a(this).parent().removeClass("current-cat");a(".product-filter-field").first().trigger("ixTermFilter",[a(this).parent().data("term"),"product_cat","remove",f])}else{a(".product-search-product_cat-filter-item").removeClass("current-cat");a(".product-filter-field").first().trigger("ixTermFilter",["","product_cat",null,f])}}else{if(!c){a(".product-search-product_cat-filter-item").removeClass("current-cat")}a(this).parent().addClass("current-cat");a(this).addClass("loading-term-filter");a(".product-filter-field").first().trigger("ixTermFilter",[a(this).parent().data("term"),"product_cat",g,f])}return false};ixwpsf.categoryFilterSelectOnChange=function(j){var d=a(this).closest(".product-search-filter-terms"),g=a(d).attr("id"),c=a(d).data("multiple"),b=false;var f=a(this).val();if(f===null||f===""||(typeof f==="object")&&f.length===0){f="";b=true}if(c&&!b){var h="add"}else{var h="replace"}if(typeof j.preventDefault==="function"){j.preventDefault()}if(typeof j.stopImmediatePropagation==="function"){j.stopImmediatePropagation()}if(typeof j.stopPropagation==="function"){j.stopPropagation()}a(".product-filter-field").first().trigger("ixTermFilter",[f,"product_cat",h,g]);return false};ixwpsf.attributeFilterSelectOnChange=function(k){var f=a(this).closest(".product-search-filter-terms"),h=a(f).attr("id"),c=a(f).data("multiple"),b=false,d=a(this).data("taxonomy");var g=a(this).val();if(g===null||g===""||(typeof g==="object")&&g.length===0){g="";b=true}if(c&&!b){var j="add"}else{var j="replace"}if(typeof k.preventDefault==="function"){k.preventDefault()}if(typeof k.stopImmediatePropagation==="function"){k.stopImmediatePropagation()}if(typeof k.stopPropagation==="function"){k.stopPropagation()}a(".product-filter-field").first().trigger("ixTermFilter",[g,d,j,h]);return false};ixwpsf.tagFilterItemOnClick=function(h){var d=a(this).closest(".product-search-filter-terms"),f=a(d).attr("id"),c=a(d).data("multiple"),b=a(this).data("term")==="";if(c&&!b){var g="add"}else{var g="replace"}if(typeof h.preventDefault==="function"){h.preventDefault()}if(typeof h.stopImmediatePropagation==="function"){h.stopImmediatePropagation()}if(typeof h.stopPropagation==="function"){h.stopPropagation()}if(a(this).hasClass("current-tag")){a(this).addClass("loading-term-filter");if(c){a(this).removeClass("current-tag");a(".product-filter-field").first().trigger("ixTermFilter",[a(this).data("term"),"product_tag","remove",f])}else{a(".product-search-product_tag-filter-item").removeClass("current-tag");a(".product-filter-field").first().trigger("ixTermFilter",["","product_tag",null,f])}}else{if(!c){a(".product-search-product_tag-filter-item").removeClass("current-tag")}a(this).addClass("current-tag");a(this).addClass("loading-term-filter");a(".product-filter-field").first().trigger("ixTermFilter",[a(this).data("term"),"product_tag",g,f])}return false};ixwpsf.attributeFilterItemOnClick=function(h){var d=a(this).closest(".product-search-filter-terms"),f=a(d).attr("id"),c=a(d).data("multiple"),b=a(this).parent().data("term")==="";if(c&&!b){var g="add"}else{var g="replace"}if(typeof h.preventDefault==="function"){h.preventDefault()}if(typeof h.stopImmediatePropagation==="function"){h.stopImmediatePropagation()}if(typeof h.stopPropagation==="function"){h.stopPropagation()}if(a(this).parent().hasClass("current-attribute")){a(".product-search-"+a(this).parent().data("taxonomy")+"-filter-item").removeClass("current-attribute");a(this).addClass("loading-term-filter");if(c){a(".product-filter-field").first().trigger("ixTermFilter",[a(this).parent().data("term"),a(this).parent().data("taxonomy"),"remove",f])}else{a(".product-filter-field").first().trigger("ixTermFilter",["",a(this).parent().data("taxonomy"),null,f])}}else{a(this).parent().addClass("current-attribute");a(this).addClass("loading-term-filter");if(a(this).parent().data("term")==="undefined"||a(this).parent().data("term")===""){a(".product-filter-field").first().trigger("ixTermFilter",["",a(this).parent().data("taxonomy"),null,f])}else{a(".product-filter-field").first().trigger("ixTermFilter",[a(this).parent().data("term"),a(this).parent().data("taxonomy"),g,f])}}return false};ixwpsf.decodeURI=function(b){try{b=decodeURI(b)}catch(c){b=b.replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/%20/g," ")}return b};ixwpsf.toggleWidgets=function(){if(ixwpsf.autoToggleFilterWidgets){a(".product-search-filter-items").each(function(){if(!a(this).is("select")){if(!a(this).is(".selectize-control,.selectize-dropdown")){var b=a(this).children().length>0;if(b||a(this).hasClass("product-search-filter-toggle-widget")){a(this).closest(".widget").toggle(b)}if(b||a(this).hasClass("product-search-filter-toggle")){a(this).toggle(b)}}}else{if(!a(this).is("select.selectized")){var c=a(this).children(),b=true;if(c.length===0){b=false}else{if(c.length===1){var e=c.first().val();if(typeof e==="undefined"||e===""){b=false}}}}else{var b=true;if(typeof this.selectize!=="undefined"&&typeof this.selectize.options!=="undefined"){var d=Object.keys(this.selectize.options).length;if(d===0){b=false}else{if(d===1){for(i in this.selectize.options){if(typeof this.selectize.options[i].value==="undefined"||this.selectize.options[i].value===""){b=false;break}}}}}}if(b||a(this).hasClass("product-search-filter-toggle-widget")){a(this).closest(".widget").toggle(b)}if(b||a(this).hasClass("product-search-filter-toggle")){a(this).closest(".product-search-filter-terms").find(".selectize-control").toggle(b);a(this).filter("select:not(.apply-selectize)").toggle(b)}}})}};a(document).ready(function(){a(document).on("mouseenter",".expandable.auto-expand",function(d){if(typeof d.preventDefault==="function"){d.preventDefault()}if(typeof d.stopImmediatePropagation==="function"){d.stopImmediatePropagation()}if(typeof d.stopPropagation==="function"){d.stopPropagation()}var e=a(this).find(".term-expander").first();var b=false;if(typeof e.data("locked")!=="undefined"){b=e.data("locked")}if(b){return}a(this).addClass("expanded");var c=a(this).find("> ul");c.stop(true,true).show(ixwpsf.expandTime);if(a(this).hasClass("auto-retract")){a(this).closest(".product-search-filter-items").on("mouseleave.ixwpsf",function(f){c.parent().removeClass("expanded");c.stop(true,true).hide(ixwpsf.retractTime);a(this).off("mouseleave.ixwpsf")})}});a(document).on("click touchstart",".term-expander",function(g){if(typeof g.preventDefault==="function"){g.preventDefault()}if(typeof g.stopImmediatePropagation==="function"){g.stopImmediatePropagation()}if(typeof g.stopPropagation==="function"){g.stopPropagation()}var h=a(this).closest(".term-expander");var e=false;var c=false;if(typeof h.data("locked")!=="undefined"){c=h.data("locked")}switch(c){case true:e=true;break;default:h.data("locked",true);var b=setTimeout(function(){h.data("locked",false);h.data("lockedTimeout",null)},500);h.data("lockedTimeout",b)}if(e){return}var f=a(this).closest(".expandable");var d=f.find("> ul");if(!f.hasClass("expanded")){f.addClass("expanded");d.show(ixwpsf.expandTime)}else{f.removeClass("expanded");d.hide(ixwpsf.retractTime)}});a(".product-search-form input.product-filter-field").prop("disabled",false);a(".product-search-filter-price-form input.product-search-filter-price-field").prop("disabled",false);a(".product-search-filter-price.hide-fields .min-max-fields").hide();a("select.product-search-filter-product_cat").prop("disabled",false);a("select.product-search-filter-attribute").prop("disabled",false);a(".product-search-product_cat-filter-item a").on("click",ixwpsf.categoryFilterItemOnClick);a("select.product-search-filter-product_cat").on("change",ixwpsf.categoryFilterSelectOnChange);a("select.product-search-filter-attribute").on("change",ixwpsf.attributeFilterSelectOnChange);a(".product-search-product_tag-filter-item").on("click",ixwpsf.tagFilterItemOnClick);a(".product-search-attribute-filter-item a").on("click",ixwpsf.attributeFilterItemOnClick);a(document).on("change input textInput",".product-search-filter-search input.product-filter-field",function(){var b=a(this).val().trim();if(b.length>0){a(this).parent().find(".product-search-filter-search-clear").show()}else{a(this).parent().find(".product-search-filter-search-clear").hide()}});a(document).on("click",".product-search-filter-search .product-search-filter-search-clear",function(){a(this).parent().find("input.product-filter-field").val("").trigger("input")});a(document).on("change input textInput",".product-search-filter-price input.product-search-filter-min-price, .product-search-filter-price input.product-search-filter-max-price",function(){var c=a(this).parent().find("input.product-search-filter-min-price").val().trim(),b=a(this).parent().find("input.product-search-filter-max-price").val().trim();if(c.length>0||b.length>0){a(this).parent().parent().find(".product-search-filter-price-clear").show()}else{a(this).parent().parent().find(".product-search-filter-price-clear").hide()}});a(document).on("click",".product-search-filter-price .product-search-filter-price-clear",function(){var h=a(this).parent().find("input.product-search-filter-min-price"),e=a(this).parent().find("input.product-search-filter-max-price"),d=false,b=false;if(h.length>0){if(h.val()!==""){h.val("");d=true}}if(e.length>0){if(e.val()!==""){e.val("");b=true}}if(d){h.trigger("input")}else{if(b){e.trigger("input")}}if(typeof a().slider!=="undefined"){var g=a(this).parent().find(".product-search-filter-price-slider");if(g.length>0){var d=g.slider("option","min"),b=g.slider("option","max");g.slider("option","values",[d,b]);var f=g.parent().find(".slider-min"),c=g.parent().find(".slider-max");f.text(d);c.text(b)}}});a(document).on("click",".product-search-filter-extra:not(.filter-dead)",function(g){if(typeof g.preventDefault==="function"){g.preventDefault()}if(typeof g.stopImmediatePropagation==="function"){g.stopImmediatePropagation()}if(typeof g.stopPropagation==="function"){g.stopPropagation()}a(this).parent().find("a.product-search-filter-extra").addClass("loading-extra-filter");var d=null;if(a(this).is("a")){var b=a(this).parent().find('input[type="checkbox"]').first();b.prop("checked",!b.prop("checked"));if(a(this).is("a.rating-filter-option")){d=a(this).data("rating")}}var c={ixwpse:1};var f=a(this).parent().find('input[type="checkbox"]');f.each(function(){c[a(this).attr("name")]=this.checked?1:0});if(d!==null){c.rating=d}else{c.rating=""}a(".product-search-form input.product-filter-field").first().trigger("ixExtraFilter",c)});a(document).on("click",".product-search-filter-reset .product-search-filter-reset-clear",function(b){if(typeof b.preventDefault==="function"){b.preventDefault()}if(typeof b.stopImmediatePropagation==="function"){b.stopImmediatePropagation()}if(typeof b.stopPropagation==="function"){b.stopPropagation()}a(this).addClass("loading-reset-filter");a(".product-search-form input.product-filter-field").first().trigger("ixFilterReset")});a(".product-search-filter-reset").on("ixProductFilterRequestDone",function(c){var b=false;a(".product-filter-field").each(function(d){if(a(this).val().length>0){b=true;return false}});if(!b){b=a('.product-search-filter-terms .current-cat, .product-search-filter-terms .current-tag, .product-search-filter-terms .current-attribute, .product-search-filter-terms select.selectized option[selected]:not([value=""])').length>0}if(!b){a(".product-search-filter-min-price, .product-search-filter-max-price").each(function(d){if(a(this).val().length>0){b=true;return false}})}if(!b){a("input.product-search-filter-on-sale").each(function(d){if(this.checked){b=true;return false}})}if(!b){b=a(".product-search-filter-rating .rating-filter-option.rating-selected").length>0}if(b){a(this).show()}else{a(this).hide()}});a(".product-search-filter-reset").trigger("ixProductFilterRequestDone");a(".product-search-filter-items option").each(function(c,d){var e=a(d).val(),b=a(d).data();ix_dropdown_thumbnails[e]=b});a("select.apply-selectize").each(function(c,d){var b=[];a(d).find("option").each(function(e,f){a(f).data("data",{$order:e});b[a(f).val()]=e});ix_dropdown_order[d.id]=b});if(typeof a().selectize!=="undefined"){a("select.apply-selectize").trigger("apply-selectize")}ixwpsf.toggleWidgets()})})(jQuery);