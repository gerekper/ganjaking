"use strict";jQuery(function(c){var n=null!==window.wc_memberships_frontend?window.wc_memberships_frontend:{},s={},f=[];function r(){c.fn.select2&&c(".wc-memberships-member-profile-field select").not(".select2-hidden-accessible").select2().addClass("select2-initialized");var e=c(".wc-memberships-member-profile-field"),r=c(".form-row");r.not(e).find(".woocommerce-input-wrapper :input").on("keydown click focus",function(){e.find(".description").prop("aria-hidden",!0).slideUp(250)}),e.each(function(){var i=c(this),e=i.find(".description");i.find('.woocommerce-input-wrapper input[type="checkbox"], .woocommerce-input-wrapper input[type="radio"]').off(),e.hide(),i.hasClass("wc-memberships-member-profile-field wc-memberships-member-profile-field-input-file")?i.find("label, .wc-memberships-profile-field-input-file-dropzone").on("click",function(){o(i,r)}):i.hasClass("wc-memberships-member-profile-field-input-multiselect")?c(this).find("label, .select2-selection").on("click change",function(){o(i,r)}):(i.hasClass("wc-memberships-member-profile-field-input-select")&&i.find(".select2-selection").on("click change",function(){o(i,r)}),i.find("input, textarea, select, label").not(".select2-selection").on("keydown click",function(){if(c(this).is("label")){var e=c(this).attr("for"),e=c("#"+e);if(e.is(":text")||e.is("textarea")||e.is("select"))return}o(i,r)}))}),c(".wc-memberships-member-profile-field-input-file").each(function(){var s=c(this),o=s.find(".wc-memberships-profile-field-input-file-dropzone"),l=s.find(".wc-memberships-profile-field-input-file-preview"),t=s.find(".wc-memberships-profile-field-input-file-upload-progress"),a=s.find(".wc-memberships-profile-field-input-file-feedback"),d=s.find('input[type="hidden"]'),i=d.data("slug"),e={url:n.ajax_url,browse_button:o[0],drop_element:o[0],multi_selection:1<n.max_files,multipart_params:{action:"wc_memberships_upload_profile_field_file",security:n.nonces.profile_field_upload_file,profile_field:i},filters:{max_file_size:n.max_file_size,mime_types:n.mime_types}},r=new plupload.Uploader(e);r.init(),f.push(r),r.bind("Error",function(e,i){i=n.i18n.upload_error.replace("%1$s",i.code).replace("%2$s",i.message);return a.html(i).removeClass("hide"),t.addClass("hide")}),r.bind("FilesAdded",function(e,i){return a.html("").addClass("hide"),o.addClass("disabled"),t.removeClass("hide"),r.start()}),r.bind("UploadProgress",function(e,i){return t.find(".bar").css("width",i.percent+"%")}),r.bind("FileUploaded",function(e,i,r){var n=JSON.parse(r.response);return!n||n.errors?(t.addClass("hide"),o.removeClass("disabled"),n&&n.length?void a.html(n.errors.upload_error).removeClass("hide"):void console.log(r.response)):(c("#woocommerce-register-nonce").val(n.security),d.val(n.id).trigger("change"),l.removeClass("hide").find("a.file").prop("href",n.url).text(n.title),o.addClass("hide").removeClass("disabled"),t.addClass("hide").find(".bar").css("width",0),s.find(".moxie-shim").addClass("hide"))}),s.find("a.remove-file").on("click",function(e){e.preventDefault(),l.addClass("hide").find("a.file").prop("href","").text(""),o.removeClass("hide disabled");e={action:"wc_memberships_remove_profile_field_file",security:n.nonces.profile_field_remove_file,file:d.val(),profile_field:i};return c.post(n.ajax_url,e,function(e){e&&e.success||console.log(e)}).always(function(){d.val("").trigger("change")}),s.find(".moxie-shim").removeClass("hide")})})}function o(e,i){var r=e.find("span.description");r.is(":visible")||r.prop("aria-hidden",!1).slideDown(250),i.not(e).find(".description").prop("aria-hidden",!0).slideUp(250)}function l(e,i){e.find(".woocommerce-variation-add-to-cart").prepend(i),r()}function t(e){var i,e=e.find(".wc-memberships-profile-fields-wrapper");e.length&&(f.length&&f.forEach(function(e){e.destroy()}),(i=e.find(".wc-memberships-member-profile-field select.select2-initialized")).length&&i.select2("destroy"),e.remove())}c("form.variations_form").on("show_variation wcm_show_variation",function(e){var i=c('input[name="variation_id"]').val(),r=c(e.currentTarget);if(t(r),!i)return!0;i in s?l(r,s[i]):(r.block({message:null}),c.post(n.ajax_url,{action:"wc_memberships_get_variation_profile_fields",security:n.nonces.get_product_profile_fields,product_id:i},function(e){e.success&&e.data.length&&(l(r,e.data),s[i]=e.data)}).always(function(){r.unblock()}))}).on("woocommerce_variation_has_changed",function(e){c('input[name="variation_id"]').val()||t(c(e.currentTarget))}),r()});