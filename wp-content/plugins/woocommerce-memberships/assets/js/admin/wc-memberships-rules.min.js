"use strict";!function(){jQuery(function(c){var e,r=null!=(e=window.wc_memberships_admin)?e:{},a=function(e){return{type:e.split("|")[0],name:e.split("|")[1]}},o=function(e){var s={};switch(e.type){case"taxonomy":s.action="wc_memberships_json_search_terms",s.security=r.search_terms_nonce,s.taxonomy=e.name;break;case"post_type":s.action="product"===e.name?"woocommerce_json_search_products_and_variations":"wc_memberships_json_search_posts",s.security="product"===e.name?r.search_products_nonce:r.search_posts_nonce,s.post_type=e.name}return s},d=function(n){var t=0;return c("table."+n+"-rules tbody."+n+"-rule").each(function(e,s){if(!c(s).hasClass(n+"-rule-__INDEX__"))return c(s).removeClass(function(e,s){var t=new RegExp(n+"-rule-[0-9]","g"),s=s.match(t);if(s)return s[0]}),c(s).addClass(n+"-rule-"+t),c("input, select, textarea",s).each(function(e,s){s=jQuery(s);if(s.attr("name"))return s.attr("name",s.attr("name").replace(/\[([^[]*)\]/,"["+t+"]"))}),t++})},s=function(e){var s=c(e).get(0).tagName,t=c("INPUT"===s?'input[type="radio"][name="'+c(e).attr("name")+'"]:checked':e).val(),n=c(e).closest(".rule");if("immediate"===t){if(n.find(".js-show-if-access-schedule-immediate").removeClass("hide"),n.find(".js-hide-if-access-schedule-immediate").addClass("hide"),"SELECT"===s)return n.find(".js-access-schedule-period-selector").val(t).first().focus()}else if(n.find(".js-show-if-access-schedule-immediate").addClass("hide"),n.find(".js-hide-if-access-schedule-immediate").removeClass("hide"),"SELECT"!==s||c(e).hasClass("access_schedule-period")||n.find(".access_schedule-period").find("option").removeAttr("selected"),(t=n.find(".access_schedule-amount")).val()||t.val(1),c(e).hasClass("js-schedule-type"))return t.focus()};return r.initializeRuleset=function(t){var n=".js-object-ids",i=c("."+t+"-rules");return i.on("change",".js-content-type",function(e){var s=o(a(c(this).val())),t=c(this).closest("tr").find(n);return c(t).removeData("selected").val("").select2("destroy"),r.initializeEnhancedSelect(t,s)}),i.on("change",".js-access-schedule-period-selector",function(e){return s(this)}),i.find(n).each(function(){var e;if(!c(this).closest("tbody").hasClass(t+"-rule-__INDEX__"))return e=c(this).closest("tbody").find(".js-content-type").get(0).value,e=o(a(e)),r.initializeEnhancedSelect(this,e)}),i.find(".js-add-rule").click(function(){var e=i.find("."+t+"-rule-__INDEX__"),s=i.children("tbody").length-1,s=c(e.prop("outerHTML").replace(/__INDEX__/g,s));return e.before(s),(e=s.find("select.membership-plan"))&&e.select2(),s.find(".js-content-type").length&&(e=s.find(".js-content-type").get(0).value,e=o(a(e)),r.initializeEnhancedSelect(s.find(n),e)),i.find(".norules").addClass("hide"),i.find("tfoot .js-remove-rules").removeClass("hide"),d(t)}),i.find(".js-remove-rules").click(function(){var e=i.find('th.check-column input[type="checkbox"]:checked');return c.when(e.closest("tbody").fadeOut(400,function(){var e=c(this);return e.find(".js-rule-id").val()?e.addClass("hide").find(".js-rule-remove").val(1):setTimeout(function(){return e.remove()},1)})).then(function(){return i.find(".rule:visible").length<1&&(i.find(".norules").removeClass("hide"),i.find(".js-remove-rules").addClass("hide")),i.find('th.check-column input[type="checkbox"]').removeAttr("checked"),d(t)})})}})}.call(void 0);