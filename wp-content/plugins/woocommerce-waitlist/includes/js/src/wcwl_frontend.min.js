function wcwl_apply_event_on_page_update(){var e=".wcwl_elements";jQuery(".wcwl_frontend_wrap").length&&(e=".wcwl_frontend_wrap"),jQuery(".wcwl_nojs").toggleClass("wcwl_nojs",!1),jQuery(e+":not(.bound)").addClass("bound").on("click","a.wcwl_control",function(e){e.preventDefault(),wcwl_reset_waitlist_elements(jQuery(this)),jQuery('.wcwl_notice div[aria-live="polite"]').empty(),wcwl_process_waitlist_request(jQuery(this))}),jQuery(".woocommerce.quick-view.single-product .wcwl_elements:not(.bound)").addClass("bound").on("click","a.wcwl_control",function(e){e.preventDefault(),jQuery(".wcwl_notice").hide(),jQuery('.wcwl_notice div[aria-live="polite"]').empty(),wcwl_process_waitlist_request(jQuery(this))}),jQuery(".wcwl_toggle").on("click","button",function(){var e=jQuery(this).closest(".wcwl_frontend_wrap");wcwl_toggle_archive_fields(e),e.find(".wcwl_intro, .wcwl_optin, .wcwl_email_elements").show()}),jQuery(".wcwl_notice").on("click",".wcwl_notice_dismiss",function(){var e,t=jQuery(this).closest(".wcwl_notice");t.find('div[aria-live="polite"]').empty(),t.hide(),jQuery(".wcwl_frontend_wrap").length?(wcwl_toggle_archive_fields(e=jQuery(this).closest(".wcwl_frontend_wrap")),e.find(".wcwl_toggle").show(),e.find(".wcwl_elements").hide()):jQuery(this).closest(".wcwl_elements").find(".wcwl_intro, .wcwl_optin, .wcwl_email_elements, .wcwl_control").show()}),wcwl_hide_waitlist_notice_if_empty(),wcwl_add_keyboard_button_events(),null!=jQuery(e).css("display")&&(waitlist_display_class=null!=jQuery(e).css("display"))}function wcwl_toggle_archive_fields(e){jQuery(".wcwl_elements, .wcwl_notice").hide(),jQuery(".wcwl_toggle, .woocommerce_waitlist, .wcwl_frontend_wrap > .wcwl_control").show(),e.find(".wcwl_toggle").hide(),e.find(".wcwl_elements, .wcwl_email_elements, .wcwl_control, .wcwl_optin").show()}function wcwl_reset_waitlist_elements(e){jQuery(".wcwl_frontend_wrap").length?wcwl_toggle_archive_fields(e.closest(".wcwl_frontend_wrap")):(jQuery(".wcwl_elements, .wcwl_email_elements, .wcwl_control, .wcwl_optin, .wcwl_intro").show(),jQuery(".wcwl_notice").hide(),e.closest(".wcwl_elements").find(".wcwl_intro").hide()),jQuery(".wcwl_email, .wcwl_optin").removeClass("wcwl_error_highlight")}function wcwl_process_waitlist_request(e){var t=e.closest(".wcwl_frontend_wrap");t.length||(t=e.closest(".wcwl_elements"));var l=[],i=t.find('input[name="wcwl_email"]');wcwl_check_email_field(i)||l.push("email");var w=t.find('input[name="wcwl_optin"]');wcwl_check_optin_field(w)||l.push("optin"),0==l.length?(e.find("button").hide(),t.find(".wcwl_email_elements, .wcwl_optin").hide(),e.find(".spinner").show(),wcwl_add_screenreader_message(t.find(".wcwl_control"),wcwl_data.loading_message),wcwl_process_ajax_request(t,e,i.val())):(t.find(".wcwl_notice").hide(),t.find(".wcwl_intro, .wcwl_optin").show(),"email"==l[0]?i.focus():w.focus())}function wcwl_process_ajax_request(i,e,t){var w=e.data("context"),l=wcwl_get_grouped_products(),_=e.data("product-id"),c=e.data("wpml-lang"),n={action:"wcwl_process_user_waitlist_request",nonce:e.data("nonce"),product_id:_,language:c,products:l,email:t,context:w,archive:i.hasClass("wcwl_frontend_wrap")?"true":"false"};jQuery(document.body).trigger("wcwl_before_waitlist_request",n),jQuery.post(wcwl_data.ajax_url,n).done(function(e){var t,l;e.success&&(l=(l=e.data.html.replace("\x3c!-- wcwl_elements --\x3e","")).replace("\x3c!-- wcwl_frontend_wrap --\x3e",""),i.replaceWith(l),i.hasClass("wcwl_frontend_wrap")?wcwl_process_dom_changes_on_archive_page(_,w):(jQuery(".single_variation_wrap").length&&wcwl_update_availability_html_on_variation_form(e.data.html,_),(t=jQuery('.wcwl_control[data-product-id="'+_+'"]').closest(".wcwl_elements")).length&&(t.find(".wcwl_intro, .wcwl_optin, .wcwl_control, .wcwl_email_elements").hide(),t.find(".wcwl_notice").show(),t.css("display",waitlist_display_class),"none"!==waitlist_display_class&&void 0!==waitlist_display_class||t.show())),jQuery(".woocommerce.quick-view.single-product .product-type-simple").length&&jQuery(".wcwl_frontend_wrap .wcwl_notice").hide()),wcwl_apply_event_on_page_update(),jQuery(document.body).trigger("wcwl_after_waitlist_request",n)})}function wcwl_update_availability_html_on_variation_form(i,w){var _=jQuery("form.variations_form").data("product_variations");jQuery.each(_,function(e,t){var l;t.variation_id===w&&(i=i.replace("</div>\x3c!-- wcwl_elements --\x3e",""),l=t.availability_html.substring(t.availability_html.lastIndexOf('<div class="wcwl_elements">'),t.availability_html.lastIndexOf("</div>\x3c!-- wcwl_elements --\x3e")),t.availability_html=t.availability_html.replace(l,i),_[e]=t)}),jQuery("form.variations_form").data("product_variations",_)}function wcwl_process_dom_changes_on_archive_page(e,t){var l=jQuery('a[data-product-id="'+e+'"]').closest(".wcwl_frontend_wrap");l.find(".wcwl_elements").css("display",waitlist_display_class),l.find(".wcwl_elements, .wcwl_notice").show(),l.find(".wcwl_notice").next("a button").hide(),l.find(".wcwl_toggle, .wcwl_intro, .wcwl_optin, .wcwl_email_elements, .wcwl_control").hide(),"leave"===t&&l.find(".woocommerce_waitlist").text(l.find('input[name="wcwl_join_button_text"]').val())}function wcwl_hook_up_variation_events(){jQuery("form.variations_form").on("show_variation",function(){wcwl_apply_event_on_page_update()})}function wcwl_maybe_show_for_bundle(){jQuery(".bundle_wrap .wcwl_elements").remove(),(jQuery(".bundle_availability").is(":visible")&&jQuery(".bundle_availability .stock.out-of-stock").length||wcwl_bundle_data.backorder_allowed&&jQuery(".bundle_availability").is(":visible")&&jQuery(".bundle_availability .stock.available-on-backorder").length)&&jQuery(wcwl_bundle_data.waitlist_html).insertAfter(".bundle_availability"),wcwl_apply_event_on_page_update()}var wcwl_ticket_form,wcwl_tickets,requires_waitlist;function wcwl_get_grouped_products(){var l={};return jQuery(".wcwl_checkbox").length&&jQuery(".wcwl_checkbox").each(function(){var e=jQuery(this).data("product-id"),t=jQuery(this).data("wpml-lang");l[e]={checked:this.checked,lang:t}}),l}function wcwl_add_keyboard_button_events(){jQuery(".wcwl_email_elements").on("keyup keypress","input.wcwl_email",function(e){13===(e.keyCode||e.which)&&(jQuery(this).closest(".wcwl_frontend_wrap").length?jQuery(this).closest(".wcwl_frontend_wrap").find(".woocommerce_waitlist").trigger("click"):jQuery(this).closest(".wcwl_elements").find(".woocommerce_waitlist").trigger("click"))})}function wcwl_check_optin_field(e){return e.length&&!e.is(":checked")?(e.closest(".wcwl_optin").addClass("wcwl_error_highlight"),!1):(e.closest(".wcwl_optin").removeClass("wcwl_error_highlight"),!0)}function wcwl_check_email_field(e){return!e.length||e.val()&&wcwl_validate_email(e.val())?(e.removeClass("wcwl_error_highlight"),!0):(e.addClass("wcwl_error_highlight"),!1)}function wcwl_validate_email(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function wcwl_add_screenreader_message(e,t){var l=e.find('div[aria-live="polite"]');l.empty(),l.append("<p>"+t+"</p>")}function wcwl_hide_waitlist_notice_if_empty(){jQuery(".wcwl_notice:empty").hide()}jQuery(document).ready(function(e){wcwl_apply_event_on_page_update(),wcwl_hook_up_variation_events(),e("body").on("quick-view-displayed",function(){wcwl_hook_up_variation_events()})}),"undefined"!=typeof wcwl_bundle_data&&jQuery(".bundle_availability").length&&jQuery(".bundle_form .bundle_data").on("woocommerce-product-bundle-initialized, woocommerce-product-bundle-updated",function(){setTimeout(function(){wcwl_maybe_show_for_bundle()},300)}),"undefined"!=typeof wcwl_event_data&&jQuery("#tribe-events").length?0<(wcwl_tickets=jQuery(".woocommerce.tribe-tickets-form-row")).length?(requires_waitlist=!1,jQuery.each(wcwl_tickets,function(e,t){var l=jQuery(t).data("product-id"),i=wcwl_event_data.tickets[l];i&&(requires_waitlist=!0,jQuery(i).insertAfter(jQuery(t).find(".tickets_nostock")))}),requires_waitlist&&(jQuery(wcwl_event_data.button).insertAfter(jQuery(".tribe-events-tickets")),wcwl_apply_event_on_page_update())):0<(wcwl_tickets=jQuery('input[value="Tribe__Tickets_Plus__Commerce__WooCommerce__Main"').nextAll("div.product.type-product")).length&&(requires_waitlist=!1,jQuery.each(wcwl_tickets,function(e,t){var l=jQuery(t).data("ticket-id"),i=wcwl_event_data.tickets[l];i&&(requires_waitlist=!0,jQuery(i).insertAfter(jQuery(t)))}),requires_waitlist&&(jQuery(wcwl_event_data.button).insertAfter(jQuery("form#tribe-tickets")),wcwl_apply_event_on_page_update())):(wcwl_ticket_form=jQuery('form[data-provider-id="woo"]'),"undefined"!=typeof wcwl_event_data&&jQuery(wcwl_ticket_form).length&&(0==(wcwl_tickets=wcwl_ticket_form.find(".tribe-tickets__item")).length&&(wcwl_tickets=wcwl_ticket_form.find(".tribe-tickets__tickets-item")),0<wcwl_tickets.length&&(requires_waitlist=!1,jQuery.each(wcwl_tickets,function(e,t){var l=jQuery(t).data("ticket-id"),i=wcwl_event_data.tickets[l];i&&(requires_waitlist=!0,jQuery('<div class="wcwl_event_checkbox">'+i+"</div>").insertAfter(jQuery(t)))}),requires_waitlist&&(jQuery(wcwl_event_data.button).insertAfter(wcwl_ticket_form),wcwl_apply_event_on_page_update())))),jQuery("body").on("quick-view-displayed",function(){wcwl_apply_event_on_page_update()}),jQuery(window).on("wcpf_after_ajax_filtering",function(){wcwl_apply_event_on_page_update()}),jQuery(document).on("ixProductFilterRequestProcessed",function(){wcwl_apply_event_on_page_update()});