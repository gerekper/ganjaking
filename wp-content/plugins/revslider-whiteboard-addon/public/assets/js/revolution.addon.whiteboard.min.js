/**
 * @preserve
 * @name REVOLUTION 6.0+ EXTENSION - WHITEBOARD
 * @version 2.2.3 (13-01-2021)
 * @author ThemePunch
 */
!function(e){var t=jQuery.fn;jQuery.extend(!0,t,{rsWhiteBoard:function(e,t){return this.each((function(){if(jQuery.fn.revolution&&jQuery.fn.revolution[this.id]){var e=jQuery.fn.revolution[this.id];jQuery(this).on("revolution.slide.onloaded",(function(){a(e)}))}}))}});var a=function(e){if(void 0===e.whiteboard)return!1;var t={handtype:"right",jittering:{distance:"80",distance_horizontal:"100",repeat:"5",offset:"10",offset_horizontal:"0"},rotation:{angle:"10",repeat:"3"}};jQuery.extend(!0,e.whiteboard.writehand,t),jQuery.extend(!0,e.whiteboard.movehand,t);var a=e.whiteboard,i="position:absolute;z-index:1000;top:0px;left:0px;",r="position:absolute;z-index:1000;top:0px;left:0px;",s="position:absolute; top:0px;left:0px;background-size:contain;background-repeat:no-repeat;background-position:center center;";null!=a.movehand&&(a.movehand.markup='<div class="wb-move-hand wb-thehand" style="'+i+'"><div class="wb-hand-inner" style="'+r+";width:"+a.movehand.width+"px;height:"+a.movehand.height+'px"><div class="wb-hand-scale" ><div class="wb-hand-image" style="'+s+"width:"+a.movehand.width+"px;height:"+a.movehand.height+"px;background-image:url("+a.movehand.source+');"></div></div></div>'),null!=a.writehand&&(a.writehand.markup='<div class="wb-draw-hand wb-thehand" style="'+i+'"><div class="wb-hand-inner" style="'+r+'"><div class="wb-hand-scale" style="position:absolute;z-index:1000;top:0px;left:0px;"><div class="wb-hand-image" style="'+s+"width:"+a.writehand.width+"px;height:"+a.writehand.height+"px;background-image:url("+a.writehand.source+');"></div></div></div>'),jQuery(window).on("resize",(function(){clearTimeout(e.whiteboard_resize_timer),e.whiteboard_resize_timer=setTimeout((function(){jQuery(".wb-thehand").each((function(){var t=jQuery(this).find(".wb-hand-scale");punchgs.TweenLite.set(t,{scale:e.bw})}))}),50)})),e.c.on("revolution.slide.onbeforeswap",(function(t,a){e.whiteboard.animating=!1,e.c.find(".wb-thehand").remove()})),e.c.on("revolution.slide.layeraction",(function(t,i){var r=i.layersettings.whiteboard;if(null!=r){1!=r.configured&&("write"!=r.hand.mode&&"draw"!=r.hand.mode||(r.jitter.distance=null!=r.jitter.distance?parseInt(r.jitter.distance,10)/100:parseInt(a.writehand.jittering.distance,10)/100,r.jitter.distanceHorizontal=null!=r.jitter.distanceHorizontal?parseInt(r.jitter.distanceHorizontal,10)/100:parseInt(a.writehand.jittering.distance_horizontal,10)/100,r.jitter.offset=null!=r.jitter.offset?parseInt(r.jitter.offset,10)/100:parseInt(a.writehand.jittering.offset,10)/100,r.jitter.offsetHorizontal=null!=r.jitter.offsetHorizontal?parseInt(r.jitter.offsetHorizontal,10)/100:parseInt(a.writehand.jittering.offset_horizontal,10)/100,r.hand.type=r.hand.type||a.writehand.handtype),"move"==r.hand.mode&&(r.hand.type=r.hand.type||a.movehand.handtype),r.configured=!0);var s,l=i.layer.data(),f=jQuery(l.p).find(".wb-thehand");if(s=f.length>0?f.data("wb"):jQuery.extend(!0,{},i.layersettings.whiteboard),"enterstage"==i.eventtype){if(!1===i.layer.is(":visible"))return;i.layer.hasClass("handadded")||(i.layer.addClass("handadded"),i.layersettings.handEffect="on",1!=s.handadded&&o(e,i,s),d(i,s,e))}"enteredstage"==i.eventtype&&(i.layer.data("whiteboardactive",!0),i.layer.hasClass("handadded")&&!i.layer.hasClass("handremoved")&&(i.layer.addClass("handremoved"),i.layersettings.handEffect="off",0==n(e,i,s)&&h(e,i,s))),"leavestage"==i.eventtype&&(i.layer.data("whiteboardactive",!1),i.layer.removeClass("handadded"),i.layer.removeClass("handremoved"))}}))},n=function(e,t,a){e.whiteboard.animating=!1;var n=!1,i=t.layer.data(),r=jQuery(i.p).find(".wb-thehand"),o=function(){e.whiteboard.animating?requestAnimationFrame((function(){r.remove()})):requestAnimationFrame(o)};if("on"===i.whiteboard.hand.gotoLayer&&"move"!=i.whiteboard.hand.mode&&0==e.c.find(".wb-between-stations").length){var s=function(e){var t={obj:"",startat:9999999};return e.layer.closest("rs-slide").find("rs-layer, .rs-layer").each((function(){var e=jQuery(this),a=e.data();a.whiteboardactive||null==a.whiteboard||"move"==a.whiteboard.hand.mode||parseInt(a.frames.frame_1.timeline.start,10)<t.startat&&(t.obj=e,t.startat=parseInt(a.frames.frame_1.timeline.start,10))})),t}(t);if(null!=s&&s.obj.length>0){var d=r.find(".wb-hand-inner"),h=null!=i.timeline&&null!=i.timeline.labels&&null!=i.timeline.labels.frame_1_end?i.timeline.labels.frame_1_end:0,l=Math.max(s.startat/1e3-h,0),f=jQuery(i.p).position(),p=s.obj.data("p").position(),c=r.closest("rs-static-layers").length>0;r.appendTo(r.closest("rs-slides")),r.addClass("wb-between-stations"),c?r.css({zIndex:200}):r.css({zIndex:100}),a.handEffect="off",punchgs.TweenLite.fromTo(r,l,{top:f.top,left:f.left},{top:p.top,left:p.left}),punchgs.TweenLite.to(d,l,{x:0,y:0,onComplete:o}),n=!0}}return n},i=function(e,t,a){if("off"!=a.handEffect&&1==a.handadded){var n=parseInt(a.hand.angle,10)||10,r="write"==a.hand.mode||"draw"==a.hand.mode?Math.random()*n-n/2:0;a.rotatespeed=a.rotatespeed||.05,a.rotating_anim=punchgs.TweenLite.to(e,a.rotatespeed,{rotationZ:r,ease:punchgs.Power3.easeOut,onComplete:function(){i(e,t,a)}})}},r=function(e,t,a){if("off"!=a.handEffect&&1==a.handadded){var n=t.layer.data();if("horizontal"==a.jitter_direction){var i=a.maxwave||n.eow*a.jitter.distanceHorizontal,o=n.eow*a.jitter.offsetHorizontal;if(0==i)return;a.current_x_offset=a.current_x_offset||0,a.lastwave=Math.random()*i+o,a.jitterspeed=a.jitterspeed||.05,a.jittering_anim=punchgs.TweenLite.to(e,a.jitterspeed,{x:a.lastwave,ease:punchgs.Power3.easeOut,onComplete:function(){r(e,t,a)}})}else{var s=a.maxwave||n.eoh;if(0==s)return;a.current_y_offset=a.current_y_offset||0,a.lastwave=a.lastwave==a.current_y_offset+s*a.jitter.offset?Math.random()*(s*a.jitter.distance)+a.current_y_offset+s*a.jitter.offset:a.current_y_offset+s*a.jitter.offset,a.jitterspeed=a.jitterspeed||.05,a.jittering_anim=punchgs.TweenLite.to(e,a.jitterspeed,{y:a.lastwave,ease:punchgs.Power3.easeOut,onComplete:function(){r(e,t,a)}})}}},o=function(e,t,a){var n="move"==a.hand.mode?e.whiteboard.movehand:e.whiteboard.writehand,i=n.markup,r=t.layer.data();a.hand.rotation=a.hand.rotation||0,a.hand_origin=n.originX+"px "+n.originY+"px",a.hand_scale="right"==a.hand.type?1:-1,a.hand.x=parseInt(a.hand.x,10)||0,a.hand.y=parseInt(a.hand.y,10)||0,jQuery(i).appendTo(jQuery(r.p)),a.handadded=!0;var o=jQuery(r.p).find(".wb-thehand"),s=o.find(".wb-hand-image");punchgs.TweenLite.set(s,{scaleX:a.hand_scale,rotation:a.hand.rotation,transformOrigin:a.hand_origin,x:0-n.originX+a.hand.x,y:0-n.originY+a.hand.y}),punchgs.TweenLite.set(o.find(".wb-hand-scale"),{scale:e.bw,transformOrigin:"0% 0%"})},s=function(e){e.whiteboard.animating=!0},d=function(e,a,n){var o=e.layer.data(),d=jQuery(o.p).find(".wb-thehand"),h=d.find(".wb-hand-inner");switch(a.hand.mode){case"write":case"draw":var l,f,p,c,m=o.frames[e.frame_index].timeline.speed/1e3;if(null!=o.splitText&&"none"!=o.splitText)a.tweens=e.layersettings.timeline.getChildren(!0,!0,!1),jQuery.each(a.tweens,(function(t,i){if("frame_1"===e.frame_index&&this.data&&this.data.splitted)for(var r=i.timeline.getChildren(!0,!0,!1),o=r.length;o--;)r[o].eventCallback("onStart",(function(e,a,i){var r=jQuery(this.targets()[0]),o=r.width(),s=r.height();if(void 0!==r&&void 0!==r.html()&&r.html().length>0&&9!=r.html().charCodeAt(0)&&10!=r.html().charCodeAt(0)){var d=r.position(),h=r.parent(),l=h.parent(),f=this._dur,p=d.left,c=d.top;h.hasClass("rs_splitted_words")&&(p=h.position().left+p,c=h.position().top+c),l.hasClass("rs_splitted_lines")&&(p=l.position().left+p,c=l.position().top+c),i.rotatespeed=void 0!==i.hand.angleRepeat?parseFloat(f)/parseFloat(i.hand.angleRepeat):f>1||f>.5?f/6:f/3,i.jitterspeed=void 0!==i.jitter.repeat?parseFloat(f)/parseFloat(i.jitter.repeat):f>1||f>.5?f/6:f/3,i.current_y_offset!=c&&(f=.1),i.current_y_offset=c||0,i.maxwave=s,t<i.tweens.length-1?punchgs.TweenLite.to(e,f,{x:p+o}):punchgs.TweenLite.to(e,f,{x:p+o,onComplete:function(){i.handEffect="off";try{i.jittering_anim.kill(!1)}catch(e){}}})}else{i.current_y_offset=0,i.maxwave=s,i.handEffect="off";try{i.jittering_anim.kill(!1)}catch(e){}}n.whiteboard.animating=!0}),[h,e,a])}));else{var u=o.eow*a.jitter.distanceHorizontal,w=o.eow*a.jitter.offsetHorizontal,g=o.eoh*a.jitter.distance,y=o.eoh*a.jitter.offset;a.rotatespeed=void 0!==a.hand.angleRepeat?parseFloat(m)/parseFloat(a.hand.angleRepeat):m>1||m>.5?m/6:m/3,a.jitterspeed=void 0!==a.jitter.repeat?parseFloat(m)/parseFloat(a.jitter.repeat):m>1||m>.5?m/6:m/3,"right_to_left"==a.hand.direction?(c=(p=o.eow-w)-u,punchgs.TweenLite.fromTo(h,m,{x:p},{x:c,ease:e.layersettings.frames.frame_1.timeline.ease,onComplete:function(){a.handEffect="off"},onStart:s,onStartParams:[n]})):"top_to_bottom"==a.hand.direction?(f=(l=y)+g,punchgs.TweenLite.fromTo(h,m,{y:l},{y:f,ease:e.layersettings.frames.frame_1.timeline.ease,onComplete:function(){a.handEffect="off"},onStart:s,onStartParams:[n]}),a.jitter_direction="horizontal"):"bottom_to_top"==a.hand.direction?(f=(l=o.eoh-y)-g,punchgs.TweenLite.fromTo(h,m,{y:l},{y:f,ease:e.layersettings.frames.frame_1.timeline.ease,onComplete:function(){a.handEffect="off"},onStart:s,onStartParams:[n]}),a.jitter_direction="horizontal"):(c=(p=w)+u,punchgs.TweenLite.fromTo(h,m,{x:p},{x:c,ease:e.layersettings.frames.frame_1.timeline.ease,onComplete:function(){a.handEffect="off"},onStart:s,onStartParams:[n]}))}r(h,e,a),0==t.isFirefox&&i(h,e,a);break;case"move":function v(e){if(void 0!==this.targets){var t=this.targets();pos={x:t[0]._gsap.x,y:t[0]._gsap.y},void 0===d.data("pos")&&d.data("pos",pos),a.hand_inner_animation=punchgs.TweenLite.set(d,{x:pos.x,y:pos.y})}}d.data("outspeed",e.layersettings.frames.frame_999.timeline.speed/1e3),d.data("outease",e.layersettings.frames.frame_999.timeline.ease);var b=tpGS.gsap.getTweensOf(e.layer);len=b.length;for(var j=function(){n.whiteboard.animating=!0},_=0;_<len;_++)"frame_1"===e.frame_index&&(b[_].eventCallback("onStart",j),b[_].eventCallback("onUpdate",v,[e]))}d.data("wb",a)},h=function(e,t,a){e.whiteboard.animating=!1;var n=t.layer.data(),i=jQuery(n.p).find(".wb-thehand"),r=i.data("pos")||{x:0,y:0},o=i.position()||{top:0,left:0},s=n.frames.frame_999.timeline.speed/1e3||2,d=n.frames.frame_999.timeline.ease,h=0==r.x&&0==r.y?0:1;if(s*=.5,"move"!=a.hand.mode){var l=jQuery(n.p).position();o.left="right"==a.hand.type?e.c.width()-l.left+n.eow:0-l.left-n.eow,o.top=e.c.height()}punchgs.TweenLite.to(i,s,{top:o.top,left:o.left,autoAlpha:h,x:r.x,y:r.y,ease:d,onComplete:function(){i.remove(),a.handadded=!1}})}}(jQuery);