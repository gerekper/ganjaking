"use strict";!function(e,t){var n=t.modules.controls.Select.extend({isSurpriseControl:function(){return"_ha_design"===this.model.get("name")&&-1!==this.getWidgetName().indexOf("ha-")},onReady:function(){window.happyDesigns=window.happyDesigns||{},this.fetchSurprises()},onRender:function(){this.constructor.__super__.onRender.apply(this,arguments),this.isSurpriseControl()&&this.addResetButton()},onResetClick:function(){var e=t.getPanelView().getCurrentPageView().getOption("editedElementView");$e.run("document/elements/reset-style",{container:e.getContainer()})},addResetButton:function(){var e=this;this.ui.radio.parent().prev().after('<button class="ha-reset-design"><i title="Reset Style" class="eicon-undo ha-reset-design--disable" aria-hidden="true"></i> Reset Style</button>'),this.$el.find(".ha-reset-design").on("click",function(){e.onResetClick(),e.ui.radio.prop("checked",!1),e.setSettingsModel("")})},getElementSettingsModel:function(){return this.container.settings},getWidgetName:function(){return this.getElementSettingsModel().get("widgetType")},isFetched:function(){return!_.isUndefined(window.happyDesigns[this.getWidgetName()])},fetchSurprises:function(){var t=this;this.isSurpriseControl()&&!this.isFetched()&&this.getWidgetName()&&e.get(hapro.ajaxUrl,{action:"ha_make_me_surprised",widget:this.getWidgetName(),secret:hapro.secret}).done(function(e){e.success&&t.setSurprises(e.data)})},setSurprises:function(e){window.happyDesigns[this.getWidgetName()]=JSON.parse(e)},getSurprises:function(){return!_.isUndefined(window.happyDesigns)&&window.happyDesigns[this.getWidgetName()]||{}},onBaseInputChange:function(e){var t;this.constructor.__super__.onBaseInputChange.apply(this,arguments),this.isSurpriseControl()&&e.currentTarget.value&&(e.stopPropagation(),t=this.getSurprises(),_.isUndefined(t[e.currentTarget.value])||this.applySurprise(t[e.currentTarget.value]))},applySurprise:function(r){var e=this.getElementSettingsModel().controls,o=this,t={};_.each(e,function(e,i){var s;o.model.get("name")===i||_.isUndefined(r[i])||(e.is_repeater&&"_ha_condition_list"!=i&&((s=o.getElementSettingsModel().get(i).clone()).each(function(e,n){_.isUndefined(r[i][n])||_.each(e.controls,function(e,t){o.isStyleTransferControl(e)&&s.at(n).set(t,r[i][n][t])})}),t[i]=s),null!=o.isStyleTransferControl(e)&&o.isStyleTransferControl(e)&&(t[i]=r[i]))}),this.getElementSettingsModel().setExternalChange(t),this.container.view.render()},isStyleTransferControl:function(e){return!_.isUndefined(e.style_transfer)&&e.style_transfer?e.style_transfer:"content"!==e.tab||e.selectors||e.prefix_class}});t.addControlView("ha-image-selector",n)}(window.jQuery,window.elementor);