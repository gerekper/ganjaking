jQuery(document).ready(function(e){function n(n){return e("#wp-"+n+"-wrap").hasClass("tmce-active")?tinyMCE.get(n).getContent():e("#"+n).val()}function t(n,t){var i=e(n).closest("li.discussion-container"),a=i.find("div.ywqa-actions"),s=i.find("div.ywqa-modify-content"),o=i.find("div.wp-editor-wrap.tmce-active"),c=i.find("div.answer-content"),r=i.find("a.action-confirm"),d=i.find("span.confirm-delete"),l=i.find("div.badge.unapproved");s.css("display","inherit"),a.css("display","none"),c.css("display","none"),l.css("display","none"),"edit"==t?o.css("display","inherit"):"delete"==t&&d.css("display","inherit"),r.data("op-type",t)}function i(n,t){var i=e(n).closest("li.discussion-container"),a=i.find("div.ywqa-actions"),s=i.find("div.ywqa-modify-content"),o=i.find("div.wp-editor-wrap.tmce-active"),c=i.find("div.answer-content"),r=i.find("a.action-confirm"),d=i.find("span.confirm-delete"),l=i.find("div.badge.unapproved");o.css("display","none"),s.css("display","none"),d.css("display","none"),c.css("display","inherit"),a.css("display","inherit"),l.css("display","inherit"),r.data("op-type","")}e(document).on("click","input#publish",function(n){return 0==e("input#title").val().length?(n.preventDefault(),alert("Please fill in a title"),!1):"-1"===e("#select_product").val()?(n.preventDefault(),alert("Please select a product"),!1):void 0}),e(document).on("click","input#submit-answer",function(t){t.preventDefault(),e("#question-content-div .error").empty(),e("#question-content-div .success").empty();var i=n("respond-to-question");if(0==i.length)return e("#wp-respond-to-question-wrap").after('<span class="error">'+ywqa.empty_answer+"</span>"),!1;var a={action:"admin_respond_to_question",question_id:e("#post_ID").val(),answer_content:i,product_id:e("input#product_id").val(),answered_backend:"1"},s=e("#question-content-div");s.block({message:null,overlayCSS:{background:"#fff url("+ywqa.loader+") no-repeat center",opacity:.6}}),e.post(ywqa.ajax_url,a,function(n){1==n.code?(e("#respond-to-question").after('<span class="success">'+ywqa.answer_success+"</span>"),e("#answers").replaceWith(n.items)):-1==n.code&&e("#respond-to-question").after('<span class="error">'+ywqa.answer_error+"</span>"),s.unblock()})}),e(document).on("click","a.action-modify",function(n){n.preventDefault();var i=e(this).closest("li.discussion-container");i.block({message:null,overlayCSS:{background:"#fff url("+ywqa.loader+") no-repeat center",opacity:.6}}),t(e(this),"edit"),i.unblock()}),e(document).on("click","a.action-delete",function(n){n.preventDefault();var i=e(this).closest("li.discussion-container");i.block({message:null,overlayCSS:{background:"#fff url("+ywqa.loader+") no-repeat center",opacity:.6}}),t(e(this),"delete"),i.unblock()}),e(document).on("click","a.action-confirm",function(t){t.preventDefault();var a=e(this).data("op-type"),s=e(this),o=e("div.ywqa-modify-content"),c=e(this).closest("li.discussion-container"),r=e(this).data("discussion-id"),d="";"edit"==a&&(d=n("edit-answer-"+r));var l={action:"edit_discussion_content",discussion_id:r,discussion_content:d,action_type:a};c.block({message:null,overlayCSS:{background:"#fff url("+ywqa.loader+") no-repeat center",opacity:.6}}),e.post(ywqa.ajax_url,l,function(e){e.code?("edit"==a?c.find("span.answer-text").html(d):"delete"==a&&c.remove(),i(s)):-1==e.code&&o.after('<span class="error">'+ywqa.answer_error+"</span>"),c.unblock()})}),e(document).on("click","a.change-status",function(n){n.preventDefault();var t=e(this).data("action"),i=(e(this),e(this).closest("li.discussion-container")),a={action:"change_answer_status",action_type:t,discussion_id:e(this).data("discussion-id")};i.block({message:null,overlayCSS:{background:"#fff url("+ywqa.loader+") no-repeat center",opacity:.6}}),e.post(ywqa.ajax_url,a,function(e){e.code>0?""!=e.result&&i.replaceWith(e.result):-1==e.code&&confirm_section.after('<span class="error">'+ywqa.answer_error+"</span>"),i.unblock()})}),e(document).on("click","a.action-cancel",function(n){n.preventDefault(),i(e(this))})});