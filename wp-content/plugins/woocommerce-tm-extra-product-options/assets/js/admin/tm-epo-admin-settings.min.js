!function(t,e,s){"use strict";function o(t){var e,o=s("#tm_epo_consent_for_transmit");o.length&&o.is(":checked")&&0===y&&(y=1,s(".tm-license-button").block({message:null}),e={action:"tm_"+t+"_license",username:s("#tm_epo_envato_username").val(),key:s("#tm_epo_envato_purchasecode").val(),security:b.settings_nonce},s.post(b.ajax_url,e,function(t){var e;e=t&&-1!==t?t&&t.message&&t.result&&("-3"===t.result||"-2"===t.result||"wp_error"===t.result||"server_error"===t.result)?t.message:t&&t.message&&t.result&&"4"===t.result?t.message:"":b.i18n_invalid_request,s(".tm-license-result").html(e),s(".tm-license-button").unblock()},"json").always(function(e){s(".tm-license-button").unblock(),y=0,e&&e.result&&"4"===e.result&&("activate"===t&&(s(".tm-deactivate-license").removeClass("tm-hidden"),s(".tm-activate-license").removeClass("tm-hidden").addClass("tm-hidden")),"deactivate"===t&&(s(".tm-deactivate-license").removeClass("tm-hidden").addClass("tm-hidden"),s(".tm-activate-license").removeClass("tm-hidden")))}))}function n(t){var e=t.val(),o=s("#tm_epo_options_placement_custom_hook").closest("tr");"custom"===e?o.show():o.hide()}function a(t){var e=t.val(),o=s("#tm_epo_totals_box_placement_custom_hook").closest("tr");"custom"===e?o.show():o.hide()}function i(t){var e=t.val(),o=s("#tm_epo_options_placement").closest("tr"),i=s("#tm_epo_totals_box_placement").closest("tr"),l=s("#tm_epo_options_placement_custom_hook").closest("tr"),c=s("#tm_epo_totals_box_placement_custom_hook").closest("tr");"action"===e?(o.hide(),i.hide(),l.hide(),c.hide()):(o.show(),i.show(),n(s("#tm_epo_options_placement")),a(s("#tm_epo_totals_box_placement")))}function l(t){var e=t.val(),o=s("#tm_epo_floating_totals_box_visibility").closest("tr"),n=s("#tm_epo_floating_totals_box_add_button").closest("tr"),a=s("#tm_epo_totals_box_pixels").closest("tr");"disable"===e?(o.hide(),n.hide(),a.hide()):(o.show(),n.show(),c(s("#tm_epo_floating_totals_box_visibility")))}function c(t){var e=t.val(),o=s("#tm_epo_floating_totals_box").val(),n=s("#tm_epo_totals_box_pixels").closest("tr");"always"===e||"disable"===o?n.hide():n.show()}function m(t){var e=t.is(":checked"),o=s("#tm_epo_show_price_inside_option_hidden_even").closest("tr"),n=s("#tm_epo_multiply_price_inside_option").closest("tr");e?(o.show(),n.show()):(o.hide(),n.hide())}function _(t){var e=t.is(":checked"),o=s("#tm_epo_show_upload_image_replacement").closest("tr");e?o.hide():o.show()}function r(t){s(t).closest("td").css("position","relative").append('<label class="tm-epo-field-label"><span class="tm-epo-style-wrapper"><input type="checkbox" checked><span class="tm-epo-style"></span></span></label><label class="tm-epo-field-label"><span class="tm-epo-style-wrapper"><input type="radio" checked><span class="tm-epo-style"></span></span></label>')}function d(t){var e=t.val();s(".tm-epo-field-label").find(".tm-epo-style-wrapper, .tm-epo-style").removeClass("square square2 round round2").addClass(e)}function p(t){var e=t.val(),o=s("#tm_epo_css_styles_style").closest("tr");"on"===e?o.show():o.hide()}function u(t){s(t).closest("td").css("position","relative").append('<div class="tm-border-type"></div>')}function f(t){var e=t.val();s(".tm-border-type").removeClass("square round shadow thinline").addClass(e)}function h(t){return t.closest("tr")}function v(t,e,s,o){h(s).addClass("tm-hidden"),h(s.filter("."+t)).removeClass("tm-hidden"),o.find(".tm-section-desc .tm-section-menu-item").removeClass("active"),e.addClass("active")}var b=t.TMEPOADMINSETTINGSJS,g=s.epoAPI.util.getStorage("localStorage"),x=t.confirm,w=t.toastr,y=0;s(e).ready(function(){var h,y=s(".tm-settings-wrap");y.length>0&&((h=y.find(":checkbox")).closest("label").addClass("tm-epo-switch-wrapper-label"),h.wrap('<span class="tm-epo-switch-wrapper tc"></span>'),h.after('<span class="tc-label tm-epo-switch tc"></span>'),s(".forminp .description").toArray().forEach(function(t){var e=s(t);e.closest("tr").find(".titledesc").append(e)}),s("#tm_epo_consent_for_transmit").closest("tr").after(s('<tr valign="top"><th scope="row" class="titledesc tm-license-div"></th><td class="forminp forminp-license"></td></tr>')),s(".tm-license-div").append(s(".tm-license-button")),s(".forminp-license").append(s(".tm-license-result")),s(t).on("tc-opentab.tmtabs tc-isopentab.tmtabs",function(t,e){var o,n,a,i=e.table.find(".tm-section-desc .tm-section-menu-item");i.length>0&&(g&&(o=g.getItem("tmadminextratab")),n=i.filter('[data-menu="'+o+'"]'),a=e.table.find("select,input,text,textarea"),o&&0!==n.length||(o=(n=s(i).eq(0)).attr("data-menu")),v(o,n,a,e.table))}),s(e).on("keydown.tmtabs",".tm-section-menu-item",function(t){var e,o=s(this);13===t.keyCode&&o.trigger("click"),39===t.keyCode&&(e=o.next(".tm-section-menu-item")),37===t.keyCode&&(e=o.prev(".tm-section-menu-item")),e&&e.length&&(o.blur(),e.focus().trigger("click"),t.preventDefault())}),s(e).on("click",".tm-section-menu-item",function(){var t=s(this),e=t.attr("data-menu"),o=t.closest(".tm-tab");v(e,t,o.find("select,input,text,textarea"),o),g&&g.setItem("tmadminextratab",e)}),s(t).on("tc-tmtabs-clicked",function(t,e){var o,n,a,i,l,c=e.table.find(".tm-section-desc .tm-section-menu-item");c.length>0&&(g&&(o=g.getItem("tmadminextratab")),g&&(n=g.getItem("tmadminextratab-context")),a=e.header.attr(e.options.dataattribute),l=e.table.find("select,input,text,textarea"),o&&n===a?i=c.filter('[data-menu="'+o+'"]'):o=(i=s(c).eq(0)).attr("data-menu"),g&&g.setItem("tmadminextratab-context",a),i.length>0&&!i.is(".active")&&v(o,i,l,e.table))}),s(e).on("click",".tc-save-button",function(t){var e=s(this).closest("form"),o=e.tcSerializeObject();o=s.extend(!0,o,{action:"tm_save_settings",save:"save",security:b.settings_nonce}),t.preventDefault(),e.block({message:null}),s.post(b.ajax_url,o,function(t){t&&(1===t.error?w.error(t.message,b.i18n_epo):w.success(t.message,b.i18n_epo))},"json").always(function(){e.unblock()})}),s(".tm-settings-wrap .tm-tabs").tmtabs(),s(".tm-activate-license").on("click",function(t){t.preventDefault(),o("activate")}),s(".tm-deactivate-license").on("click",function(t){t.preventDefault(),o("deactivate")}),s("#tm_epo_display").on("change",function(){i(s(this))}),s("#tm_epo_options_placement").on("change",function(){n(s(this))}),s("#tm_epo_totals_box_placement").on("change",function(){a(s(this))}),s("#tm_epo_css_styles").on("change",function(){p(s(this))}),s("#tm_epo_css_styles_style").on("change",function(){d(s(this))}),s("#tm_epo_css_selected_border").on("change",function(){f(s(this))}),s("#tm_epo_floating_totals_box").on("change",function(){l(s(this))}),s("#tm_epo_floating_totals_box_visibility").on("change",function(){c(s(this))}),s("#tm_epo_show_price_inside_option").on("change",function(){m(s(this))}),s("#tm_epo_show_hide_uploaded_file_url_cart").on("change",function(){_(s(this))}),i(s("#tm_epo_display")),n(s("#tm_epo_options_placement")),a(s("#tm_epo_totals_box_placement")),r(s("#tm_epo_css_styles_style")),d(s("#tm_epo_css_styles_style")),p(s("#tm_epo_css_styles")),u(s("#tm_epo_css_selected_border")),f(s("#tm_epo_css_selected_border")),l(s("#tm_epo_floating_totals_box")),c(s("#tm_epo_floating_totals_box_visibility")),m(s("#tm_epo_show_price_inside_option")),_(s("#tm_epo_show_hide_uploaded_file_url_cart")),s(e).on("click.cpf",".tm-mn-movetodir,.tm-mn-deldir,.tm-mn-delfile",function(t){var e,o=s(this),n=s(".forminp-tm_html");if(t.preventDefault(),n.length>0){if(n.data("doing_ajax"))return;if(o.is(".tm-mn-deldir")&&!x(b.i18n_mn_delete_folder))return;if(o.is(".tm-mn-delfile")&&!x(b.i18n_mn_delete_file))return;o.prepend('<i class="tm-icon tcfa tcfa-spin tcfa-spinner"></i>'),n.data("doing_ajax",1).block({message:null}),e={action:"tm_mn_movetodir",dir:o.attr("data-tm-dir"),security:b.settings_nonce},o.is(".tm-mn-deldir")?(e.action="tm_mn_deldir",e.tmdir=o.attr("data-tm-deldir")):o.is(".tm-mn-delfile")&&(e.action="tm_mn_delfile",e.tmfile=o.attr("data-tm-delfile"),e.tmdir=o.attr("data-tm-deldir")),s.post(b.ajax_url,e,function(t){var e;t&&t.result&&""!==t.result?n.html(t.result):t&&t.error&&t.message&&(e=s.tmEPOAdmin.builder_floatbox_template_import({id:"temp_for_floatbox_insert",html:'<div class="tm-inner">'+t.message+"</div>",title:b.i18n_error_title}),s.tcFloatBox({closefadeouttime:0,animateOut:"",fps:1,ismodal:!0,refresh:"fixed",width:"50%",height:"300px",classname:"flasho tm_wrapper tm-error",data:e}))},"json").always(function(){n.data("doing_ajax",0).unblock(),o.find(".tm-icon").remove()})}})),s.tcToolTip()})}(window,document,window.jQuery);