!function(o){"use strict";function a(t,e){return this.element=o(t),this.settings=o.extend({},o.fn.tcFloatBox.defaults,e),this.settings.type="<"+this.settings.type+">",this.top=0,this.left=0,this.ticking=!1,1===this.element.length&&(this.init(),this)}a.prototype={constructor:a,destroy:function(){var t=this.settings;return void 0!==this.instance&&(o.fn.tcFloatBox.instances.splice(this.instance,1),delete this.instance,t.hideelements&&o("embed, object, select").css({visibility:"visible"}),t._ovl&&(t._ovl.off(),t._ovl.remove(),delete t._ovl),o(t.floatboxID).remove(),this.element.removeData("tcfloatbox"),o(window).off("scroll.tcfloatbox"+this.instance),o(window).off("resize.tcfloatbox"+this.instance)),this},hide:function(){var t=this.settings;t.hideelements&&o("embed, object, select").css({visibility:"visible"}),!0===t.showoverlay&&t._ovl&&t._ovl.hide(),o(t.floatboxID).addClass("tc-closing").removeClass(t.animateIn).addClass(t.animateOut),o(t.floatboxID).animate({opacity:0},t.closefadeouttime,function(){o(t.floatboxID).hide(),o(t.floatboxID).removeClass("tc-closing").addClass("tc-closed")}),o(window).off("scroll.tcfloatbox"+this.instance),o(window).off("resize.tcfloatbox"+this.instance)},requestTick:function(){var t=this.settings;this.ticking||(t.refresh?setTimeout(this.requestAnimationFrame.bind(this),t.refresh):requestAnimationFrame(this.update),this.ticking=!0)},requestAnimationFrame:function(){requestAnimationFrame(this.update.bind(this))},update:function(){this.render(),this.ticking=!1},doit:function(){this.requestTick()},render:function(){var t=this.settings,e=o.epoAPI.dom.size(),i="fixed"===t.refresh?{top:0,left:0}:o.epoAPI.dom.scroll(),s=parseInt(i.top+(e.visibleHeight-o(t.floatboxID).height())/2,10),i=parseInt(i.left+(e.visibleWidth-o(t.floatboxID).width())/2,10);s=parseInt((s-this.top)/t.fps,10),i=parseInt((i-this.left)/t.fps,10),this.top+=s,this.left+=i,o(t.floatboxID).css({top:this.top+"px",left:this.left+"px",opacity:1})},show:function(){var t,e,i=this.settings;1===this.element.length&&(void 0===this.instance&&this.init(),i.hideelements&&o("embed, object, select").css({visibility:"hidden"}),e=o.epoAPI.dom.size(),!0===i.showoverlay&&(i._ovl?i._ovl.show():(i._ovl=o('<div class="fl-overlay"></div>').css({zIndex:parseInt(i.zIndex,10)-1,opacity:i.overlayopacity}),i._ovl.appendTo("body"),i.ismodal||(i.cancelEvent||i.unique?i._ovl.on("click",this.applyCancelEvent.bind(this)):i._ovl.on("click",i.cancelfunc.bind(this))))),i.showfunc&&i.showfunc.call(),o(i.floatboxID).removeClass("tc-closing").addClass(i.animationBaseClass+" "+i.animateIn),"fixed"===i.refresh?(!1!==i.top?t=i.top:(t=parseInt((e.visibleHeight-o(i.floatboxID).height())/2,10),t+="px"),o(i.floatboxID).css({position:"fixed",top:t}),!1!==i.left&&o(i.floatboxID).css({left:i.left})):this.render())},applyCancelEvent:function(){var t=this.settings;!0===t.cancelEvent?this.destroy():"function"==typeof t.cancelEvent&&t.cancelEvent.call(this,this)},applyCancelEventFromKey:function(t){27===t.which&&this.applyCancelEvent()},applyUpdateEvent:function(){var t=this.settings;"function"==typeof t.updateEvent&&t.updateEvent.call(this,this)},applyUpdateEventFromKey:function(t){13===t.which&&this.applyUpdateEvent()},init:function(){var t,e,i=this.settings;1===this.element.length&&(0<o.fn.tcFloatBox.instances.length&&(i.zIndex=parseInt(o.fn.tcFloatBox.instances[o.fn.tcFloatBox.instances.length-1].zIndex,10)+100),this.instance=o.fn.tcFloatBox.instances.length,o.fn.tcFloatBox.instances.push(i),i.id=i.id+this.instance,i.floatboxID="#"+o.epoAPI.dom.id(i.id),this.hide(),t=o.epoAPI.dom.size(),e=o.epoAPI.dom.scroll(),o(i.type).attr("id",i.id).addClass(i.classname).html(i.data).appendTo(this.element),o(i.floatboxID).css({width:i.width,height:i.height}),e=parseInt(e.left+(t.visibleWidth-o(i.floatboxID).width())/2,10),o(i.floatboxID).css({top:"0px",left:e+"px","z-index":i.zIndex}),this.top=0,this.left=e,this.cancelfunc=i.cancelfunc,i.cancelEvent&&i.cancelClass&&(o(i.floatboxID).find(i.cancelClass).on("click",this.applyCancelEvent.bind(this)),i.isconfirm&&o(document).off("keyup.escape-"+i.floatboxID).on("keyup.escape-"+i.floatboxID,this.applyCancelEventFromKey.bind(this))),i.updateEvent&&i.updateClass&&(o(i.floatboxID).find(i.updateClass).on("click",this.applyUpdateEvent.bind(this)),i.isconfirm&&o(document).off("keyup.enter-"+i.floatboxID).on("keyup.enter-"+i.floatboxID,this.applyUpdateEventFromKey.bind(this))),this.show(),"fixed"!==i.refresh&&o(window).on("scroll.tcfloatbox"+this.instance,this.doit.bind(this)),o(window).on("resize.tcfloatbox"+this.instance,this.doit.bind(this)))}},o.fn.tcFloatBox=function(t){var e,i=o(this),s=i.data("tcfloatbox"),n="object"==typeof t?t:{};return s||(s=new a(this,n),i.data("tcfloatbox",s)),void 0===(e="string"==typeof t?s[t].apply(s,[]):e)?i:e},o.fn.tcFloatBox.defaults={id:"flasho",classname:"flasho",type:"div",data:"",width:"500px",height:"auto",closefadeouttime:1e3,animationBaseClass:"tm-animated",animateIn:"fadein",animateOut:"fadeout",top:!1,left:!1,refresh:!1,fps:4,hideelements:!1,showoverlay:!0,zIndex:100100,ismodal:!1,cancelfunc:a.prototype.hide,showfunc:null,cancelEvent:!0,cancelClass:".floatbox-cancel",updateEvent:!1,updateClass:!1,unique:!0,overlayopacity:.5,isconfirm:!1},o.fn.tcFloatBox.instances=[],o.fn.tcFloatBox.Constructor=a,o.tcFloatBox=function(t){var e=o("body"),i=!1;return e.map(function(){return o(this).data("tcfloatbox")||""}).get().some(function(t){return""===t})||t.unique?(i=new a(e,t),e.data("tcfloatbox",i)):(i=e.data("tcfloatbox")).init(),i}}(window.jQuery);