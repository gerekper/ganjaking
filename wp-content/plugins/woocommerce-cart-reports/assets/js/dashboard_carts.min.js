jQuery(function () {
	function a(a) {
		var b = [],
			c = new Date(a.xaxis.min);
		c.setUTCDate(c.getUTCDate() - (c.getUTCDay() + 1) % 7);
		c.setUTCSeconds(0);
		c.setUTCMinutes(0);
		c.setUTCHours(0);
		var d = c.getTime();
		do {
			b.push({
				xaxis: {
					from: d,
					to: d + 1728e5
				}
			});
			d += 6048e5
		} while (d < a.xaxis.max);
		return b
	}
	function h(a, b, c) {
		jQuery('<div id="tooltip">' + c + "</div>").css({
			position: "absolute",
			display: "none",
			top: b + 5,
			left: a - 50,
			padding: "5px 10px",
			border: "3px solid #3da5d5",
			background: "#288ab7"
		}).appendTo("body").fadeIn(200)
	}
	var b = jQuery.parseJSON(paramscarts.order_data.replace(/&quot;/g, '"')),
		c = b.converted_counts,
		d = b.updated_counts;
	for (var e = 0; e < c.length; ++e) {
		c[e][0] += 36e5;
	}
	for (var e = 0; e < d.length; ++e) {
		d[e][0] += 36e5;
	}
	var f = jQuery("#placeholder_carts"),
		g = jQuery.plot(f, [{
			label: paramscarts.number_of_converted_carts,
			data: c
		}, {
			label: paramscarts.number_of_updated_carts,
			data: d,
			yaxis: 1
		}], {
			series: {
				stack:true,
				lines: {
					fill: true,
					show: !0
				},
				points: {
					show: !0
				}
			},
			grid: {
				show: !0,
				aboveData: !1,
				color: "#ccc",
				backgroundColor: "#fff",
				borderWidth: 2,
				borderColor: "#ccc",
				clickable: !1,
				hoverable: !0,
				markings: a
			},
			xaxis: {
				mode: "time",
				timeformat: "%d %b",
				monthNames: paramscarts.month_names,
				tickLength: 1,
				minTickSize: [1, "day"]
			},
			yaxes: [{
				position: "right",
				min: 0,
				tickSize: 10,
				tickDecimals: 0
			}],
			colors: [ "green","red"]
		});
	f.resize();
	var i = null;
	jQuery("#placeholder_carts").bind("plothover", function (a, b, c) {
		if (c) {
			if (i != c.dataIndex) {
				i = c.dataIndex;
				jQuery("#tooltip").remove();
				if (c.series.label == paramscarts.number_of_converted_carts) {
					var d = c.datapoint[1];
					h(c.pageX, c.pageY, c.series.label + ": " + Math.round(d));
				} else {
					var d = c.datapoint[1].toFixed(2);
					h(c.pageX, c.pageY, "Open, Abandoned, and Converted : " + Math.round(d));
				}
			}
		} else {
			jQuery("#tooltip").remove();
			i = null;
		}
	});
});
